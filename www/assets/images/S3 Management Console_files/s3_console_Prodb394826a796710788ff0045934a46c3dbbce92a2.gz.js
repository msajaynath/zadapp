"use strict";(function(){var h="integ";var b={LOCAL:"LOCAL",PROD:"PROD",GAMMA:"GAMMA"};var i={PUBLIC:{NAME:"PUBLIC",SUFFIX:"aws.amazon.com",PROD:"console.aws.amazon.com",GAMMA:"awsc-integ.aws.amazon.com"},CN:{NAME:"CN",SUFFIX:"amazonaws.cn",PROD:"console.amazonaws.cn",GAMMA:"aws-console-platform-proxy-integ-bjs.integ.amazonaws.cn"}};var l="s3";var d=[l,"batchOpsServlet","sns","sqs","lambda","kms","cloudwatch"];var g={PUBLIC:"us-east-1",CN:"cn-north-1"};var m=["us-east-1","us-east-2","us-west-1","us-west-2","eu-west-1","eu-central-1","ap-south-1","ap-southeast-1","ap-southeast-2","ap-northeast-1","ap-northeast-2","sa-east-1"];var f={PUBLIC:{PROD:["us-east-1","us-east-2","us-west-1","us-west-2","eu-west-1","eu-central-1","ap-south-1","ap-southeast-1","ap-southeast-2","ap-northeast-1","ap-northeast-2","sa-east-1","ca-central-1","eu-west-2"],GAMMA:["us-east-1","eu-west-1"]},CN:{PROD:["cn-north-1"],GAMMA:["cn-north-1"]}};_.remove(f.PUBLIC.PROD,function(n){return n!==g.PUBLIC&&!e(n)});if(f.PUBLIC.PROD.length===1){f.PUBLIC.PROD=m}var k={PUBLIC:["us-east-1","us-east-2","us-west-1","us-west-2","eu-west-1","eu-central-1","ap-south-1","ap-southeast-1","ap-southeast-2","ap-northeast-1","ap-northeast-2","ca-central-1","eu-west-2","sa-east-1"],CN:["cn-north-1"]};var j=b.LOCAL;var a=b.LOCAL;if(_.contains(window.location.host,i.CN.SUFFIX)){a=i.CN.NAME;j=_.contains(window.location.host,h)?b.GAMMA:b.PROD}if(_.contains(window.location.host,i.PUBLIC.SUFFIX)){a=i.PUBLIC.NAME;j=_.contains(window.location.host,h)?b.GAMMA:b.PROD}var c={};if(a===i.PUBLIC.NAME){d.forEach(function(n){c[n]={};k[a].forEach(function(o){var p=_.includes(f[a][j],o)?o:g[a];if(n!==l){c[n][o]="https://"+p+"."+i[a][j]+"/s3/"+n+"-proxy"}else{c[n][o]="https://"+p+"."+i[a][j]+"/s3/proxy"}})});angular.module("awsconsole.common").constant("S3Endpoint",c[l]);angular.module("awsconsole.common").constant("S3CWSEndpoint",c.batchOpsServlet);angular.module("awsconsole.common").constant("SNSEndpoint",c.sns);angular.module("awsconsole.common").constant("SQSEndpoint",c.sqs);angular.module("awsconsole.common").constant("LambdaEndpoint",c.lambda);angular.module("awsconsole.common").constant("KMSEndpoint",c.kms);angular.module("awsconsole.common").constant("CloudWatchEndpoint",c.cloudwatch)}else{angular.module("awsconsole.common").constant("S3Endpoint","/s3/proxy");angular.module("awsconsole.common").constant("S3CWSEndpoint","/s3/batchOpsServlet-proxy");angular.module("awsconsole.common").constant("SNSEndpoint","/s3/sns-proxy");angular.module("awsconsole.common").constant("KMSEndpoint","/s3/kms-proxy");angular.module("awsconsole.common").constant("LambdaEndpoint","/s3/lambda-proxy");angular.module("awsconsole.common").constant("SQSEndpoint","/s3/sqs-proxy");angular.module("awsconsole.common").constant("CloudWatchEndpoint","/s3/cloudwatch-proxy")}angular.module("awsconsole.common").constant("IAMEndpoint","/s3/iam-proxy");angular.module("awsconsole.common").constant("IAMAdminEndpoint","/s3/iamadmin-proxy");angular.module("awsconsole.common").constant("OptOutEndpoint","/s3/optOutServlet-proxy");function e(q){var o={};var n=$("#meta-features-json");if(!n||!n.attr("data-featuresjson")){return false}var p=JSON.parse(n.attr("data-featuresjson"));if(angular.isArray(p)){p.forEach(function(r){o[r.externalId]=r.enabled})}return o["s3-prod-stack-"+q]===true}})();"use strict";(function(){var a=angular.module("s3",["AWS-DBUX-FAC","AWS-UI-Components","awsCommonComponents","awsconsole.common","ngCookies","ngRoute","ui.ace","pascalprecht.translate","storageconsole.common"]);a.config(["$routeProvider","$locationProvider","S3Constants",function(d,b,c){b.html5Mode({enabled:true});d.when("/"+c.PATH_SEGMENTS.BUCKETS+"/:"+c.PATH_SEGMENTS.BUCKET_NAME+"/:"+c.PATH_SEGMENTS.KEY_PREFIX+"*/"+c.PATH_SEGMENTS.OBJECT_DETAILS,{templateUrl:"/s3/partials/object-details/objectdetails.html",controller:"ObjectDetailsController",resolve:{translations:["$translate",function(e){return e.onReady()}]}});d.when("/"+c.PATH_SEGMENTS.BUCKETS+"/:"+c.PATH_SEGMENTS.BUCKET_NAME+"/:"+c.PATH_SEGMENTS.KEY_PREFIX+"*",{templateUrl:"/s3/partials/bucketdetails.html",controller:"ObjectController",resolve:{translations:["$translate",function(e){return e.onReady()}]}});d.when("/"+c.PATH_SEGMENTS.BUCKETS+"/:"+c.PATH_SEGMENTS.BUCKET_NAME,{templateUrl:"/s3/partials/bucketdetails.html",controller:"ObjectController",resolve:{translations:["$translate",function(e){return e.onReady()}]}});d.when("/ot/"+c.PATH_SEGMENTS.BUCKETS+"/:"+c.PATH_SEGMENTS.BUCKET_NAME+"/:"+c.PATH_SEGMENTS.KEY_PREFIX+"*/"+c.PATH_SEGMENTS.OBJECT_DETAILS,{templateUrl:"/s3/partials/object-details/objectdetails.html",controller:"ObjectDetailsController",resolve:{translations:["$translate",function(e){return e.onReady()}]}});d.when("/lc/"+c.PATH_SEGMENTS.BUCKETS+"/:"+c.PATH_SEGMENTS.BUCKET_NAME,{templateUrl:"/s3/partials/bucketdetails.html",controller:"ObjectController",resolve:{translations:["$translate",function(e){return e.onReady()}]}});d.when("/oi/"+c.PATH_SEGMENTS.BUCKETS+"/:"+c.PATH_SEGMENTS.BUCKET_NAME,{templateUrl:"/s3/partials/bucketdetails.html",controller:"ObjectController",resolve:{translations:["$translate",function(e){return e.onReady()}]}});d.when("/si/"+c.PATH_SEGMENTS.BUCKETS+"/:"+c.PATH_SEGMENTS.BUCKET_NAME,{templateUrl:"/s3/partials/bucketdetails.html",controller:"ObjectController",resolve:{translations:["$translate",function(e){return e.onReady()}]}});d.otherwise({templateUrl:"/s3/partials/buckets.html",controller:"LambController",resolve:{translations:["$translate",function(e){return e.onReady()}]}})}]);a.config(["$httpProvider",function(b){b.defaults.useXDomain=true;b.defaults.withCredentials=true}]);a.config(["$translateProvider",function(d){var b={en:"/s3/translations/messages_en.json",en_US:"/s3/translations/messages_en.json",zh:"/s3/translations/messages_zh_cn.json",zh_CN:"/s3/translations/messages_zh_cn.json",ja:"/s3/translations/messages_ja_jp.json",ja_JP:"/s3/translations/messages_ja_jp.json",fr:"/s3/translations/messages_fr.json",fr_FR:"/s3/translations/messages_fr.json"};var c=$("meta[property='requestLocale']").attr("content");d.useStaticFilesLoader({filePath:b[c]}).preferredLanguage(c);d.useSanitizeValueStrategy("escapeParameters");d.forceAsyncReload(true)}]);a.filter("humanReadableBytes",["S3Constants",function(b){return function(d,c){if(d===0){return d+" "+b.UNITS[d]}if(isNaN(d)){return""}if(typeof c==="undefined"){c=1}var e=Math.floor(Math.log(d)/Math.log(1024));return(d/Math.pow(1024,Math.floor(e))).toFixed(c)+" "+b.UNITS[e]}}])})();"use strict";(function(){angular.module("s3").constant("S3Constants",{CLOG_PAGE_ID:"s3v2",CLOG_OBJECTS_PAGE_ID:"s3v2-objects",CLOG_OBJECTS_DETAILS_PAGE_ID:"s3v2-objectdetails",DELIMITER:"/",PATH_SEGMENTS:{BUCKETS:"buckets",BUCKET_NAME:"bucketName",KEY_PREFIX:"prefix",OBJECT_DETAILS:"details"},SHOW_DELETED_PARAM:"showdeleted",UPLOAD:{TIMEOUT_MSECS:3600000,PART_SIZE_IN_BYTES:8388608,MAX_NUMBER_OF_PARTS:10000,MIN_NUMBER_OF_PARTS:1,ZERO_BYTE_MD5:"d41d8cd98f00b204e9800998ecf8427e",CUSTOM_ARN:"CUSTOM_ARN",USER_ERROR_MESSAGES:["Access Denied","Forbidden","Bad Request","Your proposed upload is smaller than the minimum allowed size","OptionsRequestDenied","OptionsResponseMissingHeaders"]},OBJECT_SSE:{AES256:"AES256",CUSTOM_ARN:"CUSTOM_ARN",KMS_ENCRYPTION:"aws:kms",NONE:"NONE"},MULTIPART_COPY:{PART_SIZE:16777216},HTTP_STATUS_CODES:{PERMANENT_REDIRECT:301,ACCESS_DENIED:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,SERVER_ERROR_THRESHOLD:500,CLIENT_ERROR_THRESHOLD:300},BATCH_OPS_MAX_KEYS_PER_OP:20,LIST_OBJECTS_MAX_KEYS_PER_LISTING:100,LIST_DELETED_OBJECTS_MAX_KEYS_PER_LISTING:1000,FAC:{OBJECT_TAGGING:"s3-ot",TAG_QUERY:"s3-tq",QUICKSIGHT:"s3-qs",NEW_MULTIPART_COPY:"s3-new-multipart-copy",ANALYTICS:"s3-an",INVENTORY:"s3-oi",METRICS:"s3-me"},OPERATION:{NAME:"opName",ID:"opId",STEP:"opStep",INITIAL_BUCKET:"initialBucket",INITIAL_PATH:"initialPath",BUCKET_REGION:"bucketRegion",TIMESTAMP:"timestamp",CURRENT_BUCKET:"currentBucket",CURRENT_PATH:"currentPath",CWS_OP_ID:"cwsOpId",ERROR_STATUS:"errorStatus",THRESHOLD_PERCENTAGE:15},OPERATION_MANAGER_LOGGING:{STARTED:"S3ConsoleOperationStarted",ADDED:"S3ConsoleOperationsAdded",ENQUEUED:"S3ConsoleOperationsEnqueued",DEQUEUED:"S3ConsoleOperationsDequeued",CANCELED:"S3ConsoleOperationCanceled",COMPLETED:"S3ConsoleOperationCompleted"},OPERATION_PER_KEY_STATUS:{DONE:"SUCCESS",IN_PROGRESS:"IN_PROGRESS",ERROR:"ERROR"},S3_RESPONSE_HEADERS:{X_AMZ_ID_2:"x-amz-id-2",X_AMZ_REQUEST_ID:"x-amz-request-id",X_AMZ_BUCKET_REGION:"x-amz-bucket-region"},OPERATION_STATE:{ACTIVE:"active",WAITING:"waiting",CANCEL:"cancel",ERROR:"error",COMPLETED:"completed"},OPERATION_NAME:{ADD_OBJECT_TAG:"Add object tags",COPY:"Copy",CUT:"Cut",PASTE:"Paste",GET_INFO:"GetInfo",MAKE_PUBLIC:"Make public",DELETE_OBJECTS:"Delete objects",RESTORE_OBJECTS:"Restore objects",EDIT_PERMISSIONS:"Edit permissions",CHANGE_STORAGE_CLASS:"Change storage class",CHANGE_SSE:"Change SSE",UPLOAD:"Upload",LAMB:"LAMB",RENAME:"Rename",GET_OBJECT_DETAILS:"GetObjectDetails",LIST_DELETED_OBJECTS:"ListDeletedObjects",LIST_VERSIONS:"ListVersions",SWITCH_VERSION:"SwitchVersion",EMPTY_BUCKET:"Empty bucket",DELETE_BUCKET:"Delete bucket",CHANGE_METADATA:"Change metadata",GET_OBJECT_TAGGING:"GetObjectTagging",PUT_OBJECT_TAGGING:"PutObjectTagging",INITIATE_RESTORE:"Initiate restore",GET_METADATA:"Get object metadata",METRICS_GET_CONFIG:"GetMetricsConfig",METRICS_PUT_CONFIG:"PutMetricsConfig",METRICS_DELETE_CONFIG:"DeleteMetricsConfig",ANALYTICS_GET_CONFIG:"GetAnalyticsConfig",ANALYTICS_PUT_CONFIG:"PutAnalyticsConfig",ANALYTICS_DELETE_CONFIG:"DeleteAnalyticsConfig",ANALYTICS_GET_DATA:"GetAnalyticsData",SWITCH_BACK_TO_OLD_CONSOLE:"SwitchBackToOriginal",IS_INVENTORY_ENABLED:"isInventoryEnabled",IS_ANALYTICS_ENABLED:"isAnalyticsEnabled",IS_LIFECYCLE_ENABLED:"isLifecycleEnabled",IS_METRICS_ENABLED:"isMetricsEnabled"},METRIC_NAME:{LIFECYCLE_RULE_MISMATCH:"LifecycleRuleMismatch"},CWS_OPERATION_NAME:{ADD_OBJECT_TAG:"AddTags",CHANGE_METADATA:"ChangeMetadata",CHANGE_SSE:"ChangeSSE",CHANGE_STORAGE_CLASS:"ChangeStorageClass",COMPLETE_MULTIPART_COPY:"CompleteMultipartCopy",COPY:"CopyObject",GENERATE_COUNT:"Count",GENERATE_PRESIGNED_URL:"GeneratePresignedUrl",GET_METADATA:"GetObjectMetadata",INITIATE_RESTORE:"RestoreObject",MAKE_PUBLIC:"MakePublic",MULTIPART_COPY:"MultipartCopy"},PROGRESS_BAR:{USER_CONFIRM_CANCEL_FROM_PROGRESS_BAR:"S3ConsoleUserConfirmCancelProgressBar",USER_CONFIRM_CANCEL_FROM_DETAIL_MODAL:"S3ConsoleUserConfirmCancelDetailModal"},CACHE:{SIZE:{BUCKET_LOCATION:1000,BUCKET_PROPERTIES:11,LAMB:1,LIST_OBJECTS:50}},DIRECTORY_CONTENT_TYPE:"application/x-directory",OPT_OUT_COOKIE:{COOKIE_KEY:"awsc-experiment-override",PATH:"/s3",VALUE:{PUBLIC:"%7B%22s3_v2%22%3A%22zbRrjeUKQv%22%7D",CN:"%7B%22s3_v2%22%3A%229WEM14B71j%22%7D"}},HEADERS:{CACHE_CONTROL:"Cache-Control",CONTENT_DISPOSITION:"Content-Disposition",CONTENT_ENCODING:"Content-Encoding",CONTENT_LENGTH:"Content-Length",CONTENT_MD5:"Content-MD5",CONTENT_TYPE:"Content-Type",CONTENT_TYPE_JSON:"application/x-amz-json-1.1",EXPECT:"Expect",EXPIRES:"Expires",X_AMZ_MFA:"x-amz-mfa",X_AMZ_STORAGE_CLASS:"x-amz-storage-class",X_AMZ_SERVER_SIDE_ENCRYPTION:"x-amz-server-side-encryption",X_AMZ_SERVER_SIDE_ENCRYPTION_KMS_ID:"x-amz-server-side-encryption-aws-kms-key-id",X_AMZ_GRANT_READ:"x-amz-grant-read",X_AMZ_RESTORE:"x-amz-restore",X_AMZ_GRANT_READ_ACP:"x-amz-grant-read-acp",X_AMZ_GRANT_WRITE:"x-amz-grant-write",X_AMZ_GRANT_WRITE_ACP:"x-amz-grant-write-acp",X_AMZ_WEBSITE_REDIRECT_LOCATION:"x-amz-website-redirect-location",X_AMZ_REPLICATION_STATUS:"x-amz-replication-status",OPERATION:"X-Amazon-S3Console-Operation",X_AMZ_ID_2:"x-amz-id-2",X_AMZ_REQUEST_ID:"x-amz-request-id",X_AMZ_DATE:"X-Amz-Date",X_AMZ_EXPIRATION:"x-amz-expiration",X_AMZ_TAGGING:"x-amz-tagging"},STORAGE_CLASSES:{DEFAULT:"default",GLACIER:"GLACIER",Glacier:"GLACIER",REDUCED_REDUNDANCY:"REDUCED_REDUNDANCY","Reduced redundancy":"REDUCED_REDUNDANCY",STANDARD:"STANDARD",Standard:"STANDARD",STANDARD_INFREQUENT_ACCESS:"STANDARD_IA","Standard - IA":"STANDARD_IA"},UNITS:["B","KB","MB","GB","TB","PB"],LOGGING:{S3_REQUEST_PREFIX:"s3Req",S3_RESPONSE_PREFIX:"s3Res",CWS_REQUEST_PREFIX:"cwsReq",CWS_RESPONSE_PREFIX:"cwsRes"},ACL_PERMISSIONS:{READ:"READ",WRITE:"WRITE",READ_ACP:"READ_ACP",WRITE_ACP:"WRITE_ACP",FULL_CONTROL:"FULL_CONTROL"},VERSIONS:{LIST_VERSIONS_COMPLETED:"ListVersionsCompleted"},PUBLIC_PERMISSIONS_LIST:["AuthenticatedUsers","AllUsers"],LOG_DELIVERY_VALUE:"LogDelivery",BUCKET_PERMISSIONS:{PUT_BUCKET_PERMISSIONS_REQUEST:"put-bucket-permissions-request",GET_BUCKET_OWNER:"get-bucket-owner",CREATE_BUCKET_PERMISSIONS:"CreateBucketPermissions",INITIALIZE_ACLS:{publicPermissions:[{detail:{text:"Any authenticated AWS user",value:"AuthenticatedUsers",Type:"Group",URI:"http://acs.amazonaws.com/groups/global/AuthenticatedUsers"},permissions:{READ:false,READ_ACP:false,WRITE:false,WRITE_ACP:false}},{detail:{text:"Everyone",value:"AllUsers",Type:"Group",URI:"http://acs.amazonaws.com/groups/global/AllUsers"},permissions:{READ:false,READ_ACP:false,WRITE:false,WRITE_ACP:false}}],userPermissions:[{permissions:{READ:true,READ_ACP:true,WRITE:true,WRITE_ACP:true},revokeAll:false}]},SAMPLE_CORS_POLICY:"<!-- Sample policy -->\n<CORSConfiguration>\n\t<CORSRule>\n\t\t<AllowedOrigin>*</AllowedOrigin>\n\t\t<AllowedMethod>GET</AllowedMethod>\n\t\t<MaxAgeSeconds>3000</MaxAgeSeconds>\n\t\t<AllowedHeader>Authorization</AllowedHeader>\n\t</CORSRule>\n</CORSConfiguration>",POLICY_GEN:{PUBLIC:"http://awspolicygen.s3.amazonaws.com/policygen.html",CN:"https://awspolicygen.s3.cn-north-1.amazonaws.com.cn/policygen.html"}},BUCKET_PROPERTIES:{WEBSITE:{USE_BUCKET:"useBucket",PROPERTY_NAME:"website",INDEX_FILE:"index.html",CREATE_BUCKET_CARD:"create-bucket-website-card",REDIRECT_REQUEST:"redirectRequest",CONFIGURE_BUCKET_WEBSITE:"configureBucketWebsite",REDIRECT_BUCKET_WEBSITE_REQUESTS:"redirectBucketWebsiteRequests",NO_WEBSITE_CONFIGURATION_MESSAGE:"The specified bucket does not have a website configuration",DISABLE:"disable",REGION_TO_WEBSITE_ENDPOINT_MAP:{"us-east-1":"s3-website-us-east-1.amazonaws.com","us-west-2":"s3-website-us-west-2.amazonaws.com","us-west-1":"s3-website-us-west-1.amazonaws.com","eu-west-1":"s3-website-eu-west-1.amazonaws.com",EU:"s3-website-eu-west-1.amazonaws.com","ap-southeast-1":"s3-website-ap-southeast-1.amazonaws.com","ap-northeast-1":"s3-website-ap-northeast-1.amazonaws.com","ap-southeast-2":"s3-website-ap-southeast-2.amazonaws.com","sa-east-1":"s3-website-sa-east-1.amazonaws.com","eu-central-1":"s3-website.eu-central-1.amazonaws.com","ap-northeast-2":"s3-website.ap-northeast-2.amazonaws.com","ap-south-1":"s3-website.ap-south-1.amazonaws.com","us-east-2":"s3-website.us-east-2.amazonaws.com","ca-central-1":"s3-website.ca-central-1.amazonaws.com","eu-west-2":"s3-website.eu-west-2.amazonaws.com","us-gov-west-1":"s3-website-us-gov-west-1.amazonaws.com","us-iso-east-1":"s3-website.us-iso-east-1.c2s.ic.gov","cn-north-1":"s3-website.cn-north-1.amazonaws.com.cn"}},TAGGING:{PROPERTY_NAME:"tagging",CREATE_BUCKET_CARD:"create-bucket-tagging-card",PUT_BUCKET_TAGGING:"putBucketTagging",TAG_SET_NOT_EXIST_MESSAGE:"The TagSet does not exist"},PUT_BUCKET_ACL:"putBucketACL",GET_BUCKET_ACL:"getBucketACL",LOGGING:{ENABLE_BUCKET_LOGGING:"enableBucketLogging",CREATE_BUCKET_CARD:"create-bucket-logging-card",ENABLE:"enable"},VERSIONING:{ENABLE_BUCKET_VERSIONING:"enableBucketVersioning",CREATE_BUCKET_CARD:"create-bucket-versioning-card",ENABLED:"Enabled",ENABLE:"enable"},REPLICATION:{CREATE_BUCKET_CARD:"create-bucket-replication-card",PUT_REPLICATION:"putBucketReplication",DISABLED:"Disabled",ENABLED:"Enabled"},EVENTS:{PUT_NOTIFICATION:"putBucketNotification",CREATE_BUCKET_CARD:"create-bucket-events-card"},REPORTS:{CREATE_BUCKET_CARD:"create-bucket-reports-card",FREQUENCY:{DAILY:"DAILY",WEEKLY:"WEEKLY"},VERSIONING:{ALL:"All",CURRENT:"Current"},TYPE:{OBJECT:"OBJECT"},FORMAT:{CSV:"CSV"}},ENABLE:"enable",DISABLE:"disable",GROUP_GANTEE_TYPE:"Group",LOG_DELIVERY_GROUP:"http://acs.amazonaws.com/groups/s3/LogDelivery"},BULK_OPERATION_KEYS_PER_REQUEST:{S3_API:1000,CWS_API:20},BULK_OPERATION_KEY_COUNT_PER_ERROR_TYPE:100,BUCKET_EVENTS:{PUT:"s3:ObjectCreated:Put",POST:"s3:ObjectCreated:Post",COPY:"s3:ObjectCreated:Copy",COMPLETE_MULTIPART_UPLOAD:"s3:ObjectCreated:CompleteMultipartUpload",DELETE:"s3:ObjectRemoved:Delete",DELETE_MARKER_CREATED:"s3:ObjectRemoved:DeleteMarkerCreated",RRS_OBJECT_LOST:"s3:ReducedRedundancyLostObject",CREATE_OBJECT_ALL:"s3:ObjectCreated:*",DELETE_OBJECT_ALL:"s3:ObjectRemoved:*"},EVENTS:{PREFIX:"Prefix",SUFFIX:"Suffix",SNS:"SNS",SQS:"SQS",LAMBDA:"Lambda",CUSTOM:"custom",CLOUDCONFIG:"CloudFunctionConfiguration",QUEUECONFIG:"QueueConfiguration",TOPICCONFIG:"TopicConfiguration",TOPIC:"Topic",QUEUE:"Queue",CLOUDFN:"CloudFunction",CUSTOM_PLACEHOLDER:{LAMBDA:"us-east-1:123456789:function:my_function_name",SNS:"us-east-1:123456789012:my_topic",SQS:"us-east-1:123456789012:my_queue"}},REPLICATION:{ENABLED:"Enabled",DISABLED:"Disabled",CONFIGNOTFOUND:"The replication configuration was not found",NEWROLE:"newrole"},TAGGING:{ERROR_CODES:{NO_SUCH_TAG_SET:"NoSuchTagSet"},MAX_ALLOWED_TAGS:10},USER_DEFINED_METADATA:["Cache-Control","Content-Disposition","Content-Encoding","Content-Language","Content-Type","Expires","x-amz-website-redirect-location"],CONTENT_TYPE_VALUES:[{text:"binary/octet-stream"},{text:"image/png"},{text:"image/jpeg"},{text:"image/gif"},{text:"image/bmp"},{text:"image/tiff"},{text:"text/plain"},{text:"text/rtf"},{text:"application/msword"},{text:"application/zip"},{text:"audio/mpeg"},{text:"application/pdf"},{text:"application/x-gzip"},{text:"application/x-compressed"},{text:"application/zip"}],USER_DEFINED_METADATA_PREFIX:"x-amz-meta-",FILE_EXTENSIONS_ICON_MAP:{"default":"file-o","7z":"file-archive-o",dmg:"file-archive-o",gz:"file-archive-o",iso:"file-archive-o",jar:"file-archive-o",rar:"file-archive-o",tar:"file-archive-o",tgz:"file-archive-o",war:"file-archive-o",z:"file-archive-o",zip:"file-archive-o",mp3:"file-audio-o",bin:"file-code-o",c:"file-code-o","c++":"file-code-o",css:"file-code-o",html:"file-code-o",java:"file-code-o",js:"file-code-o",py:"file-code-o",sh:"file-code-o",xml:"file-code-o",xl:"file-excel-o",xlsx:"file-excel-o",xlsm:"file-excel-o",gif:"file-image-o",jpeg:"file-image-o",jpg:"file-image-o",png:"file-image-o",pdf:"file-pdf-o",ppt:"file-powerpoint-o",rt:"file-text-o",rtf:"file-text-o",rtx:"file-text-o",text:"file-text-o",txt:"file-text-o",avi:"file-video-o",flv:"file-video-o",m4v:"file-video-o",mov:"file-video-o",movie:"file-video-o",mp4:"file-video-o",qt:"file-video-o",wmv:"file-video-o",doc:"file-word-o",docm:"file-word-o",docx:"file-word-o",word:"file-word-o",trash:"trash-o"},LIFECYCLE:{NAME:"lifecycle",ENABLED:"Enabled",DISABLED:"Disabled",SIA:"SIA",GLACIER:"Glacier",EXPIRE:"Expire",AMU:"AMU",PREFIX_PROPERTY:"Prefix",PERMANENTLY_DELETE:"PermanentlyDelete",LIST_VIEW:{STANDARD_IA:"Standard-IA",GLACIER:"Amazon Glacier",PREFIX:"prefix : ",WHOLE:"Whole bucket",PermanentlyDelete:"Permanently Delete"},REVIEW_SECTION_TRANSITIONS:{SIA:"Standard-IA",Glacier:"Amazon Glacier",Expire:"Expire",PermanentlyDelete:"Permanently delete"},MAX_DAYS_ALLOWED:2147483647,EXPONENTIAL:"e",EXPIRATION:"Expiration",NON_CURRENT_VERSION_EXPIRATION:"NoncurrentVersionExpiration",NON_CURRENT_DAYS:"NoncurrentDays",DAYS:"Days",STORAGE_CLASS:"StorageClass",TRUE:"true",FALSE:"false",WHOLE_BUCKET:"whole",PREFIX:"prefix",TOTAL_OPTIONS:2,RULE_ACTIONS_MAP:{STANDARD_IA:"SIA",GLACIER:"Glacier",Expiration:"Expire",NoncurrentVersionExpiration:"PermanentlyDelete"},KEY:"Key",VALUE:"Value",TAGSET:"Tags",NONCURRENT_RULE_OPTIONS_MAP:{SIA:0,Glacier:1,PermanentlyDelete:2},CURRENT_RULE_OPTIONS_MAP:{SIA:0,Glacier:1,Expire:2},TAGS:"Tags",KEY_STRING:"Key",VALUE_STRING:"Value",BUCKET_LIFECYCLE:"BucketLifecycle",GET_BUCKET_LIFECYCLE:"getBucketLifecycle",PUT_BUCKET_LIFECYCLE:"putBucketLifecycle",ENABLED_LIFECYCLE_RULE_ACTIONS:"enabledLifecycleRuleActions",CREATE_BUCKET_LIFECYCLE:"createLifecycleRule",EDIT_BUCKET_LIFECYCLE:"editLifecycleRule",CURRENT:"current",NONCURRENT:"noncurrent",AMU_DEFAULT_DAYS:"7",LIFECYCLE_RULE_ACTION_MIN_DAYS:{SIA:30,Glacier:0,Expire:1,PermanentlyDelete:1,AMU:1,Delete:1},RECOMMENDED_DAYS:{SIA:"30",GLACIER:"1",EXPIRATION:"365"},RULE_ACTION_ERRORS:{SIA:0,GLACIER:1,EXPIRE:2,PERMANENTLY_DELETE:2,DELETE_RULE_ACTION:2,GLACIER_GREATER_THAN_SIA:"GlacierGreaterThanSIA",DELETE_RULE_ACTION_GREATER_THAN_SIA:"DeleteGreaterThanSIA",DELETE_RULE_ACTION_GREATER_THAN_GLACIER:"DeleteGreaterThanGlacier"},LIFECYCLE_DOES_NOT_EXIST_MESSAGE:"The lifecycle configuration does not exist",CONFIRMATION_MODAL:{ENABLE_POLICY:"enablePolicy",DISABLE_POLICY:"disablePolicy",DELETE_POLICY:"deletePolicy"},LIST_VIEW_MAX_LENGTH:25,ENABLE_LIFECYCLE_POLICY:"enableLifecyclePolicy",DISABLE_LIFECYCLE_POLICY:"disableLifecyclePolicy",DELETE_LIFECYCLE_POLICY:"deleteLifecyclePolicy"},KEY_CODES:{DOWN:40,ENTER:13,ESC:27,UP:38},ENTITY_MAX_LENGTH:{ROLE:64,POLICY:128,PATH:512,TAG_KEY:128,TAG_VALUE:256},REQUEST_METRICS:{SERVER_AVAILABILITY_SUFFIX:"-SerAvail",CLIENT_AVAILABILITY_SUFFIX:"-CliAvail",STATUS_CODE_INFIX:"-Code-",LATENCY_SUFFIX:"-latency"},PROXY_API_NAMES:{KMS:{LIST_KEYS:"KMS-ListKeys"},SNS:{LIST_TOPICS:"SNS-ListTopics"},SQS:{LIST_QUEUES:"SQS-ListQueues"},LAMBDA:{LIST_FUNCTIONS:"LAMBDA-listFunctions"},IAM:{LIST_ROLES:"IAM-ListRoles"},S3:{LAMB:"S3-LAMB",HEAD_BUCKET:"S3-HeadBucket",PUT_OBJECT:"S3-PutObject",HEAD_OBJECT:"S3-HeadObject",CREATE_BUCKET:"S3-CreateBucket",LIST_OBJECT:"S3-ListObject",LIST_VERSION:"S3-ListVersion",GET_OBJECT_TAG:"S3-GetObjectTag",PUT_OBJECT_TAG:"S3-PutObjectTag",GET_OBJECT_ACL:"S3-GetObjectAcl",PUT_OBJECT_ACL:"S3-PutObjectAcl",INITIAL_MULTIPART_UPLOAD:"S3-InitialMPUpload",COMPLETE_MULTIPART_UPLOAD:"S3-CompleteMPUpload",GET_OBJECT_METADATA:"S3-GetObjectMD",GET_PROPERTY_PREFIX:"S3-Get",PUT_PROPERTY_PREFIX:"S3-Put",DELETE_PROPERTY_PREFIX:"S3-Delete",DELETE:"S3-Delete",GET_OBJECT:"S3-GetObject",TAG_QUERY:"S3-TagQuery"}},IAM_REGION:"us-east-1",S3_DEFAULT_ENDPOINT:"https://s3.amazonaws.com",S3_ENDPOINTS:{"us-east-1":"https://s3.amazonaws.com","us-west-2":"https://s3-us-west-2.amazonaws.com","us-west-1":"https://s3-us-west-1.amazonaws.com","eu-west-1":"https://s3-eu-west-1.amazonaws.com","ap-southeast-1":"https://s3-ap-southeast-1.amazonaws.com","ap-northeast-1":"https://s3-ap-northeast-1.amazonaws.com","ap-southeast-2":"https://s3-ap-southeast-2.amazonaws.com","sa-east-1":"https://s3-sa-east-1.amazonaws.com","eu-central-1":"https://s3.eu-central-1.amazonaws.com","ap-northeast-2":"https://s3.ap-northeast-2.amazonaws.com","ap-south-1":"https://s3.ap-south-1.amazonaws.com","us-east-2":"https://s3.us-east-2.amazonaws.com","ca-central-1":"https://s3.ca-central-1.amazonaws.com","eu-west-2":"https://s3.eu-west-2.amazonaws.com","cn-north-1":"https://s3.cn-north-1.amazonaws.com.cn"},SESSION_TIMEOUT_MESSAGE:"Please (re)authenticate or return to https://console.aws.amazon.com",METRICS:{RANGE:{H1:"H1",H3:"H3",H12:"H12",H24:"H24",D3:"D3",W1:"W1",W2:"W2"},TYPE:{STORAGE:"storage",REQUESTS:"requests",DATA:"data"},UNIT:{COUNT:"Count",BYTES:"Bytes",MILLIS:"Milliseconds"}},MANAGEMENT:{VIEWS:{LIFECYCLE:0,ANALYTICS:1,CLOUDWATCH:2,INVENTORY:3},ACTION:{APPLYING_CONFIG:"applyingConfig",SAVING_FILTER:"savingFilter",CONFIG_LOADING:"configLoading",DELETE_FILTER:"deleteFilter",DATA_LOADING:"dataLoading"},FILTER_NAME_REGEX:/^[a-zA-Z0-9\-_.]+$/},ENTRY_STATE:{CREATE:0,ADDED:1,SAVED:2,REMOVE:3,UPDATE:4},STATUS_CODE_MAP:{"403":"Access Denied"},ACCELERATE:{COMPARISON_ENDPOINT:"http://s3-accelerate-speedtest.s3-accelerate.amazonaws.com/en/accelerate-speed-comparsion.html?",ENDPOINT:{PUBLIC:".s3-accelerate.amazonaws.com"}},ANALYTICS:{STORAGE_CLASS:{STANDARD:"STANDARD",STANDARD_IA:"STANDARD-IA",GLACIER:"GLACIER",REDUCED_REDUNDANCY:"REDUCED_REDUNDANCY"},ERROR:{USER_INFO_MISSING:"USER_INFO_MISSING",DATA_FILE_NOT_FOUND:"DATA_FILE_NOT_FOUND"},TAB_VIEW:"Tab",DETAILS:"Details",CREATE_BUCKET_MODAL:"CreateBucketModal",UPLOAD_OBJECTS_MODAL:"UploadObjectsModal",LIFECYCLE_RULES_MODAL:"LifecycleRulesModal",LATEST_VERSION:"LatestVersion",DOWNLOAD_AS:"DownloadAs",ADD_GRANTEE:"AddGrantee",SAVE_LOGGING:"SaveLogging",CANCEL_LOGGING:"CancelLogging",SAVE_WEBSITE:"SaveWebsite",CANCEL_WEBSITE:"CancelWebsite",SAVE_REPLICATION:"SaveReplication",CANCEL_REPLICATION:"CancelReplication",SAVE_EVENTS:"SaveEvents",CANCEL_EVENTS:"CancelEvents",SAVE_VERSIONING:"SaveVersioning",CANCEL_VERSIONING:"CancelVersioning",CONFIRMATION_MODAL:"ConfirmationModal",CARD_OPEN:"CardOpen",SAVE_TAGGING:"SaveTagging",CANCEL_TAGGING:"CancelTagging",SAVE_OBJECT_METADATA:"SaveObjectMetadata",CANCEL_OBJECT_METADATA:"CancelObjectMetadata",SAVE_OBJECT_TAGS:"SaveObjectTags",CANCEL_OBJECT_TAGS:"CancelObjectTags",SAVE_OBJECT_SSE:"SaveObjectSSE",CANCEL_OBJECT_SSE:"CancelObjectSSE",SAVE_OBJECT_STORAGE_CLASS:"SaveObjectStorageClass",CANCEL_OBJECT_STORAGE_CLASS:"CancelObjectStorageClass",CREATE_BUCKET_S3:"CreateBucketS3",START_CREATE_BUCKET:"Start_CreateBucket",NAME_REGION_CREATE_BUCKET:"NameRegion_CreateBucket",SET_PROP_CREATE_BUCKET:"SetProp_CreateBucket",SET_PERM_CREATE_BUCKET:"SetPerm_CreateBucket",REVIEW_CREATE_BUCKET:"Review_CreateBucket",END_CREATE_BUCKET:"End_CreateBucket",UPLOAD_FILE_S3:"UploadFileS3",START_UPLOAD_FILE:"Start_UploadFileS3",SELECT_UPLOAD_FILE:"Select_UploadFileS3",SET_PERMISSIONS_UPLOAD_FILE:"SetPerm_UploadFileS3",SET_PROPERTIES_UPLOAD_FILE:"SetProp_UploadFileS3",REVIEW_UPLOAD_FILE:"Review_UploadFileS3",END_UPLOAD_FILE:"End_UploadFileS3",LIFECYCLE_S3:"LifeCycleS3",START_LIFECYCLE:"Start_LifeCycleS3",NAME_SCOPE_LIFECYCLE:"NameScope_LifeCycleS3",TRANSITION_LIFECYCLE:"Transition_LifeCycleS3",EXPIRATIONS_LIFECYCLE:"Expirations_LifeCycleS3",REVIEW_LIFECYCLE:"Review_LifeCycleS3",END_LIFECYCLE:"End_LifeCycleS3",CANCEL_ACCELERATE:"CancelAccelerate",GET_BUCKET_ACCELERATE:"GetBucketAccelerate",PUT_BUCKET_ACCELERATE:"PutBucketAccelerate",SAVE_ACCELERATE:"SaveAccelerate"},LEARN_MORE_LINKS:{ACCELERATE:"console/s3/transfer-acceleration",ENCRYPTION:"console/s3/usingencryption",EVENTS:"console/s3/event-notifications",LAMB:{MAIN:"documentation/s3/"},LOGGING:"console/s3/server-access-logging",METADATA:"console/s3/using-metadata",OBJECT_TAGGING:"console/s3/object-tagging",PERMISSIONS:{POLICY:"console/s3/using-iam-policies",CORS:"console/s3/enablecors"},REPLICATION:"console/s3/replication",STORAGE_CLASS:"console/s3/storageclasses",TAGGING:"console/s3/cost-allocation-tagging",VERSIONING:"console/s3/enable-bucket-versioning",WEBSITE:"console/s3/configurebucketforwebsite",bucket:["console/s3/usingbucket","console/s3/upload-object","console/s3/accesscontrol"],object:["console/s3/upload-object","console/s3/object-properties","console/s3/accesscontrol"],lifecycle:["console/s3/lifecyclerules","console/s3/lifecycle-transitions","console/s3/lifecycle-expire"],"storage-management":{"analytics-storage-class":"console/s3/analytics-storage-class","configure-metrics-filter":"console/s3/cloudwatch-request-metrics-filter","configure-inventory":"console/s3/configure-inventory",quicksight:"https://quicksight.aws"}},SUCCESS_MESSAGE_TIMEOUT:5000,TARGET_MEDIATOR:{SUPPORTED_LANGUAGES:["en","jp","cn","fr"],LANGUAGE_MAP:{en:"en",en_us:"en",ja:"jp",ja_jp:"jp",zh:"cn",zh_cn:"cn",fr:"fr",fr_fr:"fr"}},FALLBACK_REGION_LIST:{PUBLIC:["us-east-1","us-east-2","us-west-1","us-west-2","eu-west-1","eu-west-2","eu-central-1","ap-south-1","ap-southeast-1","ap-southeast-2","ap-northeast-1","ap-northeast-2","ca-central-1","sa-east-1"],CN:["cn-north-1"],ISO:["us-iso-east-1"]},DEFAULT_REGION:{PUBLIC:"us-east-1",CN:"cn-north-1"},ARN_SERVICE:{IAM:"iam::",LAMBDA:"lambda:",S3:"s3:::",SNS:"sns:",SQS:"sqs:"},AWS_SERVICE:{S3:"S3",LAMBDA:"LAMBDA",IAM:"IAM",SQS:"SQS",SNS:"SNS"},BUCKET_PERMISSION_TYPE:{ACL:"acl",CORS:"cors",POLICY:"policy"},CARD_SUMMARY_INIT:{isActive:false,isMultiValue:false,activeSummary:{text:"",value:""},inactiveSummary:{text:""}}})})();"use strict";(function(){angular.module("s3").directive("fileread",function(){return{restrict:"A",link:function a(d,c,b){c.bind("change",function(e){d.filesSelected(e.target);this.value=""})}}})})();"use strict";(function(){angular.module("s3").controller("LambController",["$filter","$http","$location","$parse","$route","$routeParams","$scope","$window","$translate","APIProxyService","AWSC","AwsUrlsService","BucketPropertiesService","BulkOperationService","CachingService","ConsoleOperation","FAC","OperationDispatcherService","OptOutEndpoint","Region","S3Constants","SCLogService","UtilService",a]);function a(A,k,w,H,p,G,j,F,r,E,D,t,y,o,l,e,J,q,C,m,I,g,n){var z=new e("InitialLAMBcall","StartLAMBcall");j.loadBuckets=function(N){var M=arguments.length<=1||arguments[1]===undefined?false:arguments[1];var O=arguments.length<=2||arguments[2]===undefined?true:arguments[2];g.log("LoadBucketsReceived",1,N);D.Clog.setPageId(I.CLOG_PAGE_ID);E.listAllMyBuckets(N,O).then(function(P){j.bucketList=P.response.ListAllMyBucketsResult.Buckets.Bucket;D.Timer.customerReady();g.log("LoadBuckets",1,N);j.bucketList.forEach(function(Q){y.getBucketLocation(Q.Name).then(function(R){j.regions.forEach(function(S){if(S.value===R){Q.Location=S.text}})})})})["catch"](function(Q){var P=n.handleErrors(Q);D.Timer.customerReady();g.log("LoadBuckets",0,N,{errorMessage:P});j.error=P})["finally"](function(){j.isRefreshing=false;if(M){j.isLoadingPage=false}})};j.docLink=t.getMarketingUrl(I.LEARN_MORE_LINKS.LAMB.MAIN);j.currentRegion=m.getCurrentRegion();j.isConfirmationModalOpen={flag:false};j.bucketConfirmationDetails={headerTitle:"",warningMessage:"",operation:"",isDelete:false};j.isLoadingPage=true;j.loadBuckets(z,true);j.isRefreshing=false;j.panelHide=true;j.selectBucket=function(M){w.path(I.DELIMITER+I.PATH_SEGMENTS.BUCKETS+I.DELIMITER+M).search("tab","overview")};j.configData={properties:{eventsCount:null,versioning:null,logging:null,staticWebHost:null,tags:null},permissions:{owner:null,bucketPolicy:null,accessControlList:null,corsConfiguration:null},management:{lifecycle:null}};var L="s3-x-acceleration";var K="s3-crr";if(J.isFeatureEnabled(K)){j.configData.properties.replication=null}if(J.isFeatureEnabled(L)){j.configData.properties.accelerate=null}if(J.isFeatureEnabled(I.FAC.ANALYTICS)){j.configData.management.analytics=null}if(J.isFeatureEnabled(I.FAC.INVENTORY)){j.configData.management.inventory=null}if(J.isFeatureEnabled(I.FAC.METRICS)){j.configData.management.metrics=null}j.regions=[];n.getFACRegions(m.regionMapping,j.regions);j.openConfigPanel=function(M){j.panelHide=false;j.selectedBucket=M;j.panelOpen=true;j.getConfigData(M.Name)};j.notificationShow=true;j.closeNotification=function(){j.notificationShow=false};var v=r.instant("bucketlambda.replicationconfig.notexist");var c=r.instant("bucketlambda.corsconfig.notexist");var f=r.instant("bucketlambda.tag.notexist");var s=r.instant("bucketlambda.website.notexist");j.bucket_more_dropdown=[{items:[{id:"pasteinto",text:r.instant("moreDropDown.pasteinto")}]},{items:[{id:"managecloudtraillog",text:r.instant("moreDropDown.managecloudtraillog")}]}];var b=[{servicesCall:y.getVersioningStatus,scopeBinding:"configData.properties.versioning",resultDisplay:r.instant("bucketproperty.enabled"),defaultValue:r.instant("bucketproperty.suspended"),name:"getVersioningStatus"},{servicesCall:y.getEventCount,scopeBinding:"configData.properties.eventsCount",resultDisplay:r.instant("bucketsidepanel.activenotification"),defaultValue:"0 ".concat(r.instant("bucketsidepanel.activenotification")),name:"getEventCount",isNumber:true},{servicesCall:y.isLoggingEnabled,scopeBinding:"configData.properties.logging",resultDisplay:r.instant("bucketproperty.enabled"),defaultValue:r.instant("bucketproperty.disabled"),name:"isLoggingEnabled"},{servicesCall:y.getTagCount,scopeBinding:"configData.properties.tags",resultDisplay:" ".concat(r.instant("bucketsidepanel.tags")),defaultValue:"0 ".concat(r.instant("bucketsidepanel.tags")),name:"getTagCount",isNumber:true,nomessage:f},{servicesCall:y.isReplicationEnabled,scopeBinding:"configData.properties.replication",resultDisplay:r.instant("bucketproperty.enabled"),defaultValue:r.instant("bucketproperty.disabled"),name:"isReplicationEnabled",nomessage:v,facId:K},{servicesCall:y.getBucketAccelerate,scopeBinding:"configData.properties.accelerate",resultDisplay:r.instant("bucketproperty.enabled"),defaultValue:r.instant("bucketproperty.disabled"),name:"getBucketAccelerate",nomessage:r.instant("bucketproperty.disabled"),facId:L},{servicesCall:y.getBucketOwnerDisplayName,scopeBinding:"configData.permissions.owner",resultDisplay:"",defaultValue:r.instant("bucketproperty.no"),name:"getBucketOwnerDisplayName"},{servicesCall:y.isCORSEnabled,scopeBinding:"configData.permissions.corsConfiguration",resultDisplay:r.instant("bucketproperty.yes"),defaultValue:r.instant("bucketproperty.no"),name:"isCORSEnabled",nomessage:c},{servicesCall:y.getBucketGrantees,scopeBinding:"configData.permissions.accessControlList",resultDisplay:" ".concat(r.instant("bucketsidepanel.grantees")),defaultValue:"0 ".concat(r.instant("bucketsidepanel.grantees")),granteeCount:true,name:"getBucketGrantees",isNumber:true},{servicesCall:y.getBucketPolicy,scopeBinding:"configData.permissions.bucketPolicy",resultDisplay:r.instant("bucketproperty.yes"),defaultValue:r.instant("bucketproperty.no"),name:"getBucketPolicy"},{servicesCall:y.isLifecycleEnabled,scopeBinding:"configData.management.lifecycle",resultDisplay:r.instant("bucketproperty.enabled"),defaultValue:r.instant("bucketproperty.disabled"),name:"isLifecycleEnabled"},{servicesCall:y.isAnalyticsEnabled,scopeBinding:"configData.management.analytics",resultDisplay:r.instant("bucketproperty.enabled"),defaultValue:r.instant("bucketproperty.disabled"),name:"isAnalyticsEnabled",facId:I.FAC.ANALYTICS},{servicesCall:y.isMetricsEnabled,scopeBinding:"configData.management.metrics",resultDisplay:r.instant("bucketproperty.enabled"),defaultValue:r.instant("bucketproperty.disabled"),name:"isMetricsEnabled",facId:I.FAC.METRICS},{servicesCall:y.isInventoryEnabled,scopeBinding:"configData.management.inventory",resultDisplay:r.instant("bucketproperty.enabled"),defaultValue:r.instant("bucketproperty.disabled"),name:"isInventoryEnabled",facId:I.FAC.INVENTORY}];function h(M,P,O,N){if(P&&M!==P){g.log(O,0,N);j.bucketPanelInfoError=M}else{g.log(O,1,N)}}function B(O,N,M){angular.forEach(O,function(Q){var P=H(Q.scopeBinding);if(!Q.facId||Q.facId&&J.isFeatureEnabled(Q.facId)){Q.servicesCall(N,M).then(function(R){g.log(Q.name,1,M);if(Q.hasOwnProperty("granteeCount")){R=Object.keys(R).length}if(R&&R!=="Suspended"){if(Q.isNumber){P.assign(j,R+" "+Q.resultDisplay)}else{if(Q.resultDisplay){P.assign(j,Q.resultDisplay)}else{P.assign(j,R)}}}else{P.assign(j,Q.defaultValue)}})["catch"](function(R){P.assign(j,Q.defaultValue);h(R,Q.nomessage,Q.name,M)})}})}function d(N,M){E.getBucketProperty(M,N,"website").then(function(Q){var O=Q.response;g.log("getBucketWebsite",1,M);var P=O.WebsiteConfiguration;if(P.RedirectAllRequestsTo){j.configData.properties.staticWebHost=r.instant("bucketproperty.websitehosting.redirectAll")}else{if(P.IndexDocument){j.configData.properties.staticWebHost=r.instant("bucketproperty.websitehosting.enableHosting")}}})["catch"](function(O){j.configData.properties.staticWebHost=r.instant("bucketproperty.disabled");h(O,s,"getBucketWebsite",M)})}var i=null;j.hoverSidePanelAction=function(M){if(!i){i=$(".storage-console-config-panel")}n.bodyFreezeScroll(M,i)};j.getConfigData=function(N){var M=new e("BucketProperties","getBucketConfigProperties");B(b,N,M);d(N,M)};j.closePanel=function(){var M=arguments.length<=0||arguments[0]===undefined?true:arguments[0];j.panelHide=true;if(M){j.hoverSidePanelAction(false)}};j.copyARNToClipboard=function(N){N.stopPropagation();var M=n.getBucketARN(j.selectedBucket.Name);n.copyToClipboard(M)};j.isCreateBucketModalOpen={flag:false};j.showCreateBucketModal=function(){var M=new e("CreateBucket","populateBucketSelectorDropdown");E.listAllMyBuckets(M).then(function(O){var N=O.response;g.log("listBucketsComplete",1,M);j.bucketList=N.ListAllMyBucketsResult.Buckets.Bucket;j.bucketList.forEach(function(P){y.getBucketLocation(P.Name).then(function(Q){m.regionMapping.forEach(function(R){if(R.value===Q){P.Location=R.text}})})})});j.isCreateBucketModalOpen.flag=true;n.analyticsTrackClick(I.ANALYTICS.CREATE_BUCKET_MODAL,I.ANALYTICS.DETAILS);n.analyticsTrackClick(I.ANALYTICS.START_CREATE_BUCKET,I.ANALYTICS.CREATE_BUCKET_S3);n.analyticsTrackView(I.ANALYTICS.NAME_REGION_CREATE_BUCKET,I.ANALYTICS.CREATE_BUCKET_S3);n.bodyFreezeScroll(j.isCreateBucketModalOpen.flag)};j.moveToBucketTab=function(M){j.hoverSidePanelAction(false);F.scrollTo(0,0);w.path("/"+I.PATH_SEGMENTS.BUCKETS+"/"+j.selectedBucket.Name).search("tab",M)};j.reloadBuckets=function(){j.isRefreshing=true;var M=new e("RefreshLAMB","RefreshLAMB");j.loadBuckets(M,false,false)};j.deleteBucket=function(){var N=o.createBulkOperation(I.OPERATION_NAME.DELETE_BUCKET,[],[{Prefix:""}],1000,{});N.changeInitialBucketForOperation(j.selectedBucket.Name);N.defer.promise.then(function(){_.remove(j.bucketList,function(P){return P.Name===N.initialBucket});j.reloadBuckets();l.evictAllBucketData(N.initialBucket);j.closePanel()});j.bucketConfirmationDetails.headerTitle=r.instant("confirmationmodal.deletebucket.title");var O=j.selectedBucket.Name;var M=r.instant("confirmationmodal.deletebucketwarning");j.bucketConfirmationDetails.warningMessage=M+' "'+O+'" ?';j.bucketConfirmationDetails.operation=N;j.bucketConfirmationDetails.isDelete=true;j.isConfirmationModalOpen.flag=true};j.emptyBucket=function(){var M=o.createBulkOperation(I.OPERATION_NAME.EMPTY_BUCKET,[],[{Prefix:""}],1000,{});M.changeInitialBucketForOperation(j.selectedBucket.Name);M.defer.promise.then(function(){l.evictBucketObjects(j.selectedBucket.Name)});j.bucketConfirmationDetails.headerTitle=r.instant("confirmationmodal.emptybucket.title");var O=r.instant("confirmationmodal.emptybucketwarning");var N=j.selectedBucket.Name;j.bucketConfirmationDetails.warningMessage=O+' "'+N+'" ?';j.bucketConfirmationDetails.operation=M;j.isConfirmationModalOpen.flag=true};j.filterColumn="Name";j.tableFiltering={filter:{}};j.clearFilter=function(){j.tableFiltering.filter[j.filterColumn]=""};j.filterKeyDown=function(M){if(M&&M.keyCode===I.KEY_CODES.ESC){$(".input-field").blur();j.clearFilter()}if(M&&M.keyCode===I.KEY_CODES.ENTER){$(".input-field").blur();F.scrollTo(0,0)}};j.$watch(function(){j.numRegions=_.without(_.uniq(_.pluck(A("filter")(j.bucketList,j.tableFiltering.filter),"Location")),undefined).length||"-";return j.tableFiltering.filter[j.filterColumn]},function(N,M){if(M!==N){j.selectedItem=null;j.totalItems=A("filter")(j.bucketList,j.tableFiltering.filter).length}});j.setSortOrder=function(M){j.sortColumnName=M;j.reverseSortOrder=!j.reverseSortOrder};j.isFeatureEnabled=function(M){return J.isFeatureEnabled(M)};if(w.search().bucket){var u=w.search().bucket;var x=w.search().prefix;if(x){x=x.replace(/\/+$/,"")}delete w.search().bucket;delete w.search().prefix;w.path("/"+I.PATH_SEGMENTS.BUCKETS+"/"+u+"/"+(x||""));w.replace()}}})();"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol==="function"&&a.constructor===Symbol?"symbol":typeof a};function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}angular.module("s3").controller("ObjectController",["$filter","$location","$rootScope","$route","$q","$routeParams","$scope","$translate","APIProxyService","AWSC","BucketPropertiesService","BulkOperationService","CachingService","ConsoleOperation","CopyService","CountService","DownloadService","DirectoryExplorerService","FAC","humanReadableBytesFilter","KeySelectionService","ListDeletedObjectsService","ObjectListingService","ObjectPropertiesService","PathService","Region","S3Constants","SCLogService","UploadOperationService","UtilService","XMLParser",ObjectController]);function ObjectController(ar,an,z,b,W,d,E,o,S,j,J,ap,aq,h,am,f,ak,A,au,K,ab,ai,t,Q,O,U,c,x,Z,l,v){var i,aj,ac;var n={label:o.instant("details.tab.management"),id:"management"};E.currLocation={objects:{relativePaths:[],error:null},folders:{relativePaths:[]}};E.tabs=[{label:o.instant("details.tab.objects"),id:"overview"},{label:o.instant("details.tab.properties"),id:"properties"},{label:o.instant("details.tab.permissions"),id:"permissions"}];E.createFolder={displayed:false};var aw=(i={},_defineProperty(i,c.OPERATION_NAME.CHANGE_STORAGE_CLASS,{headTitle:o.instant("confirmationmodal.storageclass.title")}),_defineProperty(i,c.OPERATION_NAME.CHANGE_SSE,{headTitle:o.instant("confirmationmodal.sse.title")}),_defineProperty(i,c.OPERATION_NAME.INITIATE_RESTORE,{headTitle:o.instant("confirmationmodal.initiaterestore.title")}),_defineProperty(i,c.OPERATION_NAME.ADD_OBJECT_TAG,{headTitle:o.instant("confirmationmodal.addtags.title")}),i);var ad=(aj={},_defineProperty(aj,c.OPERATION_NAME.CHANGE_STORAGE_CLASS,{values:[["STANDARD",o.instant("storageclasses.standard"),"sidepanel.storageclass.standarddescription"],["STANDARD_IA",o.instant("storageclasses.standardia"),"sidepanel.storageclass.standardiadescription"]],setting:undefined}),_defineProperty(aj,c.OPERATION_NAME.CHANGE_SSE,{values:[["NONE",o.instant("sse.none"),""],["AES256",o.instant("sse.aes256"),"sidepanel.sse.aes256description"]],setting:undefined}),_defineProperty(aj,c.OPERATION_NAME.INITIATE_RESTORE,{inputErrorMsg:"",setting:undefined}),_defineProperty(aj,c.OPERATION_NAME.ADD_OBJECT_TAG,{values:[{Key:"",Value:""}],setting:{maxKeys:c.TAGGING.MAX_ALLOWED_TAGS}}),aj);E.maxKeys=c.LIST_OBJECTS_MAX_KEYS_PER_LISTING;E.toggleVersioning=false;E.toggleLogging=false;E.toggleWebsite=false;E.toggleEvents=false;E.toggleAccelerate=false;E.toggleCRR=false;E.toggleTagging=false;E.disabledButton=true;E.versioning={selectedValue:c.BUCKET_PROPERTIES.DISABLE};E.website={selectedValue:c.BUCKET_PROPERTIES.DISABLE,websiteEnabledOption:"",websiteEnabledContent:""};E.logging={selectedValue:c.BUCKET_PROPERTIES.DISABLE};E.bucketTags={tagSet:{tags:[]}};E.selectedTab=an.search().tab||"overview";E.confirmationSelectedFiles={folders:[],objects:[],currFolderPathPrefix:""};E.isUploadModalDisplayed={flag:false};E.flags={uploadDisabled:false};E.isRefreshing=false;E.isConfirmationModalOpen={flag:false,sidePanelOpen:false,dialogOpen:{flag:false},isRestorePanel:false};E.objectPropertiesPanel={show:false};E.showDeleted=false;E.filters={input:"",prefixFilters:[],tagFilters:[]};j.Clog.setPageId(c.CLOG_OBJECTS_PAGE_ID);E.tagQueryDeferred=W.defer();E.allKeys={selected:false};E.getIconClass=function(ax){return ax.selected?"awsui-icon-light "+l.getIconClassFromFilename(ax.Key):l.getIconClassFromFilename(ax.Key)};E.hoverObjectPropertiesPanel=function(ax){l.bodyFreezeScroll(ax,true)};E.hoverDownloadPanel=function(ax){l.bodyFreezeScroll(ax,true)};E.hoverConfirmationPanel=function(ax){l.bodyFreezeScroll(ax,true)};E.$watch("isConfirmationModalOpen",function(ax){l.bodyFreezeScroll(!!ax.dialogOpen.flag)},true);E.$watch("isUploadModalDisplayed",function(ax){l.bodyFreezeScroll(!!ax.flag)},true);E.more_dropdown=[{items:[{id:"getinfo",text:o.instant("objectMoreDropDown.getinfo"),disabled:false,action:function aa(){E.takeActions(c.OPERATION_NAME.GET_INFO)}},{id:"download",text:o.instant("objectMoreDropDown.download"),disabled:false,action:function aa(){E.openDownloadAsPanel()},facID:"s3-download"}]},{items:[{id:"rename",text:o.instant("objectMoreDropDown.rename"),disabled:false,action:function aa(){E.takeActions(c.OPERATION_NAME.RENAME)},opName:c.OPERATION_NAME.RENAME,facID:"s3-rename"},{id:"delete",text:o.instant("objectMoreDropDown.delete"),disabled:false,action:function aa(){E.takeActions(c.OPERATION_NAME.DELETE_OBJECTS)},opName:c.OPERATION_NAME.DELETE_OBJECTS,facID:"s3-delete"},{id:"undodelete",text:o.instant("objectMoreDropDown.undodelete"),disabled:true,action:function aa(){E.takeActions(c.OPERATION_NAME.RESTORE_OBJECTS)},opName:c.OPERATION_NAME.RESTORE_OBJECTS,facID:"s3-delete"}]},{items:[{id:"cut",text:o.instant("objectMoreDropDown.cut"),disabled:false,action:function aa(){E.takeActions(c.OPERATION_NAME.CUT)},opName:c.OPERATION_NAME.CUT,facID:"s3-copy"},{id:"copy",text:o.instant("objectMoreDropDown.copy"),disabled:false,action:function aa(){E.takeActions(c.OPERATION_NAME.COPY)},opName:c.OPERATION_NAME.COPY,facID:"s3-copy"},{id:"paste",text:o.instant("objectMoreDropDown.paste"),disabled:false,action:function aa(){E.takeActions(c.OPERATION_NAME.PASTE)},opName:c.OPERATION_NAME.PASTE,facID:"s3-copy"}]},{items:[{id:"changestorageclass",text:o.instant("objectMoreDropDown.changestorageclass"),disabled:false,action:function aa(){E.takeActions(c.OPERATION_NAME.CHANGE_STORAGE_CLASS)},opName:c.OPERATION_NAME.CHANGE_STORAGE_CLASS,facID:"s3-change-storage-class"},{id:"initialrestore",text:o.instant("objectMoreDropDown.initialrestore"),disabled:true,action:function aa(){E.takeActions(c.OPERATION_NAME.INITIATE_RESTORE)},opName:c.OPERATION_NAME.INITIATE_RESTORE,facID:"s3-initiate-restore"},{id:"changeencryption",text:o.instant("objectMoreDropDown.changeencryption"),disabled:false,action:function aa(){E.takeActions(c.OPERATION_NAME.CHANGE_SSE)},opName:c.OPERATION_NAME.CHANGE_SSE,facID:"s3-change-encryption"},{id:"makeobjectpublic",text:o.instant("objectdetails.button.makepublic"),disabled:false,action:function aa(){E.takeActions(c.OPERATION_NAME.MAKE_PUBLIC)},opName:c.OPERATION_NAME.MAKE_PUBLIC,facID:"s3-make-public"},{id:"addobjecttags",text:o.instant("objectMoreDropDown.addtags"),disabled:false,action:function aa(){E.takeActions(c.OPERATION_NAME.ADD_OBJECT_TAG)},opName:c.OPERATION_NAME.ADD_OBJECT_TAG,facID:"s3-ot"}]}];_.each(E.more_dropdown,function(ax){ax.items=_.filter(ax.items,function(az){var ay=az.facID;return !ay||au.isFeatureEnabled(ay)})});E.batchOps={error:null,numKeysOperatedOn:null,size:20};E.timing={fetchAllObjects:{start:null,end:null,duration:null}};E.validateInitialRestoreValue=function(ax){if(isNaN(ax.setting)||parseInt(ax.setting)<1){ax.inputErrorMsg="initialrestorevalue.invalidwarning"}else{ax.inputErrorMsg=""}};E.startKeyNum=0;E.markers=[];E.tagContinuationTokens=[];E.sortColumnName="";E.reverseSortOrder=false;g();E.downloadAsPanel=false;E.operations={};E.objectSelectedForSidePanel={};var w=["Key","Size","ExpirationDate","ExpirationRule","ETag","LastModified","Link"];var D=["StorageClass","Encryption"];var al="getObjectMetadata";var B="getObjectAcl";var ah=c.VERSIONS.LIST_VERSIONS_COMPLETED;var e={isTruncated:true,currentPage:0,lastCachedPage:0};E.createFolder={show:false};E.selected={selectedItems:{currFolderPathPrefix:"",folders:[],objects:[]}};var Y={flag:true,folders:0,objects:0,size:0,currLevelObjs:0,countResultEachFolder:{}};E.countInfo=_.cloneDeep(Y);E.bucketName=d[c.PATH_SEGMENTS.BUCKET_NAME];J.getBucketRegion(E.bucketName).then(function(ax){E.bucketRegion=ax});E.setSortOrder=function(ax){E.sortColumnName=ax;E.reverseSortOrder=!E.reverseSortOrder};E.showCreateFolder=function(){E.operation=new h("CreateFolder");E.createFolder.displayed=true;E.showEmptyScreen=false;E.noResultsMessage=false};E.navigateIntoFolder=function(ay){var ax=an.path()+c.DELIMITER+ay;if(E.showDeleted){an.path(ax).search(c.SHOW_DELETED_PARAM,"true")}an.path(ax)};E.closeObjectPropertiesPanel=function(){var ax=arguments.length<=0||arguments[0]===undefined?true:arguments[0];E.objectPropertiesPanel.show=false;if(ax){E.hoverObjectPropertiesPanel(false)}};E.closeDownloadAsPanel=function(){E.downloadAsPanel=false;E.hoverDownloadPanel(false)};E.openDownloadAsPanel=function(){E.objectPropertiesPanel.show=false;E.downloadAsPanel=true;E.downloadAsPanelGenerating=true;E.downloadPanelError=false;E.downloadPanel={};ak.generatePresignedUrlForCurrentObject(E.getSelectedObjects()[0]).then(function ax(az){E.downloadAsPanelGenerating=false;E.downloadPanel.url=az.data.presignedUrl},function ay(az){E.downloadAsPanelGenerating=false;E.downloadPanelError=true})};E.downloadSelectedObject=function(){ak.downloadCurrentSelection(E.getSelectedObjects()[0])["catch"](function(ax){if(ax.error&&ax.error.status){E.batchOpsError=ax.error.status}})};E.showAllObjects=function(){var ax=an.path();an.path(ax).search(c.SHOW_DELETED_PARAM,"false");an.path(ax)};E.showDeletedObjects=function(){aq.resetDeletedObjects();var ax=an.path();an.path(ax).search(c.SHOW_DELETED_PARAM,"true");an.path(ax)};function L(){return E.isSingleObjectOnlySelected()}function V(ax){for(var ay in E.currLocation.objects.relativePaths){var az=E.currLocation.objects.relativePaths[ay];if(az.Key===ax.Key&&az.selected){E.currLocation.objects.relativePaths[ay]=ax;return}}}E.getSelectedFolders=function(){return _.filter(E.currLocation.folders.relativePaths,function(ax){return ax.selected===true})};E.getSelectedObjects=function(){return _.filter(E.currLocation.objects.relativePaths,function(ax){return ax.selected===true})};E.getSelectedKeys=function(){return E.getSelectedFolders().concat(E.getSelectedObjects())};E.isSingleObjectOnlySelected=function(){return E.getSelectedObjects().length===1&&E.getSelectedFolders().length===0};E.showVersionsDropdown={show:false};E.versionLabel={name:o.instant("versionsdropdown.label.latestVersion")};E.objectsPage={show:true};E.bucketForVersionsDropdown={name:E.bucketName};E.listVersions=function(ax){ax.stopPropagation();if(E.showVersionsDropdown.show){E.showVersionsDropdown.show=false}else{E.showVersionsDropdown.show=true;l.analyticsTrackClick(c.ANALYTICS.LATEST_VERSION,c.ANALYTICS.DETAILS)}};function p(){E.objectPropertiesConfig={};if(L()){var ax=function(){var az=E.getSelectedObjects()[0];E.objectSelectedForSidePanel={};E.objectSelectedForSidePanel.obj=angular.copy(az);E.objectSelectedForSidePanel.obj.disableDownload=false;E.objectSelectedForSidePanel.error="";var aB=new h(c.OPERATION_NAME.LIST_VERSIONS);E.versionDropdownKey={};E.versionDropdownKey.name=O.getCurrentAbsoluteFolderPath()?O.getCurrentAbsoluteFolderPath()+az.Key:az.Key;E.versionLabel.name=o.instant("versionsdropdown.label.latestVersion");Q.listVersions(E.bucketName,E.versionDropdownKey.name,aB).then(function(aC){E.objectSelectedForSidePanel.versions=aC;E.objectSelectedForSidePanel.versionId=aC&&aC[0]&&aC[0].VersionId;x.log(ah,1,aB,{objectKey:E.versionDropdownKey.name,versions:aC})})["catch"](function(aC){E.objectSelectedForSidePanel.error=l.handleErrors(aC);x.log(ah,0,aB,aC)});if(_.isEmpty(az.ETag)&&!E.showDeleted){var ay=new h(c.OPERATION_NAME.GET_OBJECT_DETAILS),aA={bucket:E.bucketName,prefix:az.Path+az.Key,maxKeys:1,cacheAllowed:true};S.listObjects(ay,aA).then(function(aC){var aD=aC.response.ListBucketResult.Contents[0];aD.ETag=aD.ETag.replace(/[\\"]+/g,"");aD.Path=az.Path;aD.VersionId=az.VersionId;aD.selected=true;if(aD.Key.lastIndexOf(c.DELIMITER)!==-1){aD.Key=aD.Key.substring(aD.Key.lastIndexOf(c.DELIMITER)+1)}V(aD);p()});return{v:undefined}}E.setUpObjectMetadataForPropertiesPanel(az);E.updateObjAcl(az);E.updateObjMetadata(az);E.showVersionsDropdown.show=false;E.objectPropertiesPanel.show=true}();if((typeof ax==="undefined"?"undefined":_typeof(ax))==="object"){return ax.v}}else{E.objectPropertiesPanel.show=false}}function a(){if(E.isSingleObjectOnlySelected()){if(E.downloadAsPanel){E.openDownloadAsPanel()}}else{E.downloadAsPanel=false}}function M(){p();a()}function y(ax){for(var ay=0;ay<ax.length;ay++){ax[ay].selected=E.allKeys.selected}M()}E.selectAllKeys=function(){if(E.currLocation.folders.relativePaths!==undefined){y(E.currLocation.folders.relativePaths)}if(E.currLocation.objects.relativePaths!==undefined){y(E.currLocation.objects.relativePaths)}};E.selectOneMoreKey=function(ay){var az=arguments.length<=1||arguments[1]===undefined?true:arguments[1];var ax=arguments.length<=2||arguments[2]===undefined?true:arguments[2];if(ax){ay.selected=_.has(ay,"selected")&&ay.selected?false:true;if(!ay.selected){E.allKeys.selected=false}}else{ay.selected=true}if(az){E.shiftSelectAxis=ay}M();m()};E.selectCurrentKeyOnly=function(ax){E.resetSelection();ax.selected=true;E.shiftSelectAxis=ax;M()};E.resetSelection=function(){E.allKeys.selected=false;ab.setSelectedFlagAsFalse(E.currLocation.folders.relativePaths,E.currLocation.objects.relativePaths);M()};E.shiftSelectAxis=null;E.shiftSelect=function(aB){E.resetSelection();var ax=ar("orderBy")(E.currLocation.folders.relativePaths,E.sortColumnName,E.reverseSortOrder);var aF=ar("orderBy")(E.currLocation.objects.relativePaths,E.sortColumnName,E.reverseSortOrder);if(!E.shiftSelectAxis){if(E.currLocation.folders.relativePaths&&E.currLocation.folders.relativePaths.length>0){E.shiftSelectAxis=ax[0]}else{if(E.currLocation.objects.relativePaths&&E.currLocation.objects.relativePaths.length>0){E.shiftSelectAxis=aF[0]}}}if(aB===E.shiftSelectAxis){E.selectOneMoreKey(aB);return}var aE=false;var aC=false;if(E.currLocation.folders.relativePaths){for(var az=0;az<E.currLocation.folders.relativePaths.length;az++){if(aE&&aC){break}var aA=ax[az];if(aE&&!aC){E.selectOneMoreKey(aA,false,false)}if(aA===E.shiftSelectAxis||aA===aB){if(!aE){E.selectOneMoreKey(aA,false,false);aE=true}else{aC=true}}}}if(E.currLocation.objects.relativePaths){for(var ay=0;ay<E.currLocation.objects.relativePaths.length;ay++){if(aE&&aC){break}var aD=aF[ay];if(aE&&!aC){E.selectOneMoreKey(aD,false,false)}if(aD===E.shiftSelectAxis||aD===aB){if(!aE){E.selectOneMoreKey(aD,false,false);aE=true}else{aC=true}}}}};E.clickObjectRow=function(ay,ax){if(ay.ctrlKey||ay.metaKey){E.selectOneMoreKey(ax,true,true)}else{if(ay.shiftKey){E.shiftSelect(ax)}else{E.selectCurrentKeyOnly(ax)}}};var G=(ac={},_defineProperty(ac,c.OPERATION_NAME.DELETE_OBJECTS,{numberOfKeysPerBulkOperation:c.BULK_OPERATION_KEYS_PER_REQUEST.S3_API}),_defineProperty(ac,c.OPERATION_NAME.RESTORE_OBJECTS,{numberOfKeysPerBulkOperation:c.BULK_OPERATION_KEYS_PER_REQUEST.S3_API}),_defineProperty(ac,c.OPERATION_NAME.MAKE_PUBLIC,{numberOfKeysPerBulkOperation:c.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API}),_defineProperty(ac,c.OPERATION_NAME.CUT,{isCut:true,numberOfKeysPerBulkOperation:c.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API}),_defineProperty(ac,c.OPERATION_NAME.COPY,{isCut:false,numberOfKeysPerBulkOperation:c.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API}),_defineProperty(ac,c.OPERATION_NAME.RENAME,{isRename:true,numberOfKeysPerBulkOperation:c.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API}),ac);function N(){var ay=0;var ax=E.getSelectedKeys();if(ax.length===1){if(ax[0].Key){E.currLocation.objects.relativePaths.forEach(function(az){if(az.Key===ax[0].Key){az.beingRenamed=true}else{ay++}})}}}E.addTag=function(){var ax={Key:"",Value:""};if(E.panelSettingValues.values){E.panelSettingValues.values.push(ax)}else{E.panelSettingValues.values=[ax]}};E.isAnyKeyEmpty=function(){return !_.isEmpty(E.panelSettingValues.values)&&_.some(E.panelSettingValues.values,function(ax){return _.isEmpty(ax.Key)})};E.removeTag=function(ax){E.panelSettingValues.values.splice(ax,1)};function C(ax){l.analyticsTrackClick(c.ANALYTICS.CONFIRMATION_MODAL,ax)}E.takeActions=function(ax){E.opName=ax;E.isConfirmationModalOpen.flag=false;E.isConfirmationModalOpen.dialogOpen.flag=false;E.tagError=false;E.isConfirmationModalOpen.sidePanelOpen=false;E.isConfirmationModalOpen.isRestorePanel=false;E.countInfo=_.cloneDeep(Y);E.panelSettingValues=null;E.operation=null;E.modalInfo={headTitle:"",buttonName:"",warningInfo:{flag:false,text:""}};C(ax);switch(ax){case c.OPERATION_NAME.PASTE:E.isConfirmationModalOpen.flag=true;E.isConfirmationModalOpen.dialogOpen.flag=true;T(ax);break;case c.OPERATION_NAME.COPY:case c.OPERATION_NAME.CUT:T(ax);am.setClipboardOperation(E.operation);break;case c.OPERATION_NAME.INITIATE_RESTORE:case c.OPERATION_NAME.CHANGE_STORAGE_CLASS:case c.OPERATION_NAME.CHANGE_SSE:case c.OPERATION_NAME.ADD_OBJECT_TAG:T(ax,true);if(ax===c.OPERATION_NAME.INITIATE_RESTORE){E.isConfirmationModalOpen.isRestorePanel=true}E.modalInfo=aw[ax];E.panelSettingValues=_.cloneDeep(ad)[E.operation.name];E.operation.panelSettingValues=E.panelSettingValues;E.isConfirmationModalOpen.sidePanelOpen=true;var ay={currFolderPathPrefix:E.operation.initialPath,folders:E.operation.selectedFolders,objects:E.operation.selectedKeys};E.countInfo.countFinish=true;E.isCounting={flag:false};f.countAllFiles(ay,E.countInfo,E.operation,E.isCounting);break;case c.OPERATION_NAME.RENAME:T(ax);am.setClipboardOperation(E.operation);N();break;case c.OPERATION_NAME.GET_INFO:E.isConfirmationModalOpen.flag=true;E.isConfirmationModalOpen.dialogOpen.flag=true;T(ax);break;default:E.isConfirmationModalOpen.flag=true;E.isConfirmationModalOpen.dialogOpen.flag=true;T(ax)}E.closeObjectPropertiesPanel(false)};E.saveConfirmationPanel=function(ax){ax.stopPropagation();if(s()){E.isConfirmationModalOpen.sidePanelOpen=false;E.isConfirmationModalOpen.flag=true;E.isConfirmationModalOpen.isRestorePanel=false;E.isConfirmationModalOpen.dialogOpen.flag=true}};E.cancelConfirmationPanel=function(ax){ax.stopPropagation();E.isConfirmationModalOpen.countFinish=false;E.isConfirmationModalOpen.sidePanelOpen=false;E.isConfirmationModalOpen.isRestorePanel=false;E.panelSettingValues=null;E.operation=null};function s(){if(E.opName===c.OPERATION_NAME.ADD_OBJECT_TAG){var az=E.operation.panelSettingValues&&E.operation.panelSettingValues.values;if(az){var ay=az.length;for(var aB=0;aB<ay;aB++){var aA=az[aB].Key;var aC=0;for(var ax=0;ax<ay;ax++){if(az[ax].Key===aA){aC++}}if(aC>1){E.tagError=true;E.tagErrorMessage=o.instant("objectproperties.tags.duplicatekeynames");return false}}}}return true}function T(ay,az){if(ay===c.OPERATION_NAME.PASTE){E.operation=am.getClipboardOperation()}else{var ax=0;if(ay===c.OPERATION_NAME.RENAME){ax=1}var aA=az?null:G[ay];E.operation=ap.createBulkOperation(ay,E.getSelectedObjects(),E.getSelectedFolders(),ax,aA)}E.operation.defer.promise.then(function(){I(E.operation)},function(){},function(){I(E.operation)})}function I(ax){if(E.showDeleted){aq.evictBucketObjects(ax.initialBucket);E.showAllObjects()}else{if(ax.name===c.OPERATION_NAME.DELETE_OBJECTS||ax.name===c.OPERATION_NAME.CHANGE_STORAGE_CLASS||ax.name===c.OPERATION_NAME.RESTORE_OBJECTS){aq.evictBucketObjects(ax.initialBucket);E.refreshWithSelection()}else{if(ax.name===c.OPERATION_NAME.COPY||ax.name===c.OPERATION_NAME.CUT){aq.evictBucketObjects(ax.initialBucket);aq.evictBucketObjects(ax.dstBucket);E.refreshWithSelection()}}}}E.refreshAndClearObjectsCacheForCurrentBucket=function(){aq.evictBucketObjects(O.getCurrentBucket());E.refreshWithSelection()};E.refreshWithSelection=function(){E.isRefreshing=true;var ay=O.getCurrentAbsoluteFolderPath()||"";var ax=typeof E.currentMarker==="string"?E.currentMarker:"";E.tagContinuationTokens=[];E.filters.prefixFilters=[];E.filters.tagFilters=[];t.listObjects(ay,ax,E.maxKeys,c.DELIMITER,false).then(function(aD){var aA=aD.response.ListBucketResult;var aC=_.pluck(E.getSelectedObjects(),"Key");var az=_.pluck(E.getSelectedFolders(),"Prefix");av(aA,true);ao();var aB=_.filter(E.currLocation.objects.relativePaths,function(aF){return _.indexOf(aC,aF.Key)!==-1});var aE=_.filter(E.currLocation.folders.relativePaths,function(aF){return _.indexOf(az,aF.Prefix)!==-1});aB.forEach(function(aF){E.selectOneMoreKey(aF,false,false)});aE.forEach(function(aF){E.selectOneMoreKey(aF,false,false)});E.currentMarker=aA.Marker;E.nextMarker=aA.NextMarker})["catch"](function(az){k(az)})};E.batchOpsAlertDismissed=function(){E.batchOps.error=null};E.goToObjectDetails=function(ay){if(E.showDeleted){return}var ax=ay.Path?ay.Path+ay.Key:ay.Key;if(!_.isEmpty(ay.ETag)){aq.setCurrentObject(ay)}an.path("/"+c.PATH_SEGMENTS.BUCKETS+"/"+O.getCurrentBucket()+"/"+O.relativeToAbsoluteObjectPath(ax)+"/details")};E.openObjectInBrowser=function(ax){if(ax.StorageClass.toUpperCase()!==c.STORAGE_CLASSES.GLACIER){ak.openInBrowser(ax.Key,ax.Size)}};E.setUpObjectMetadataForPropertiesPanel=function(aC){E.objectPropertiesConfig={};var aB={object:w,properties:D,permissions:[]};_.map(aB,function(aE,aD){E.objectPropertiesConfig[aD]={};_.map(aE,function(aF){E.objectPropertiesConfig[aD][aF]=aC[aF]})});var aA=O.relativeToAbsoluteObjectPath(aC.Key);var az=aC.versionId;aA=aC.Path?aC.Path+aA:aA;S.getObjectMetadata(new h("getObjectMetadata"),E.bucketName,aA,az).then(function(aD){if(aD.headers()){if(aD.headers()[c.HEADERS.X_AMZ_REPLICATION_STATUS]){E.objectPropertiesConfig.object.ReplicationStatus=aD.headers()[c.HEADERS.X_AMZ_REPLICATION_STATUS]}}});if(E.isFeatureEnabled("s3-ot")){S.getObjectTag(new h("ObjectTagging","getTagging"),E.bucketName,aA,az).then(function(aG){var aD=aG.response;if(aD){var aE=v.convertXmlStringToJson(aD);var aF=0;if(aE&&aE.Tagging&&aE.Tagging.TagSet&&aE.Tagging.TagSet.Tag){aE=l.transformObjectToArray(aE.Tagging.TagSet.Tag);aF=aE.length||0}E.objectPropertiesConfig.object.Tags=o.instant("objectproperties.tags.keyvalue",{tagsCount:aF})}})["catch"](function(){E.objectPropertiesConfig.object.Tags=o.instant("objectproperties.tags.keyvalue",{tagsCount:0})})}var ax=E.objectPropertiesConfig.object;var ay=E.objectPropertiesConfig.properties;ax.LastModified=ar("date")(ax.LastModified,"MMM d, y h:mm:ss a 'GMT'Z");ax.Size=K(ax.Size);if(E.showDeleted||_.isEmpty(ax.Size)){ax.Size="-"}ay.StorageClass=ay.StorageClass?l.getStorageClassTranslations()[ay.StorageClass]:"-";ay.Encryption=l.getEncryptionTranslations()[ay.Encryption];if(E.showDeleted||_.isEmpty(ay.Encryption)){ay.Encryption="-"}ax.ETag=ax.ETag&&!E.showDeleted?ax.ETag.replace(/[\\"]+/g,""):"-";ax.Link="-";ax.ExpirationDate=ax.ExpirationDate?ax.ExpirationDate:"N/A";ax.ExpirationRule=ax.ExpirationRule?ax.ExpirationRule:"N/A";S.getBucketLocation(E.operation,E.bucketName,{}).then(function(aD){var aE=E.showDeleted?"":O.getObjectLink(aA,aD.region);ax.Link=ax.Path?ax.Path+aE:aE})};function g(){at();E.flags.uploadDisabled=false;E.isUploadModalDisplayed.flag=false}function at(){E.batchOps.error=null;E.batchOps.numKeysOperatedOn=null}E.updateObjMetadataForTest=function(ax){E.updateObjMetadata(ax)};E.updateObjMetadata=function(az){var ax=new h("getObjectMetadata");var ay=O.relativeToAbsoluteObjectPath(az.Key);ay=az.Path?az.Path+ay:ay;var aA=O.getCurrentBucket();S.getObjectMetadata(ax,aA,ay).then(function(aC){x.log(al,1,ax,{bucket:aA,key:ay});if(!E.objectPropertiesConfig){E.objectPropertiesConfig={}}if(!E.objectPropertiesConfig.properties){E.objectPropertiesConfig.properties={}}if(!E.objectPropertiesConfig.object){E.objectPropertiesConfig.object={}}if(ab.isCurrentlySelectedObject(aC.config.data.path,E.getSelectedObjects())){E.objectPropertiesConfig.properties.Encryption=l.getEncryptionTranslations()["NONE"];E.objectPropertiesConfig.object.ExpirationDate="N/A";E.objectPropertiesConfig.object.ExpirationRule="N/A";if(aC.headers()){var aB=aC.headers()[c.HEADERS.X_AMZ_RESTORE];if(aB){var aD=l.extractFromQuotes(aB);if(aD==="true"){E.objectPropertiesConfig.properties.Restoration=o.instant("objectdetails.value.restoration")}else{if(aD==="false"){E.objectPropertiesConfig.properties.RestorationExpiry=ar("date")(new Date(l.extractFromQuotes(aB,1)),"medium")}}}if(aC.headers()[c.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]){E.objectPropertiesConfig.properties.Encryption=l.getEncryptionTranslations()[aC.headers()[c.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]]}if(aC.headers()[c.HEADERS.X_AMZ_EXPIRATION]){var aE=aC.headers()[c.HEADERS.X_AMZ_EXPIRATION];E.objectPropertiesConfig.object.ExpirationDate=l.extractFromQuotes(aE,0);E.objectPropertiesConfig.object.ExpirationRule=l.extractFromQuotes(aE,1)}}}},function(aC){var aB={};aB.error=l.handleErrors(aC);aB.key=ay;aB.bucket=aA;x.log(al,0,ax,aB);if(!E.objectPropertiesConfig){E.objectPropertiesConfig={}}if(!E.objectPropertiesConfig.properties){E.objectPropertiesConfig.properties={}}if(!E.objectPropertiesConfig.object){E.objectPropertiesConfig.object={}}E.objectPropertiesConfig.properties.Encryption="";E.objectPropertiesConfig.object.ExpirationDate="";E.objectPropertiesConfig.object.ExpirationRule=""})};E.updateObjAclForTest=function(ax){E.updateObjAcl(ax)};function P(ax,az){var ay=function ay(aA){return aA.URI?aA.URI.split("/").pop():aA.ID};if(ax&&ax.Grantee){return ax.Grantee.DisplayName||ay(ax.Grantee)}else{return az}}E.updateObjAcl=function(ay){var ax=new h("getObjectAcl");var aA=O.getCurrentBucket();var az=O.relativeToAbsoluteObjectPath(ay.Key);S.getObjectAcl(ax,aA,az).then(function(aF){if(aF&&aF.response&&aF.response.AccessControlPolicy&&aF.response.AccessControlPolicy.AccessControlList){var aD;var aB=aF.response.AccessControlPolicy;var aE=(aD={},_defineProperty(aD,c.ACL_PERMISSIONS.READ,[]),_defineProperty(aD,c.ACL_PERMISSIONS.WRITE,[]),_defineProperty(aD,c.ACL_PERMISSIONS.READ_ACP,[]),_defineProperty(aD,c.ACL_PERMISSIONS.WRITE_ACP,[]),aD);var aC=aB.AccessControlList.Grant;var aH=aB.Owner.DisplayName;var aG=function aG(aI){var aK=P(aI,aH);if(aI.Permission===c.ACL_PERMISSIONS.FULL_CONTROL){for(var aJ in aE){if(aE[aJ].indexOf(aK)===-1){aE[aJ].push(aK)}}}else{if(aE[aI.Permission].indexOf(aK)===-1){aE[aI.Permission].push(aK)}}};if(aC){if(Array.isArray(aC)){aC.forEach(function(aI){aG(aI)})}else{aG(aC)}if(ab.isCurrentlySelectedObject(aF.request.path,E.getSelectedObjects())){if(!E.objectPropertiesConfig){E.objectPropertiesConfig={}}if(!E.objectPropertiesConfig.permissions){E.objectPropertiesConfig.permissions={}}E.objectPropertiesConfig.permissions.owner=aH;E.objectPropertiesConfig.permissions.grantees={};E.objectPropertiesConfig.permissions.grantees.object={};E.objectPropertiesConfig.permissions.grantees.object[c.ACL_PERMISSIONS.READ]=aE[c.ACL_PERMISSIONS.READ].length;E.objectPropertiesConfig.permissions.grantees.object[c.ACL_PERMISSIONS.WRITE]=aE[c.ACL_PERMISSIONS.WRITE].length;E.objectPropertiesConfig.permissions.grantees.objectPermissions={};E.objectPropertiesConfig.permissions.grantees.objectPermissions[c.ACL_PERMISSIONS.READ_ACP]=aE[c.ACL_PERMISSIONS.READ_ACP].length;E.objectPropertiesConfig.permissions.grantees.objectPermissions[c.ACL_PERMISSIONS.WRITE_ACP]=aE[c.ACL_PERMISSIONS.WRITE_ACP].length}}x.log(B,1,ax,{bucket:aA,key:az})}},function(aC){var aB={};aB.key=az;aB.bucket=aA;aB.error=l.handleErrors(aC);x.log(B,0,ax,aB);if(!E.objectPropertiesConfig){E.objectPropertiesConfig={}}if(!E.objectPropertiesConfig.permissions){E.objectPropertiesConfig.permissions={}}E.objectPropertiesConfig.permissions=aC})};function ag(ax){if(typeof ax!=="string"){return""}return ax}E.fetchObjects=function(aA){var ay=arguments.length<=1||arguments[1]===undefined?true:arguments[1];var ax=arguments.length<=2||arguments[2]===undefined?"":arguments[2];E.isRefreshing=true;E.filters.tagFilters=[];E.filters.prefixFilters=[];E.filters.input="";E.sortColumnName="";E.isConfirmationModalOpen.sidePanelOpen=false;E.resetSelection();E.timing.fetchAllObjects.start=new Date().getTime();var az=O.getCurrentAbsoluteFolderPath();if(az===undefined){az=""}E.markers=[];if(E.showDeleted){q(az)}else{if(aA){X(az,ax,ay)}else{H(az,ax,ay)}}};function av(ay,aC){E.showEmptyScreen=false;E.noResultsMessage=undefined;var aA=ag(ay.Prefix);if(E.filters.input){aA=aA.substring(0,aA.length-E.filters.input.length)}var ax=O.absoluteToRelativeObjectPaths(ay.Contents,aA);E.currLocation.objects.relativePaths=aC?ax:E.currLocation.objects.relativePaths.concat(ax);var aB=O.absoluteToRelativeFolderPaths(ay.CommonPrefixes,aA);E.currLocation.folders.relativePaths=aC?aB:E.currLocation.folders.relativePaths.concat(aB);j.Timer.customerReady();var az=0;if(ax){az+=ax.length}if(aB){az+=aB.length}if(az===0){if(ag(ay.Prefix)===""){if(E.showDeleted){E.noResultsMessage=o.instant("objectlisting.nodeletedobjects")}else{E.showEmptyScreen=true}}else{if(E.filters.input){E.noResultsMessage=o.instant("prefixsearch.noresults")}else{E.noResultsMessage=o.instant("objectlisting.noobjects")}}}E.startKeyNum=az===0?0:E.maxKeys*E.markers.length+1;E.endKeyNum=E.maxKeys*E.markers.length+az;m();E.isRefreshing=false}function m(){var ax=E.currLocation.folders.relativePaths?E.currLocation.folders.relativePaths.concat(E.currLocation.objects.relativePaths):E.currLocation.objects.relativePaths;if(ax){E.allKeys.selected=_.every(ax,function(ay){return _.has(ay,"selected")&&ay.selected===true})}else{E.allKeys.selected=false}}function H(az,ax){var ay=arguments.length<=2||arguments[2]===undefined?true:arguments[2];E.isConfirmationModalOpen.sidePanelOpen=false;E.resetSelection();E.isRefreshing=true;t.listObjects(az,ax,E.maxKeys,c.DELIMITER,ay).then(function(aB){var aA=aB.response.ListBucketResult;av(aA,true);ao();E.currentMarker=aA.Marker;E.nextMarker=aA.NextMarker})["catch"](function(aA){k(aA)})}function F(az){var ax={Contents:az.deletedFiles,CommonPrefixes:az.folders},ay={Contents:az.cachedDeletedFiles,CommonPrefixes:az.cachedFolders};av(ax,true);E.startKeyNum=e.currentPage*E.maxKeys+1;E.endKeyNum=E.startKeyNum+ax.Contents.length+ax.CommonPrefixes.length-1;aq.setPageOfDeletedObjects(ax,e.currentPage);e.lastCachedPage=e.currentPage;if(ay.Contents.length+ay.CommonPrefixes.length>0){aq.setPageOfDeletedObjects(ay,e.currentPage+1)}e.nextKeyMarker=az.NextKeyMarker;e.nextVersionIdMarker=az.NextVersionIdMarker;e.isTruncated=l.convertStringToBoolean(az.IsTruncated)}function q(ax){E.currLocation.folders.relativePaths=[];E.currLocation.objects.relativePaths=[];E.isRefreshing=true;e.currentPage=0;e.lastCachedPage=0;E.startKeyNum=0;E.endKeyNum=0;aq.resetDeletedObjects();ai.listDeletedObjects(new h(c.LIST_DELETED_OBJECTS),ax).then(function(ay){F(ay)},function(ay){k(ay)})}E.fetchOnePagePrefix=function(ay,ax){H(ay,ax)};E.fetchOnePageTag=function(ax){var ay=arguments.length<=1||arguments[1]===undefined?true:arguments[1];E.showEmptyScreen=false;E.noResultsMessage=undefined;E.isConfirmationModalOpen.sidePanelOpen=false;E.resetSelection();if(ay){E.currLocation.folders.relativePaths=[];E.currLocation.objects.relativePaths=E.nextTagObjs||[];E.startKeyNum=E.tagContinuationTokens.length===0?0:E.maxKeys*E.markers.length+1;E.endKeyNum=E.startKeyNum;E.isRefreshing=true}E.tagQueryDeferred=W.defer();E.tagQueryDeferred.promise.then(function(az){return af(az)},function(az){if(az.status===c.HTTP_STATUS_CODES.METHOD_NOT_ALLOWED){E.currLocation.objects.error=o.instant("prefixtagsearch.methodnotallowed")}else{E.currLocation.objects.error=o.instant("utilities.unknown.error")}E.isRefreshing=false;E.showAllObjects()});t.tagQuery(E.filters.tagFilters,E.maxKeys,ax).then(function(az){return E.tagQueryDeferred.resolve(az)},function(az){return E.tagQueryDeferred.reject(az)})};function af(aA){var ax=v.convertXmlStringToJson(aA.response).TagQueryResult;var az=true;if(ax.Contents){var ay=[].concat(ax.Contents);angular.forEach(ay,function(aB){return az=u(aB.Key)})}if(ax.IsTruncated===true&&_.isString(ax.NextContinuationToken)){if(az){E.fetchOnePageTag(ax.NextContinuationToken,false)}else{E.tagContinuationTokens.push(ax.NextContinuationToken);E.isRefreshing=false;E.showAllObjects()}}else{if(E.currLocation.objects.relativePaths.length===0){E.noResultsMessage=o.instant("tagsearch.noresults")}E.isRefreshing=false;E.showAllObjects()}}function u(ay,ax){var aA=ay.split("/"),az=aA[aA.length-1],aB={ETag:"",Key:az,LastModified:"",Owner:{DisplayName:"",ID:""},Path:aA.length>1?ay.substring(0,ay.lastIndexOf(az)):"",Size:"",StorageClass:"",VersionId:ax,beingRenamed:false};if(E.endKeyNum-E.startKeyNum<E.maxKeys-1){E.currLocation.objects.relativePaths.push(aB);if(E.startKeyNum===0){E.startKeyNum=1}E.endKeyNum++;return true}else{if(E.nextTagObjs){E.nextTagObjs.push(aB)}else{E.nextTagObjs=[aB]}return false}}function r(){if(e.currentPage>e.lastCachedPage){e.lastCachedPage=e.currentPage}var ax=aq.getPageOfDeletedObjects(e.currentPage);av(ax,true);E.startKeyNum=e.currentPage*E.maxKeys+1;E.endKeyNum=E.startKeyNum+ax.Contents.length+ax.CommonPrefixes.length-1}E.fetchNextPageOfObjects=function(){var ax=O.getCurrentAbsoluteFolderPath();if(ax===undefined){ax=""}if(E.showDeleted){e.currentPage++;if(e.currentPage<=e.lastCachedPage||!e.isTruncated){r()}else{ai.fetchDeletedPageOfObjects(ax,e.currentPage,e.nextKeyMarker,e.nextVersionIdMarker).then(function(ay){F(ay)},function(ay){k(ay)})}}else{if(E.tagContinuationTokens.length>0){E.fetchOnePageTag(E.tagContinuationTokens[E.tagContinuationTokens.length-1])}else{ax=ax.concat(E.filters.input||"");E.markers.push(E.currentMarker);E.startKeyNum=E.maxKeys*E.markers.length+1;H(ax,E.nextMarker)}}};E.fetchPreviousPageOfObjects=function(){if(E.showDeleted){e.currentPage--;r()}else{var ax=O.getCurrentAbsoluteFolderPath();if(ax===undefined){ax=""}ax=ax.concat(E.filters.input||"");var ay=E.markers.pop();if(!ay||Object.keys(ay).length===0){ay=""}E.startKeyNum=E.maxKeys*E.markers.length+1;H(ax,ay)}};function X(az,ax){var ay=arguments.length<=2||arguments[2]===undefined?true:arguments[2];t.listObjects(az,ax,E.maxKeys,c.DELIMITER,ay).then(function(aB){var aA=aB.response.ListBucketResult;av(aA);if(aA.IsTruncated&&l.convertStringToBoolean(aA.IsTruncated)){X(aA.NextMarker)}else{ao()}})["catch"](function(aA){k(aA)})}function k(ax){E.currLocation.objects.error=l.handleErrors(ax);j.Timer.customerReady();E.currLocation.loading=false;E.isRefreshing=false}function ao(){E.timing.fetchAllObjects.duration=new Date().getTime()-E.timing.fetchAllObjects.start;E.currLocation.loading=false;E.currLocation.objects.error=false;E.isRefreshing=false}E.openUploadModal=function(){E.currentPath=O.getAbsolutePathWithBucket();E.flags.uploadDisabled=true;l.analyticsTrackClick(c.ANALYTICS.UPLOAD_OBJECTS_MODAL,c.ANALYTICS.DETAILS);l.analyticsTrackClick(c.ANALYTICS.START_UPLOAD_FILE,c.ANALYTICS.UPLOAD_FILE_S3);l.analyticsTrackView(c.ANALYTICS.SELECT_UPLOAD_FILE,c.ANALYTICS.UPLOAD_FILE_S3);E.isUploadModalDisplayed.flag=true};var R=z.$on("fileDropEvent",function(az,ay){if(E.isUploadModalDisplayed.flag){return}az.defaultFired=true;E.operations.dragAndDropOperation=Z.createUploadOperation();var ax=A.createExplorer(ay,E.operations.dragAndDropOperation);ax.then(function(aA){E.operations.dragAndDropOperation.explorers.push(aA);E.selected={selectedItems:aA.getSelectedItems()};E.flags.uploadDisabled=false},function(aA){E.error=aA});E.openUploadModal()});E.getPropertyTitleConditionally=function(az,ax,ay){if(az){return o.instant(ax+ay)}return""};E.setTabParam=function(ax){an.search("tab",ax);l.analyticsTrackClick(""+c.ANALYTICS.TAB_VIEW+ax,c.ANALYTICS.DETAILS)};E.$on("$destroy",function(){R();ab.setSelectedFlagAsFalse(E.currLocation.folders.relativePaths,E.currLocation.objects.relativePaths)});E.getStorageClassTranslation=function(ax){return l.getStorageClassTranslations()[ax]};E.isFeatureEnabled=function(ax){return au.isFeatureEnabled(ax)};E.isFetchPreviousPageDisabled=function(){if(!E.showDeleted){return E.markers.length===0}else{return e.currentPage===0}};E.isFetchNextPageDisabled=function(){if(!E.showDeleted){return !E.nextMarker}else{if(!e.isTruncated&&e.currentPage===e.lastCachedPage){if(aq.getPageOfDeletedObjects(e.currentPage+1)){return false}return true}return false}};function ae(){if(E.isFeatureEnabled("s3-si")){E.tabs.push(n)}if(d[c.SHOW_DELETED_PARAM]){E.showDeleted=l.convertStringToBoolean(d[c.SHOW_DELETED_PARAM])}E.fetchObjects(false)}ae()};"use strict";(function(){angular.module("s3").directive("createBucketModal",[function(){return{restrict:"E",scope:{isOpen:"=",bucketList:"=",regions:"=",numRegions:"=",loadBuckets:"="},templateUrl:"/s3/partials/createbucketmodal.html",controller:"CreateBucketController"}}]);angular.module("s3").controller("CreateBucketController",["$filter","$q","$scope","$translate","APIProxyService","BucketPropertiesService","CachingService","ConsoleOperation","PermissionsUtilService","Region","S3Constants","SCLogService","UtilService",a]);function a(o,w,q,r,t,k,h,m,j,e,p,c,y){q.STEP={NAME_AND_REGION:{name:"NAME_AND_REGION",value:r.instant("createbucketmodal.label.nameandregion")},PROPERTIES:{name:"PROPERTIES",value:r.instant("createbucketmodal.label.setproperties")},PERMISSIONS:{name:"PERMISSIONS",value:r.instant("createbucketmodal.label.setpermissions")},REVIEW:{name:"REVIEW",value:r.instant("createbucketmodal.label.review")}};q.state=q.STEP.NAME_AND_REGION;q.headerTitle=r.instant("createbucketmodal.header.title");q.createBucketValues={firstLoad:true};q.createBucketProperties={getResponse:{tagging:{tags:[]},logging:{selectedValue:p.BUCKET_PROPERTIES.DISABLE},versioning:{selectedValue:p.BUCKET_PROPERTIES.DISABLE}}};q.forCreateBucketModal=true;q.defaultAcls=_.cloneDeep(p.BUCKET_PERMISSIONS.INITIALIZE_ACLS);q.currPermissions=_.cloneDeep(p.BUCKET_PERMISSIONS.INITIALIZE_ACLS);q.sourceBucketPermissions={grantees:{},aclGrants:{},owner:{}};q.isCreatingBucket=false;q.propertyStatuses=[];z();q.bucketNameValidationErrors=[];q.$watch(function(){return q.currPermissions.publicPermissions},function(B,A){if(B!==A){q.aclsSummaries[1].value=l(q.currPermissions.publicPermissions)}},true);function u(){return w.reject()}function g(A){return A.then(function(){})["catch"](function(){return u()})}function s(B){var A=new m(p.BUCKET_PROPERTIES.VERSIONING.ENABLE_BUCKET_VERSIONING);return g(k.enableBucketVersioning(B,A))}function f(B,A){var C=new m(p.BUCKET_PROPERTIES.TAGGING.PUT_BUCKET_TAGGING);return g(k.putBucketTagging(B,A,C))}function v(A){var B=new m(p.BUCKET_PERMISSIONS.PUT_BUCKET_PERMISSIONS_REQUEST);return k.putBucketACL(A,j.updateAcl(q.sourceBucketPermissions,q.currPermissions),B).then(function(){})["catch"](function(C){return u(C)})}function z(){var A=new m(p.BUCKET_PERMISSIONS.GET_BUCKET_OWNER);t.getBucketOwner(A).then(function(B){c.log("getBucketOwner",1,A);q.currPermissions.ownerName=B.DisplayName;q.defaultAcls.userPermissions[0].detail=_.clone(B);q.currPermissions.userPermissions[0].detail=_.clone(B)})["catch"](function(B){c.log("getBucketOwner",0,A);q.sourceBucketPermissions.owner.isError=true;q.sourceBucketPermissions.owner.errorMessage=y.handleErrors(B)})}function b(D,A,B,C){D.push({Grantee:{Type:p.BUCKET_PROPERTIES.GROUP_GANTEE_TYPE,DisplayName:"",EmailAddress:"",ID:"",URI:p.BUCKET_PROPERTIES.LOG_DELIVERY_GROUP},Permission:A});c.log("LogDeliveryGroupGranteeAdded",1,B,{bucketName:C})}function x(C,E,D,A){var B=new m(p.BUCKET_PROPERTIES.LOGGING.ENABLE_BUCKET_LOGGING);B.step=p.BUCKET_PROPERTIES.GET_BUCKET_ACL;return k.getBucketACL(E,B).then(function(F){var G=y.transformObjectToArray(F);b(G,p.ACL_PERMISSIONS.WRITE,B,C);b(G,p.ACL_PERMISSIONS.READ_ACP,B,C);B.step=p.BUCKET_PROPERTIES.PUT_BUCKET_ACL;return k.putBucketACL(E,G,B).then(function(){B.step=p.BUCKET_PROPERTIES.LOGGING.ENABLE_BUCKET_LOGGING;return k.enableBucketLogging(C,E,D,A,B).then(function(){})["catch"](function(H){return u(H)})})["catch"](function(H){return u(H)})})["catch"](function(F){return u(F)})}function d(C,F){if(q.createBucketProperties.getResponse.versioning.selectedValue===p.BUCKET_PROPERTIES.ENABLE){F.push(s(C))}if(q.createBucketProperties.getResponse.tagging.tags.length>0){var B=q.createBucketProperties.getResponse.tagging.tags;F.push(f(C,B))}if(q.createBucketProperties.getResponse.logging.selectedValue===p.BUCKET_PROPERTIES.ENABLE){var E=q.createBucketProperties.getResponse.logging.targetBucket;var D=q.createBucketProperties.getResponse.logging.targetPrefix;var A=y.transformObjectToArray(q.createBucketProperties.getResponse.logging.targetGrants);F.push(x(C,E,D,A))}if(JSON.stringify(j.updateAcl(q.sourceBucketPermissions,q.currPermissions))!==JSON.stringify(j.updateAcl(q.defaultAcls,q.defaultAcls))){F.push(v(C))}}q.createBucket=function(B,C){y.analyticsTrackClick(p.ANALYTICS.END_CREATE_BUCKET,p.ANALYTICS.CREATE_BUCKET_S3);q.isCreatingBucket=true;var A=new m("CreateBucket","CreateBucketRequestReceived");c.log("CreateBucketRequestReceived",1,A,{bucketName:B,region:C.value});t.createBucket(A,B,C.value).then(function(){h.evictLamb();c.log("CreateBucketSuccess",1,A,{bucketName:B,region:C.value});var F=[];d(B,F);w.all(F).then(function E(G){q.closeCreateBucketModal()},function D(){q.createS3BucketWarning=r.instant("createbucketmodal.errormsg",{bucketName:B})});q.loadBuckets(A)})["catch"](function(D){q.createS3BucketError=y.handleErrors(D);c.log("CreateBucketSuccess",0,A,{bucketName:B,region:C.value,errorMessage:D})})["finally"](function(){q.isCreatingBucket=false;if(q.createS3BucketError){q.setState(q.STEP.REVIEW)}})};q.closeCreateBucketModal=function(){q.isOpen.flag=false;q.createS3BucketError=undefined;q.createS3BucketWarning=null;q.createBucketValues.region=null;q.createBucketValues.name="";q.createBucketValues.copySettingsSourceBucket=undefined;q.state=q.STEP.NAME_AND_REGION;q.createBucketProperties={getResponse:{tagging:{tags:[]},logging:{selectedValue:p.BUCKET_PROPERTIES.DISABLE},versioning:{selectedValue:p.BUCKET_PROPERTIES.DISABLE}}};q.sourceBucketPermissions.aclGrants={};q.sourceBucketPermissions.grantees={};q.currPermissions.publicPermissions=_.cloneDeep(q.defaultAcls.publicPermissions);q.currPermissions.userPermissions=_.cloneDeep(q.defaultAcls.userPermissions);q.bucketNameValidationErrors=[];y.bodyFreezeScroll(false)};q.goToPreviousState=function(){q.bucketNameValidationErrors=[];q.previousState()};q.generateSummary=function(){t.headBucket(new m("checkBucketAvailability"),q.createBucketValues.name).then(function(A){q.bucketNameValidationErrors=[r.instant("createbucketmodal.bucketname.exists.error")]})["catch"](function(A){if(A.status===p.HTTP_STATUS_CODES.NOT_FOUND){if(q.state===q.STEP.NAME_AND_REGION){y.analyticsTrackClick(p.ANALYTICS.NAME_REGION_CREATE_BUCKET,p.ANALYTICS.CREATE_BUCKET_S3);y.analyticsTrackView(p.ANALYTICS.SET_PROP_CREATE_BUCKET,p.ANALYTICS.CREATE_BUCKET_S3)}else{if(q.state===q.STEP.PROPERTIES){var C={versioning:q.createBucketProperties.getResponse.versioning.selectedValue,logging:q.createBucketProperties.getResponse.logging.selectedValue};y.analyticsTrackClick(p.ANALYTICS.SET_PROP_CREATE_BUCKET,p.ANALYTICS.CREATE_BUCKET_S3,C);y.analyticsTrackView(p.ANALYTICS.SET_PERM_CREATE_BUCKET,p.ANALYTICS.CREATE_BUCKET_S3)}else{if(q.state===q.STEP.PERMISSIONS){var B=[{name:r.instant("bucketproperties.versioning.label.versioning"),value:"versioning"},{name:r.instant("bucketproperties.logging.label.logging"),value:"logging"},{name:r.instant("bucketproperties.tagging.label.tagging"),value:"tagging"}];q.propertyStatuses=[];B.forEach(function(D){q.propertyStatuses.push(n(D))});y.analyticsTrackClick(p.ANALYTICS.SET_PERM_CREATE_BUCKET,p.ANALYTICS.CREATE_BUCKET_S3);y.analyticsTrackView(p.ANALYTICS.REVIEW_CREATE_BUCKET,p.ANALYTICS.CREATE_BUCKET_S3)}}}q.nextState()}else{q.bucketNameValidationErrors=[r.instant("createbucketmodal.bucketname.access.error")]}})};q.validateBucketName=function(){var A=[];if(y.isValidBucketName(q.createBucketValues.name,A)){if(i(q.createBucketValues.name)){q.bucketNameValidationErrors=[r.instant("createbucketmodal.bucketname.exists.error")]}else{q.bucketNameValidationErrors=[]}}else{q.bucketNameValidationErrors=A}};function i(A){return q.bucketList.some(function(B){return B.Name===A})}function n(D){var A=q.createBucketProperties.getResponse[D.value];var C={name:D.name};var B={enabled:r.instant("createbucketmodal.review.enabled"),disabled:r.instant("createbucketmodal.review.disabled"),activenotifs:r.instant("createbucketmodal.review.activenotifications"),tags:r.instant("createbucketmodal.review.tags")};switch(D.value){case"versioning":C.status=A.selectedValue;C.status=A.selectedValue===p.BUCKET_PROPERTIES.VERSIONING.ENABLE?B.enabled:B.disabled;break;case"logging":C.status=A.selectedValue===p.BUCKET_PROPERTIES.LOGGING.ENABLE?B.enabled:B.disabled;break;case"tagging":C.status=A.tags.length+" "+B.tags;break}return C}var l=function l(A){return _.map(A,"permissions").filter(function(B){return B&&(B.READ||B.READ_ACP||B.WRITE||B.WRITE_ACP)}).length>0?r.instant("modal.acl.summary.enabled"):r.instant("modal.acl.summary.disabled")};q.aclsSummaries=[{summaryTitle:r.instant("modal.acl.summary.users"),value:q.currPermissions.userPermissions.length},{summaryTitle:r.instant("modal.acl.summary.publicacls"),value:r.instant("modal.acl.summary.disabled")}]}})();"use strict";angular.module("s3").factory("APIProxyService",["CachingService","FAC","SCLogService","S3Service","Md5GenerationService","S3Constants","UtilService","KMSService","$q","$window",function(o,X,e,r,R,V,u,S,b,O){var s=function s(Y,ad,ab,aa){aa.step=V.LOGGING.S3_REQUEST_PREFIX+ab;if(ad.path){ad.path=u.escapePath(ad.path)}e.log(aa.step.replace(/ /g,""),1,aa,ad);var Z=ab.replace(/ /g,"");var ac=O.Date.now();return Y(ad).then(function(af){var ae=O.Date.now();var ag={};var ah=af.headers();ag[V.S3_RESPONSE_HEADERS.X_AMZ_ID_2]=ah[V.S3_RESPONSE_HEADERS.X_AMZ_ID_2];ag[V.S3_RESPONSE_HEADERS.X_AMZ_REQUEST_ID]=ah[V.S3_RESPONSE_HEADERS.X_AMZ_REQUEST_ID];e.log(""+Z+V.REQUEST_METRICS.STATUS_CODE_INFIX+af.status,1,aa,ag);e.logWithSimplifiedOperation(""+Z+V.REQUEST_METRICS.SERVER_AVAILABILITY_SUFFIX,1,aa);e.logWithSimplifiedOperation(""+Z+V.REQUEST_METRICS.CLIENT_AVAILABILITY_SUFFIX,1,aa);e.logWithSimplifiedOperation(""+Z+V.REQUEST_METRICS.LATENCY_SUFFIX,ae-ac,aa);if(af&&af.response&&af.response.error){return b.reject(u.handleErrors(af.response.error))}return af})["catch"](function(af){var ae=O.Date.now();var ag={};var ah=af.headers();ag[V.S3_RESPONSE_HEADERS.X_AMZ_ID_2]=ah[V.S3_RESPONSE_HEADERS.X_AMZ_ID_2];ag[V.S3_RESPONSE_HEADERS.X_AMZ_REQUEST_ID]=ah[V.S3_RESPONSE_HEADERS.X_AMZ_REQUEST_ID];e.log(""+Z+V.REQUEST_METRICS.STATUS_CODE_INFIX+af.status,1,aa,{response:af,details:ag});if(af.status>=V.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD){e.logWithSimplifiedOperation(""+Z+V.REQUEST_METRICS.SERVER_AVAILABILITY_SUFFIX,0,aa)}else{e.logWithSimplifiedOperation(""+Z+V.REQUEST_METRICS.SERVER_AVAILABILITY_SUFFIX,1,aa)}if(af.status>=V.HTTP_STATUS_CODES.CLIENT_ERROR_THRESHOLD&&af.status<V.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD){e.logWithSimplifiedOperation(""+Z+V.REQUEST_METRICS.CLIENT_AVAILABILITY_SUFFIX,0,aa)}else{e.logWithSimplifiedOperation(""+Z+V.REQUEST_METRICS.CLIENT_AVAILABILITY_SUFFIX,1,aa)}e.logWithSimplifiedOperation(""+Z+V.REQUEST_METRICS.LATENCY_SUFFIX,ae-ac,aa);return b.reject(af)})};function a(Z,ab,Y,aa){return I(Z,ab,{path:ab+"/"+Y,params:{versionId:aa}}).then(function(ac){return s(r.getObjectMetadata,ac,V.PROXY_API_NAMES.S3.GET_OBJECT_METADATA,Z)})}function w(Y){var Z=arguments.length<=1||arguments[1]===undefined?true:arguments[1];if(Z){var aa=o.getLamb();if(aa){return b.when(aa)}}return s(r.listAllMyBuckets,{region:V.DEFAULT_REGION[u.getCloudSystem()]},V.PROXY_API_NAMES.S3.LAMB,Y).then(function(ac){var ab=_.get(ac,"response.ListAllMyBucketsResult.Buckets");ab.Bucket=g(ab.Bucket);ab.Bucket.forEach(function(ad){I(Y,ad.Name)});o.putLamb(ac);return ac})}function C(Y){var Z=o.getLamb();if(Z){return b.when(Z.response.ListAllMyBucketsResult.Owner)}return s(r.listAllMyBuckets,{region:V.DEFAULT_REGION[u.getCloudSystem()]},V.PROXY_API_NAMES.S3.LAMB,Y).then(function(aa){return _.get(aa,"response.ListAllMyBucketsResult.Owner")})}function c(Y,Z){var aa={path:Z};return s(r.headBucket,aa,V.PROXY_API_NAMES.S3.HEAD_BUCKET,Y)}function Q(Y){var Z={path:Y.initialBucket};return I(Y,Y.initialBucket,Z).then(function(aa){return s(r.deleteBucket,aa,Y.name,Y)})}function q(Z,ae,aa,ac,ad){var Y=b.defer();aa=aa||"";var ab={path:ae+"/"+aa+ac+"/"};if(ad){ab.headers=ad}I(Z,ae,ab).then(function(af){s(r.putObject,af,V.PROXY_API_NAMES.S3.PUT_OBJECT,Z).then(function(ag){Y.resolve(ag)})["catch"](function(ag){Y.reject(ag)})})["catch"](function(af){Y.reject(af)});return Y.promise}function J(Z,ac,aa){var Y=b.defer();var ab={path:ac+"/"+aa};I(Z,ac,ab).then(function(ad){s(r.headObject,ad,V.PROXY_API_NAMES.S3.HEAD_OBJECT,Z).then(function(ae){Y.resolve(ae)})["catch"](function(ae){Y.reject(ae)})})["catch"](function(ad){Y.reject(ad)});return Y.promise}function j(Z,aa,ac){var Y;if(ac==="us-east-1"){Y=""}else{Y="<CreateBucketConfiguration xmlns='http://s3.amazonaws.com/doc/2006-03-01/'><LocationConstraint>"+ac+"</LocationConstraint></CreateBucketConfiguration>"}var ab={content:Y,path:aa,region:ac};return s(r.createBucket,ab,V.PROXY_API_NAMES.S3.CREATE_BUCKET,Z).then(function(ad){return ad})["catch"](function(ad){if(ad.response&&ad.response.Error&&ad.response.Error.Message){return b.reject(ad.response.Error.Message)}else{return b.reject(ad)}})}var I=function I(Z,ad,ab){var Y=o.getBucketLocation(ad);if(Y){if(ab){ab.region=Y}return b.when(ab)}var ac={path:ad};if(!u.isIE()){return s(r.headBucket,ac,V.PROXY_API_NAMES.S3.HEAD_BUCKET,Z).then(function(af){var ae=p(af);o.putBucketLocation(ad,ae);if(ab){ab.region=ae}return ab})["catch"](function(ae){var af=p(ae);if(af){o.putBucketLocation(ad,af);if(ab){ab.region=af}return ab}return b.reject("Error retrieving bucket region")})}else{var aa=u.getRegionOrder();return i(Z,ad,ab,aa)}};function i(Z,ad,ab,aa){if(aa.length===0){return b.reject("Error retrieving bucket region")}var Y=aa.shift();var ac={path:ad,region:Y};return s(r.headBucket,ac,V.PROXY_API_NAMES.S3.HEAD_BUCKET,Z).then(function(af){var ae=p(af);o.putBucketLocation(ad,ae);if(ab){ab.region=ae}return ab})["catch"](function(ae){var af=p(ae);if(af){o.putBucketLocation(ad,af);if(ab){ab.region=af}return ab}return i(Z,ad,ab,aa)})}var K=function K(Z,ab){var aa=ab.cacheAllowed;delete ab.cacheAllowed;if(aa){var Y=o.getBucketObjects(ab.path,JSON.stringify(ab));if(Y){return b.when(Y)}}return s(r.listObjects,ab,V.PROXY_API_NAMES.S3.LIST_OBJECT,Z).then(function(ae){var ad=ae.response.ListBucketResult;if(ad.Contents){ad.Contents=g(ad.Contents);ad.Contents=ad.Contents.map(function(af){af.Size=parseInt(af.Size);return af})}if(ad.CommonPrefixes){ad.CommonPrefixes=g(ad.CommonPrefixes)}if(ad.IsTruncated&&ad.IsTruncated==="true"&&!ad.NextMarker){var ac=ad.Contents[ad.Contents.length-1].Key;ad.NextMarker=ac}if(!aa||aa&&!Y){o.putBucketObjects(ab.path,JSON.stringify(ab),ae)}return ae})};function H(Z,aa){var Y={path:aa.bucket,params:{prefix:aa.prefix,"max-keys":aa.maxKeys,marker:aa.marker,delimiter:aa.delimiter},cacheAllowed:aa.cacheAllowed};if(X.isFeatureEnabled("s3-log-response-data")){Y.details={shouldLogResponseData:true}}return I(Z,aa.bucket,Y).then(function(ab){return K(Z,ab)})}function m(Z,ab){var Y=b.defer(),aa={path:ab.bucket,params:{delimiter:ab.delimiter,"key-marker":ab.keyMarker,"max-keys":ab.maxKeys,prefix:ab.prefix,"version-id-marker":ab.versionIdMarker},cacheAllowed:ab.cacheAllowed};I(Z,ab.bucket,aa).then(function(ac){s(r.listVersions,ac,V.PROXY_API_NAMES.S3.LIST_VERSION,Z).then(function(ad){Y.resolve(ad)})["catch"](function(ad){Y.reject(ad)})})["catch"](function(ac){Y.reject(ac)});return Y.promise}var W=function W(Y,Z){return s(r.getObjectAcl,Z,V.PROXY_API_NAMES.S3.GET_OBJECT_ACL,Y).then(function(ab){var aa=ab.response.AccessControlPolicy.AccessControlList;aa.Grant=g(aa.Grant);return ab})};function z(Z,aa,Y){return I(Z,aa,{path:aa+"/"+Y}).then(function(ab){return W(Z,ab)})}function h(Z,aa,ab){var Y=b.defer();I(Z,aa,{path:aa,content:ab}).then(function(ac){s(r.tagQuery,ac,V.PROXY_API_NAMES.S3.TAG_QUERY,Z).then(function(ad){return Y.resolve(ad)},function(ad){return Y.reject(ad)})});return Y.promise}var x=function x(Z,aa){var Y=b.defer();s(r.getObjectTag,aa,V.PROXY_API_NAMES.S3.GET_OBJECT_TAG,Z).then(function(ab){return Y.resolve(ab)},function(ab){return Y.reject(ab)});return Y.promise};function A(aa,ac,Z){var ab=arguments.length<=3||arguments[3]===undefined?null:arguments[3];var Y=b.defer(),ad={path:ac+"/"+Z};if(!_.isEmpty(ab)){ad.params={versionId:ab}}I(aa,ac,ad).then(function(ae){x(aa,ae).then(function(af){Y.resolve(af)},function(af){Y.reject(af)})},function(ae){Y.reject(ae)});return Y.promise}function k(Z,ab,ae,ad){var aa=arguments.length<=4||arguments[4]===undefined?null:arguments[4];var Y=b.defer(),ac={path:ab+"/"+ae,content:ad};if(!_.isEmpty(aa)){ac.params={versionId:aa}}I(Z,ab,ac).then(function(af){s(r.putObjectTag,af,V.PROXY_API_NAMES.S3.PUT_OBJECT_TAG,Z).then(function(ag){Y.resolve(ag)},function(ag){Y.reject(ag)})});return Y.promise}function N(Y,aa,Z,ac){var ab={path:aa+"/"+Z,content:ac};return I(Y,aa,ab).then(function(ad){return s(r.putObjectAcl,ad,V.PROXY_API_NAMES.S3.PUT_OBJECT_ACL,Y).then(function(ae){return ae},function(ae){return ae})})["catch"](function(ad){if(ad.response){return b.reject(ad.response.Error.Message)}else{return b.reject(ad)}})}function n(Y,Z,aa){return I(Y,Z,aa).then(function(ab){return s(r.getObjectInventory,ab,"S3-GetObjectInventory",Y).then(function(ac){return ac})})["catch"](function(ab){if(ab.response){return b.reject(ab.response.Error.Message)}else{return b.reject(ab)}})}var d=function d(Y,Z,aa){return I(Y,Z,aa).then(function(ab){return s(r.deleteObjectInventoryConfig,ab,"S3-DeleteObjectInventoryConfig",Y).then(function(ac){return ac})})["catch"](function(ab){if(ab.response){return b.reject(ab.response.Error.Message)}else{return b.reject(ab)}})};var M=function M(Y,Z,aa){return I(Y,Z,aa).then(function(ab){return s(r.putObjectInventoryConfig,ab,"S3-PutObjectInventoryConfig",Y).then(function(ac){return ac})})["catch"](function(ab){if(ab.response){return b.reject(ab.response.Error.Message)}else{return b.reject(ab)}})};function p(Y){return Y&&Y.headers?Y.headers()["x-amz-bucket-region"]:null}function g(Y){if(!Y){return[]}var Z;if(!angular.isArray(Y)){Z=new Array(Y)}else{Z=Y}return Z}function D(ab,aa,ac,Z,Y){var ad={content:"",path:ab+"/"+aa,params:{uploads:""},headers:ac,config:{timeout:Z}};return I(Y,ab,ad).then(function(ae){return s(r.initiateMultipartUpload,ae,V.PROXY_API_NAMES.S3.INITIAL_MULTIPART_UPLOAD,Y)})}function y(ad,aa,ac,ae,Z,Y){var ab={content:ac,path:ad+"/"+aa,params:{uploadId:ae},config:{timeout:Z}};return I(Y,ad,ab).then(function(af){return s(r.completeMultipartUpload,af,V.PROXY_API_NAMES.S3.COMPLETE_MULTIPART_UPLOAD,Y)})}function L(Y,Z,ab){var ac=arguments.length<=3||arguments[3]===undefined?{}:arguments[3];var aa=arguments.length<=4||arguments[4]===undefined?true:arguments[4];return aa&&T(Z,ab)||I(Y,Z,{path:Z}).then(function(ad){angular.extend(ad,ac);return s(B[ab].getterFunction,ad,V.PROXY_API_NAMES.S3.GET_PROPERTY_PREFIX+ab,Y).then(function(ae){if(aa){o.putBucketProperty(Z,ab,ae)}return ae})})["catch"](function(ad){if(ad.response&&ad.response.Error&&ad.response.Error.Message){return b.reject(ad.response.Error.Message)}else{return b.reject(ad)}})}function T(Y,Z){var aa=o.getBucketProperty(Y,Z);if(aa){return b.when(aa)}}function v(Y,Z,aa){var ab=arguments.length<=3||arguments[3]===undefined?{}:arguments[3];var ac=_.extend({path:Z},ab);return I(Y,Z,ac).then(function(ad){return s(B[aa].deleteFunction,ad,V.PROXY_API_NAMES.S3.DELETE_PROPERTY_PREFIX+aa,Y).then(function(ae){o.evictBucketProperty(Z,aa);return ae})})["catch"](function(ad){if(ad.response&&ad.response.Error&&ad.response.Error.message){return b.reject(ad.response.Error.Message)}else{return b.reject(ad)}})}var B={acl:{name:"acl",getterFunction:function f(Y){return r.getBucketAcl(Y)},putterFunction:function U(Y){return r.putBucketAcl(Y)}},cors:{name:"cors",getterFunction:function f(Y){return r.getBucketCORS(Y)},putterFunction:function U(Y){return r.putBucketCORS(Y)},deleteFunction:function G(Y){return r.deleteBucketCORS(Y)}},policy:{name:"policy",getterFunction:function f(Y){return r.getBucketPolicy(Y)},putterFunction:function U(Y){return r.putBucketPolicy(Y)},deleteFunction:function G(Y){return r.deleteBucketPolicy(Y)}},logging:{name:"logging",getterFunction:function f(Y){return r.getBucketLogging(Y)},putterFunction:function U(Y){return r.putBucketLogging(Y)}},lifecycle:{name:"lifecycle",getterFunction:function f(Y){return r.getLifecycleConfiguration(Y)},putterFunction:function U(Y){return r.putLifecycleConfiguration(Y)},deleteFunction:function G(Y){return r.deleteLifecycleConfiguration(Y)}},website:{name:"website",getterFunction:function f(Y){return r.getBucketWebsite(Y)},putterFunction:function U(Y){return r.putBucketWebsite(Y)},deleteFunction:function G(Y){return r.deleteBucketWebsite(Y)}},notification:{name:"notification",getterFunction:function f(Y){return r.getBucketNotification(Y)},putterFunction:function U(Y){return r.putBucketNotification(Y)}},versioning:{name:"versioning",getterFunction:function f(Y){return r.getBucketVersioning(Y)},putterFunction:function U(Y){return r.putBucketVersioning(Y)}},replication:{name:"replication",getterFunction:function f(Y){return r.getBucketReplication(Y)},putterFunction:function U(Y){return r.putBucketReplication(Y)},deleteFunction:function G(Y){return r.deleteBucketReplication(Y)}},tagging:{name:"tagging",getterFunction:function f(Y){return r.getBucketTagging(Y)},putterFunction:function U(Y){return r.putBucketTagging(Y)},deleteFunction:function G(Y){return r.deleteBucketTagging(Y)}},requestPayment:{name:"requestPayment",getterFunction:function f(Y){return r.getRequestPayment(Y)}},metrics:{name:"metrics",getterFunction:function f(Y){return r.getBucketMetrics(Y)},putterFunction:function U(Y){return r.putBucketMetrics(Y)},deleteFunction:function G(Y){return r.deleteBucketMetrics(Y)}},analytics:{name:"analytics",getterFunction:function f(Y){return r.getBucketAnalytics(Y)},putterFunction:function U(Y){return r.putBucketAnalytics(Y)},deleteFunction:function G(Y){return r.deleteBucketAnalytics(Y)}},accelerate:{name:"accelerate",getterFunction:function f(Y){return r.getBucketAccelerate(Y)},putterFunction:function U(Y){return r.putBucketAccelerate(Y)}}};var E=["tagging","cors","replication","lifecycle"];function F(Y,Z,aa,ad){var ab=arguments.length<=4||arguments[4]===undefined?{}:arguments[4];var ac=_.extend({path:Z,content:ad},ab);if(E.indexOf(aa)!==-1){ac.headers={"Content-Type":"application/x-amz-json-1.1","X-Amz-Date":new Date().toUTCString(),"Content-MD5":R.getContentMd5(ad)}}return I(Y,Z,ac).then(function(ae){return s(B[aa].putterFunction,ae,V.PROXY_API_NAMES.S3.PUT_PROPERTY_PREFIX+aa,Y).then(function(af){o.evictBucketProperty(Z,aa);return af})})["catch"](function(ag){if(ag.response&&ag.response.Error&&ag.response.Error.Message){var af=ag.response.Error;var ae=af.ArgumentValue1?af.Message+". "+af.ArgumentValue1+". ("+af.ArgumentName1+")":af.Message;return b.reject(ae)}else{return b.reject(ag)}})}var l=function l(Y,Z){return s(r.getObject,Z,V.PROXY_API_NAMES.S3.GET_OBJECT,Y).then(function(aa){return aa.response})["catch"](function(aa){if(aa.response&&aa.response.Error&&aa.response.Error.Message){return b.reject(aa.response.Error.Message)}else{return b.reject(aa)}})};function P(Z,aa,Y,ab){if(!ab){ab={"response-content-type":"text"}}return I(Z,aa,{path:aa+"/"+Y}).then(function(ac){ac.params=ab;return l(Z,ac)})}function t(Z,aa,ab){var Y=b.defer();I(Z,aa,ab).then(function(ac){e.log("GetBucketLocation",1,Z);s(S.listKeysForService,{Service:"s3",region:ac.region,Limit:1000},V.PROXY_API_NAMES.KMS.LIST_KEYS,Z).then(function(ad){e.log("ListKeysForService",1,Z);Y.resolve(ad)})["catch"](function(ad){e.log("ListKeysForService",0,Z,ad);Y.reject(ad)})})["catch"](function(ac){e.log("GetBucketLocation",0,Z,ac);Y.reject(ac)});return Y.promise}return{bucketPropertiesMap:B,completeMultipartUpload:y,createBucket:j,deleteBucket:Q,deleteBucketProperty:v,getBucketProperty:L,getBucketLocation:I,getBucketOwner:C,getObject:P,getObjectAcl:z,getObjectMetadata:a,getObjectTag:A,makeProxyRequest:s,putObjectTag:k,getObjectInventory:n,deleteObjectInventoryConfig:d,putObjectInventoryConfig:M,headBucket:c,headObject:J,initiateMultipartUpload:D,listAllMyBuckets:w,listObjects:H,listVersions:m,putBucketProperty:F,putObject:q,putObjectAcl:N,tagQuery:h,getKmsKeys:t}}]);"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol==="function"&&a.constructor===Symbol?"symbol":typeof a};angular.module("s3").factory("S3CWSAPIService",["$q","APIProxyService","S3Constants","$http","UtilService","UUIDService","SCLogService","ConsoleOperation","Region","S3CWSEndpoint",function(g,a,e,j,l,d,n,h,p,i){var f=function f(t,x,r,s){if(!r){r={}}if(!r.headers){r.headers={}}r.headers[e.HEADERS.OPERATION]=x;var v=d.generateUUID();t.cwsRequestId=v;var u=e.OPERATION.CWS_OP_ID;var q={};q[u]=v;s.step=e.LOGGING.CWS_REQUEST_PREFIX+x;var w=t.region||p.getCurrentRegion();var y=(typeof i==="undefined"?"undefined":_typeof(i))==="object"?i[w]:i;return j.post(y,t,r).then(function(z){var A={};A[u]=v;s.step=e.LOGGING.CWS_RESPONSE_PREFIX+x;n.log(""+x+e.REQUEST_METRICS.STATUS_CODE_INFIX+z.status,1,s,A);n.logWithSimplifiedOperation(""+x+e.REQUEST_METRICS.SERVER_AVAILABILITY_SUFFIX,1,s);n.logWithSimplifiedOperation(""+x+e.REQUEST_METRICS.CLIENT_AVAILABILITY_SUFFIX,1,s);if(z&&z.data&&z.data.error){return g.reject(l.handleErrors(z.data.error))}return z},function(z){var A={};A[u]=v;A.message=z.statusText;s.step=e.LOGGING.CWS_RESPONSE_PREFIX+x;n.log(""+x+e.REQUEST_METRICS.STATUS_CODE_INFIX+z.status,1,s,A);if(z.status>=e.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD){n.logWithSimplifiedOperation(""+x+e.REQUEST_METRICS.SERVER_AVAILABILITY_SUFFIX,0,s)}else{n.logWithSimplifiedOperation(""+x+e.REQUEST_METRICS.SERVER_AVAILABILITY_SUFFIX,1,s)}if(z.status>=e.HTTP_STATUS_CODES.CLIENT_ERROR_THRESHOLD&&z.status<e.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD){n.logWithSimplifiedOperation(""+x+e.REQUEST_METRICS.CLIENT_AVAILABILITY_SUFFIX,0,s)}else{n.logWithSimplifiedOperation(""+x+e.REQUEST_METRICS.CLIENT_AVAILABILITY_SUFFIX,1,s)}return g.reject(z)})};return{makeS3ConsoleOperationRequest:f,makePublic:function m(q,r,t){if(!q){q=new h("FAKE CWS CALL OPERATION IN "+e.CWS_OPERATION_NAME.MAKE_PUBLIC)}var s={};s.bucket=q.initialBucket;s.region=t;s.keys=r;return a.getBucketLocation(q,s.bucket,s).then(function(u){return f(u,e.CWS_OPERATION_NAME.MAKE_PUBLIC,{},q)})},fetchPresignedUrl:function c(u,y,r,z,w,v,q,t){if(!t){t=new h("FAKE CWS CALL OPERATION IN "+e.CWS_OPERATION_NAME.GENERATE_PRESIGNED_URL)}var x={};x.bucket=u;x.key=y;x.httpMethod=r;x.headerOverrides=z;x.subresourceMap=w;x.customRequestHeaders=q;var s={};if(v){s.timeout=v}return a.getBucketLocation(t,u,x).then(function(A){return f(A,e.CWS_OPERATION_NAME.GENERATE_PRESIGNED_URL,s,t)})},generateCount:function k(s,r,t,q){var u={};u.bucket=s;u.folders=r;u.continuationTokens=t;return a.getBucketLocation(q,s,u).then(function(v){return f(v,e.CWS_OPERATION_NAME.GENERATE_COUNT,{},q)})},getMetadata:function b(s,r,q){var t={};t.bucket=s;t.key=r;return a.getBucketLocation(q,s,t).then(function(u){return f(u,e.CWS_OPERATION_NAME.GET_METADATA,{},q)})},wasOperationSuccessful:function o(q){return q.data.requestStatus==="success"}}}]);"use strict";angular.module("s3").factory("FileUpload",["$translate","S3Constants",function(c,b){function a(A,w,o,G,x,j,r,g){function d(){return w}function J(){return A}function h(){return o}function y(){return G}function e(){return x}function D(){return j}var l=c.instant("utilities.unknown.error");function L(){return l}function m(N){l=N}function M(){if(r&&r.storageClass){return r.storageClass}return b.STORAGE_CLASSES.STANDARD}function k(){if(r&&r.serverSideEncryption&&r.serverSideEncryption!="NONE"){return r.serverSideEncryption}return undefined}function f(){if(r&&r.serverSideEncryption&&r.serverSideEncryption==="KMS"){return r.kmsId}}function B(){if(r&&r.serverSideEncryption&&r.serverSideEncryption==="KMS"&&r.kmsId===b.UPLOAD.CUSTOM_ARN){return r.kmsARN}}function p(){if(r&&r.metadata){return r.metadata}return undefined}function n(){if(r&&r.tags){var N="";angular.forEach(r.tags,function(Q,P){var O=encodeURIComponent(P)+"="+encodeURIComponent(Q)+"&";N=N.concat(O)});return N.slice(0,-1)}return undefined}function E(N){var O=n();if(!_.isEmpty(O)){N[b.HEADERS.X_AMZ_TAGGING]=O}}function I(O){var N="";if(r&&r.permissions){if(r.permissions.publicPermissions){r.permissions.publicPermissions.forEach(function(P){if(P.permissions[O]===true){N+=N.length>0?", ":"";N+='uri="'+P.detail.URI+'"'}})}if(r.permissions.userPermissions){if(!Array.isArray(r.permissions.userPermissions)){r.permissions.userPermissions=[r.permissions.userPermissions]}r.permissions.userPermissions.forEach(function(P){if(P.permissions[O]===true){N+=N.length>0?", ":"";N+='id="'+P.detail.ID+'"'}})}return N}}function s(N){if(I(b.ACL_PERMISSIONS.READ)!==""){N[b.HEADERS.X_AMZ_GRANT_READ]=I(b.ACL_PERMISSIONS.READ)}if(I(b.ACL_PERMISSIONS.READ_ACP)!==""){N[b.HEADERS.X_AMZ_GRANT_READ_ACP]=I(b.ACL_PERMISSIONS.READ_ACP)}if(I(b.ACL_PERMISSIONS.WRITE)!==""){N[b.HEADERS.X_AMZ_GRANT_WRITE]=I(b.ACL_PERMISSIONS.WRITE)}if(I(b.ACL_PERMISSIONS.WRITE_ACP)!==""){N[b.HEADERS.X_AMZ_GRANT_WRITE_ACP]=I(b.ACL_PERMISSIONS.WRITE_ACP)}}function i(){var P={};P[b.HEADERS.X_AMZ_STORAGE_CLASS]=M();var O=k();if(O==="KMS"){P[b.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]="aws:kms";P[b.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION_KMS_ID]=f()===b.UPLOAD.CUSTOM_ARN?B():f()}else{if(O){P[b.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]=O}}s(P);E(P);if(p()){var N=p();P=angular.extend({},P,N)}if(!P[b.HEADERS.CONTENT_TYPE]){P[b.HEADERS.CONTENT_TYPE]=undefined}return P}var z;function t(){return z}function K(N){z=N}var H={};function F(){return H}this.addEtag=function(O,N){H[O]=N};var u=Math.ceil(w.size/g);function q(){return u}var C=0;function v(){return C}this.incrementCompletedParts=function(){C+=1};Object.defineProperties(this,{filePointer:{get:d},id:{get:J},cancelDeferredObject:{get:h},uploadDeferredObject:{get:y},destKey:{get:e},destBucket:{get:D},errorMessage:{get:L,set:m},headers:{get:i},timeoutPromise:{get:t,set:K},etags:{get:F},numberOfParts:{get:q},completedParts:{get:v}})}return a}]);"use strict";(function(){angular.module("s3").service("PathService",["$routeParams","$location","S3Constants",function(d,f,b){this.getCurrentBucket=function(){return c()};var c=function c(){if(f.path().indexOf("/"+b.PATH_SEGMENTS.BUCKETS+"/")===0){return d[b.PATH_SEGMENTS.BUCKET_NAME]}return undefined};this.getCurrentAbsoluteFolderPath=function(){return a()};var a=function a(){if(f.path().indexOf("/"+b.PATH_SEGMENTS.BUCKETS+"/")===0){if(d[b.PATH_SEGMENTS.KEY_PREFIX]){if(f.path().indexOf(b.PATH_SEGMENTS.OBJECT_DETAILS)!==-1){var g=d[b.PATH_SEGMENTS.KEY_PREFIX].lastIndexOf("/");return d[b.PATH_SEGMENTS.KEY_PREFIX].slice(0,g+1)}return d[b.PATH_SEGMENTS.KEY_PREFIX]+"/"}}return undefined};this.relativeToAbsoluteFolderPath=function(h){var g=a();if(g!==undefined){return g+h+b.DELIMITER}return h+b.DELIMITER};this.relativeToAbsoluteObjectPath=function(g){return e(g)};this.getObjectLink=function(g,h){var i=b.S3_ENDPOINTS[h]||b.S3_DEFAULT_ENDPOINT;return i+"/"+c()+"/"+encodeURIComponent(g).replace(/%20/g,"+").replace(/%2F/g,"/")};var e=function e(h){var g=a();if(g!==undefined){return g+h}return h};this.getAbsolutePathWithBucket=function(){var i=c();var g=a();var h="";if(g){h=i+"/"+g}else{h=i}return h};this.getAbsolutePathToObjectWithBucket=function(i){var j=c();var g=e(i);var h="";if(g){h=j+"/"+g}else{h=j}return h};this.absoluteToRelativeObjectPaths=function(h,g){if(!h){return}h=h.filter(function(i){return i.Key!==g});h.forEach(function(i){if(i.Key===g){i.Key="/"}else{i.Key=i.Key.replace(g,"")}i.beingRenamed=false});return h};this.absoluteToRelativeFolderPaths=function(g,h){if(!g){return}g.forEach(function(i){i.Prefix=i.Prefix.replace(h,"").replace(b.DELIMITER,"");i.beingRenamed=false});return g};this.getCurrentObject=function(){var g="/"+b.PATH_SEGMENTS.BUCKETS+"/";if(f.path().indexOf(g)===0&&f.path().indexOf("/details")!==-1){return f.path().split(g+c()+"/")[1].match(/^(.*?)\/details$/)[1]}};this.getFolderList=function(){var l=d.bucketName;var j=f.path();var i=j.indexOf("/details");if(i!==-1){j=j.substring(0,i)}j=j.substring(j.indexOf(l));var k=j.split("/");var g="";var h=[];k.forEach(function(m){g+="/"+m;h.push({name:m,path:g})});delete h[h.length-1].path;return h}}])})();"use strict";(function(){angular.module("s3").service("CachingService",["S3Constants","$cacheFactory",function(b,g){var c=g(".bucketLocationCache",{capacity:b.CACHE.SIZE.BUCKET_LOCATION});var d=g(".lambCache",{capacity:b.CACHE.SIZE.LAMB});var e="lamb";var h=".properties";var a=".objects";var f;var i={};var j=[];this.putLamb=function(k){d.put(e,k)};this.evictLamb=function(){d.removeAll()};this.getLamb=function(){return d.get(e)};this.getBucketLocation=function(k){return c.get(k)};this.putBucketLocation=function(l,k){c.put(l,k)};this.evictBucketLocation=function(k){c.remove(k)};this.getBucketProperty=function(m,l){var k=g.get(m+h);if(k){return k.get(l)}return undefined};this.putBucketProperty=function(m,l,k){if(!g.get(m+h)){g(m+h,{capacity:b.CACHE.SIZE.BUCKET_PROPERTIES})}g.get(m+h).put(l,k)};this.evictBucketProperty=function(m,l){var k=g.get(m+h);if(k){k.remove(l)}};this.evictAllBucketProperties=function(l){var k=g.get(l+h);if(k){k.removeAll()}};this.getBucketObjects=function(m,l){var k=g.get(m+a);if(k){return k.get(l)}return undefined};this.putBucketObjects=function(m,k,l){if(!g.get(m+a)){g(m+a,{capacity:b.CACHE.SIZE.LIST_OBJECTS})}g.get(m+a).put(k,l)};this.evictBucketObjects=function(l){var k=g.get(l+a);if(k){k.removeAll()}};this.evictAllBucketData=function(k){c.remove(k);this.evictBucketObjects(k);this.evictAllBucketProperties(k)};this.setCurrentObject=function(k){f=k};this.getCurrentObject=function(){return f};this.setCurrentVersions=function(l,k){i[l]=k};this.getCurrentVersions=function(k){return i[k]};this.deleteCurrentVersions=function(k){delete i[k]};this.setPageOfDeletedObjects=function(l,k){j[k]=l};this.getPageOfDeletedObjects=function(k){return j[k]};this.resetDeletedObjects=function(){j=[]}}])})();"use strict";(function(){angular.module("s3").service("UploadRequestsService",["$q","S3Constants","S3CWSAPIService","APIProxyService","SCLogService","XMLParser",function(b,c,e,f,d,a){this.initiateMultipartUpload=function(i,k,j,h,g){return f.initiateMultipartUpload(k,i,j,h,g).then(function(m){var l=m.response;var n=m.headers();l=a.convertXmlStringToJson(l);if(l&&l.InitiateMultipartUploadResult&&l.InitiateMultipartUploadResult.UploadId){d.logS3("InitiateMultipart",1,g,n[c.HEADERS.X_AMZ_ID_2],n[c.HEADERS.X_AMZ_REQUEST_ID],m);return l.InitiateMultipartUploadResult.UploadId}d.logS3("InitiateMultipart",0,g,n[c.HEADERS.X_AMZ_ID_2],n[c.HEADERS.X_AMZ_REQUEST_ID],m);return b.reject(l)},function(l){var n=l.headers();var m=Number(l.status<c.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD);d.logS3("InitiateMultipart",m,g,n[c.HEADERS.X_AMZ_ID_2],n[c.HEADERS.X_AMZ_REQUEST_ID],l);return b.reject(l)})};this.completeMultipartUpload=function(n,g,m,h,j,i){var k="<CompleteMultipartUpload>";for(var o in h){var l="<Part><PartNumber>"+o+"</PartNumber>";l+="<ETag>"+h[o]+"</ETag>";l+="</Part>";k+=l}k+="</CompleteMultipartUpload>";return f.completeMultipartUpload(g,n,k,m,j,i).then(function(p){var q=p.headers();if(p.response&&p.response.CompleteMultipartUploadResult){d.logS3("CompleteMultipartUpload",1,i,q[c.HEADERS.X_AMZ_ID_2],q[c.HEADERS.X_AMZ_REQUEST_ID],p);return p.response.CompleteMultipartUploadResult}d.logS3("CompleteMultipartUpload",0,i,q[c.HEADERS.X_AMZ_ID_2],q[c.HEADERS.X_AMZ_REQUEST_ID],p);return b.reject({statusText:p.response})},function(p){var q=p.headers();d.logS3("CompleteMultipartUpload",0,i,q[c.HEADERS.X_AMZ_ID_2],q[c.HEADERS.X_AMZ_REQUEST_ID],p);return b.reject({statusText:p.response.Error.Message})})};this.generatePresignedUrlForUpload=function(i,l,h,k,j,g){return e.fetchPresignedUrl(l,i,"PUT",{},k,h,j).then(function(m){if(m.data&&m.data.presignedUrl){d.log("UploadPresignedUrl",1,g,m);return m}d.log("UploadPresignedUrl",0,g,m);return b.reject(m)},function(m){var n=Number(m.status<c.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD);d.log("UploadPresignedUrl",n,g,m);return b.reject(m)})}}])})();"use strict";(function(){angular.module("s3").service("ReadAndSendBlobService",["$http","$q","$window","S3Constants","SCLogService",function(h,b,g,c,d){var f="UploadPut";this.readAndPutBlobToUrl=function(l,q,i,k,o,m){var n=b.defer();if(k&&!k[c.HEADERS.CONTENT_TYPE]){k["Content-Type"]=undefined}var p={method:"PUT",url:i,data:q,headers:k,timeout:o,transformRequest:[]};d.log("UploadReader",1,m,p);var j=g.Date.now();h(p).then(e(n,m,j),a(n,m));return n.promise};var e=function e(i,j,k){return function(m){var l=g.Date.now();i.resolve(m);d.log(f+"Time",l-k,j);var n=m.headers();d.logS3(f+"Request",1,j,n[c.HEADERS.X_AMZ_ID_2],n[c.HEADERS.X_AMZ_REQUEST_ID],m)}};var a=function a(i,j){return function(k){var m=k.headers();d.log(""+f+c.REQUEST_METRICS.STATUS_CODE_INFIX+k.status,1,j,k);var l=Number(k.status<c.HTTP_STATUS_CODES.SERVER_ERROR_THRESHOLD);d.logS3(f+"Request",l,j,m[c.HEADERS.X_AMZ_ID_2],m[c.HEADERS.X_AMZ_REQUEST_ID]);if(k.status===-1){k.statusText="OptionsRequestDenied"}else{if(k.status===0){k.statusText="OptionsResponseMissingHeaders"}}i.reject(k)}}}])})();"use strict";(function(){angular.module("s3").service("UploadService",["$http","$q","$timeout","$translate","CachingService","S3Constants","FileUpload","UploadRequestsService","ReadAndSendBlobService","SCLogService","UploadVerificationService","UtilService",function(o,a,D,x,p,H,G,m,F,e,l,t){var c=0;var h={};var j=function j(){c++;return c};var v=function v(L){if(h[L]){D.cancel(h[L].timeoutPromise)}};function n(N,M,P,O,L){O.uploadedEtag=M[0].headers().etag;O.calculatedEtag=M[1];var Q=L?"MD5MPVerification":"MD5Verification";if(I(M)){if(B(P.filePointer)){O.errorReason="FileChanged";e.log("UploadFileChanged",1,N,O)}else{O.errorReason="EtagsDoNotMatch";e.log(Q,0,N,O)}}else{e.log(Q,1,N,O)}}var r=function r(L,M){return function(N){v(L,M);N=t.transformObjectToArray(N);var P=N[0];var O={fileName:h[L].filePointer.name};if(!P||!P.headers()||!P.headers().etag){J(L,{statusText:"No etag was provided by S3"},M)}else{if(z(M)){n(M,N,h[L],O,false);if(O.errorReason){J(L,{statusText:O.errorReason},M)}else{s(L,P.headers().etag,M)}}else{s(L,P.headers().etag,M)}}}};var I=function I(L){var M=L[1];var N=L[0].headers().etag;return M!==N.substring(1,N.length-1)};var B=function B(L){return L.lastModified&&L.lastModified!==L.initialLastModified};var K=function K(M,L){if(h[L].isCancelled){return x.instant("upload.cancelled")}var N=t.transformObjectToArray(M)[0];if(N.statusText){return N.statusText}else{return t.handleErrors(N)}};var E=function E(L,M){return function(N){v(L,M);J(L,K(N,L),M)}};var b=function b(L,M){return function(N){s(L,N.ETag||"",M)}};var s=function s(M,O,N){var L={};L.id=M;L.name=h[M].filePointer.name;L.etag=O.substring(1,O.length-1);L.operation=N;if(Object.keys(h[M].etags).length>0){L.multiPartEtags=_.mapValues(h[M].etags,function(P){return P.substring(1,P.length-1)})}h[M].uploadDeferredObject.resolve(L);delete h[M]};var k=function k(L,M){return function(N){J(L,K(N,L),M)}};var J=function J(M,O,N){var L={};L.errorMessage=O;L.name=h[M].filePointer.name;L.id=M;L.operation=N;L.isCancelled=h[M].isCancelled;h[M].uploadDeferredObject.reject(L);delete h[M]};var z=function z(L){return !L.options.serverSideEncryption||L.options.serverSideEncryption===H.OBJECT_SSE.NONE};var g=function g(M,P,S,Q,O){var L=F.readAndPutBlobToUrl(M,h[M].filePointer,P,Q,S.promise,O);var N=undefined;if(z(O)){var R=l.verifyUpload(h[M].filePointer,M,O.id);N=a.all([L,R])}else{N=L}N.then(r(M,O),E(M,O),function(T){T.destKey=h[M].destKey;T.destBucket=h[M].destBucket;T.operation=O;h[M].uploadDeferredObject.notify(T)});if(h[M]){d(h[M],O)}};var A=function A(N,L){var M=D(function(){N.cancelDeferredObject.resolve(N.id);N.errorMessage="Upload timed out."},H.UPLOAD.TIMEOUT_MSECS);N.timeoutPromise=M;m.generatePresignedUrlForUpload(N.destKey,N.destBucket,N.cancelDeferredObject.promise,{},N.headers,L).then(function(O){g(N.id,O.data.presignedUrl,N.cancelDeferredObject,N.headers,L)},function(){J(N.id,"There was an issue generating a presigned url for the upload",L)});d(N,L)};var y=function y(M,N,L){return function(){return m.generatePresignedUrlForUpload(M.destKey,M.destBucket,M.cancelDeferredObject.promise,N,undefined,L)}};var u=function u(M,O,N,L){return function(R){var S=M.filePointer.slice(O,N);S.name=M.filePointer.name;var P=F.readAndPutBlobToUrl(M.id,S,R.data.presignedUrl,{},M.cancelDeferredObject.promise,L);var Q=undefined;if(!L.options.serverSideEncryption||L.options.serverSideEncryption===H.OBJECT_SSE.NONE){var T=l.verifyUpload(S,M.id,L.id);Q=a.all([P,T])}else{Q=P}return Q}};var C=function C(M,N,L){return function(O){O=t.transformObjectToArray(O);var Q=O[0];if(!Q||!Q.headers()||!Q.headers().etag){return a.reject(O[0])}var P={partNumber:N,fileName:M.filePointer.name};if(z(L)){n(L,O,M,P,true);if(P.errorReason){return a.reject(O[0])}}M.incrementCompletedParts();M.uploadedByte+=Math.min(H.UPLOAD.PART_SIZE_IN_BYTES,M.totalBytes-(N-1)*H.UPLOAD.PART_SIZE_IN_BYTES);M.progress=100*M.uploadedByte/M.totalBytes;d(M,L);M.addEtag(N,Q.headers().etag)}};var q=function q(S,T,P,N){var U=0;var M=H.UPLOAD.PART_SIZE_IN_BYTES;var L=function L(V){if(V){V.operation=N;S.uploadDeferredObject.notify(V)}};var Q=function Q(V){P.reject(V)};S.uploadedByte=0;S.totalBytes=S.filePointer.size;var O;for(var R=1;R<=S.numberOfParts;R++){if(O){O=O.then(y(S,{uploadId:T,partNumber:R},N))}else{O=y(S,{uploadId:T,partNumber:R},N)()}O=O.then(u(S,U,M,N)).then(C(S,R,N),Q,L);U+=H.UPLOAD.PART_SIZE_IN_BYTES;M+=H.UPLOAD.PART_SIZE_IN_BYTES}if(!O){P.reject({statusText:x.instant("utilities.unknown.error")});return}O.then(function(){P.resolve(T)})};var d=function d(N,M){var L={};L.destKey=N.destKey;L.destBucket=N.destBucket;L.id=N.id;L.fileName=N.filePointer.name;L.uploadedByte=N.uploadedByte;L.totalBytes=N.totalBytes;L.progress=N.completedParts/N.numberOfParts*100;L.operation=M;N.uploadDeferredObject.notify(L)};var w=function w(M,L){return function(O){var N=a.defer();d(M,L);q(M,O,N,L);return N.promise}};var i=function i(M,L){if(M.numberOfParts>H.UPLOAD.MAX_NUMBER_OF_PARTS||M.numberOfParts<=H.UPLOAD.MIN_NUMBER_OF_PARTS){k(M.id,L)({statusText:"A multipart upload needs between 2 and 10000 parts to be a valid upload."});return}var N=m.initiateMultipartUpload(M.destKey,M.destBucket,M.headers,M.cancelDeferredObject.promise,L);N.then(w(M,L)).then(function(O){return m.completeMultipartUpload(M.destKey,M.destBucket,O,M.etags,M.cancelDeferredObject.promise,L)}).then(b(M.id,L))["catch"](k(M.id,L))};var f=function f(M,L){e.log("UploadFileSize",M.filePointer.size,L,{name:M.filePointer.name});if(M.filePointer.size<=H.UPLOAD.PART_SIZE_IN_BYTES){A(M,L)}else{i(M,L)}};this.upload=function(O,T,M,N,P,V){if(!M){e.log("UploadNoBucketError",1,P);return}p.evictBucketObjects(M);if(!N||h[N]!==undefined){e.log("InvalidUploadFileId",1,P);return}var S=a.defer();var Q=a.defer();var U=O.name;if(T){U=T+U}var L=angular.copy(V);if(!L.metadata["Content-Type"]){L.metadata["Content-Type"]=O.type}var R=new G(N,O,S,Q,U,M,L,H.UPLOAD.PART_SIZE_IN_BYTES);h[N]=R;f(R,P);p.deleteCurrentVersions(U);return R.uploadDeferredObject.promise};this.cancelUpload=function(M,L){if(h[M]){h[M].cancelDeferredObject.resolve(M);h[M].isCancelled=true;e.log("UploadCancel",1,L)}else{e.log("UploadCancel",0,L)}};this.fileSelected=function(){return j()}}])})();"use strict";(function(){angular.module("s3").service("DirectoryExplorerService",["$q","ConsoleOperation","S3Constants","SCLogService","UploadService","UtilService",function(n,h,k,a,i,p){var s={createExplorer:l,processFile:c};var f="CreatedExplorer",q="ExplorerTraversalComplete",e="GetFolderSize",b="InitialFolderTraversal",j="OverrideFolders",m="SkipOverriddenFolder";return s;function l(L,J){var B=n.defer(),E=J.explorers.length+1,A={getNext:C,getSelectedItems:F,explorerId:E,setOverriddenFolders:u,operation:J};var z=undefined,H=[],t=[],G=[],O=[],M=0,w=undefined,x=undefined,v=undefined,D={},P=true,K=L.length;for(var R=0;R<K;R++){z=L[R].webkitGetAsEntry();if(z.isDirectory){H.push(z)}else{o(z,G,t,"",J).then(function(){M++},function(T){a.log(J.name+f,0,J,{error:T,explorerId:E});B.reject(T)})}}for(var Q in H){var S=n.defer();w=H[Q];N(w,d(w.createReader()),0,0,p.createQueue(),S);t.push(S.promise);S.promise.then(function(T){O.push(T);if(T.objsCount===0){M++}})}n.all(t).then(function(){v=p.createQueue(H);w=undefined;x=undefined;a.log(J.name+f,1,J,{explorerId:E,selectedItems:F()});B.resolve(A)},function(T){a.log(J.name+f,0,J,{error:T,explorerId:E});B.reject(T)});function N(U,T,Z,Y,W,X){var V=[];T.readEntries(function(aa){var ac=undefined;if(aa.length===0){if(W.getLength()===0){a.log(J.name+b,1,J,{explorerId:E,folderSize:Z,folderName:U.name,fullPath:U.fullPath,objsCount:Y});X.resolve(r(U,Z,Y))}else{var ae=d(W.dequeue().createReader());N(U,ae,Z,Y,W,X)}return}for(var ab in aa){ac=aa[ab];if(ac.isDirectory){W.enqueue(ac)}else{Y++;M++;var ad=g(ac);V.push(ad);ad.then(function(af){Z+=af})}}n.all(V).then(function(){N(U,T,Z,Y,W,X)},function(ag){var af=r(U,Z,Y);a.log(J.name+e,0,J,{error:ag,explorerId:E,folder:af});X.resolve(af)})},function(aa){a.log(J.name+b,0,J,{error:aa,explorerId:E});X.reject(aa)})}function C(){var T=n.defer();if(!w){w=I();x=w?d(w.createReader()):undefined}if(!x){if(v.getLength()===0){a.log(J.name+q,1,J,{explorerId:E,selectedItems:F()});T.resolve(undefined);return T.promise}else{w=I();x=d(w.createReader());P=true}}y(T,J);return T.promise}function y(W,U){var X=undefined,V=[],T=[];x.readEntries(function(aa){var Y=undefined;if(aa.length===0){if(P){Y=r(w,0,0)}w=I();x=w?d(w.createReader()):undefined;P=true}else{P=false}for(var Z in aa){X=aa[Z];if(X.isDirectory){v.enqueue(X)}else{o(X,V,T,w.fullPath.substr(1)+"/",U)}}n.all(T).then(function(){W.resolve({fileList:V,emptyFolderToBeUploaded:Y})},function(ab){a.log(U.name+q,0,U,{error:ab,explorerId:E});W.reject(ab)})},function(Y){a.log(U.name+q,0,U,{error:Y,explorerId:E});W.reject(Y)})}function F(){return{currFolderPathPrefix:"",folders:O,objects:G,totalObjCount:M}}function u(T){for(var U in T){D[T[U]]=true}a.log(J.name+j,1,J,{explorerId:E,originalFolders:F().folders,newlyOveriddenFolders:T})}function I(){var T=v.dequeue();while(T){if(T.fullPath!=="/"+T.name||!D[T.name]){return T}else{a.log(J.name+m,1,J,{explorerId:E,skippedFolderName:T.name});T=v.dequeue()}}}return B.promise}function c(u,v,t){return{file:u,fullPath:t,id:v,Key:u.name,Size:u.size}}function r(t,w,v){var u=t.fullPath.substr(1);u=u.substr(0,u.length-t.name.length-1);u=u===""?u:u+"/";return{folderSize:w,fullPath:u,Prefix:t.name,objsCount:v||1}}function o(y,x,v,w,u){var t=n.defer();v.push(t.promise);y.file(function(A){var z=i.fileSelected(A,u);x.push(c(A,z,w));t.resolve()},function(z){t.reject(z)});return t.promise}function g(u){var t=n.defer();u.file(function(v){t.resolve(v.size)});return t.promise}function d(t){var v=3;var w=[];function u(y,x){if(w.length===0){t.readEntries(function(z){if(z.length>v){w=z;y(w.splice(0,v))}else{y(z)}},x)}else{y(w.splice(0,v))}}return{readEntries:u}}}])})();"use strict";(function(){angular.module("s3").controller("UploadController",["$scope","$rootScope","$translate","APIProxyService","ConsoleOperation","DirectoryExplorerService","OperationDispatcherService","PathService","S3Constants","SCLogService","UploadOperationService","UtilService",a]);function a(w,q,x,y,s,m,j,g,v,f,r,C){var z="FilesSelectedFor",c="MultipleDropEvents",i="OverrideExplorers",h="SimultaneousDrop",p="FolderRemoved",o="FileRemoved",B="NONE",d="KMS",k="STANDARD";var e=_.cloneDeep(v.BUCKET_PERMISSIONS.INITIALIZE_ACLS);y.getBucketOwner(new s("getBucketOwner")).then(function(D){e.userPermissions[0].detail=D;w.options.permissions.userPermissions[0].detail=D});var n=C.createQueue();w.operation=null;w.$watchCollection("selected",function(){w.selectedItems=w.selected.selectedItems});w.$watchCollection("flags",function(){w.uploadDisabled=w.flags.uploadDisabled});w.STEP={SELECT_FILES:{name:"SELECT_FILES",value:x.instant("uploadmodal.label.selectfiles")},PERMISSIONS:{name:"PERMISSIONS",value:x.instant("uploadmodal.label.setpermissions")},PROPERTIES:{name:"PROPERTIES",value:x.instant("uploadmodal.label.setproperties")},REVIEW:{name:"REVIEW",value:x.instant("uploadmodal.label.review")}};w.state=w.STEP.SELECT_FILES;w.headerTitle=x.instant("uploadmodal.header.title");w.currentTagging={Key:"",Value:""};var u=q.$on("fileDropEvent",function(F,E){if(!w.modalOpen.flag||F.defaultFired){return}w.state=w.STEP.SELECT_FILES;w.uploadDisabled=true;if(!w.operation){w.operation=r.createUploadOperation()}var D=m.createExplorer(E,w.operation);n.enqueue(D);if(n.getLength()===1){b(n.peek())}else{f.log(w.operation.name+h,1,w.operation,{numberOfDropsToBeProcessed:n.getLength()})}});function A(H,G){var I=G?w.operation.explorers.length-1:w.operation.explorers.length,D=[];for(var F=0;F<H.length;F++){D.push(H[F].Prefix)}for(var E=0;E<I;E++){w.operation.explorers[E].setOverriddenFolders(D)}f.log(w.operation.name+i,1,w.operation,{folderNames:D,numberOfExplorersOverridden:I,selectedFilesData:w.getSelectedFilesData()})}function b(D){D.then(function(M){var K=M.getSelectedItems(),H=K.folders,N=K.objects,F=undefined,I=undefined,G=function G(O){return F.Prefix!==O.Prefix},E=function E(O){return I.Key!==O.Key};for(var L=0;L<H.length;L++){F=H[L];w.selectedItems.folders=_.filter(w.selectedItems.folders,G)}for(var J=0;J<N.length;J++){I=N[J];w.selectedItems.objects=_.filter(w.selectedItems.objects,E)}w.selectedItems.folders=w.selectedItems.folders.concat(H);w.selectedItems.objects=w.selectedItems.objects.concat(N);w.operation.explorers.push(M);if(w.operation.explorers.length>1){f.log(w.operation.name+c,1,w.operation,{newExplorerId:M.explorerId,numberOfExplorersCreated:w.operation.explorers.length,selectedItems:M.getSelectedItems()});A(H,true)}n.dequeue();if(n.getLength()>0){b(n.peek())}else{w.uploadDisabled=false}},function(E){w.error=E})}w.goToNextState=function(){if(w.state===w.STEP.SELECT_FILES){C.analyticsTrackClick(v.ANALYTICS.SELECT_UPLOAD_FILE,v.ANALYTICS.UPLOAD_FILE_S3);C.analyticsTrackView(v.ANALYTICS.SET_PERMISSIONS_UPLOAD_FILE,v.ANALYTICS.UPLOAD_FILE_S3)}else{if(w.state===w.STEP.PERMISSIONS){C.analyticsTrackClick(v.ANALYTICS.SET_PERMISSIONS_UPLOAD_FILE,v.ANALYTICS.UPLOAD_FILE_S3);C.analyticsTrackView(v.ANALYTICS.SET_PROPERTIES_UPLOAD_FILE,v.ANALYTICS.UPLOAD_FILE_S3)}else{if(w.state===w.STEP.PROPERTIES){var D={storage_class:w.options.storageClass,encryption:w.options.serverSideEncryption};C.analyticsTrackClick(v.ANALYTICS.SET_PROPERTIES_UPLOAD_FILE,v.ANALYTICS.UPLOAD_FILE_S3,D);C.analyticsTrackView(v.ANALYTICS.REVIEW_UPLOAD_FILE,v.ANALYTICS.UPLOAD_FILE_S3)}}}w.nextState()};w.removeItemFromUpload=function(D){if(D.Key){w.selectedItems.objects=_.filter(w.selectedItems.objects,function(E){return D.Key!==E.Key});f.log(w.operation.name+o,1,w.operation,{fileName:D.Key})}else{if(D.Prefix){w.selectedItems.folders=_.filter(w.selectedItems.folders,function(E){return D.Prefix!==E.Prefix});A([D],false);f.log(w.operation.name+p,1,w.operation,{folderName:D.Prefix})}}if(!w.haveSelectedItems()){w.uploadDisabled=true}};w.filesSelected=function(D){if(!w.operation){w.operation=r.createUploadOperation()}w.$apply(function(){if(D&&D.files&&D.files.length>0){w.operation.newlySelectedFiles=D.files;f.log(z+w.operation.name,D.files.length,w.operation);for(var F=0;F<D.files.length;F++){var E=D.files[F],G=l(E.name),H=r.selectFile(E,w.operation);if(G>-1){w.selectedItems.objects.splice(G,1,m.processFile(E,H))}else{w.selectedItems.objects.push(m.processFile(E,H))}}w.uploadDisabled=false}})};function l(E){for(var D=0;D<w.selectedItems.objects.length;D++){if(w.selectedItems.objects[D].Key===E){return D}}return -1}w.uploadNow=function(){if(!w.operation||!w.selectedItems.objects&&!w.selectedItems.folders||w.selectedItems.objects.length===0&&w.selectedItems.folders.length===0){throw"No file selected"}C.analyticsTrackClick(v.ANALYTICS.END_UPLOAD_FILE,v.ANALYTICS.UPLOAD_FILE_S3);function D(){w.$parent.refreshWithSelection()}if(_.eq(w.options.permissions,e)){w.options.permissions=undefined}r.setupUploadOperation(w.operation,w.selectedItems.folders,w.selectedItems.objects,w.getSelectedFilesData(),w.options,D);w.clearFileInput();j.addOperation(w.operation);w.closeModal();w.selected.selectedItems={currFolderPathPrefix:"",folders:[],objects:[]};w.resetOptions()};w.clearFileInput=function(){var D=$("#uploadInput");if(D&&D.get(0)){D.wrap("<form>").closest("form").get(0).reset();D.unwrap()}};w.closeModal=function(){if(w.state===w.STEP.SELECT_FILES){w.clearFileInput()}w.state=w.STEP.SELECT_FILES;w.selected.selectedItems={currFolderPathPrefix:"",folders:[],objects:[]};w.modalOpen.flag=false;w.uploadDisabled=true;w.operation=undefined;w.resetOptions()};w.haveSelectedItems=function(){return w.selectedItems&&w.selectedItems.folders&&!_.isEmpty(w.selectedItems.folders)||w.selectedItems&&w.selectedItems.objects&&!_.isEmpty(w.selectedItems.objects)};w.isValidMetadata=function(F,E,D){if(D&&!_.startsWith(F,v.USER_DEFINED_METADATA_PREFIX)){w.metadataErrorMsg=x.instant("metadatacard.startingwith");return false}if(D&&!/^[\x20-\x7E]+$/.test(F)||!/^[\x20-\x7E]+$/.test(E)){w.metadataErrorMsg=x.instant("metadatacard.nonasc");return false}w.metadataErrorMsg="";return true};w.addMetadataOptionsHeader=function(F,E,D){w.metadataErrorMsg="";if(w.isValidMetadata(F,E,D)){w.options.metadata[F]=E;if(D){w.metadataHeaders.customHeader=v.USER_DEFINED_METADATA_PREFIX;w.metadataHeaders.customValue=""}else{w.metadataHeaders.selectedValue="";w.metadataHeaders.selectedHeader=""}}};w.metaErrorReset=function(){w.metadataErrorMsg=""};w.deleteMetadataHeader=function(D){delete w.options.metadata[D]};w.addTag=function(D,E){if(_.isEmpty(D)){return}if(Object.keys(w.options.tags).indexOf(D)>-1){w.taggingError=x.instant("objectproperties.tags.duplicatekeynames");return}if(Object.keys(w.options.tags).length>=v.TAGGING.MAX_ALLOWED_TAGS){w.taggingError=x.instant("objectproperties.tags.morethantentagswarning");return}w.taggingError=null;w.options.tags[D]=E;w.currentTagging={Key:"",Value:""}};w.deleteTag=function(D){delete w.options.tags[D]};w.updateTaggingError=function(D){if(Object.keys(w.options.tags).indexOf(D)>-1||Object.keys(w.options.tags).length>=v.TAGGING.MAX_ALLOWED_TAGS){return}w.taggingError=null};w.resetOptions=function(){w.options={};w.metadataHeaders={};w.metadataErrorMsg="";w.errorMessage=null;w.KMSServiceError=null;w.metadataHeaders.acceptedHeaders=[];w.options.metadata={};w.options.tags={};w.taggingError=null;w.currentTagging={Key:"",Value:""};w.options.permissions=_.cloneDeep(e);w.metadataHeaders.headerNames=[v.HEADERS.CACHE_CONTROL,v.HEADERS.CONTENT_DISPOSITION,v.HEADERS.CONTENT_ENCODING,v.HEADERS.CONTENT_LENGTH,v.HEADERS.CONTENT_TYPE,v.HEADERS.EXPECT,v.HEADERS.EXPIRES,v.HEADERS.X_AMZ_WEBSITE_REDIRECT_LOCATION];w.metadataHeaders.headers=[];for(var E in w.metadataHeaders.headerNames){var D=w.metadataHeaders.headerNames[E];w.metadataHeaders.headers.push({value:D,text:D,disabled:false})}};w.getSelectedFilesData=function(){if(!w.selectedItems){return{files:0,size:0}}var D=0,H=0,I=undefined,F=undefined;for(var G in w.selectedItems.folders){I=w.selectedItems.folders[G];H+=I.objsCount;D+=I.folderSize}for(var E in w.selectedItems.objects){F=w.selectedItems.objects[E];H++;D+=F.Size}return{files:H,size:D}};w.getGranteeCount=function(){var D=0;Object.keys(w.options.permissions).forEach(function(E){w.options.permissions[E].forEach(function(F){if(_.findKey(F.permissions,function(G){return G===true})!==undefined){D++}})});return D};w.$on("$destroy",function(){u()});w.resetOptions();w.getStorageClassTranslation=function(){return C.getStorageClassTranslations()[w.options.storageClass]};w.getEncryptionTranslation=function(){var D=w.options.serverSideEncryption===B?"uploadmodal.review.encryption.no":"uploadmodal.review.encryption.yes";return x.instant(D)};w.setStorageClassOption=function(){if(!w.options.storageClass){w.options.storageClass=k}};w.updateKMSKey=function(D){if(D===d){t()}else{if(!_.isEmpty(w.errorMessage)&&w.errorMessage===w.KMSServiceError){w.errorMessage=null}w.KMSServiceError=null}};w.setEncryptionOption=function(){if(!w.options.serverSideEncryption){w.options.serverSideEncryption=B}};function t(){w.kmsKeys=[];var E=new s("GetKMSKeysForUpload");var D={};y.getKmsKeys(E,g.getCurrentBucket(),D).then(function(G){var F=G.response.Keys;f.log("GetKMSKeys",1,E);angular.forEach(F,function(H,I){w.kmsKeys.push({value:H.KeyId,text:H.KeyArn})});w.kmsKeys.push({value:v.UPLOAD.CUSTOM_ARN,text:x.instant("uploadmodal.kms.customarn")});if(w.errorMessage===w.KMSServiceError){w.errorMessage=null}w.KMSServiceError=null})["catch"](function(F){w.KMSServiceError=C.handleErrors(F);w.errorMessage=C.handleErrors(F);f.log("GetKMSKeys",0,E,F)})}}angular.module("s3").directive("uploadModal",[function(){return{scope:{modalOpen:"=",currentPath:"=",fetchObjects:"=",operation:"=",selected:"=",flags:"="},templateUrl:"/s3/partials/upload.html",controller:"UploadController"}}])})();"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol==="function"&&a.constructor===Symbol?"symbol":typeof a};angular.module("s3").factory("SCLogService",["AWSC","CachingService","PathService","ConsoleOperation","$filter","S3Constants",function(q,d,b,j,o,p){var a={unit:"",metricType:"",logLevel:""},m={explorers:true};function k(u){var t;for(t=0;t<u.length;++t){if(u[t]===undefined||u[t]===null){return false}}return true}function l(u,v){if(v!==null&&(typeof v==="undefined"?"undefined":_typeof(v))==="object"){for(var t in v){if(v.hasOwnProperty(t)&&!a.hasOwnProperty(t)){u[t]=v[t]}}}}function r(t,u){if(u!==undefined&&u!==null){for(var v in a){if(a.hasOwnProperty(v)&&u.hasOwnProperty(v)){t[v]=u[v]}}}}function h(u,v){for(var t in v){if(v.hasOwnProperty(t)){u[t]=v[t]}}}function e(D,C,x,A,y,w){var z={};z[p.OPERATION.NAME]=x.name;z[p.OPERATION.ID]=x.id;z[p.OPERATION.STEP]=x.step;z[p.OPERATION.INITIAL_BUCKET]=x.initialBucket;z[p.OPERATION.INITIAL_PATH]=x.initialPath;z[p.OPERATION.BUCKET_REGION]=x.bucketRegion;var u=Object.keys(x);for(var v in u){if(!m[u[v]]){z[u[v]]=x[u[v]]}}if(!(A instanceof Date)){A=new Date()}z[p.OPERATION.TIMESTAMP]=o("date")(A,"yyyy-MM-dd-HH-mm-ss.sss","UTC");z[p.OPERATION.CURRENT_BUCKET]=b.getCurrentBucket()||"";z[p.OPERATION.CURRENT_PATH]=b.getCurrentAbsoluteFolderPath()||"";h(z,y);l(z,w);var t="";if(z[p.OPERATION.CURRENT_BUCKET]){t=d.getBucketLocation(z[p.OPERATION.CURRENT_BUCKET])}var B={key:D,value:C,detail:JSON.stringify(z).replace(/\\\"/g," "),pageId:p.CLOG_PAGE_ID};r(B,w);q.Clog.log(B);return true}function g(t,w,y,v,u){if(!(y instanceof j)){return false}var x=[t,w,y,y.name,y.id,y.initialBucket,y.initialPath];if(!k(x)){return false}return e(t,w,y,u,{},v)}return{log:g,logCws:function c(u,x,A,t,w,v){if(!(A instanceof j)){return false}var y=[u,x,A.name,A.id,A.initialBucket,A.initialPath,t];if(!k(y)){return false}var z={};z[p.OPERATION.CWS_OP_ID]=t;return e(u,x,A,v,z,w)},logS3:function f(B,A,w,z,x,u,y){if(!(w instanceof j)){return false}var t=[B,A,w,w.name,w.id,w.initialBucket,w.initialPath,z,x];if(!k(t)){return false}var v={};v[p.S3_RESPONSE_HEADERS.X_AMZ_ID_2]=z;v[p.S3_RESPONSE_HEADERS.X_AMZ_REQUEST_ID]=x;return e(B,A,w,y,v,u)},logWithSimplifiedOperation:function n(u,w,x){if(!(x instanceof j)){return false}var v={};v[p.OPERATION.ID]=x.id;v[p.OPERATION.TIMESTAMP]=o("date")(new Date(),"yyyy-MM-dd-HH-mm-ss.sss","UTC");var t={key:u,value:w,detail:JSON.stringify(v).replace(/\\\"/g," "),pageId:p.CLOG_PAGE_ID};q.Clog.log(t)},logRequestReceived:function i(u){var t=new j(u,"requestReceived");g(u,1,t);return t},logRequestComplete:function s(u,t){t.step="requestComplete";g(u,1,t)}}}]);"use strict";(function(){angular.module("s3").factory("UUIDService",[function(){return{generateUUID:function a(){var b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(d){var c=Math.floor(Math.random()*16);return(d==="x"?c:c&3|8).toString(16)});return b}}}])})();"use strict";(function(){angular.module("s3").service("ObjectListingService",["$q","ConsoleOperation","ListVerificationService","S3Constants","PathService","APIProxyService","SCLogService","XMLParser",function(g,h,b,e,j,a,l,i){var f={getBatchOfItems:c,listObjects:d,tagQuery:k};return f;function d(q,n,m,o,p){var r={bucket:j.getCurrentBucket(),prefix:q,marker:n,maxKeys:m,delimiter:o,cacheAllowed:p};return a.listObjects(new h("listObjects"),r)}function k(o,q,p){var n={TagQuery:{MaxKeys:q,IncludeTags:true,ContinuationToken:p,And:{Filter:[]}}};var m="";angular.forEach(o,function(r){var t=r.tagKey,u=r.tagVal,s=u.split(", ");n.TagQuery.And.Filter.push({Key:t,Or:{Value:s}})});m=i.jsonToXml(n);return a.tagQuery(new h("tagQuery"),j.getCurrentBucket(),m)}function c(s,u,y,o,n,x,v,q){if(!b.verifyPrefixesToBeListed(s,v)){l.log("BulkOpPrefixesMalformed",1,s);return g.reject({error:"Bulk operation prefixes malformed"})}var r={bucket:s.initialBucket,maxKeys:y,cacheAllowed:o};q=q?q:{keys:[],truncated:false};var w=undefined;if(u){for(w=0;w<v.length;w++){if(!v[w].folderListed&&u.indexOf(v[w].Prefix)===0){r.prefix=v[w].Prefix;break}}if(n){r.keyMarker=u;r.versionIdMarker=x}else{r.marker=u}}else{for(w=0;w<v.length;w++){if(!v[w].folderListed){r.prefix=v[w].Prefix;break}}if(v[v.length-1].folderListed===true){q.truncated=false;var m=g.defer();m.resolve(q);return m.promise}}if(n===true){l.log("getBatchOfVersionsReceived",1,s,r);return a.listVersions(s,r).then(function(A){var z=A.response.ListVersionsResult;l.log("getBatchOfVersionsComplete",1,s,r);var p=[];if(z.Version){p=p.concat(z.Version)}if(z.DeleteMarker){p=p.concat(z.DeleteMarker)}return t(p,z.IsTruncated,z.NextKeyMarker,z.NextVersionIdMarker)})["catch"](function(p){r.error=p;l.log("getBatchOfVersionsComplete",0,s,r);return g.reject(p)})}else{l.log("getBatchOfObjectsReceived",1,s,r);return a.listObjects(s,r).then(function(z){var p=z.response.ListBucketResult;l.log("getBatchOfObjectsComplete",1,s,r);return t(p.Contents,p.IsTruncated,p.NextMarker)})["catch"](function(p){r.error=p;l.log("getBatchOfObjectsComplete",0,s,r);return g.reject(p)})}function t(C,p,B,z){if(C!==undefined){q.keys=q.keys.concat(C);var A=_.uniq(_.pluck(q.keys,"Key"));if(b.verify(A,v)===false){if(b.verifyEmptyKeyInSelectedPrefixes(A,v)){l.log("batchListVerification",1,s,r);l.log("emptyKeyBatchListVerification",1,s,r)}else{l.log("batchListVerification",0,s,r)}q.error="List verification failed.";return g.reject(q)}else{l.log("batchListVerification",1,s,r)}}else{if(r.prefix!==""){a.headObject(s,s.initialBucket,r.prefix).then(function(){l.log("prefixNotExistForListing",0,s)})["catch"](function(){l.log("prefixNotExistForListing",1,s)})}}if(p==="true"){q.marker=B;if(z){q.versionIdMarker=z}q.truncated=true;return q}else{var D=undefined;for(D=0;D<v.length;D++){if(v[D].Prefix===r.prefix){v[D].folderListed=true;break}}q.truncated=D<v.length-1;if(q.keys.length===y||!q.truncated){return q}else{return c(s,null,y-C.length,o,n,null,v,q)}}}}}])})();"use strict";(function(){angular.module("s3").service("ListDeletedObjectsService",["$q","APIProxyService","CachingService","ConsoleOperation","S3Constants","UtilService",a]);function a(f,c,b,h,d,j){var g={fetchDeletedPageOfObjects:i,listDeletedObjects:e};return g;function e(p,q,o){var n=arguments.length<=3||arguments[3]===undefined?d.LIST_OBJECTS_MAX_KEYS_PER_LISTING:arguments[3];var r=arguments.length<=4||arguments[4]===undefined?{}:arguments[4];var k=arguments.length<=5||arguments[5]===undefined?d.LIST_DELETED_OBJECTS_MAX_KEYS_PER_LISTING:arguments[5];var m=arguments.length<=6||arguments[6]===undefined?d.DELIMITER:arguments[6];var l=f.defer();if(!o){o={cachedDeletedFiles:[],cachedFolders:[],deletedFiles:[],folders:[]}}r.bucket=p.initialBucket;r.delimiter=m;r.maxKeys=k;r.prefix=q;c.listVersions(p,r).then(function(u){var s=_.get(u,"response.ListVersionsResult");if(s){if(s.CommonPrefixes){var v=j.transformObjectToArray(s.CommonPrefixes);angular.forEach(v,function(w){if(!_.isEmpty(q)&&w.Prefix.lastIndexOf(q)!==-1){w.Prefix=w.Prefix.substring(w.Prefix.lastIndexOf(q)+q.length)}if(o.deletedFiles.length+o.folders.length<n){o.folders.push(w)}else{o.cachedFolders.push(w)}})}if(s.DeleteMarker){var t=j.transformObjectToArray(s.DeleteMarker);angular.forEach(t,function(w){if(j.convertStringToBoolean(w.IsLatest)){if(w.Key.lastIndexOf("/")!==-1){w.Key=w.Key.substring(w.Key.lastIndexOf(d.DELIMITER)+1)}w.Size="";w.StorageClass="";if(o.deletedFiles.length+o.folders.length<n){o.deletedFiles.push(w)}else{o.cachedDeletedFiles.push(w)}}})}o.IsTruncated=s.IsTruncated;if(s.IsTruncated==="true"){if(o.deletedFiles.length+o.folders.length<n){r.keyMarker=s.NextKeyMarker;r.versionIdMarker=s.NextVersionIdMarker;e(p,q,o,n,r).then(function(w){l.resolve(w)},function(w){l.reject(w)})}else{o.NextKeyMarker=s.NextKeyMarker;o.NextVersionIdMarker=s.NextVersionIdMarker;l.resolve(o)}}else{l.resolve(o)}}else{l.reject()}},function(s){l.reject(s)});return l.promise}function i(q,t,s,n){var v=f.defer(),r=b.getPageOfDeletedObjects(t);var m=d.LIST_OBJECTS_MAX_KEYS_PER_LISTING,l={keyMarker:s,versionIdMarker:n};if(r){m=m-(r.Contents.length+r.CommonPrefixes.length)}if(m>=0){e(new h(d.LIST_DELETED_OBJECTS),q,null,m,l).then(function(w){if(r){w.deletedFiles=r.Contents.concat(w.deletedFiles);w.folders=r.CommonPrefixes.concat(w.folders)}v.resolve(w)},function(w){v.reject(w)})}else{var k=r.CommonPrefixes,p=r.Contents,o={cachedDeletedFiles:[],cachedFolders:[],deletedFiles:[],folders:[],IsTruncated:"true",NextKeyMarker:s,NextVersionIdMarker:n};if(k.length>d.LIST_OBJECTS_MAX_KEYS_PER_LISTING){o.folders=k.slice(0,d.LIST_OBJECTS_MAX_KEYS_PER_LISTING);o.cachedFolders=k.slice(d.LIST_OBJECTS_MAX_KEYS_PER_LISTING);o.cachedDeletedFiles=p}else{var u=d.LIST_OBJECTS_MAX_KEYS_PER_LISTING-k.length;o.folders=k;o.deletedFiles=p.slice(0,u);o.cachedDeletedFiles=p.slice(u)}v.resolve(o)}return v.promise}}})();"use strict";(function(){angular.module("s3").service("ListVerificationService",["S3Constants",function(b){function a(g,f){return g.indexOf(f)===0}function e(g,f){return g.length>0&&g.lastIndexOf(f)===g.length-f.length}function c(h,g){var f=h.indexOf(g);return f>=0&&f===h.lastIndexOf(g)}function d(f){return f.name===b.OPERATION_NAME.DELETE_BUCKET||f.name===b.OPERATION_NAME.EMPTY_BUCKET}this.verifyPrefixesToBeListed=function(f,k){if(d(f)){return k.length===1&&k[0].Prefix===""}else{for(var g in k){var j=k[g];var i=undefined;if(f.initialPath.length===0){i=j.Prefix}else{var h=j.Prefix.split(f.initialPath);i=h[1];if(i===""&&h.length===3){i=f.initialPath}}if(!(a(j.Prefix,f.initialPath)&&c(i,b.DELIMITER)&&e(i,b.DELIMITER))){return false}}return true}};this.verify=function(l,f){if(!l){throw"keys is undefined."}if(l&&!angular.isArray(l)){l=new Array(l)}for(var k=0;k<l.length;k++){var h=false;for(var g=0;g<f.length;g++){if(a(l[k],f[g].Prefix)){h=true;break}}if(!h){return false}}return true};this.verifyEmptyKeyInSelectedPrefixes=function(k,f){var m=_.find(k,function(i){return i===""});if(m!==undefined){var o=_.find(f,function(i){return i.Prefix===""});if(o===undefined){var n=[];for(var l=0;l<k.length;l++){var h=false;for(var g=0;g<f.length;g++){if(_.startsWith(k[l],f[g].Prefix)){h=true;break}}if(!h){n.push(k[l])}if(n.length>1){break}}return n.length===1&&n[0]===""}}return false}}])})();"use strict";(function(){angular.module("s3").factory("ConsoleOperation",["$q","CachingService","KeySelectionService","PathService","S3Constants","UtilService","UUIDService",function(d,c,f,h,e,b,a){function g(ac,Q){var S=a.generateUUID();var C=h.getCurrentBucket()||"";var v=c.getBucketLocation(C)||"";var ai=h.getCurrentAbsoluteFolderPath()||"";var F={};var aa=d.defer();var at=0;var w=0;var i=0;var p="";var aq=0;var l=0;var aj=0;var ar=[];var Y={};var x=function x(){};var aE=function aE(){};var ah=null;var t=null;var ak=function ak(aG){C=aG};var aA;var am;var av=0;var ad=0;var aC=e.OPERATION_STATE.WAITING;function ap(){return aa}function an(){if(b.isNumeric(at)){if(at>=0&&at<=100){return Number(Number(at).toFixed(2))}else{if(at>100){return 100}}}return"--"}function E(aG){at=aG}function ao(aG){w=aG}function aB(){if(b.isNumeric(w)){if(w>=0&&w<=100){return Number(Number(w).toFixed(2))}else{if(w>100){return 100}}}return"--"}function J(){if(b.isNumeric(i)){return Math.min(Number(Number(i).toFixed(2)),100)}return"--"}function z(aG){i=aG}function B(){return v}function G(aG){v=aG}function L(aG){p=aG}function r(){return p}function az(aG){aq=aG}function q(){return aq}function D(aG){l=aG}function j(){return l}function ab(){return aj}function X(aG){aj=aG}function U(){return ar}function V(aG){ar=aG}function ae(){return Y}function ag(aG){Y=aG}function N(){return x}function P(aG){x=aG}function T(){return aE}function W(aG){aE=aG}function I(){return ah}function M(aG){ah=aG}function s(){return t}function O(aG){t=aG}function al(aG){aC=aG}function u(){return aC}function ay(aG){F=aG}function aw(){return F}function K(){return ac}function n(){return Q}function aF(aG){Q=aG}function y(){return S}function au(){return C}function H(){return ai}function A(){return aA}function m(aG){aA=aG}function ax(){return am}function aD(aG){am=aG}function R(){return av}function o(aG){av=aG}function af(){return ad}function Z(aG){ad=aG}function k(){return ak}Object.defineProperties(this,{defer:{get:ap},name:{get:K},step:{get:n,set:aF},id:{get:y},initialBucket:{get:au},initialPath:{get:H},bucketRegion:{get:B,set:G},progressPercentage:{get:an,set:E},succeedKeyCount:{get:q,set:az},failedKeyCount:{get:j,set:D},totalOperatedObjectCount:{get:ab,set:X},successPercentage:{get:aB,set:ao},errorPercentage:{get:J,set:z},progressText:{get:r,set:L},errorTypes:{get:U,set:V},errorDetails:{get:ae,set:ag},state:{get:u,set:al},start:{get:N,set:P},cancel:{get:T,set:W},errorCallBack:{get:I,set:M},finishCallBack:{get:s,set:O},parameters:{get:aw,set:ay},selectedObjects:{get:ax,set:aD},selectedFolders:{get:A,set:m},keyCount:{get:R,set:o},totalSizeInBytes:{get:af,set:Z},changeInitialBucketForOperation:{get:k}})}return g}])})();"use strict";(function(){angular.module("s3").service("UploadVerificationService",["$filter","$http","$window","$q","$translate","ConsoleOperation","Md5WorkerService","S3Constants","SCLogService",function(i,m,b,g,a,h,j,d,o){var c=[];var l={};var f={verifyUpload:k};return f;function k(v,r,t){var s=new h("uploadVerification","requestReceived");var u={fileName:v.name,fileSize:v.size,uploadOpId:t};o.log("MD5CalculationSize",v.size,s,u);var w=g.defer();if(v.size===0){w.resolve(d.UPLOAD.ZERO_BYTE_MD5)}else{n(r,v,t,w,s)}return w.promise}function n(t,s,u,y,x){x.step="MD5CalculationStart";var r={fileName:s.name,uploadOpId:u};o.log("MD5CalculationStart",1,x,r);var w=t+"-";var z=j.generateWorker(t,s,u,y,x);z.worker.addEventListener("message",q(w));z.worker.addEventListener("error",e(w));l[w]=z;var v={file_size:s.size,start:0,end:s.size};z.worker.postMessage({message:s,block:v})}function e(r){return function(){var s=l[r];s.uploadVerificationDeferredObject.reject(a.instant("upload.md5calculation.error"));p(s,"MD5CalculationSuccess",0);delete l[r]}}function q(r){return function(t){if(t.data.result){var u=l[r];c[u.fileId]=t.data.result;var s=b.Date.now()-u.startTime;p(u,"MD5CalculationSuccess",1);p(u,"MD5CalculationTime",s);console.log("Etag calculated for "+u.file.name+": "+t.data.result);u.uploadVerificationDeferredObject.resolve(c[u.fileId]);delete l[r]}}}function p(u,t,s){u.operation.step=t;var r={fileName:u.file.name,uploadOpId:u.uploadOpId};o.log(t,s,u.operation,r)}}])})();"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol==="function"&&a.constructor===Symbol?"symbol":typeof a};(function(){angular.module("s3").service("Md5WorkerService",["$window",function(c){this.generateWorker=function(d,g,f,h,e){if(!a){b()}var i=new c.Worker(a);var j={fileId:d,worker:i,file:g,startTime:c.Date.now(),uploadOpId:f,uploadVerificationDeferredObject:h,operation:e};return j};var a;function b(){if(_typeof(c.Blob)===(typeof Function==="undefined"?"undefined":_typeof(Function))||_typeof(c.Blob)==="object"){var d=new c.Blob(['/*                          * Crypto-JS v2.5.1                          * http://code.google.com/p/crypto-js/                          * (c) 2009-2011 by Jeff Mott. All rights reserved.                          * http://code.google.com/p/crypto-js/wiki/License                          */                         /*global Crypto, self*/                        (typeof Crypto=="undefined"||!Crypto.util)&&function(){var e=self.Crypto={},g=e.util={rotl:function(a,b){return a<<b|a>>>32-b},rotr:function(a,b){return a<<32-b|a>>>b},endian:function(a){if(a.constructor==Number)return g.rotl(a,8)&16711935|g.rotl(a,24)&4278255360;for(var b=0;b<a.length;b++)a[b]=g.endian(a[b]);return a},randomBytes:function(a){for(var b=[];a>0;a--)b.push(Math.floor(Math.random()*256));return b},bytesToWords:function(a){for(var b=[],c=0,d=0;c<a.length;c++,d+=8)b[d>>>5]|=a[c]<<24-                        d%32;return b},wordsToBytes:function(a){for(var b=[],c=0;c<a.length*32;c+=8)b.push(a[c>>>5]>>>24-c%32&255);return b},bytesToHex:function(a){for(var b=[],c=0;c<a.length;c++)b.push((a[c]>>>4).toString(16)),b.push((a[c]&15).toString(16));return b.join("")},hexToBytes:function(a){for(var b=[],c=0;c<a.length;c+=2)b.push(parseInt(a.substr(c,2),16));return b},bytesToBase64:function(a){if(typeof btoa=="function")return btoa(f.bytesToString(a));for(var b=[],c=0;c<a.length;c+=3)for(var d=a[c]<<16|a[c+1]<<8|                        a[c+2],e=0;e<4;e++)c*8+e*6<=a.length*8?b.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(d>>>6*(3-e)&63)):b.push("=");return b.join("")},base64ToBytes:function(a){if(typeof atob=="function")return f.stringToBytes(atob(a));for(var a=a.replace(/[^A-Z0-9+/]/ig,""),b=[],c=0,d=0;c<a.length;d=++c%4)d!=0&&b.push(("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c-1))&Math.pow(2,-2*d+8)-1)<<d*2|"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(a.charAt(c))>>>                        6-d*2);return b}},e=e.charenc={};e.UTF8={stringToBytes:function(a){return f.stringToBytes(unescape(encodeURIComponent(a)))},bytesToString:function(a){return decodeURIComponent(escape(f.bytesToString(a)))}};var f=e.Binary={stringToBytes:function(a){for(var b=[],c=0;c<a.length;c++)b.push(a.charCodeAt(c)&255);return b},bytesToString:function(a){for(var b=[],c=0;c<a.length;c++)b.push(String.fromCharCode(a[c]));return b.join("")}}}();                        function FF(a, b, c, d, x, s, t) {                            var n = a + (b & c | ~b & d) + (x >>> 0) + t;                            return ((n << s) | (n >>> (32 - s))) + b;                        }                        function GG(a, b, c, d, x, s, t) {                            var n = a + (b & d | c & ~d) + (x >>> 0) + t;                            return ((n << s) | (n >>> (32 - s))) + b;                        }                        function HH(a, b, c, d, x, s, t) {                            var n = a + (b ^ c ^ d) + (x >>> 0) + t;                            return ((n << s) | (n >>> (32 - s))) + b;                        }                        function II(a, b, c, d, x, s, t) {                            var n = a + (c ^ (b | ~d)) + (x >>> 0) + t;                            return ((n << s) | (n >>> (32 - s))) + b;                        }                        function md5(m, hash) {                            var a = hash[0], b = hash[1], c = hash[2], d = hash[3];                            for (var i = 0; i < m.length; i += 16) {                                var aa = a, bb = b, cc = c, dd = d;                                a = FF(a, b, c, d, m[i + 0], 7, -680876936);                                d = FF(d, a, b, c, m[i + 1], 12, -389564586);                                c = FF(c, d, a, b, m[i + 2], 17, 606105819);                                b = FF(b, c, d, a, m[i + 3], 22, -1044525330);                                a = FF(a, b, c, d, m[i + 4], 7, -176418897);                                d = FF(d, a, b, c, m[i + 5], 12, 1200080426);                                c = FF(c, d, a, b, m[i + 6], 17, -1473231341);                                b = FF(b, c, d, a, m[i + 7], 22, -45705983);                                a = FF(a, b, c, d, m[i + 8], 7, 1770035416);                                d = FF(d, a, b, c, m[i + 9], 12, -1958414417);                                c = FF(c, d, a, b, m[i + 10], 17, -42063);                                b = FF(b, c, d, a, m[i + 11], 22, -1990404162);                                a = FF(a, b, c, d, m[i + 12], 7, 1804603682);                                d = FF(d, a, b, c, m[i + 13], 12, -40341101);                                c = FF(c, d, a, b, m[i + 14], 17, -1502002290);                                b = FF(b, c, d, a, m[i + 15], 22, 1236535329);                                a = GG(a, b, c, d, m[i + 1], 5, -165796510);                                d = GG(d, a, b, c, m[i + 6], 9, -1069501632);                                c = GG(c, d, a, b, m[i + 11], 14, 643717713);                                b = GG(b, c, d, a, m[i + 0], 20, -373897302);                                a = GG(a, b, c, d, m[i + 5], 5, -701558691);                                d = GG(d, a, b, c, m[i + 10], 9, 38016083);                                c = GG(c, d, a, b, m[i + 15], 14, -660478335);                                b = GG(b, c, d, a, m[i + 4], 20, -405537848);                                a = GG(a, b, c, d, m[i + 9], 5, 568446438);                                d = GG(d, a, b, c, m[i + 14], 9, -1019803690);                                c = GG(c, d, a, b, m[i + 3], 14, -187363961);                                b = GG(b, c, d, a, m[i + 8], 20, 1163531501);                                a = GG(a, b, c, d, m[i + 13], 5, -1444681467);                                d = GG(d, a, b, c, m[i + 2], 9, -51403784);                                c = GG(c, d, a, b, m[i + 7], 14, 1735328473);                                b = GG(b, c, d, a, m[i + 12], 20, -1926607734);                                a = HH(a, b, c, d, m[i + 5], 4, -378558);                                d = HH(d, a, b, c, m[i + 8], 11, -2022574463);                                c = HH(c, d, a, b, m[i + 11], 16, 1839030562);                                b = HH(b, c, d, a, m[i + 14], 23, -35309556);                                a = HH(a, b, c, d, m[i + 1], 4, -1530992060);                                d = HH(d, a, b, c, m[i + 4], 11, 1272893353);                                c = HH(c, d, a, b, m[i + 7], 16, -155497632);                                b = HH(b, c, d, a, m[i + 10], 23, -1094730640);                                a = HH(a, b, c, d, m[i + 13], 4, 681279174);                                d = HH(d, a, b, c, m[i + 0], 11, -358537222);                                c = HH(c, d, a, b, m[i + 3], 16, -722521979);                                b = HH(b, c, d, a, m[i + 6], 23, 76029189);                                a = HH(a, b, c, d, m[i + 9], 4, -640364487);                                d = HH(d, a, b, c, m[i + 12], 11, -421815835);                                c = HH(c, d, a, b, m[i + 15], 16, 530742520);                                b = HH(b, c, d, a, m[i + 2], 23, -995338651);                                a = II(a, b, c, d, m[i + 0], 6, -198630844);                                d = II(d, a, b, c, m[i + 7], 10, 1126891415);                                c = II(c, d, a, b, m[i + 14], 15, -1416354905);                                b = II(b, c, d, a, m[i + 5], 21, -57434055);                                a = II(a, b, c, d, m[i + 12], 6, 1700485571);                                d = II(d, a, b, c, m[i + 3], 10, -1894986606);                                c = II(c, d, a, b, m[i + 10], 15, -1051523);                                b = II(b, c, d, a, m[i + 1], 21, -2054922799);                                a = II(a, b, c, d, m[i + 8], 6, 1873313359);                                d = II(d, a, b, c, m[i + 15], 10, -30611744);                                c = II(c, d, a, b, m[i + 6], 15, -1560198380);                                b = II(b, c, d, a, m[i + 13], 21, 1309151649);                                a = II(a, b, c, d, m[i + 4], 6, -145523070);                                d = II(d, a, b, c, m[i + 11], 10, -1120210379);                                c = II(c, d, a, b, m[i + 2], 15, 718787259);                                b = II(b, c, d, a, m[i + 9], 21, -343485551);                                a = (a + aa) >>> 0;                                b = (b + bb) >>> 0;                                c = (c + cc) >>> 0;                                d = (d + dd) >>> 0;                            }                            return [a, b, c, d];                        }                        var hash = [1732584193, -271733879, -1732584194, 271733878];                        onmessage = function (event) {                            var uint8_array, message, block, output, nBitsTotal, nBitsLeft, nBitsTotalH, nBitsTotalL;                            var reader = new FileReaderSync();                            uint8_array = new Uint8Array(reader.readAsArrayBuffer(event.data.message));                            message = Crypto.util.endian(Crypto.util.bytesToWords(uint8_array));                            block = event.data.block;                            event = null;                            uint8_array = null;                            output = {};                            nBitsTotal =  block.file_size * 8;                            nBitsLeft = (block.end - block.start) * 8;                            message[nBitsLeft >>> 5] |= 0x80 << (nBitsLeft % 32);                            nBitsTotalH = Math.floor(nBitsTotal / 0x100000000);                            nBitsTotalL = nBitsTotal & 0xFFFFFFFF;                            message[(((nBitsLeft + 64) >>> 9) << 4) + 15] = nBitsTotalH;                            message[(((nBitsLeft + 64) >>> 9) << 4) + 14] = nBitsTotalL;                            self.hash = md5(message, self.hash);                            output.result = Crypto.util.bytesToHex(Crypto.util.wordsToBytes(Crypto.util.endian(self.hash)));                            message = null;                            self.postMessage(output);                            close();                        }'],{type:"application/javascript"});a=c.URL.createObjectURL(d)}}}])})();"use strict";(function(){angular.module("s3").service("BucketPropertiesService",["$window","$q","APIProxyService","Region","S3Constants","SCLogService","XMLParser","PermissionsUtilService","UtilService",function(ae,f,Z,w,an,m,P,Y,y){var j={deleteBucketCORS:N,deleteBucketPolicy:ag,getBucketACL:o,getBucketOwnerDisplayName:c,getBucketLocation:M,getBucketGranteeCounts:s,getBucketCORS:al,getBucketGrantees:u,getBucketNotification:q,getBucketPolicy:A,getBucketVersioning:r,getEventCount:D,getBucketLifecycleConfiguration:J,getLoggingTargetBucket:k,getTagCount:ai,getVersioningStatus:ac,isAnalyticsEnabled:T,isBucketPolicyApplied:F,isCORSEnabled:Q,isInventoryEnabled:e,isLifecycleEnabled:ab,isLoggingEnabled:V,isMetricsEnabled:G,isReplicationEnabled:I,isRequesterPaysEnabled:ak,isWebsiteEnabled:O,putBucketACL:g,putBucketNotification:z,parseBucketNotificationObject:l,putBucketCORS:af,putBucketPolicy:L,enableBucketVersioning:am,disableBucketVersioning:S,enableBucketLogging:i,disableBucketLogging:C,putBucketTagging:ad,deleteBucketTagging:aa,configureBucketWebsite:K,redirectBucketWebsiteRequests:E,deleteBucketWebsite:p,getBucketReplication:X,putBucketReplication:d,deleteBucketReplication:ah,parseBucketReplicationObject:t,getBucketLifecycle:aj,putBucketLifecycle:B,deleteBucketLifecycle:H,getBucketInventory:x,putBucketInventory:b,deleteBucketInventory:h,getBucketAccelerate:W,putBucketAccelerate:a,getBucketRegion:v};return j;function c(){var ao=m.logRequestReceived("getBucketOwnerDisplayName");return Z.getBucketOwner().then(function(ap){m.logRequestComplete("getBucketOwnerDisplayName",ao);return ap.DisplayName})}function v(ao){return j.getBucketLocation(ao).then(function(ap){return _.find(w.regionMapping,{value:ap})})}function M(ap){var ao=m.logRequestReceived("getBucketLocation");return Z.getBucketLocation(ao,ap,{}).then(function(aq){m.logRequestComplete("getBucketLocation",ao);return aq.region})}function s(ap){var ao=m.logRequestReceived("getBucketGranteeCounts");return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.acl.name).then(function(av){var ar=av.response;m.logRequestComplete("getBucketGranteeCounts",ao);var au={READ:0,WRITE:0,READ_ACP:0,WRITE_ACP:0};if(ar){var aq=ar.AccessControlPolicy.AccessControlList.Grant;var at=function at(aw){if(aw.Permission==="FULL_CONTROL"){for(var ax in au){au[ax]++}}else{au[aw.Permission]++}};if(aq){if(aq.forEach){aq.forEach(function(aw){at(aw)})}else{at(aq)}}}return au})}function u(ap,ao){m.log("getBucketGranteesReceived",1,ao,{bucketName:ap});ao.step="getBucketAclComplete";return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.acl.name).then(function(au){var ar=au.response;var at={};m.log("getBucketACL",1,ao,{bucketName:ap});var aq=ar.AccessControlPolicy.AccessControlList.Grant;if(aq){if(aq.forEach){aq.forEach(function(av){Y.updateGranteesHelperFunction(av,at)})}else{Y.updateGranteesHelperFunction(aq,at)}}m.logRequestComplete("getBucketGrantees",ao);return at})["catch"](function(aq){m.log("getBucketGrantees",0,ao,{bucketName:ap,error:aq});return f.reject(y.handleErrors(aq))})}function n(ap,ao){m.log("getBucketACPReceived",1,ao,{bucketName:ap});return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.acl.name).then(function(ar){var aq=ar.response;m.logRequestComplete("getBucketACP",ao);return aq.AccessControlPolicy})["catch"](function(aq){m.log("getBucketACP",0,ao,{bucketName:ap,error:aq});return f.reject(y.handleErrors(aq))})}function o(ap,ao){m.log("getBucketACLReceived",1,ao,{bucketName:ap});return n(ap,ao).then(function(aq){m.logRequestComplete("getBucketACL",ao);return aq.AccessControlList.Grant})["catch"](function(aq){m.log("getBucketACL",0,ao,{bucketName:ap,error:aq});return f.reject(y.handleErrors(aq))})}function g(aq,ao,ap){m.log("putBucketACLReceived",1,ap,{bucketName:aq});var ar="";return n(aq,ap).then(function(at){ar+='<AccessControlPolicy xmlns="http://s3.amazonaws.com/doc/2006-03-01/"><Owner><ID>'+at.Owner.ID+"</ID>";ar+="<DisplayName>"+at.Owner.DisplayName+"</DisplayName></Owner><AccessControlList>";ao.forEach(function(au){au.Grantee.Type=au.Grantee.URI?"Group":au.Grantee.EmailAddress?"AmazonCustomerByEmail":"CanonicalUser";ar+='<Grant><Grantee xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="'+au.Grantee.Type+'">';ar+=au.Grantee.ID?"<ID>"+au.Grantee.ID+"</ID>":"";ar+=au.Grantee.DisplayName?"<DisplayName>"+au.Grantee.DisplayName+"</DisplayName>":"";ar+=au.Grantee.EmailAddress?"<EmailAddress>"+au.Grantee.EmailAddress+"</EmailAddress>":"";ar+=au.Grantee.URI?"<URI>"+au.Grantee.URI+"</URI>":"";ar+="</Grantee>";ar+="<Permission>"+au.Permission+"</Permission></Grant>"});ar+="</AccessControlList></AccessControlPolicy>";return Z.putBucketProperty(ap,aq,Z.bucketPropertiesMap.acl.name,ar).then(function(av){var au=av.response;m.logRequestComplete("putBucketACL",ap);return au})["catch"](function(au){m.log("putBucketACL",0,ap,{bucketName:aq,error:au});return f.reject(y.handleErrors(au))})})["catch"](function(at){return f.reject(at)})}function z(ar,ap,ao){m.log("putBucketNotificationReceived",1,ap,{bucketName:ar});var aq=l(ao);return Z.putBucketProperty(ap,ar,Z.bucketPropertiesMap.notification.name,aq).then(function(au){var at=au.response;m.log("putBucketNotification",1,ap,{bucketName:ar});return at})["catch"](function(at){m.log("putBucketNotification",0,ap,{bucketName:ar,error:at});return f.reject(y.handleErrors(at))})}function l(ao){var ap={};var aq=[{name:an.EVENTS.TOPIC,value:an.EVENTS.TOPICCONFIG},{name:an.EVENTS.QUEUE,value:an.EVENTS.QUEUECONFIG},{name:an.EVENTS.CLOUDFN,value:an.EVENTS.CLOUDCONFIG}];aq.forEach(function(at){var ar=[];if(ao[at.name]){ao[at.name].forEach(function(au){ar.push(R(au))});ap[at.value]=ar}});ap={NotificationConfiguration:ap};return P.jsonToXml(ap)}function R(ar){var aq={};aq.Id=ar.id;var ao=[];if(ar.prefix&&ar.prefix!==""){ao.push({Name:"Prefix",Value:ar.prefix})}if(ar.suffix&&ar.suffix!==""){ao.push({Name:"Suffix",Value:ar.suffix})}if(ao.length!==0){U(ao);aq.Filter={S3Key:{FilterRule:ao}}}switch(ar.type){case an.EVENTS.SNS:aq.Topic=ar.arn;break;case an.EVENTS.SQS:aq.Queue=ar.arn;break;case an.EVENTS.LAMBDA:aq.CloudFunction=ar.arn}var ap=U(ar.events);aq.Event=ap;return aq}function U(ao){if(ao.length===1){return ao[0]}return ao}function Q(ap){var ao=m.logRequestReceived("isCORSEnabled");return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.cors.name).then(function(aq){m.logRequestComplete("isCORSEnabled",ao);return aq.response!==undefined})}function af(aq,ap,ao){m.log("putBucketCORSReceived",1,ao,{bucketName:aq});return Z.putBucketProperty(ao,aq,Z.bucketPropertiesMap.cors.name,ap).then(function(ar){m.logRequestComplete("putBucketCORS",ao);return ar.response})["catch"](function(ar){m.log("putBucketCORS",0,ao,{bucketName:aq,error:ar});return f.reject(y.handleErrors(ar))})}function al(ap,ao){m.log("getBucketCORSReceived",1,ao,{bucketName:ap});return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.cors.name).then(function(aq){m.logRequestComplete("getBucketCORS",ao);return aq.response})["catch"](function(ar){var aq=y.handleErrors(ar);if(aq!=="The CORS configuration does not exist"){m.log("getBucketCORS",0,ao,{bucketName:ap,error:ar});return f.reject(aq)}else{m.logRequestComplete("getBucketCORS",ao)}})}function N(ap,ao){m.log("deleteBucketCORSReceived",1,ao,{bucketName:ap});return Z.deleteBucketProperty(ao,ap,Z.bucketPropertiesMap.cors.name).then(function(aq){m.logRequestComplete("deleteBucketCORS",ao);return aq.response})["catch"](function(aq){m.log("deleteBucketCORS",0,ao,{bucketName:ap,error:aq});return f.reject(y.handleErrors(aq))})}function F(ap){var ao=m.logRequestReceived("isBucketPolicyApplied");return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.policy.name).then(function(aq){m.logRequestComplete("isBucketPolicyApplied",ao);return aq.response!==undefined})}function A(ap,ao){m.log("getBucketPolicyReceived",1,ao,{bucketName:ap});return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.policy.name).then(function(aq){m.logRequestComplete("getBucketPolicy",ao);return aq.response})["catch"](function(ar){var aq=y.handleErrors(ar);if(aq!=="The bucket policy does not exist"){m.log("getBucketPolicy",0,ao,{bucketName:ap,error:ar});return f.reject(aq)}else{m.logRequestComplete("getBucketPolicy",ao)}})}function L(ap,aq,ao){m.log("putBucketPolicyReceived",1,ao,{bucketName:ap});return Z.putBucketProperty(ao,ap,Z.bucketPropertiesMap.policy.name,aq).then(function(ar){m.logRequestComplete("putBucketPolicy",ao);return ar.response})["catch"](function(at){var ar=y.handleErrors(at);m.log("putBucketPolicy",0,ao,{bucketName:ap,error:at});return f.reject(ar)})}function ag(ap,ao){m.log("deleteBucketPolicyReceived",1,ao,{bucketName:ap});return Z.deleteBucketProperty(ao,ap,Z.bucketPropertiesMap.policy.name).then(function(aq){m.logRequestComplete("deleteBucketPolicy",ao);return aq.response})["catch"](function(aq){m.log("deleteBucketPolicy",0,ao,{bucketName:ap,error:aq});return f.reject(y.handleErrors(aq))})}function J(ap){var ao=m.logRequestReceived("getBucketLifecycleConfiguration");return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.lifecycle.name).then(function(aq){m.logRequestComplete("getBucketLifecycleConfiguration",ao);if(aq.response){return P.convertXmlStringToJson(aq.response)}else{return aq}})}function ac(ap){var ao=m.logRequestReceived("getVersioningStatus");return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.versioning.name).then(function(aq){m.logRequestComplete("getVersioningStatus",ao);var ar=P.convertXmlStringToJson(aq.response);return ar.VersioningConfiguration&&ar.VersioningConfiguration.Status})}function D(ap){var ao=m.logRequestReceived("getEventCount");return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.notification.name).then(function(aq){m.logRequestComplete("getEventCount",ao);var ar=P.convertXmlStringToJson(aq.response);var au=0;for(var at in ar.NotificationConfiguration){au+=ar.NotificationConfiguration[at].length||1}return au})}function q(ap,ao){m.log("getBucketNotificationReceived",1,ao,{bucketName:ap});return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.notification.name).then(function(aq){m.logRequestComplete("getBucketNotification",ao);return aq})["catch"](function(aq){m.log("getBucketNotification",0,ao,{bucketName:ap,error:aq});return f.reject(y.handleErrors(aq))})}function V(ap){var ao=m.logRequestReceived("isLoggingEnabled");return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.logging.name).then(function(aq){m.logRequestComplete("isLoggingEnabled",ao);return aq.response&&aq.response.BucketLoggingStatus.LoggingEnabled!==undefined})}function k(ap){var ao=m.logRequestReceived("getLoggingTargetBucket");return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.logging.name).then(function(aq){m.logRequestComplete("getLoggingTargetBucket",ao);var ar=aq.response.BucketLoggingStatus.LoggingEnabled;if(ar){return ar.TargetBucket}else{return"Logging is not enabled"}})}function ak(ap){var ao=m.logRequestReceived("isRequesterPaysEnabled");return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.requestPayment.name).then(function(aq){m.logRequestComplete("isRequesterPaysEnabled",ao);var ar=P.convertXmlStringToJson(aq.response);return ar.RequestPaymentConfiguration.Payer==="Requester"})}function I(ap){var ao=m.logRequestReceived("isReplicationEnabled");return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.replication.name).then(function(aq){var ar=P.convertXmlStringToJson(aq.response);var at=false;if(ar.ReplicationConfiguration){m.logRequestComplete("isReplicationEnabled",ao);if(ar.ReplicationConfiguration.Rule.length){at=_.filter(ar.ReplicationConfiguration.Rule,function(au){return au.Status==="Enabled"}).length>0}else{at=ar.ReplicationConfiguration.Rule.Status==="Enabled"}}return at})}function T(ap){var aq=an.OPERATION_NAME.IS_ANALYTICS_ENABLED;var ao=m.logRequestReceived(aq);return Z.getBucketProperty(ao,ap,"analytics",{},false).then(function(av){var ar=av.response;m.log(aq,1,ao);var au=P.convertXmlStringToJson(ar);var at=au.ListBucketAnalyticsConfigurationsResult;if(at&&at.AnalyticsConfiguration){return true}return false})["catch"](function(ar){m.log(aq,0,ao,{bucketName:ap,error:ar});return false})}function ab(ap){var aq=an.OPERATION_NAME.IS_LIFECYCLE_ENABLED;var ao=m.logRequestReceived(aq);return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.lifecycle.name).then(function(at){m.log(aq,1,ao);if(at.response){var ar=P.convertXmlStringToJson(at.response);if(ar&&ar.LifecycleConfiguration&&ar.LifecycleConfiguration.Rule){var au=y.transformObjectToArray(ar.LifecycleConfiguration.Rule);return _.some(au,function(av){return av.Status==="Enabled"})}}return false})["catch"](function(ar){m.log(aq,0,ao,{bucketName:ap,error:ar});return false})}function e(ap){var aq=an.OPERATION_NAME.IS_INVENTORY_ENABLED;var ao=m.logRequestReceived(aq);return Z.getObjectInventory(ao,ap,{path:ap}).then(function(at){var ar=at.response;m.log(aq,1,ao);if(ar){var au=P.convertXmlStringToJson(ar);if(au.ListInventoryConfigurationsResult&&au.ListInventoryConfigurationsResult.InventoryConfiguration){return true}}return false})["catch"](function(ar){m.log(aq,0,ao,{bucketName:ap,error:ar});return false})}function G(ap){var aq=an.OPERATION_NAME.IS_METRICS_ENABLED;var ao=m.logRequestReceived(aq);return Z.getBucketProperty(ao,ap,"metrics",{},false).then(function(au){var ar=au.response;m.log(aq,1,ao);if(ar){var av=P.convertXmlStringToJson(ar);var at=av.ListMetricsConfigurationsResult;if(av&&at&&at.MetricsConfiguration){return true}}return false})["catch"](function(ar){m.log(aq,0,ao,{bucketName:ap,error:ar});return false})}function ai(ap){var ao=m.logRequestReceived("getTagCount");return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.tagging.name).then(function(aq){m.logRequestComplete("getTagCount",ao);var ar=P.convertXmlStringToJson(aq.response);var at=0;if(ar.Tagging){at=ar.Tagging.TagSet.Tag.length||1}return at})}function O(ap){var ao=m.logRequestReceived("isWebsiteEnabled");return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.website.name).then(function(aq){m.logRequestComplete("isWebsiteEnabled",ao);return aq.response!==undefined})}function r(ap,ao){m.log("getBucketVersioningReceived",1,ao,{bucketName:ap});return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.versioning.name).then(function(aq){m.logRequestComplete("getBucketVersioning",ao);var ar=P.convertXmlStringToJson(aq.response);return ar.VersioningConfiguration&&ar.VersioningConfiguration.Status})["catch"](function(aq){m.log("getBucketVersioning",0,ao,{bucketName:ap,error:aq});return f.reject(y.handleErrors(aq))})}function am(ap,ao){m.log("putBucketVersioningReceived",1,ao,{bucketName:ap});var aq="<VersioningConfiguration xmlns='http://s3.amazonaws.com/doc/2006-03-01/'><Status>Enabled</Status></VersioningConfiguration>";return Z.putBucketProperty(ao,ap,Z.bucketPropertiesMap.versioning.name,aq).then(function(ar){m.logRequestComplete("putBucketVersioning",ao);return ar})["catch"](function(ar){m.log("putBucketVersioning",0,ao,{bucketName:ap,error:ar});return f.reject(y.handleErrors(ar))})}function S(ap,ao){m.log("putBucketVersioningReceived",1,ao,{bucketName:ap});var aq="<VersioningConfiguration xmlns='http://s3.amazonaws.com/doc/2006-03-01/'><Status>Suspended</Status></VersioningConfiguration>";return Z.putBucketProperty(ao,ap,Z.bucketPropertiesMap.versioning.name,aq).then(function(ar){m.logRequestComplete("putBucketVersioning",ao);return ar})["catch"](function(ar){m.log("putBucketVersioning",0,ao,{bucketName:ap,error:ar});return f.reject(y.handleErrors(ar))})}function i(ar,av,au,ap,aq){m.log("enableBucketLoggingReceived",1,aq,{bucketName:ar});var ao;if(ap===undefined||ap.length===0){ao=""}else{ao="<TargetGrants>";ap.forEach(function(aw){aw.Grantee.Type=aw.Grantee.URI?"Group":aw.Grantee.EmailAddress?"AmazonCustomerByEmail":"CanonicalUser";ao+='<Grant><Grantee xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="'+aw.Grantee.Type+'">';ao+=aw.Grantee.ID?"<ID>"+aw.Grantee.ID+"</ID>":"";ao+=aw.Grantee.DisplayName?"<DisplayName>"+aw.Grantee.DisplayName+"</DisplayName>":"";ao+=aw.Grantee.EmailAddress?"<EmailAddress>"+aw.Grantee.EmailAddress+"</EmailAddress>":"";ao+=aw.Grantee.URI?"<URI>"+aw.Grantee.URI+"</URI>":"";ao+="</Grantee>";ao+="<Permission>"+aw.Permission+"</Permission></Grant>"});ao+="</TargetGrants>"}var at="<BucketLoggingStatus xmlns='http://doc.s3.amazonaws.com/2006-03-01'>"+("<LoggingEnabled><TargetBucket>"+av+"</TargetBucket><TargetPrefix>"+au+"</TargetPrefix>"+ao+"</LoggingEnabled></BucketLoggingStatus>");return Z.putBucketProperty(aq,ar,Z.bucketPropertiesMap.logging.name,at).then(function(aw){m.logRequestComplete("enableBucketLogging",aq);return aw})["catch"](function(aw){m.log("enableBucketLogging",0,aq,{bucketName:ar,error:aw});return f.reject(y.handleErrors(aw))})}function C(ap,ao){m.log("disableBucketLoggingReceived",1,ao,{bucketName:ap});var aq="<BucketLoggingStatus xmlns='http://doc.s3.amazonaws.com/2006-03-01/' />";return Z.putBucketProperty(ao,ap,Z.bucketPropertiesMap.logging.name,aq).then(function(ar){m.logRequestComplete("disableBucketLogging",ao);return ar})["catch"](function(ar){m.log("disableBucketLogging",0,ao,{bucketName:ap,error:ar});return f.reject(y.handleErrors(ar))})}function ad(ar,aq,ap){var at={Tagging:{TagSet:{Tag:[]}}};angular.forEach(aq,function(au){at.Tagging.TagSet.Tag.push({Key:au.Key,Value:au.Value})});var ao=P.jsonToXml(at);m.log("putBucketTaggingReceived",1,ap,{bucketName:ar});return Z.putBucketProperty(ap,ar,Z.bucketPropertiesMap.tagging.name,ao).then(function(au){m.logRequestComplete("putBucketTagging",ap);return au})["catch"](function(au){m.log("putBucketTagging",0,ap,{bucketName:ar,error:au});return f.reject(y.handleErrors(au))})}function aa(aq,ap,ao){m.log("deleteBucketTaggingReceived",1,ao,{bucketName:aq});return Z.deleteBucketProperty(ao,aq,Z.bucketPropertiesMap.tagging.name).then(function(ar){m.logRequestComplete("deleteBucketTagging",ao);return ar})["catch"](function(ar){m.log("deleteBucketTagging",0,ao,{bucketName:aq,error:ar});return f.reject(y.handleErrors(ar))})}function K(ar,at,ap,au,aq){m.log("putBucketWebsiteReceived",1,aq,{bucketName:ar});var ao="<WebsiteConfiguration xmlns='http://s3.amazonaws.com/doc/2006-03-01/'>"+("<IndexDocument><Suffix>"+at+"</Suffix></IndexDocument>");ao+=ap?"<ErrorDocument><Key>"+ap+"</Key></ErrorDocument>":"";ao+=au+"</WebsiteConfiguration>";return Z.putBucketProperty(aq,ar,Z.bucketPropertiesMap.website.name,ao).then(function(av){m.logRequestComplete("putBucketWebsite",aq);return av})["catch"](function(av){m.log("putBucketWebsite",0,aq,{bucketName:ar,error:av});return f.reject(y.handleErrors(av))})}function E(aq,ar,at,ap){m.log("putBucketWebsiteReceived",1,ap,{bucketName:aq});var ao="<WebsiteConfiguration xmlns='http://s3.amazonaws.com/doc/2006-03-01/'>"+("<RedirectAllRequestsTo><HostName>"+ar+"</HostName>");if(at){ao+="<Protocol>"+at+"</Protocol>"}ao+="</RedirectAllRequestsTo></WebsiteConfiguration>";return Z.putBucketProperty(ap,aq,Z.bucketPropertiesMap.website.name,ao).then(function(au){m.logRequestComplete("putBucketWebsite",ap);return au})["catch"](function(au){m.log("putBucketWebsite",0,ap,{bucketName:aq,error:au});return f.reject(y.handleErrors(au))})}function p(ap,ao){m.log("deleteBucketWebsiteReceived",1,ao,{bucketName:ap});return Z.deleteBucketProperty(ao,ap,Z.bucketPropertiesMap.website.name).then(function(aq){m.logRequestComplete("deleteBucketWebsite",ao);return aq})["catch"](function(aq){m.log("deleteBucketWebsite",0,ao,{bucketName:ap,error:aq});return f.reject(y.handleErrors(aq))})}function X(ap,ao){m.log("getBucketReplicationReceived",1,ao,{bucketName:ap});return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.replication.name).then(function(aq){m.logRequestComplete("getBucketReplication",ao);return aq})["catch"](function(aq){m.log("getBucketReplication",0,ao,{bucketName:ap});return f.reject(y.handleErrors(aq))})}function d(ar,ap,ao){m.log("putBucketReplicationReceived",1,ap,{bucketName:ar});var aq=t(ao);return Z.putBucketProperty(ap,ar,Z.bucketPropertiesMap.replication.name,aq).then(function(at){m.logRequestComplete("putBucketReplication",ap);return at})["catch"](function(at){m.log("putBucketReplication",0,ap,{bucketName:ar});return f.reject(y.handleErrors(at))})}function t(ao){var ar=[];var ap=ao.destinationBucket.value||ao.destinationBucket;ao.rules.forEach(function(au){var at={ID:au.id,Status:au.status,Prefix:au.prefix,Destination:{Bucket:y.getBucketARN(ap),StorageClass:au.storageClass}};ar.push(at)});if(ar.length===1){ar=ar[0]}var aq={ReplicationConfiguration:{Role:ao.role,Rule:ar}};return P.jsonToXml(aq)}function ah(ap,ao){m.log("deleteBucketReplicationReceived",1,ao,{bucketName:ap});return Z.deleteBucketProperty(ao,ap,Z.bucketPropertiesMap.replication.name).then(function(aq){m.logRequestComplete("deleteBucketReplication",ao);return aq})["catch"](function(aq){m.log("deleteBucketReplication",0,ao,{bucketName:ap});return f.reject(y.handleErrors(aq))})}function H(ar,aq,ao,au,at,ap){m.log("deleteBucketLifecycleReceived",1,ap);return Z.deleteBucketProperty(ap,ar,Z.bucketPropertiesMap.lifecycle.name).then(function(av){m.log("deleteBucketLifecycle",1,ap,{initialXml:aq,finalXml:ao,ruleBeforeEdit:au,ruleAfterEdit:at,"x-amz-id-2":av.headers(an.HEADERS.X_AMZ_ID_2),"x-amz-request-id":av.headers(an.HEADERS.X_AMZ_REQUEST_ID)});return av})["catch"](function(av){m.log("deleteBucketLifecycle",0,ap,{initialXml:aq,finalXml:ao,ruleBeforeEdit:au,ruleAfterEdit:at,error:av});return f.reject(y.handleErrors(av))})}function B(ar,aq,ao,au,at,ap){m.log("putBucketLifecycleReceived",1,ap);return Z.putBucketProperty(ap,ar,Z.bucketPropertiesMap.lifecycle.name,ao).then(function(av){m.log("putBucketLifecycle",1,ap,{initialXml:aq,finalXml:ao,ruleBeforeEdit:au,ruleAfterEdit:at,"x-amz-id-2":av.headers(an.HEADERS.X_AMZ_ID_2),"x-amz-request-id":av.headers(an.HEADERS.X_AMZ_REQUEST_ID)});return av})["catch"](function(av){m.log("putBucketLifecycle",0,ap,{initialXml:aq,finalXml:ao,ruleBeforeEdit:au,ruleAfterEdit:at,error:av});return f.reject(y.handleErrors(av))})}function aj(ap,ao){m.log("getBucketLifecycleReceived",1,ao);return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.lifecycle.name).then(function(aq){if(aq.response){m.log("getBucketLifecycle",1,ao,{content:aq.response});return aq.response}else{m.log("getBucketLifecycle",1,ao,{content:aq});return aq}})["catch"](function(ar){var aq=y.handleErrors(ar);if(ar!==an.LIFECYCLE.LIFECYCLE_DOES_NOT_EXIST_MESSAGE){m.log("getBucketLifecycle",0,ao,{error:ar})}else{m.log("getBucketLifecycle",1,ao,{content:an.LIFECYCLE.LIFECYCLE_DOES_NOT_EXIST_MESSAGE})}return f.reject(aq)})}function x(ap,ao){m.log("getBucketInventoryReceived",1,ao,{bucketName:ap});return Z.getBucketProperty(ap,Z.bucketPropertiesMap.inventory.name).then(function(aq){m.logRequestComplete("getBucketInventory",ao);return aq})["catch"](function(aq){m.log("getBucketInventory",0,ao,{bucketName:ap,error:aq});return f.reject(y.handleErrors(aq))})}function b(ap,aq,ao){m.log("putBucketInventoryReceived",1,ao);return Z.putBucketProperty(ap,Z.bucketPropertiesMap.inventory.name,aq).then(function(ar){m.log("putBucketInventory",1,ao,{content:aq});return ar})["catch"](function(ar){m.log("putBucketInventory",0,ao,{error:ar});return f.reject(y.handleErrors(ar))})}function h(ap,ao){m.log("deleteBucketInventoryReceived",1,ao);return Z.deleteBucketProperty(ap,Z.bucketPropertiesMap.inventory.name).then(function(aq){m.logRequestComplete("deleteBucketInventory",ao);return aq})["catch"](function(aq){m.log("deleteBucketInventory",0,ao,{error:aq});return f.reject(y.handleErrors(aq))})}function W(ap,ao){m.log("getBucketAccelerateReceived",1,ao,{bucketName:ap});return Z.getBucketProperty(ao,ap,Z.bucketPropertiesMap.accelerate.name).then(function(aq){m.logRequestComplete("getBucketAccelerate",ao);var ar=P.convertXmlStringToJson(aq.response);return ar.AccelerateConfiguration&&ar.AccelerateConfiguration.Status})["catch"](function(aq){m.log("getBucketAccelerate",0,ao,{bucketName:ap,error:aq});return f.reject(y.handleErrors(aq))})}function a(aq,ao,ap){var at={},ar=undefined;at.AccelerateConfiguration={};at.AccelerateConfiguration.Status=ap;ar=P.jsonToXml(at);ar=ar.replace("<AccelerateConfiguration>",'<?xml version="1.0" encoding="UTF-8"?> <AccelerateConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">');m.log("putBucketAccelerateReceived",1,ao);return Z.putBucketProperty(ao,aq,Z.bucketPropertiesMap.accelerate.name,ar).then(function(au){m.log("putBucketAccelerate",1,ao,{content:ar});return au})["catch"](function(au){m.log("putBucketAccelerate",0,ao,{content:ar,error:au});return f.reject(y.handleErrors(au))})}}])})();"use strict";(function(){angular.module("s3").service("ObjectPropertiesService",["$q","APIProxyService","CachingService","PathService","S3Constants","SCLogService","UtilService","XMLParser",function(h,c,b,k,g,n,l,i){var e="putObjectTagging";var j="putObjectVersionTagging";function a(p){for(var r in p){var q=p[r];if(q.StorageClass===g.STORAGE_CLASSES.GLACIER){q.downloadDisabled=true;q.deleteDisabled=true}q.StorageClass=l.getStorageClassTranslations()[q.StorageClass]}return p}function m(q,s){var p=undefined;s.downloadDisabled=true;for(var r=0;r<q.length;r++){p=q[r];if(p.LastModified<s.LastModified){q.splice(r,0,s);break}}return q}function f(t,s,r){var p=b.getCurrentVersions(s);if(p){r.isCached=true;n.log(r.name+"IsCached",0,r);return h.resolve(p)}var q=h.defer(),u={bucket:t,prefix:s};r.isCached=false;c.listVersions(r,u).then(function(z){var x=undefined,w=undefined,v=undefined;if(z.response){if(typeof z.response==="string"){x=i.convertXmlStringToJson(z.response).ListVersionsResult}else{if(z.response.ListVersionsResult){x=z.response.ListVersionsResult}else{n.log(r.name+"ListVersionsCall",0,r);q.reject("There is no data in the listVersions response.");return}}w=x.Version;w=l.transformObjectToArray(w);w=_.filter(w,function(A){return A.Key===s});n.log(r.name+"ListVersionsCall",1,r)}else{n.log(r.name+"ListVersionsCall",0,r);q.reject("There is no data in the listVersions response.");return}r.listVersionsResponse=z;v=l.getIconClassFromFilename(s);_.map(w,function(A){A.fileIconClass=v;return A});w=a(w);if(w&&x.DeleteMarker){var y=l.transformObjectToArray(x.DeleteMarker);_.each(y,function(A){A.fileIconClass=g.FILE_EXTENSIONS_ICON_MAP.trash;w=m(w,A)})}b.setCurrentVersions(s,w);q.resolve(w)})["catch"](function(v){q.reject(l.handleErrors(v))});return q.promise}function d(v,t,r,q){var s=k.getCurrentBucket();if(!t){n.log("putObjectTaggingReceived",1,q,{bucketName:s,object:v})}else{n.log("putObjectVersionTaggingReceived",1,q,{bucketName:s,object:v,versionId:t})}var u={Tagging:{TagSet:{Tag:[]}}};angular.forEach(r,function(w){if(w.Key){u.Tagging.TagSet.Tag.push({Key:w.Key,Value:w.Value})}});var p=i.jsonToXml(u);return c.putObjectTag(q,s,v,p,t).then(function(w){if(!t){n.logRequestComplete(e,q)}else{n.logRequestComplete(j,q)}return w})["catch"](function(w){if(!t){n.log(e,0,q,{objectName:v,error:w})}else{n.log(j,0,q,{objectName:v,versionId:t,error:w})}return h.reject(l.handleErrors(w))})}var o={convertToReadableStorageClass:a,insertDeleteMarker:m,listVersions:f,putObjectTagging:d};return o}])})();"use strict";(function(){angular.module("s3").directive("modal",[function(){return{restrict:"E",templateUrl:"/s3/partials/modal.html",scope:{isOpen:"=",closeCallback:"=?",headerTitle:"=",state:"=?",steps:"=?",nextState:"=?",previousState:"=?",setState:"=?"},transclude:true,compile:multiTransclude(),controller:"ModalController"}}]);angular.module("s3").controller("ModalController",["$scope","UtilService",function(b,a){b.closeModal=function(){b.isOpen.flag=false;b.closeCallback();a.bodyFreezeScroll(b.isOpen&&b.isOpen.flag)};b.getState=function(c){var d=Object.keys(b.steps)[c];if(d){return b.steps[d]}return};b.setState=function(c){b.state=c};b.nextState=function(){var c=Object.keys(b.steps).indexOf(b.state.name);b.setState(b.getState(c+1))};b.previousState=function(){var c=Object.keys(b.steps).indexOf(b.state.name);b.setState(b.getState(c-1))}}])})();"use strict";(function(){angular.module("s3").directive("focusWhen",[function(){return{restrict:"A",link:function a(c,d,b){c.$on("focusOn",function(e,f){if(f===b.focusWhen){d[0].focus()}})}}}]);angular.module("s3").factory("focusOn",["$rootScope","$timeout",function(a,b){return function(c){b(function(){a.$broadcast("focusOn",c)})}}])})();"use strict";angular.module("s3").directive("clickoutside",["$document","UUIDService",function(c,a){return{restrict:"A",scope:{onClickOutside:"=",isEnabled:"=?"},link:function b(e,f,d){if(d.id){e.mainElementId=d.id}else{e.mainElementId=a.generateUUID();$(f).attr("id",e.mainElementId)}var g=function g(h){if(e.isEnabled===false){return}if(!h||!h.target){return}for(var i=h.target;i;i=i.parentNode){var j=i.id;if(j!==undefined&&j===e.mainElementId){return}}e.$apply(function(){e.onClickOutside()})};c.on("click",g);e.$on("$destroy",function(){c.off("click",g)})}}}]);"use strict";angular.module("s3").directive("bucketSelector",[function(){return{restrict:"E",controller:"BucketSelectorController",scope:{bucketList:"=?",copySettingsSourceBucket:"=?",operation:"=?",getSourceBucketProperties:"=?",getSourceBucketPermissions:"=?",currBucketPermissions:"=?",defaultAcls:"=?",editable:"=?",selectedReport:"=?",showBucketNameOnly:"=?",chooseAccounts:"=?",isOpen:"=?",sameRegion:"=?"},templateUrl:"/s3/partials/bucketselector.html"}}]);angular.module("s3").controller("BucketSelectorController",["$filter","$scope","$translate","BucketPropertiesService","BucketPropertiesUtilService","APIProxyService","XMLParser","SCLogService","ConsoleOperation","Region","PathService","PermissionsUtilService","S3Constants","UtilService",function(n,r,s,i,f,t,w,b,k,d,c,g,o,v){r.emptyText=s.instant("lamb.nobuckets");r.noSelectedBucketText=s.instant("bucketselector.selecteditem.placeholder");r.filterColumn="Name";var l=c.getCurrentBucket();var j="false";var e="";r.savingBucket=false;r.account={outside:j};r.tmpValues={accountId:"",bucket:"",regionError:""};r.tableFiltering={filter:{}};r.tableFiltering.filter[r.filterColumn]=r.defaultFilterValue;r.filterBlur=function(){if(!r.tableFiltering.filter[r.filterColumn]){r.tableFiltering.showClear=false}};r.clearFilter=function(){r.tableFiltering.filter[r.filterColumn]="";r.tableFiltering.showClear=false};r.filterKeyDown=function(y){if(y&&y.keyCode===o.KEY_CODES.ESC){$(".input-field").blur();r.clearFilter()}};function u(){i.getBucketLocation(r.copySettingsSourceBucket.Name).then(function(y){r.copySettingsSourceBucket.Location=d.twoWayMapping[y];r.selectedReport.Location=r.copySettingsSourceBucket.Location})["catch"](function(y){r.selectedReport.bucketUnknown=s.instant("bucketselector.invalid.bucket");r.selectedReport.bucketError=true})}r.$watch(function(){return r.tableFiltering.filter[r.filterColumn]},function(z,y){if(y!==z){r.selectedItem=null;r.totalItems=n("filter")(r.bucketList,r.tableFiltering.filter).length}});r.toggleDropDown=function(){r.isOpen=!r.isOpen;if(r.bucketList){r.bucketList.forEach(function(y){return y.isExpanded=false})}};r.closeDropDown=function(){r.isOpen=false;if(r.bucketList){r.bucketList.forEach(function(y){return y.isExpanded=false})}};r.getBucketPlaceHolder=function(){var y="bucketselector.selecteditem.placeholder";if(r.editable){y="bucketselector.selecteditem.notoptional.placeholder"}return s.instant(y)};r.getSearchPlaceHolder=function(){var y="bucketselector.inputfield.placeholder";if(r.editable){y="bucketselector.inputfield.enter.placeholder"}return s.instant(y)};r.getResultsMessage=function(){var y="bucketselector.nomatchesfound";if(r.editable&&!r.chooseAccounts){y="bucketselector.cross.account"}return s.instant(y)};function q(y){if(r.editable){r.selectedReport.bucket=y.Name;r.selectedReport.Location=y.Location;r.selectedReport.bucketError=false;r.selectedReport.bucketUnknown=""}}r.savePressed=function(y){r.tmpValues.regionError="";r.savingBucket=true;var z=f.stripBucketARN(r.tmpValues.bucket);if(z.length===0){return}i.getBucketLocation(r.tmpValues.bucket).then(function(A){if(r.sameRegion){var B=d.twoWayMapping[A];if(e!==B){r.tmpValues.regionError=s.instant("management.analytics.bucket.region.error",{dest:B,src:e})}}})["catch"](function(A){r.tmpValues.regionError=s.instant("management.connection.error")})["finally"](function(){if(!r.tmpValues.regionError){r.selectedReport.bucket=r.tmpValues.bucket;r.selectedReport.accountId=r.tmpValues.accountId;r.copySettingsSourceBucket={Name:z,Location:""};r.closeDropDown();r.clearFilter();q(r.copySettingsSourceBucket);u();y.stopPropagation()}r.savingBucket=false})};r.selectBucket=function(B){r.copySettingsSourceBucket=B;q(B);r.getSourceBucketProperties={tagging:{tags:[]},logging:{selectedValue:o.BUCKET_PROPERTIES.DISABLE},versioning:{selectedValue:o.BUCKET_PROPERTIES.DISABLE}};var A=new k("CreateBucketLogging");var z=new k("CreateBucketTagging");var y=new k("CreateBucketVersioning");t.getBucketProperty(z,B.Name,"tagging").then(function(E){var C=E.response;p("getBucketTagging",true,z,"");var D=w.convertXmlStringToJson(C);if(D.Tagging){f.populateTagsFields(D,r.getSourceBucketProperties.tagging.tags)}})["catch"](function(D){var C=v.handleErrors(D);if(C!==o.BUCKET_PROPERTIES.TAGGING.TAG_SET_NOT_EXIST_MESSAGE){p("getBucketTagging",false,z,D);r.getSourceBucketProperties.tagging.isError=true;r.getSourceBucketProperties.tagging.errorMessage=C}else{p("getBucketTagging",true,z,"")}});i.getBucketVersioning(r.copySettingsSourceBucket.Name,y).then(function(C){if(C===o.BUCKET_PROPERTIES.VERSIONING.ENABLED){r.getSourceBucketProperties.versioning.selectedValue=o.BUCKET_PROPERTIES.ENABLE}else{r.getSourceBucketProperties.versioning.selectedValue=o.BUCKET_PROPERTIES.DISABLE}})["catch"](function(C){r.getSourceBucketProperties.versioning.isError=true;r.getSourceBucketProperties.versioning.errorMessage=C});t.getBucketProperty(A,r.copySettingsSourceBucket.Name,"logging").then(function(D){var C=D.response;p("getBucketLogging",true,A,"");if(C){f.populateLoggingFields(C,r.getSourceBucketProperties.logging)}})["catch"](function(C){p("getBucketLogging",false,A,C);r.getSourceBucketProperties.logging.isError=true;r.getSourceBucketProperties.logging.errorMessage=v.handleErrors(C)});m();r.isOpen=false;if(!r.account.outside&&r.selectedReport){r.tmpValues.accountId="";r.tmpValues.bucket="";r.tmpValues.regionError=""}};function p(z,B,y,A){B===true?b.log(z,1,y,{bucketName:r.copySettingsSourceBucket.Name}):b.log(z,0,y,{bucketName:r.copySettingsSourceBucket.Name,error:A})}function m(){var y=new k(o.BUCKET_PERMISSIONS.CREATE_BUCKET_PERMISSIONS);i.getBucketGrantees(r.copySettingsSourceBucket.Name,y).then(function(z){p("getBucketGrantees",true,y,"");r.getSourceBucketPermissions.grantees=z;i.getBucketACL(r.copySettingsSourceBucket.Name,y).then(function(A){p("getBucketAcls",true,y,"");r.getSourceBucketPermissions.aclGrants=A?Array.isArray(A)?A:[A]:A;g.populateAclsFields(r.currBucketPermissions,r.getSourceBucketPermissions.grantees)})["catch"](function(A){p("getBucketAcls",false,y,A);r.getSourceBucketPermissions.aclGrants.isError=true;r.getSourceBucketPermissions.aclGrants.errorMessage=A})})["catch"](function(z){p("getBucketGrantees",false,y,z);r.getSourceBucketPermissions.grantees.isError=true;r.getSourceBucketPermissions.grantees.errorMessage=v.data})}r.deselectBucket=function(){if(!r.editable){r.copySettingsSourceBucket=undefined;r.getSourceBucketProperties={tagging:{tags:[]},logging:{selectedValue:o.BUCKET_PROPERTIES.DISABLE},versioning:{selectedValue:o.BUCKET_PROPERTIES.DISABLE}};r.getSourceBucketPermissions.aclGrants={};r.getSourceBucketPermissions.grantees={};r.currBucketPermissions.publicPermissions=_.cloneDeep(r.defaultAcls.publicPermissions);r.currBucketPermissions.userPermissions=_.cloneDeep(r.defaultAcls.userPermissions)}m();r.isOpen=false;if(!r.account.outside&&r.selectedReport){r.tmpValues.accountId=null;r.tmpValues.regionError=""}};function p(z,B,y,A){B===true?b.log(z,1,y,{bucketName:r.copySettingsSourceBucket.Name}):b.log(z,0,y,{bucketName:r.copySettingsSourceBucket.Name,error:A})}function m(){var y=new k(o.BUCKET_PERMISSIONS.CREATE_BUCKET_PERMISSIONS);i.getBucketGrantees(r.copySettingsSourceBucket.Name,y).then(function(z){p("getBucketGrantees",true,y,"");r.getSourceBucketPermissions.grantees=z;i.getBucketACL(r.copySettingsSourceBucket.Name,y).then(function(A){p("getBucketAcls",true,y,"");r.getSourceBucketPermissions.aclGrants=A?Array.isArray(A)?A:[A]:A;g.populateAclsFields(r.currBucketPermissions,r.getSourceBucketPermissions.grantees)})["catch"](function(A){p("getBucketAcls",false,y,A);r.getSourceBucketPermissions.aclGrants.isError=true;r.getSourceBucketPermissions.aclGrants.errorMessage=A})})["catch"](function(z){p("getBucketGrantees",false,y,z);r.getSourceBucketPermissions.grantees.isError=true;r.getSourceBucketPermissions.grantees.errorMessage=z})}r.deselectBucket=function(){if(!r.editable){r.copySettingsSourceBucket=undefined;r.getSourceBucketProperties={tagging:{tags:[]},logging:{selectedValue:o.BUCKET_PROPERTIES.DISABLE},versioning:{selectedValue:o.BUCKET_PROPERTIES.DISABLE}};r.getSourceBucketPermissions.aclGrants={};r.getSourceBucketPermissions.grantees={};r.currBucketPermissions.publicPermissions=_.cloneDeep(r.defaultAcls.publicPermissions);r.currBucketPermissions.userPermissions=_.cloneDeep(r.defaultAcls.userPermissions)}};r.toggleBucket=function(y,z){z.isExpanded=!z.isExpanded;y.stopPropagation();if(z.isExpanded){b.log("getPropertiesForBucketSelector",1,r.operation,{bucketName:z.Name});z.propertyCount=0;i.getBucketGranteeCounts(z.Name).then(function(A){z.permissionCount=A;z.granteeCount=z.permissionCount.READ+z.permissionCount.WRITE+z.permissionCount.READ_ACP+z.permissionCount.WRITE_ACP});i.isLoggingEnabled(z.Name).then(function(A){if(A){z.loggingStatus=s.instant("bucketproperty.enabled");z.propertyCount++}else{z.loggingStatus=s.instant("bucketproperty.disabled")}});i.getVersioningStatus(z.Name).then(function(A){if(A==="Enabled"){z.versioningStatus=s.instant("bucketproperty.enabled");z.propertyCount++}else{if(A==="Suspended"){z.versioningStatus=s.instant("bucketproperty.suspended")}else{z.versioningStatus=s.instant("bucketproperty.disabled")}}});i.getTagCount(z.Name).then(function(A){z.tagCount=A})}};function h(y){var z=arguments.length<=1||arguments[1]===undefined?true:arguments[1];b.log("LoadBucketsReceived",1,y);t.listAllMyBuckets(y,z).then(function(B){b.log("listAllMyBuckets",1,y);var A=B.response.ListAllMyBucketsResult.Buckets.Bucket;if(A&&A.length>0){(function(){var C=A.length;A.forEach(function(D){i.getBucketLocation(D.Name).then(function(E){D.Location=d.twoWayMapping[E];if(D.Name===l){e=D.Location}})["finally"](function(){C--;if(C<=0){if(r.sameRegion&&e){var E=_.filter(A,function(F){return F.Location===e});r.bucketList=E}else{r.bucketList=A}}})})})()}else{r.bucketList=[]}})["catch"](function(A){b.log("listAllMyBuckets",0,y);r.bucketList=[]})}function x(){var y=new k(BUCKET_PERMISSIONS.GET_BUCKET_OWNER);t.getBucketOwner(y).then(function(z){b.log("getBucketOwner",1,y);r.perms.currPermissions.ownerName=z.DisplayName;r.perms.defaultAcls.userPermissions[0].detail=_.clone(z);r.perms.currPermissions.userPermissions[0].detail=_.clone(z)})["catch"](function(z){b.log("getBucketOwner",0,y);r.perms.sourceBucketPermissions.owner.isError=true;r.perms.sourceBucketPermissions.owner.errorMessage=v.handleErrors(z)})}function a(){r.outside=false;if(r.chooseAccounts&&r.selectedReport.bucket){r.tmpValues.bucket=r.selectedReport.bucket;r.tmpValues.accountId=r.selectedReport.accountId;r.tmpValues.regionError=""}if(!r.bucketList&&r.editable){r.operation=new k("SelectBucket");var z={};var y=o.BUCKET_PROPERTIES;var A=o.BUCKET_PERMISSIONS;z.createBucketProperties={getResponse:{tagging:{tags:[]},logging:{selectedValue:y.DISABLE},versioning:{selectedValue:y.DISABLE}}};z.sourceBucketPermissions={grantees:{},aclGrants:{}};z.currPermissions=_.cloneDeep(A.INITIALIZE_ACLS);z.createBucketValues={firstLoad:true,copySettingsSourceBucket:null};z.operation=new k("CreateBucket","CreateBucketRequestReceived");z.defaultAcls=_.cloneDeep(A.INITIALIZE_ACLS);r.copySettingsSourceBucket={};if(r.selectedReport&&r.selectedReport.bucket){r.copySettingsSourceBucket.Name=r.selectedReport.bucket}r.getSourceBucketProperties=z.createBucketProperties.getResponse;r.getSourceBucketPermissions=z.sourceBucketPermissions;r.currBucketPermissions=z.createBucketValues.copySettingsSourceBucket;r.defaultAcls=z.defaultAcls;h(r.operation)}}a()}]);"use strict";(function(){angular.module("s3").directive("operationManager",[function(){return{restrict:"AE",scope:{selectedTab:"="},templateUrl:"/s3/partials/progressbar.html",controller:"ProgressbarController"}}]);angular.module("s3").controller("ProgressbarController",["$filter","$scope","$translate","OperationDispatcherService","$window","SCLogService","S3Constants",function(f,a,e,h,g,d,c){a.isExpanded=false;a.thresholdPercentage=c.OPERATION.THRESHOLD_PERCENTAGE;a.$watch(function(i){return i.isExpanded&&i.showingOperations===i.allOperations.ongoingOperations&&i.totalOngoingOperations.length>0},function(i){a.isExpanded=i});a.modalOpen={flag:false};a.detailOperation=null;a.allOperations={ongoingOperations:a.totalOngoingOperations,completedOperations:a.completedOperations,incompleteOperations:a.incompleteOperations};a.$watch(function(i){i.allOperations.ongoingOperations=i.totalOngoingOperations;i.allOperations.completedOperations=i.completedOperations;i.allOperations.incompleteOperations=i.incompleteOperations;return i.allOperations},function(i){a.allOperations=i});a.showingOperations=a.allOperations.ongoingOperations;a.totalOperationCount=Object.keys(h.getAllOperations()).length;a.$watch(function(){return Object.keys(h.getAllOperations()).length},function(i){a.totalOperationCount=i});a.incompleteOperations=[];a.$watch(function(i){i.incompleteOperations.length=0;h.getOperationsWithState(c.OPERATION_STATE.ERROR,i.incompleteOperations);var j=[];h.getOperationsWithState(c.OPERATION_STATE.CANCEL,j);j.forEach(function(k){i.incompleteOperations.push(k)});return i.incompleteOperations},function(i){a.incompleteOperations=i});a.completedOperations=[];a.$watch(function(i){i.completedOperations.length=0;h.getOperationsWithState(c.OPERATION_STATE.COMPLETED,i.completedOperations);return i.completedOperations},function(i){a.completedOperations=i});a.waitingOperations=h.getWaitingOperations();a.ongoingOperations=h.getOngoingOperations();a.totalOngoingOperations=[];var b=0;a.$watch(function(j){b=j.totalOngoingOperations.length;if(j.totalOngoingOperations.length===Object.keys(j.ongoingOperations).length+j.waitingOperations.length){j.totalOngoingOperations.length=0}else{j.totalOngoingOperations=[]}for(var k in j.ongoingOperations){j.totalOngoingOperations.push(j.ongoingOperations[k])}j.waitingOperations.forEach(function(i){j.totalOngoingOperations.push(i)});return j.totalOngoingOperations},function(i){if(b<i.length){a.expandOrCollapseOperations(a.totalOngoingOperations,true,"ongoingOperations")}else{if(b!==0&&i.length===0){a.operationState.ongoingOperations=false}}a.totalOngoingOperations=i});a.expandOrCollapseOperations=function(l,k,j){var i=a.showingOperations!==l;a.operationState={ongoingOperations:false,completedOperations:false,incompleteOperations:false};a.operationState[j]=!a.isExpanded&&k;a.showingOperations=l;if(a.showingOperations.length===0){a.isExpanded=false;return}a.isExpanded=i&&a.showingOperations.length>0||!a.isExpanded};a.openModal=function(i){a.modalOpen.flag=true;a.detailOperation=i;a.detailCancelButtonText=i.state===c.OPERATION_STATE.ACTIVE?e.instant("operation.detail.cancel"):e.instant("operation.detail.close")};a.cancelOperation=function(i){if(i.state===c.OPERATION_STATE.ACTIVE){if(g.confirm(e.instant("operation.warning.cancel"))){d.log(c.PROGRESS_BAR.USER_CONFIRM_CANCEL_FROM_PROGRESS_BAR,1,i);h.cancelOperation(i)}}else{h.cancelOperation(i)}if(i===a.detailOperation){a.modalOpen.flag=false;a.detailOperation=null}};a.cancelFromDetailView=function(i){if(i.state===c.OPERATION_STATE.ACTIVE){if(g.confirm(e.instant("operation.warning.cancel"))){d.log(c.PROGRESS_BAR.USER_CONFIRM_CANCEL_FROM_DETAIL_MODAL,1,i);h.cancelOperation(i);a.modalOpen.flag=false}}else{a.modalOpen.flag=false}};a.closeDetailView=function(){a.modalOpen.flag=false;a.detailOperation=null};a.getIconForOperation=function(i){var l="cog",n="files-o",k="key",j="trash-o",m="upload";switch(i){case c.OPERATION_NAME.MAKE_PUBLIC:case c.OPERATION_NAME.CHANGE_STORAGE_CLASS:case c.OPERATION_NAME.INITIATE_RESTORE:return l;case c.OPERATION_NAME.CHANGE_SSE:return k;case c.OPERATION_NAME.DELETE_OBJECTS:case c.OPERATION_NAME.RESTORE_OBJECTS:case c.OPERATION_NAME.DELETE_BUCKET:case c.OPERATION_NAME.EMPTY_BUCKET:return j;case c.OPERATION_NAME.UPLOAD:return m;case c.OPERATION_NAME.COPY:case c.OPERATION_NAME.CUT:case c.OPERATION_NAME.ADD_OBJECT_TAG:case c.OPERATION_NAME.RENAME:return n}}}])})();"use strict";(function(){angular.module("s3").directive("detailProgress",[function(){return{restrict:"AE",templateUrl:"/s3/partials/detailprogress.html",scope:{isOpen:"=",cancelButtonText:"=",targetOperation:"=",closeCallback:"=?",cancelOperationFunction:"=?"},controller:"detailProgressController"}}]);angular.module("s3").controller("detailProgressController",["$scope","UtilService","S3Constants",function(b,a,c){b.deleteBucketOperationName=c.OPERATION_NAME.DELETE_BUCKET;b.getFileIconClass=function(d){return a.getIconClassFromFilename(d)}}])})();"use strict";(function(){angular.module("s3").directive("bucketVersioning",[function(){return{restrict:"E",scope:{cardOpen:"=",versioning:"=",forCreateBucketModal:"=?",replication:"=?",id:"@?"},templateUrl:"/s3/partials/bucketversioning.html",controller:"BucketVersioningController"}}]);angular.module("s3").controller("BucketVersioningController",["$scope","$timeout","$translate","AwsUrlsService","BucketPropertiesService","ConsoleOperation","PathService","S3Constants","SCLogService","UtilService",a]);function a(p,d,b,e,f,k,l,i,o,n){p.docLink=e.getDocUrl(i.LEARN_MORE_LINKS.VERSIONING);p.versioningError=false;p.versioningStates={enable:"enable",disable:"disable"};var c="enable",j="disable";var h=new k("BucketVersioning","getVersioning");function g(){var s=document.getElementById(i.BUCKET_PROPERTIES.VERSIONING.CREATE_BUCKET_CARD);s.scrollIntoView()}p.cardSummaryObj=_.cloneDeep(i.CARD_SUMMARY_INIT);p.cardSummaryObj.inactiveSummary.text=b.instant("bucketproperty.disabled");p.cardSummaryObj.activeSummary.text=b.instant("bucketproperty.enabled");function r(){p.cardSummaryObj.isActive=p.versioning.selectedValue===p.versioningStates.enable}p.getBucketVersioning=function(){var s=l.getCurrentBucket();f.getBucketVersioning(s,h).then(function(t){p.versioningError=false;if(t==="Enabled"){p.versioning.selectedValue=angular.copy(p.versioningStates.enable)}else{p.versioning.selectedValue=angular.copy(p.versioningStates.disable)}p.cachedVersioning=angular.copy(p.versioning);r()})["catch"](function(t){p.versioningError=true;p.versioningErrorMessage=t;p.cachedVersioning=angular.copy(p.versioning)})};function q(s){if(p.versioning.selectedValue===c&&p.cachedVersioning.selectedValue===j){p.versioningWarningMsg=s?b.instant("bucketversioning.enablewarning"):null}else{if(p.versioning.selectedValue===j&&p.cachedVersioning.selectedValue===c){p.versioningWarningMsg=s?b.instant("bucketversioning.disablewarning"):null}else{p.versioningWarningMsg=null}}}p.updateWarningMsg=function(){m()};function m(){var s=new k(i.LIFECYCLE.BUCKET_LIFECYCLE);s.step=i.LIFECYCLE.GET_BUCKET_LIFECYCLE;f.getBucketLifecycle(l.getCurrentBucket(),s).then(function(){q(true)})["catch"](function(){q(false)})}if(p.forCreateBucketModal){p.$watch("cardOpen",function(t,s){d(g,1)});if(!_.isEmpty(p.versioning)&&p.versioning.errorMessage){p.versioningError=true;p.versioningErrorMessage=p.versioning.errorMessage}p.cachedVersioning=angular.copy(p.versioning);r()}else{p.scrollCardId="#"+p.id;p.getBucketVersioning()}p.cancelBucketVersioning=function(s){n.analyticsTrackClick(i.ANALYTICS.CANCEL_VERSIONING,i.ANALYTICS.DETAILS);s.stopPropagation();p.versioning=angular.copy(p.cachedVersioning);p.versioningError=false;p.versioningErrorMessage="";p.cardOpen=false;p.versioningWarningMsg=null};p.saveBucketVersioning=function(t){n.analyticsTrackClick(i.ANALYTICS.SAVE_VERSIONING,i.ANALYTICS.DETAILS);t.stopPropagation();p.versioningError=false;p.versioningErrorMessage="";var v;var s=null;if(!p.forCreateBucketModal){var u=l.getCurrentBucket();if(p.versioning.selectedValue===p.versioningStates.enable){v=f.enableBucketVersioning;s=new k("enableBucketVersioning")}else{v=f.disableBucketVersioning;s=new k("disableBucketVersioning")}v(u,s).then(function(){p.cachedVersioning.selectedValue=angular.copy(p.versioning.selectedValue);p.cardOpen=false;p.versioningWarningMsg=null;r()})["catch"](function(w){p.versioningError=true;p.versioningErrorMessage=w})}else{p.cachedVersioning=angular.copy(p.versioning);p.cardOpen=false;if(!_.isEmpty(p.replication)){p.replication.isEnabled=i.REPLICATION.DISABLED}r()}}}})();"use strict";(function(){angular.module("s3").directive("bucketTagging",[function(){return{restrict:"E",scope:{cardOpen:"=",bucketTags:"=",forCreateBucketModal:"=?",id:"@?"},templateUrl:"/s3/partials/buckettagging.html",controller:"BucketTaggingController"}}]);angular.module("s3").controller("BucketTaggingController",["$scope","$timeout","$translate","APIProxyService","AwsUrlsService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","PathService","S3Constants","SCLogService","UtilService","XMLParser",a]);function a(p,d,b,c,e,f,j,l,m,i,o,n,k){p.docLink=e.getDocUrl(i.LEARN_MORE_LINKS.TAGGING);p.tagError=false;p.tagErrorMessage="";p.cachedBucketTags={tags:[]};p.tagCount=0;p.cardSummaryObj=_.cloneDeep(i.CARD_SUMMARY_INIT);function q(){p.cardSummaryObj.isActive=p.tagCount>0;if(p.tagCount>0){p.cardSummaryObj.activeSummary.text=p.tagCount+b.instant("bucketproperties.tagging.summarylable")}else{p.cardSummaryObj.inactiveSummary.text=p.tagCount+b.instant("bucketproperties.tagging.summarylable")}}p.cancelBucketTagging=function(r){n.analyticsTrackClick(i.ANALYTICS.CANCEL_TAGGING,i.ANALYTICS.DETAILS);r.stopPropagation();p.bucketTags.tags=angular.copy(p.cachedBucketTags.tags);p.tagError=false;p.tagErrorMessage="";p.cardOpen=false};p.removeTag=function(r){p.bucketTags.tags.splice(r,1)};p.addTag=function(){p.bucketTags.tags.push({Key:"",Value:""})};var h=new l("BucketTagging","getTagging");function g(){var r=document.getElementById(i.BUCKET_PROPERTIES.TAGGING.CREATE_BUCKET_CARD);r.scrollIntoView()}p.getBucketTags=function(){p.cachedBucketTags.tags=angular.copy(p.bucketTags.tags);o.log("getBucketTaggingReceived",1,h,{bucketName:m.getCurrentBucket()});c.getBucketProperty(h,m.getCurrentBucket(),"tagging").then(function(t){var r=t.response;o.logRequestComplete("getBucketTagging",h);p.tagError=false;if(r){var s=k.convertXmlStringToJson(r);if(s.Tagging){j.populateTagsFields(s,p.bucketTags.tags);p.tagCount=s.Tagging.TagSet.Tag.length||1}}p.cachedBucketTags.tags=angular.copy(p.bucketTags.tags);q()})["catch"](function(s){var r=n.handleErrors(s);if(s!==i.BUCKET_PROPERTIES.TAGGING.TAG_SET_NOT_EXIST_MESSAGE){o.log("getBucketTagging",0,h,{bucketName:bucketName,error:s});p.tagError=true;p.tagErrorMessage=r}else{o.logRequestComplete("getBucketTagging",h)}p.cachedBucketTags.tags=angular.copy(p.bucketTags.tags);q()})};if(!p.forCreateBucketModal){p.scrollCardId="#"+p.id;p.getBucketTags()}else{p.$watch("cardOpen",function(s,r){d(g,1)});if(!_.isEmpty(p.bucketTags.tags)&&p.bucketTags.errorMessage){p.tagError=true;p.tagErrorMessage=p.bucketTags.errorMessage}p.cachedBucketTags.tags=angular.copy(p.bucketTags.tags);p.tagCount=p.bucketTags&&p.bucketTags.tags.length?p.bucketTags.tags.length:0;q()}p.saveBucketTagging=function(u){n.analyticsTrackClick(i.ANALYTICS.SAVE_TAGGING,i.ANALYTICS.DETAILS);u.stopPropagation();p.tagError=false;p.tagErrorMessage="";if(!p.forCreateBucketModal){var s=m.getCurrentBucket();var t=p.bucketTags.tags;var v=undefined;var r=null;if(t.length>0){v=f.putBucketTagging;r=new l("putBucketTagging")}else{v=f.deleteBucketTagging;r=new l("deleteBucketTagging")}v(s,t,r).then(function(){p.tagCount=p.bucketTags.tags.length;p.cardOpen=false;p.cachedBucketTags.tags=angular.copy(p.bucketTags.tags);q()})["catch"](function(w){p.tagError=true;p.tagErrorMessage=w})}else{p.cachedBucketTags.tags=angular.copy(p.bucketTags.tags);p.tagCount=p.bucketTags.tags.length;p.cardOpen=false;q()}}}})();"use strict";(function(){angular.module("s3").directive("bucketLogging",[function(){return{restrict:"E",scope:{cardOpen:"=",logging:"=",forCreateBucketModal:"=?",bucketList:"=?",createBucketValues:"=?",id:"@?"},templateUrl:"/s3/partials/bucketlogging.html",controller:"BucketLoggingController"}}]);angular.module("s3").controller("BucketLoggingController",["$location","$filter","$scope","$timeout","$translate","APIProxyService","AwsUrlsService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","PathService","S3Constants","SCLogService","UtilService",a]);function a(j,m,o,s,p,q,b,k,g,l,d,n,c,t){o.saving=false;o.docLink=b.getDocUrl(n.LEARN_MORE_LINKS.LOGGING);o.cachedLogging={};o.logging.targetBucketOptions=[];o.loggingError=false;o.resetLoggingValue=true;o.loggingErrorMessage="";o.loggingState={enable:"enable",disable:"disable"};o.cancelBucketLogging=function(u){t.analyticsTrackClick(n.ANALYTICS.CANCEL_LOGGING,n.ANALYTICS.DETAILS);u.stopPropagation();o.logging=angular.copy(o.cachedLogging);o.cardOpen=false;o.loggingError=false;o.loggingErrorMessage="";f()};o.cardSummaryObj=_.cloneDeep(n.CARD_SUMMARY_INIT);o.cardSummaryObj.activeSummary.text=p.instant("bucketproperty.enabled");o.cardSummaryObj.inactiveSummary.text=p.instant("bucketproperty.disabled");f();function f(){o.cardSummaryObj.isActive=o.logging.selectedValue===o.loggingState.enable}function r(u){o.loggingError=true;o.loggingErrorMessage=u}function e(v,u){v.push({Grantee:{Type:n.BUCKET_PROPERTIES.GROUP_GANTEE_TYPE,DisplayName:"",EmailAddress:"",ID:"",URI:n.BUCKET_PROPERTIES.LOG_DELIVERY_GROUP},Permission:u})}function h(){var u=document.getElementById(n.BUCKET_PROPERTIES.LOGGING.CREATE_BUCKET_CARD);u.scrollIntoView()}function i(x,u,v){var w=arguments.length<=3||arguments[3]===undefined?null:arguments[3];if(_.isEmpty(w)){k.getBucketLocation(v).then(function(y){x.forEach(function(z){k.getBucketLocation(z.Name).then(function(A){if(y===A){u.push({value:z.Name,text:z.Name});o.cachedLogging.targetBucketOptions=_.cloneDeep(u)}})})})}else{u.push({value:o.createBucketValues.name,text:o.createBucketValues.name});o.cachedLogging.targetBucketOptions=_.cloneDeep(u);x.forEach(function(y){k.getBucketLocation(y.Name).then(function(z){if(w&&w.value===z){u.push({value:y.Name,text:y.Name});if(y.Name===o.logging.targetBucket&&o.resetLoggingValue){o.resetLoggingValue=false}o.cachedLogging.targetBucketOptions=_.cloneDeep(u)}})});if(o.createBucketValues.name===o.logging.targetBucket&&o.resetLoggingValue){o.resetLoggingValue=false}}}o.getBucketLogging=function(){var u=new l("BucketLogging","getLogging");var v=d.getCurrentBucket();c.log("getBucketLoggingReceived",1,u,{bucketName:v});u.step="listAllMyBuckets";q.listAllMyBuckets(u).then(function(y){var w=y.response;c.log("ListAllMyBuckets",1,u,{bucketName:v});var x=w.ListAllMyBucketsResult.Buckets.Bucket;i(x,o.logging.targetBucketOptions,v)})["catch"](function(w){c.log("ListAllMyBuckets",0,u,{bucketName:v,error:w});o.loggingError=true;o.loggingErrorMessage=t.handleErrors(w)});u.step="getBucketLogging";q.getBucketProperty(u,v,"logging").then(function(x){var w=x.response;o.loggingError=false;c.logRequestComplete("getBucketLogging",u);if(w){g.populateLoggingFields(w,o.logging);o.cachedLogging=angular.copy(o.logging);f()}})["catch"](function(w){c.log("getBucketLogging",0,u,{bucketName:v,error:w});o.loggingError=true;o.loggingErrorMessage=t.handleErrors(w);o.cachedLogging=angular.copy(o.logging)})};if(o.forCreateBucketModal){o.$watch("cardOpen",function(v,u){s(h,1)});i(o.bucketList,o.logging.targetBucketOptions,o.createBucketValues.name,o.createBucketValues.region);o.$watch("resetLoggingValue",function(u){if(u){o.logging.selectedValue=n.BUCKET_PROPERTIES.DISABLE;o.cachedLogging.selectedValue=angular.copy(o.logging.selectedValue);f()}});if(!_.isEmpty(o.logging)&&o.logging.errorMessage){o.loggingError=true;o.loggingErrorMessage=o.logging.errorMessage}o.cachedLogging=angular.copy(o.logging)}else{o.scrollCardId="#"+o.id;o.getBucketLogging()}o.saveBucketLogging=function(v){t.analyticsTrackClick(n.ANALYTICS.SAVE_LOGGING,n.ANALYTICS.DETAILS);v.stopPropagation();o.loggingError=false;o.loggingErrorMessage="";if(!o.forCreateBucketModal){var x;var w;var u;(function(){o.saving=true;var y=d.getCurrentBucket();x=o.logging.targetBucket;w=o.logging.targetPrefix;u=o.logging.targetGrants;if(!Array.isArray(u)){var z=u;u=[z]}if(o.logging.selectedValue===o.loggingState.enable){(function(){var A=new l(n.BUCKET_PROPERTIES.LOGGING.ENABLE_BUCKET_LOGGING);A.step=n.BUCKET_PROPERTIES.GET_BUCKET_ACL;k.getBucketACL(x,A).then(function(B){var C=t.transformObjectToArray(B);e(C,n.ACL_PERMISSIONS.WRITE);e(C,n.ACL_PERMISSIONS.READ_ACP);A.step=n.BUCKET_PROPERTIES.PUT_BUCKET_ACL;k.putBucketACL(x,C,A).then(function(){A.step=n.BUCKET_PROPERTIES.LOGGING.ENABLE_BUCKET_LOGGING;k.enableBucketLogging(y,x,w,u,A).then(function(){o.cachedLogging=_.cloneDeep(o.logging);f();o.cardOpen=false;o.saving=false})["catch"](function(D){r(D);o.saving=false})})["catch"](function(D){r(D);o.saving=false})})["catch"](function(B){r(B);o.saving=false})})()}else{k.disableBucketLogging(y,new l("disableBucketLogging")).then(function(A){o.cachedLogging=_.cloneDeep(o.logging);f();o.cardOpen=false})["catch"](function(A){r(A)})["finally"](function(){o.saving=false})}})()}else{if(!o.logging.targetGrants){o.logging.targetGrants=[]}o.cachedLogging=angular.copy(o.logging);o.cardOpen=false;f()}}}})();"use strict";(function(){angular.module("s3").directive("bucketWebsite",[function(){return{restrict:"E",scope:{cardOpen:"=",website:"=",forCreateBucketModal:"=?",region:"=?",createBucketName:"=?",id:"@?"},templateUrl:"/s3/partials/bucketwebsite.html",controller:"BucketWebsiteController"}}]);angular.module("s3").controller("BucketWebsiteController",["$filter","$scope","$timeout","$translate","$window","APIProxyService","AwsUrlsService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","PathService","S3Constants","SCLogService","UtilService","XMLParser",a]);function a(m,o,r,p,l,q,b,h,e,k,d,n,c,s,t){o.docLink=b.getDocUrl(n.LEARN_MORE_LINKS.WEBSITE);o.websiteErrorMessage="";o.websiteError=false;o.bucketEndpoint="";o.websitePlaceholder=n.BUCKET_PROPERTIES.WEBSITE.INDEX_FILE;o.websiteStates={disable:"disable",useBucket:"useBucket",redirectRequest:"redirectRequest"};function g(){var u=document.getElementById(n.BUCKET_PROPERTIES.WEBSITE.CREATE_BUCKET_CARD);u.scrollIntoView()}o.cardSummaryObj=_.cloneDeep(n.CARD_SUMMARY_INIT);o.cardSummaryObj.inactiveSummary.text=p.instant("bucketproperty.disabled");function i(){o.cardSummaryObj.isActive=o.website.selectedValue!==o.websiteStates.disable;o.cardSummaryObj.activeSummary.text=o.website.selectedValue!==o.websiteStates.disable?o.website.websiteEnabledOption:""}o.cancelBucketWebsite=function(u){s.analyticsTrackClick(n.ANALYTICS.CANCEL_WEBSITE,n.ANALYTICS.DETAILS);u.stopPropagation();o.website=angular.copy(o.cachedWebsite);o.cardOpen=false;o.websiteError=false;o.websiteErrorMessage=""};o.getBucketWebsite=function(){var v=d.getCurrentBucket();var u=new k("BucketWebsite","getWebsite");c.log("getBucketWebsiteReceived",1,u,{bucketName:v});q.getBucketProperty(u,v,"website").then(function(x){var w=x.response;c.logRequestComplete("getBucketWebsite",u);o.websiteError=false;e.populateWebsiteFields(w,o.website);o.cachedWebsite=angular.copy(o.website);i()})["catch"](function(x){var w=s.handleErrors(x);if(x!==n.BUCKET_PROPERTIES.WEBSITE.NO_WEBSITE_CONFIGURATION_MESSAGE){c.log("getBucketWebsite",0,u,{bucketName:v,error:x});o.websiteError=true;o.websiteErrorMessage=w}else{c.logRequestComplete("getBucketWebsite",u)}o.cachedWebsite=angular.copy(o.website)})};if(o.forCreateBucketModal){o.$watch("cardOpen",function(v,u){r(g,1)});if(!_.isEmpty(o.website)&&o.website.errorMessage){o.websiteError=true;o.websiteErrorMessage=o.website.errorMessage}var j=o.createBucketName;var f=n.BUCKET_PROPERTIES.WEBSITE.REGION_TO_WEBSITE_ENDPOINT_MAP[o.region];o.bucketEndpoint="http://"+j+"."+f;o.cachedWebsite=angular.copy(o.website)}else{(function(){o.scrollCardId="#"+o.id;var u=d.getCurrentBucket();h.getBucketLocation(u).then(function(w){var v=n.BUCKET_PROPERTIES.WEBSITE.REGION_TO_WEBSITE_ENDPOINT_MAP[w];o.bucketEndpoint="http://"+u+"."+v})["catch"](function(v){o.websiteError=true;o.websiteErrorMessage=v});o.getBucketWebsite()})()}o.openBucketEndpoint=function(){l.open(o.bucketEndpoint,"_blank")};o.saveBucketWebsite=function(w){s.analyticsTrackClick(n.ANALYTICS.SAVE_WEBSITE,n.ANALYTICS.DETAILS);w.stopPropagation();o.websiteError=false;o.websiteErrorMessage="";if(!o.forCreateBucketModal){var x=d.getCurrentBucket();if(o.website.selectedValue===o.websiteStates.useBucket){var z=o.website.indexDocument;var v=o.website.errorDocument;var B=o.website.routingXML?o.website.routingXML:"";var u=new k(n.BUCKET_PROPERTIES.WEBSITE.CONFIGURE_BUCKET_WEBSITE);h.configureBucketWebsite(x,z,v,B,u).then(function(){o.website.websiteEnabledOption=p.instant("bucketproperties.website.footer.buckethosting");o.website.websiteEnabledContent=angular.copy(o.website.indexDocument);o.cardOpen=false;o.website.targetDomain="";o.website.redirectRequestProtocol="";o.cachedWebsite=angular.copy(o.website);i()})["catch"](function(C){o.websiteError=true;o.websiteErrorMessage=C})}else{if(o.website.selectedValue===o.websiteStates.redirectRequest){var y=o.website.targetDomain;var A=o.website.redirectRequestProtocol;var u=new k(n.BUCKET_PROPERTIES.WEBSITE.REDIRECT_BUCKET_WEBSITE_REQUESTS);h.redirectBucketWebsiteRequests(x,y,A,u).then(function(){o.website.websiteEnabledOption=p.instant("bucketproperties.website.footer.redirectallrequests");o.website.websiteEnabledContent=angular.copy(o.website.targetDomain);o.cardOpen=false;o.website.indexDocument="";o.website.errorDocument="";o.website.routingXML="";o.cachedWebsite=angular.copy(o.website);i()})["catch"](function(C){o.websiteError=true;o.websiteErrorMessage=C})}else{var u=new k("deleteBucketWebsite");h.deleteBucketWebsite(x,u).then(function(){o.cardOpen=false;e.clearAllWebsiteFields(o.website);o.cachedWebsite=angular.copy(o.website);i()})["catch"](function(C){o.websiteError=true;o.websiteErrorMessage=C})}}}else{o.cachedWebsite=angular.copy(o.website);o.cardOpen=false;i()}}}})();"use strict";(function(){angular.module("s3").directive("card",[function(){return{restrict:"E",scope:{isOpen:"=",cardId:"=?",disableExpand:"=?",cardSummaryObj:"=?"},transclude:true,compile:multiTransclude(),templateUrl:"/s3/partials/card.html",controller:"CardController"}}]);angular.module("s3").controller("CardController",["$scope","$timeout","S3Constants","UtilService",a]);function a(c,e,d,b){c.openCard=function(){if(!c.disableExpand){c.isOpen=true}b.analyticsTrackClick(d.ANALYTICS.CARD_OPEN,d.ANALYTICS.DETAILS)};if(c.cardId){c.$watch("isOpen",function(g,f){if(f!==g){e(function(){b.scrollCardToViewSmoothly(c.cardId)},1)}})}}})();"use strict";(function(){angular.module("s3").service("Md5GenerationService",function(){this.getContentMd5=function(a){return require("crypto").createHash("md5").update(a).digest("base64")}})})();"use strict";var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(a){return typeof a}:function(a){return a&&typeof Symbol==="function"&&a.constructor===Symbol?"symbol":typeof a};(function(){angular.module("s3").directive("bucketpermissions",[function(){return{restrict:"E",scope:{},templateUrl:"/s3/partials/bucketpermissions.html",controller:"BucketPermissionsController"}}]);angular.module("s3").controller("BucketPermissionsController",["$filter","$scope","$translate","AwsUrlsService","BucketPropertiesService","ConsoleOperation","PathService","S3Constants","SCLogService","UtilService","PermissionsUtilService",function(h,m,a,c,d,g,i,f,l,k,j){m.permissionTypes=[{text:a.instant("permissions.types.acl"),value:"acl"},{text:a.instant("permissions.types.policy"),value:"policy"},{text:a.instant("permissions.types.cors"),value:"cors"}];m.S3Constants=f;m.policyGenLink=f.BUCKET_PERMISSIONS.POLICY_GEN[k.getCloudSystem()];m.policyDocLink=c.getDocUrl(f.LEARN_MORE_LINKS.PERMISSIONS.POLICY);m.corsDocLink=c.getDocUrl(f.LEARN_MORE_LINKS.PERMISSIONS.CORS);m.permissions={};m.permissions.selectedItem=m.permissionTypes[0];m.bucket=i.getCurrentBucket();m.bucketARN=k.getBucketARN(m.bucket);var e=new g("BucketPermissions","getPermissions");l.log("GetBucketPermissions",1,e,{bucketName:m.bucket});d.getBucketGrantees(m.bucket,e).then(function(n){m.permissionObj={};m.permissionObj.grantees=j.updateGrantees(n);d.getBucketACL(m.bucket,e).then(function(o){m.permissionObj.aclGrants=[];if(o){m.permissionObj.aclGrants=Array.isArray(o)?o:[o]}})["catch"](function(o){m.error=o})})["catch"](function(n){m.error=n});d.getBucketPolicy(m.bucket,e).then(function(n){m.policy=b(n)})["catch"](function(n){m.error=n});d.getBucketCORS(m.bucket,e).then(function(n){if(n){m.cors=n}else{m.cors=f.BUCKET_PERMISSIONS.SAMPLE_CORS_POLICY}})["catch"](function(n){m.error=n});m.showView=function(n){switch(n){case f.BUCKET_PERMISSION_TYPE.CORS:m.permissions.selectedItem={text:a.instant("permissions.types.cors"),value:f.BUCKET_PERMISSION_TYPE.CORS};return;case f.BUCKET_PERMISSION_TYPE.ACL:m.permissions.selectedItem={text:a.instant("permissions.types.acl"),value:f.BUCKET_PERMISSION_TYPE.ACL};return;case f.BUCKET_PERMISSION_TYPE.POLICY:m.permissions.selectedItem={text:a.instant("permissions.types.policy"),value:f.BUCKET_PERMISSION_TYPE.POLICY};return}};m.putAcl=function(n){return d.putBucketACL(m.bucket,n,new g("putBucketACL"))};m.save=function(){if(m.isDeleting){return}m.error=undefined;m.isSaving=true;if(m.permissions.selectedItem.value==="cors"){var n=m.corsEditorSession.getDocument().getValue();d.putBucketCORS(m.bucket,n.trim(),new g("putBucketCORS")).then(function(o){m.corsChanged=false;m.cors=m.corsEditorSession.getDocument().getValue()})["catch"](function(o){m.error=o})["finally"](function(){m.isSaving=false})}else{if(m.permissions.selectedItem.value==="policy"){(function(){var o=m.policyEditorSession.getDocument().getValue();d.putBucketPolicy(m.bucket,o.trim(),new g("putBucketPolicy")).then(function(p){m.policyChanged=false;m.policy=b(JSON.parse(o))})["catch"](function(p){m.error=p})["finally"](function(){m.isSaving=false})})()}}};m.deletePermission=function(){if(m.isSaving){return}m.error=undefined;m.isDeleting=true;if(m.permissions.selectedItem.value==="cors"){d.deleteBucketCORS(m.bucket,new g("deleteBucketCORS")).then(function(){m.corsEditorSession.getDocument().setValue("");m.cors=undefined;m.corsChanged=false})["catch"](function(n){m.error=n})["finally"](function(){m.isDeleting=false})}else{if(m.permissions.selectedItem.value==="policy"){d.deleteBucketPolicy(m.bucket,new g("deleteBucketPolicy")).then(function(){m.policyEditorSession.getDocument().setValue("");m.policy=undefined;m.policyChanged=false})["catch"](function(n){m.error=n})["finally"](function(){m.isDeleting=false})}}};m.cancel=function(){if(m.isSaving||m.isDeleting){return}m.error=undefined;if(m.permissions.selectedItem.value==="cors"){if(m.cors){m.corsEditorSession.getDocument().setValue(m.cors)}else{m.corsEditorSession.getDocument().setValue("")}m.corsChanged=false}else{if(m.permissions.selectedItem.value==="policy"){if(m.policy){m.policyEditorSession.getDocument().setValue(m.policy)}else{m.policyEditorSession.getDocument().setValue("")}m.policyChanged=false}}};m.clearError=function(){m.error=undefined};m.policyEditorLoaded=function(n){m.policyEditorSession=n.getSession();if(m.policy){if(_typeof(m.policy)==="object"){m.policy=b(m.policy)}m.policyEditorSession.getDocument().setValue(m.policy)}m.policyChanged=false};m.policyEditorChanged=function(n){m.policyChanged=true};m.corsEditorLoaded=function(n){m.corsEditorSession=n.getSession();if(m.cors){m.corsEditorSession.getDocument().setValue(m.cors)}m.corsChanged=false};m.corsEditorChanged=function(n){m.corsChanged=true};m.disableSave=function(){if(m.isDeleting){return true}if(m.permissions.selectedItem.value==="policy"){return m.policyEditorSession.getDocument().getValue()===""||!m.policyChanged}return m.corsEditorSession.getDocument().getValue()===""||!m.corsChanged};function b(n){return JSON.stringify(n,null,"    ")}}])})();"use strict";(function(){angular.module("s3").directive("dropdown",function(){return{restrict:"E",controller:"DropdownController",scope:{items:"=",selectedItem:"=",filter:"=",placeholder:"@",disabled:"=?",enableInput:"=?",inputField:"=?"},templateUrl:"/s3/partials/dropdown.html"}});angular.module("s3").controller("DropdownController",["$filter","$scope","S3Constants","$translate",function(d,a,b,c){a.filterColumn="text";a.tableFiltering={filter:{}};if(!a.placeholder){a.selectedItem=a.items[0]}a.tableFiltering.filter[a.filterColumn]=a.defaultFilterValue;a.updateInput=function(e){a.selectedItem=e;e.error=null};a.filterBlur=function(){if(!a.tableFiltering.filter[a.filterColumn]){a.tableFiltering.showClear=false}};a.clearFilter=function(){a.tableFiltering.filter[a.filterColumn]="";a.tableFiltering.showClear=false};a.filterKeyDown=function(e){if(e&&e.keyCode===b.KEY_CODES.ESC){$(".input-field").blur();a.clearFilter()}};a.$watch(function(){return a.tableFiltering.filter[a.filterColumn]},function(f,e){if(e!==f){a.selectedItem=null;a.totalItems=d("filter")(a.items,a.tableFiltering.filter).length}});a.toggleDropDown=function(e){if(!e){a.isOpen=!a.isOpen}};a.closeDropDown=function(){a.isOpen=false};a.selectItem=function(e){a.selectedItem=_.cloneDeep(e);if(a.enableInput&&a.inputField){a.inputField.text=e.text||e;a.inputField.error=null}if(a.selectedItem.displayTextField){a.selectedItem.inputValue=a.selectedItem.value}a.closeDropDown()};a.toggleBucket=function(e,f){f.isExpanded=!f.isExpanded;e.stopPropagation()}}])})();"use strict";(function(){angular.module("s3").directive("versionsDropdown",[function(){return{restrict:"E",controller:"VersionsDropdownController",scope:{selectedTab:"=?",bucket:"=",error:"=",getMetadata:"&?",setUpMetadata:"&?",key:"=",obj:"=",showVersionsDropdown:"=",versionLabel:"=",objectsPage:"=?",updateObjMetadata:"&?",updateObjAcl:"&?",refresh:"&?",objectPropertiesPanel:"=?",versions:"=?"},templateUrl:"/s3/partials/versionsdropdown.html"}}]);angular.module("s3").controller("VersionsDropdownController",["$filter","$scope","$window","$location","$translate","CachingService","ConsoleOperation","DeleteService","ObjectPropertiesService","S3Constants","S3CWSAPIService","SCLogService","UtilService","PathService",function(k,o,c,h,b,a,i,d,g,f,m,n,l,j){function e(){var p="ListVersionsCompleted",q=new i(f.OPERATION_NAME.LIST_VERSIONS);g.listVersions(o.bucket,o.key,q).then(function(r){o.versions=r;o.obj.versionId=r&&r[0]&&r[0].VersionId;n.log(p,1,q,{objectKey:o.key,versions:r})})["catch"](function(r){o.error=r;q.error=r;q.errorMessage=b.instant("versionsdropdown.errorMessage");n.log(p,0,q,r)})}o.closeDropdown=function(){o.showVersionsDropdown.show=false};o.deleteVersion=function(s,q){s.stopPropagation();if(!q||!q.Key){return}if(q.deleteDisabled){return}var p="DeleteVersion",r=new i(p);d.deleteKeysAndVersions(r,[{Key:q.Key,VersionId:q.VersionId}],{}).then(function t(w){var x=q.IsLatest==="true";var u=o.versions.length,v=Object.keys(w.result).length;o.versions=_.filter(o.versions,function(z){var y=w.result[z.Key+":"+z.VersionId],A=y?y.status:"";return A!==f.OPERATION_PER_KEY_STATUS.DONE});if(v!==1){n.log(r.name+"MoreThanOne",1,r,w.result)}else{if(o.versions.length!==u-v){n.log(r.name+"AlreadyDeleted",1,r,w.result)}}a.setCurrentVersions(q.Key,o.versions);if(o.objectsPage&&(_.isEmpty(o.versions)||x)){o.refresh();o.objectPropertiesPanel.show=false}})["catch"](function(u){o.error=u})};o.downloadVersion=function(s,p){s.stopPropagation();if(p.downloadDisabled){return}var r={"Content-Disposition":"attachment"};var q=new i("objectDownload","objDLPresignFetchStart");m.fetchPresignedUrl(o.bucket,p.Key,"GET",r,{versionId:p.VersionId},null,null,q).then(function(t){c.location.href=t.data.presignedUrl;n.log("fetchPresignedUrl",1,q,{bucket:o.bucket,key:p.Key})})["catch"](function(t){n.log("fetchPresignedUrl",0,q,t);o.error=t})};o.switchVersion=function(r,p){var q=new i(f.OPERATION_NAME.SWITCH_VERSION);r.stopPropagation();n.log(f.OPERATION_NAME.SWITCH_VERSION,1,q,{version:p});if(p.ETag&&!o.objectsPage){o.getMetadata({operation:q,versionId:p.VersionId})}o.obj.versionId=p.VersionId;o.obj.ETag=l.extractFromQuotes(p.ETag);o.obj.IsLatest=p.IsLatest;o.obj.Key=p.Key;if(o.obj.Key.lastIndexOf("/")!==-1){o.obj.Key=o.obj.Key.substring(o.obj.Key.lastIndexOf("/")+1)}o.obj.LastModified=p.LastModified;o.obj.Owner=p.Owner;o.obj.Size=p.Size;o.obj.StorageClass=f.STORAGE_CLASSES[p.StorageClass];o.versionLabel=p.IsLatest==="true"?b.instant("versionsdropdown.label.latestVersion"):k("date")(p.LastModified,"medium");o.showVersionsDropdown.show=false;if(o.selectedTab){o.selectedTab="overview"}if(o.objectsPage){var s=angular.copy(o.obj);o.obj.disableDownload=p.IsLatest==="true"?false:true;o.setUpMetadata({obj:s});o.updateObjAcl({obj:s});o.updateObjMetadata({obj:s})}};if(_.isEmpty(o.versions)){e()}}])})();"use strict";(function(){angular.module("s3").directive("editor",[function(a,c){return{restrict:"AE",scope:{code:"=",mode:"=",readonly:"=",onLoad:"&"},templateUrl:"/s3/partials/editor.html",link:{pre:function d(f,h,e){a.fullscreen=false;f.theme="dawn";var i=function i(){f.toggleFullscreen(true)};var g=function g(){if(!a.fullscreen){f.onSave()}};var j=function j(){if(!a.fullscreen){f.onBuild()}};var k=function k(m,l){f.editor.setTheme("ace/theme/"+m)};f.toggleFullscreen=function(l){a.fullscreen=!a.fullscreen;if(l){f.$apply()}c(function(){f.editor.resize()})};f.themes=["cobalt","dawn","eclipse","monokai","solarized_dark"].map(function(l){return{value:l,text:window.messages.ide.theme[l]}});f.modals={settings:{open:false}};f.saveSettings=function(){f.theme=f.modals.settings.theme;k(f.theme,true);f.modals.settings.open=false};f.aceLoaded=function(l){f.editor=l;l.$blockScrolling=Infinity;l.resize(true);c(function(){k(f.theme)});f.onLoad({editor:f.editor})}},post:function b(e){e.$watch("mode",function(){if(!e.mode){return}e.editor.session.setMode("ace/mode/"+e.mode)});e.$watch("readonly",function(){if(isNo(e.readonly)){return}e.editor.setReadOnly(e.readonly)})}}}}])})();"use strict";(function(){angular.module("s3").service("OperationDispatcherService",["PathService","$interval","ConsoleOperation","S3Constants","SCLogService","APIProxyService",function(j,h,i,g,l,d){var m=20;var e=5;var b={};var f={};var a=[];this.addOperation=function(n){for(var o in f){l.log("HaveConflictingOperation",this.isConflict(f[o],n)?1:0,n,{},Date())}b[n.id]=n;if(!n.finishCallBack){n.finishCallBack=this.operationDoneCallBack}n.errorCallBack=this.operationErrorCallBack;if(k(n)){f[n.id]=n;n.state=g.OPERATION_STATE.ACTIVE;l.log(g.OPERATION_MANAGER_LOGGING.STARTED,1,n);n.start()}else{n.state=g.OPERATION_STATE.WAITING;l.log(g.OPERATION_MANAGER_LOGGING.ENQUEUED,1,n);a.push(n)}l.log(g.OPERATION_MANAGER_LOGGING.ADDED,1,n)};this.getOngoingOperations=function(){return f};this.getWaitingOperations=function(){return a};this.getOperationById=function(n){return b[n]};this.getAllOperations=function(){return b};this.getOperationsWithState=function(o,n){for(var p in b){if(b[p].state===o){n.push(b[p])}}};var k=function k(n){if(Object.keys(f).length<m){if(n.initialBucket){var s={};d.getBucketLocation(n,n.initialBucket,s);var r=s.region;var q=0;for(var o in f){var p={};d.getBucketLocation(n,f[o].initialBucket,p);if(p.region===r){q+=1}}return q<e}return true}return false};this.operationDoneCallBack=function(n){if(b[n].state===g.OPERATION_STATE.COMPLETED){return}b[n].state=g.OPERATION_STATE.COMPLETED;b[n].defer.resolve(b[n].errorDetails);l.log(g.OPERATION_MANAGER_LOGGING.COMPLETED,1,b[n]);delete f[n];c()};this.operationErrorCallBack=function(n){b[n].state=g.OPERATION_STATE.ERROR;b[n].defer.reject(b[n].errorDetails);l.log(g.OPERATION_MANAGER_LOGGING.ERROR,1,b[n]);delete f[n];c()};this.cancelOperation=function(n){if(n.id in f){delete f[n.id];c();n.cancel();n.state=g.OPERATION_STATE.CANCEL}else{if(n.state==g.OPERATION_STATE.WAITING){n.cancel();for(var o=0;o<a.length;o++){if(a[o]===n){a.splice(o,1);break}}}delete b[n.id]}l.log(g.OPERATION_MANAGER_LOGGING.CANCELED,1,n)};var c=function c(){for(var o=0;o<a.length;o++){if(k(a[o])){var n=a[o];n.state=g.OPERATION_STATE.ACTIVE;l.log(g.OPERATION_MANAGER_LOGGING.DEQUEUED,1,n);f[n.id]=n;a.splice(o,1);n.start();l.log(g.OPERATION_MANAGER_LOGGING.STARTED,1,n);break}}};this.isConflict=function(o,n){if(o.initialBucket!==undefined&&n.initialBucket!==undefined&&o.initialBucket===n.initialBucket){if(o.initialPath.length>n.initialPath.length){return o.initialPath.lastIndexOf(n.initialPath)>=0}else{return n.initialPath.lastIndexOf(o.initialPath)>=0}}return false};this.setMaximumOngoingOperation=function(n){m=n};this.setMaximumOngoingOperationsPerRegion=function(n){e=n}}])})();"use strict";function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}(function(){angular.module("s3").service("BulkOperationService",["$translate","ConsoleOperation","SCLogService","S3Service","Md5GenerationService","PathService","S3Constants","ObjectListingService","OperationDispatcherService","ListVerificationService","APIProxyService","$q","DeleteService","CopyService","OperationUtilService","$filter",function(t,m,a,B,l,b,r,h,e,E,u,z,g,k,i,q){var p,s;var y=(p={},_defineProperty(p,r.OPERATION_NAME.DELETE_OBJECTS,g.deleteKeysAndVersions),_defineProperty(p,r.OPERATION_NAME.RESTORE_OBJECTS,g.deleteKeysAndVersions),_defineProperty(p,r.OPERATION_NAME.EMPTY_BUCKET,g.deleteKeysAndVersions),_defineProperty(p,r.OPERATION_NAME.DELETE_BUCKET,g.deleteKeysAndVersions),_defineProperty(p,r.OPERATION_NAME.MAKE_PUBLIC,i.defaultCWSBulkOperationCaller),_defineProperty(p,r.OPERATION_NAME.COPY,k.copyObjects),_defineProperty(p,r.OPERATION_NAME.CUT,k.copyObjects),_defineProperty(p,r.OPERATION_NAME.RENAME,k.copyObjects),_defineProperty(p,r.OPERATION_NAME.CHANGE_SSE,i.defaultCWSBulkOperationCaller),_defineProperty(p,r.OPERATION_NAME.CHANGE_STORAGE_CLASS,i.defaultCWSBulkOperationCaller),_defineProperty(p,r.OPERATION_NAME.CHANGE_METADATA,i.defaultCWSBulkOperationCaller),_defineProperty(p,r.OPERATION_NAME.INITIATE_RESTORE,i.defaultCWSBulkOperationCaller),_defineProperty(p,r.OPERATION_NAME.ADD_OBJECT_TAG,i.defaultCWSBulkOperationCaller),p);var o=(s={},_defineProperty(s,r.OPERATION_NAME.DELETE_OBJECTS,t.instant("operationname.deleteobjects")),_defineProperty(s,r.OPERATION_NAME.RESTORE_OBJECTS,t.instant("operationname.undodelete")),_defineProperty(s,r.OPERATION_NAME.EMPTY_BUCKET,t.instant("operationname.emptybucket")),_defineProperty(s,r.OPERATION_NAME.DELETE_BUCKET,t.instant("operationname.deletebucket")),_defineProperty(s,r.OPERATION_NAME.MAKE_PUBLIC,t.instant("operationname.makepublic")),_defineProperty(s,r.OPERATION_NAME.COPY,t.instant("operationname.copy")),_defineProperty(s,r.OPERATION_NAME.CUT,t.instant("operationname.cut")),_defineProperty(s,r.OPERATION_NAME.RENAME,t.instant("operationname.rename")),_defineProperty(s,r.OPERATION_NAME.CHANGE_SSE,t.instant("operationname.changesse")),_defineProperty(s,r.OPERATION_NAME.CHANGE_STORAGE_CLASS,t.instant("operationname.changestorageclass")),_defineProperty(s,r.OPERATION_NAME.CHANGE_METADATA,t.instant("operationname.changemetadata")),_defineProperty(s,r.OPERATION_NAME.INITIATE_RESTORE,t.instant("operationname.initiaterestore")),_defineProperty(s,r.OPERATION_NAME.ADD_OBJECT_TAG,t.instant("operationname.addtags")),s);var D={createBulkOperation:x,listAndOperateObjectsRecursively:j,updateUIWithSuccessResponse:n,populateErrorDetails:f,completeOperation:d,updateUIWithError:A,getOperationAPIMap:w,getOperationCompleteCallBack:C,shouldListVersion:v};return D;function x(G,K,F,I,J){if(K.length===0&&F.length===0){throw"No keys or folders were passed in for "+G+" operation"}var H=new m(G);H.displayName=o[H.name];H.selectedKeys=angular.copy(K);H.selectedKeys.forEach(function(L){L.Key=L.Path?L.Path+L.Key:H.initialPath+L.Key});H.selectedFolders=angular.copy(F);if(!c(H)){H.selectedFolders.forEach(function(L){L.Prefix=H.initialPath+L.Prefix+r.DELIMITER});if(H.selectedFolders.length>0){H.originFolders=angular.copy(F)}}H.totalObjectCount=I;H.totalOperatedObjectCount=0;H.start=function(){var M=H.additionalInfo?H.additionalInfo:J;if(H.selectedKeys.length>0){for(var L=0;L<K.length/M.numberOfKeysPerBulkOperation;L++){y[G](H,H.selectedKeys.slice(L*M.numberOfKeysPerBulkOperation,(L+1)*M.numberOfKeysPerBulkOperation),M).then(D.updateUIWithSuccessResponse)["catch"](D.updateUIWithError)}}if(H.selectedFolders.length>0){D.listAndOperateObjectsRecursively(H,null,M)}};H.cancel=function(){H.state=r.OPERATION_STATE.CANCEL};H.finishCallBack=D.getOperationCompleteCallBack(H);a.log(G.replace(/\s/g,"")+"OperationCreated",1,H);return H}function j(F,H,G){if(!H&&F.state===r.OPERATION_STATE.ACTIVE||H.truncated&&F.state===r.OPERATION_STATE.ACTIVE){h.getBatchOfItems(F,H?H.marker:null,G.numberOfKeysPerBulkOperation,false,v(F,G),H?H.versionIdMarker:null,F.selectedFolders,null).then(function(I){a.log(F.name.replace(/\s/g,"")+"FolderListing",1,F,I);if(I.keys.length>0){y[F.name](F,I.keys,G).then(function(J){D.updateUIWithSuccessResponse(J);D.listAndOperateObjectsRecursively(F,I,G)})["catch"](function(J){D.updateUIWithError(J)})}else{D.completeOperation(F)}})["catch"](function(I){a.log(F.name.replace(/\s/g,"")+"FolderListing",0,F,I);D.updateUIWithError({operation:F,result:I})})}else{if(F.state===r.OPERATION_STATE.CANCEL){return}else{D.completeOperation(F)}}}function n(H){var G=H.operation;var F=H.result;G.totalOperatedObjectCount+=Object.keys(F).length;Object.keys(F).forEach(function(I){if(F[I].status===r.OPERATION_PER_KEY_STATUS.DONE){G.succeedKeyCount+=1}else{G.failedKeyCount+=1}});G.defer.notify();G.progressPercentage=G.totalOperatedObjectCount/G.totalObjectCount*100;G.successPercentage=G.succeedKeyCount/G.totalObjectCount*100;G.errorPercentage=G.failedKeyCount/G.totalObjectCount*100;if(G.totalOperatedObjectCount===G.totalObjectCount&&G.selectedFolders.length===0){D.completeOperation(G)}D.populateErrorDetails(G,F)}function d(F){if(F.state===r.OPERATION_STATE.COMPLETED){return}if(c(F)){F.totalObjectCount=F.totalOperatedObjectCount;if(F.totalObjectCount===0){F.errorPercentage=0}else{F.errorPercentage=F.failedKeyCount/F.totalObjectCount*100}F.errorTypes.forEach(function(G){G.errorPercentage=Number(G.errorCount/F.totalObjectCount*100).toFixed(2)})}F.successPercentage=Number(100-F.errorPercentage).toFixed(2);F.progressPercentage=100;a.log(F.name.replace(/\s/g,"")+"Success",1,F);if(F.errorPercentage===0){F.parameters.operationSuccessful=true}else{if(F.successPercentage===0){F.parameters.operationUnsuccessful=true}else{F.parameters.operationPartiallySuccessful=true}}if(F.name===r.OPERATION_NAME.DELETE_BUCKET){F.successPercentage/=2;F.errorPercentage/=2;if(F.errorPercentage!==0&&F.name===r.OPERATION_NAME.DELETE_BUCKET){F.errorPercentage+=50}F.errorTypes.forEach(function(G){G.errorPercentage=Number(G.errorCount/F.totalObjectCount*100).toFixed(2);G.errorPercentage/=2})}if(F.errorPercentage!==0){F.errorCallBack(F.id)}else{F.finishCallBack(F.id)}}function A(F){var G=F.operation;G.defer.notify();a.log(G.name.replace(/\s/g,"")+"Success",0,G,F);G.errorPercentage=100-G.progressPercentage;if(G.name===r.OPERATION_NAME.DELETE_BUCKET){G.errorPercentage=G.errorPercentage/2;G.errorPercentage+=50}G.errorCallBack(G.id)}function C(F){if(F.name===r.OPERATION_NAME.DELETE_BUCKET){return function(){u.deleteBucket(F).then(function(){F.parameters.isDeleteBucketSuccessful=true;F.successPercentage+=50;a.log("DeleteBucketRequest",1,F);e.operationDoneCallBack(F.id)})["catch"](function(G){F.errorPercentage+=50;F.parameters.isDeleteBucketSuccessful=false;a.log("DeleteBucketRequest",0,F,G);if(G&&G.Error&&G.Error.Message){F.errorMessage=G.Error.Message}else{F.errorMessage=t.instant("operation.errormessage.cantdeletebucket")}e.operationErrorCallBack(F.id)})}}else{return F.finishCallBack}}function f(F,G){Object.keys(G).forEach(function(H){if(G[H].status!==r.OPERATION_PER_KEY_STATUS.DONE){var I=G[H].errorMessage;var J=_.filter(F.errorTypes,function(K){return K.errorMessage===I});if(J.length===0){F.errorTypes.push({errorMessage:I,errorCount:1,errorPercentage:Number(1/F.totalObjectCount*100).toFixed(2)})}else{J[0].errorCount+=1;J[0].errorPercentage=Number(J[0].errorCount/F.totalObjectCount*100).toFixed(2)}if(F.errorDetails[I]){if(F.errorDetails[I].length<r.BULK_OPERATION_KEY_COUNT_PER_ERROR_TYPE){F.errorDetails[I].push(H)}}else{F.errorDetails[I]=[H]}}})}function v(F,G){if(F.name===r.OPERATION_NAME.EMPTY_BUCKET||F.name===r.OPERATION_NAME.DELETE_BUCKET){return G.versioning==="Enabled"||G.versioning==="Suspended"}return false}function c(F){return F.name===r.OPERATION_NAME.EMPTY_BUCKET||F.name===r.OPERATION_NAME.DELETE_BUCKET}function w(){return y}}])})();"use strict";function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}(function(){angular.module("s3").service("OperationUtilService",["ConsoleOperation","FAC","MultipartCopyService","SCLogService","S3Service","S3Constants","S3CWSAPIService","APIProxyService","$q",function(l,j,y,c,v,n,d,r,s){var w;var i="BulkOpKeyCountMatch";var e="BulkOpKeyCountMismatch";var g="ObjectCount";var u="RequestFailed";var f="GetBucketLocationError";var p=[n.OPERATION_NAME.CHANGE_METADATA,n.OPERATION_NAME.CHANGE_SSE,n.OPERATION_NAME.CHANGE_STORAGE_CLASS];var m=(w={},_defineProperty(w,n.OPERATION_NAME.MAKE_PUBLIC,n.CWS_OPERATION_NAME.MAKE_PUBLIC),_defineProperty(w,n.OPERATION_NAME.CHANGE_SSE,n.CWS_OPERATION_NAME.CHANGE_SSE),_defineProperty(w,n.OPERATION_NAME.CHANGE_STORAGE_CLASS,n.CWS_OPERATION_NAME.CHANGE_STORAGE_CLASS),_defineProperty(w,n.OPERATION_NAME.CHANGE_METADATA,n.CWS_OPERATION_NAME.CHANGE_METADATA),_defineProperty(w,n.OPERATION_NAME.INITIATE_RESTORE,n.CWS_OPERATION_NAME.INITIATE_RESTORE),_defineProperty(w,n.OPERATION_NAME.ADD_OBJECT_TAG,n.CWS_OPERATION_NAME.ADD_OBJECT_TAG),w);var x={handleCWSSuccessResponse:o,handleCWSErrorResponse:k,handleGetBucketLocationError:h,initializeBulkOperationResult:a,defaultCWSBulkOperationCaller:t,generateParameterForSpecificOperation:b,verifyKeysMatching:q};return x;function a(z){return{operation:z,result:{},error:null}}function b(z,B,A){var D={};var C=_.pluck(B,"Key");D.bucket=z.initialBucket;D.keys=C;if(z.name===n.OPERATION_NAME.CHANGE_STORAGE_CLASS){D.storageClass=A.targetStorageClass}else{if(z.name===n.OPERATION_NAME.CHANGE_SSE){D.sseAlgo=A.sseAlgo;if(A.sseKmsKeyId){D.sseKmsKeyId=A.sseKmsKeyId}}else{if(z.name===n.OPERATION_NAME.CHANGE_METADATA){D.metadataMap=A.addAndChangeMetadata;D.deleteMetadata=A.deleteMetadata}else{if(z.name===n.OPERATION_NAME.INITIATE_RESTORE){D.expirationDays=A.expirationDays}else{if(z.name===n.OPERATION_NAME.ADD_OBJECT_TAG){D.tags=A.tags}}}}}if(p.indexOf(z.name)>=0&&j.isFeatureEnabled(n.FAC.NEW_MULTIPART_COPY)){D.isNewMultipartCopy=true}return D}function t(A,D,C){var E=x.generateParameterForSpecificOperation(A,D,C);var z=s.defer();var B=x.initializeBulkOperationResult(A);r.getBucketLocation(A,A.initialBucket,E).then(function(G){var F=m[A.name];if(!F){throw A.name+"is not supported"}d.makeS3ConsoleOperationRequest(G,F,{},A).then(function(H){y.startMultipartCopyForFiles(A,A.initialBucket,G.region,G.region,D,_.pluck(D,"Key"),H,false).then(function(I){x.handleCWSSuccessResponse(A,D,I,B,z)})})["catch"](function(H){x.handleCWSErrorResponse(A,H,B,z)})})["catch"](function(F){x.handleGetBucketLocationError(A,F,B,z)});return z.promise}function h(A,B,z,C){c.log(f,1,A,B);z.error=B;C.reject(z)}function k(A,B,z,C){c.log((A.name+u).replace(/ /g,""),1,A,B);z.error=B;C.reject(z)}function o(B,C,A,z,D){if(d.wasOperationSuccessful(A)){A.data.statusPerKey.forEach(function(E){z.result[E.key]=E.result});if(!x.verifyKeysMatching(C,z.result)){c.log(i,0,{operation:B,keys:C,response:A});z.error=e;D.reject(z)}else{c.log(i,1,B);c.log((B.name+g).replace(/ /g,""),Object.keys(C).length,B,z.result);D.resolve(z)}}}function q(D,B){var C={};var A=_.pluck(D,"Key");A.forEach(function(E){C[E]=false});var z=Object.keys(B);if(D.length!==z.length){return false}z.forEach(function(E){if(C[E]===false){C[E]=true}else{return false}});A.forEach(function(E){if(!C[E]){return false}});return true}}])})();"use strict";(function(){angular.module("s3").service("DeleteService",["$q","ConsoleOperation","ListVerificationService","Md5GenerationService","ObjectListingService","PathService","S3Constants","SCLogService","APIProxyService","S3Service","UtilService",function(p,j,v,i,g,b,l,a,o,r,t){var e="GetBucketLocationError";var h="DeleteCountMatch";var c="DeleteCountMismatch";var m="DeleteRequestGenerated";var d="DeleteObjectCount";var u={createDeleteMultipleObjectsXml:q,deleteKeysAndVersions:s,generateDeleteRequest:f,getKeyAndVersionIdSetFromResponse:n,compareRequestAndResponse:k};return u;function q(y){var w="<Delete>";for(var x in y){w+="<Object>";w+="<Key>"+t.encodeXml(y[x].Key)+"</Key>";if(y[x].VersionId){w+="<VersionId>"+t.encodeXml(y[x].VersionId)+"</VersionId>"}w+="</Object>"}w+="</Delete>";return w}function s(z,B,A){var w=u.createDeleteMultipleObjectsXml(B);var C=u.generateDeleteRequest(z,w,A.mfaString);var x=p.defer();var y={operation:z,error:null,result:null};o.getBucketLocation(z,z.initialBucket,C).then(function(D){o.makeProxyRequest(r.deleteObjects,D,l.PROXY_API_NAMES.S3.DELETE,z).then(function(F){if(F.response.DeleteResult){var E=u.getKeyAndVersionIdSetFromResponse(F.response.DeleteResult,z);if(!u.compareRequestAndResponse(B,E)){a.log(h,0,z,{original:B,result:E});y.error=c;x.reject(y)}else{a.log(h,1,z,{original:B,result:E});y.result=E;x.resolve(y)}}else{if(F.response.Error){y.error=F.response.Error;x.reject(y)}}})["catch"](function(E){y.error=E;x.reject(y)})})["catch"](function(D){a.log(e,1,z,D);y.error=D;x.reject(y)});return x.promise}function f(w,x,z){var y={content:x,path:w.initialBucket};y.headers={};y.headers[l.HEADERS.CONTENT_TYPE]=l.HEADERS.CONTENT_TYPE_JSON;y.headers[l.HEADERS.X_AMZ_DATE]=new Date().toUTCString();y.headers[l.HEADERS.CONTENT_MD5]=i.getContentMd5(x);if(z){y.headers[l.HEADERS.X_AMZ_MFA]=z}a.log(m,1,w,y);return y}function n(y,x){var w={};if(y.Deleted){if(y.Deleted.length>1){a.log(d,y.Deleted.length,x);y.Deleted.forEach(function(z){if(z.VersionId){w[z.Key+":"+z.VersionId]={status:l.OPERATION_PER_KEY_STATUS.DONE}}else{w[z.Key]={status:l.OPERATION_PER_KEY_STATUS.DONE}}})}else{a.log(d,1,x);if(y.Deleted.VersionId){w[y.Deleted.Key+":"+y.Deleted.VersionId]={status:l.OPERATION_PER_KEY_STATUS.DONE}}else{w[y.Deleted.Key]={status:l.OPERATION_PER_KEY_STATUS.DONE}}}}if(y.Error){if(y.Error.length>1){y.Error.forEach(function(z){if(z.VersionId){w[z.Key+":"+z.VersionId]={status:l.OPERATION_PER_KEY_STATUS.ERROR,errorCode:z.Code,errorMessage:z.Message}}else{w[z.Key]={status:l.OPERATION_PER_KEY_STATUS.ERROR,errorCode:z.Code,errorMessage:z.Message}}})}else{if(y.Error.VersionId){w[y.Error.Key+":"+y.Error.VersionId]={status:l.OPERATION_PER_KEY_STATUS.ERROR,errorCode:y.Error.Code,errorMessage:y.Error.Message}}else{w[y.Error.Key]={status:l.OPERATION_PER_KEY_STATUS.ERROR,errorCode:y.Error.Code,errorMessage:y.Error.Message}}}}return w}function k(z,x){var w={};z.forEach(function(A){if(A.VersionId){w[A.Key+":"+A.VersionId]=false}else{w[A.Key]=false}});var y=Object.keys(x);if(Object.keys(w).length!==y.length){return false}y.forEach(function(A){if(w[A]===undefined||w[A]===true){return false}w[A]=true});Object.keys(w).forEach(function(A){if(!w[A]){return false}});return true}}])})();"use strict";(function(){angular.module("s3").service("CopyService",["ConsoleOperation","FAC","MultipartCopyService","OperationDispatcherService","OperationUtilService","PathService","SCLogService","S3Service","S3Constants","S3CWSAPIService","APIProxyService","$q",function(m,j,v,e,k,c,b,t,o,d,p,s){var r="PasteObjects";var q="RenameObject";var a=null;var u={copyObjects:l,setClipboardOperation:n,isOperationInClipboard:f,startClipboardOperation:i,generateCopyRequestPayload:g,getClipboardOperation:h};return u;function n(w){if(a!==null){a.state=o.OPERATION_STATE.CANCEL}a=w}function f(){return a===null}function i(){var x=arguments.length<=0||arguments[0]===undefined?false:arguments[0];var w=arguments.length<=1||arguments[1]===undefined?null:arguments[1];if(a===null){throw"There is no operation in the clipboard."}a.dstBucket=c.getCurrentBucket();a.dstPrefix=c.getCurrentAbsoluteFolderPath();if(a.dstPrefix===undefined){a.dstPrefix=""}if(x){a.dstName=w&&w.name;b.log(q,1,a,{dstName:a.dstName})}else{b.log(r,1,a,{dstBucket:a.dstBucket,dstPrefix:a.dstPrefix})}e.addOperation(a);a=null}function g(x,y,w,B){var A={bucket:x.initialBucket,prefix:x.initialPath,dstBucket:x.dstBucket,keys:_.pluck(y,"Key"),dstKeys:[]};var z=undefined;if(B){(function(){var C=y[0].Key;y.forEach(function(E){var D=E.Key;z=D.replace(C,x.dstName);A.dstKeys.push(A.prefix?A.prefix+z:z)})})()}else{y.forEach(function(D){var C=D.Key;A.dstKeys.push(C.replace(D.Path||x.initialPath,x.dstPrefix))})}A.cutOperation=(w||B)===true;if(j.isFeatureEnabled(o.FAC.NEW_MULTIPART_COPY)){A.isNewMultipartCopy=true}return A}function l(x,A,y){var w=y.isCut;var D=y.isRename;var B=s.defer();var z=k.initializeBulkOperationResult(x);var C=u.generateCopyRequestPayload(x,A,w,D);p.getBucketLocation(x,x.initialBucket,C).then(function(){var E={};p.getBucketLocation(x,x.dstBucket,E).then(function(F){C.dstBucketRegion=F.region;d.makeS3ConsoleOperationRequest(C,o.CWS_OPERATION_NAME.COPY,{},x).then(function(G){v.startMultipartCopyForFiles(x,x.dstBucket,C.dstBucketRegion,C.region,A,C.dstKeys,G,w).then(function(H){k.handleCWSSuccessResponse(x,A,H,z,B)})})["catch"](function(G){k.handleCWSErrorResponse(x,G,z,B)})})["catch"](function(F){k.handleGetBucketLocationError(x,F,z,B)})})["catch"](function(E){k.handleGetBucketLocationError(x,E,z,B)});return B.promise}function h(){return a}}])})();"use strict";(function(){angular.module("s3").service("UploadOperationService",["$q","$window","$translate","ConsoleOperation","humanReadableBytesFilter","SCLogService","APIProxyService","PromiseQueue","S3Constants","UploadService",function(C,r,w,q,D,e,x,o,v,u){var f="DragAndDropComplete",c="OperationCreated",y="StartExplorerTraversal",d="CancelUploadOperation",g="EmptyFolder",l="Start",F="Started",j="StartedBeforeSetup",n="Complete",i="UserError";var H={createUploadOperation:B,setupUploadOperation:s,uploadFile:k,uploadSuccess:h,uploadError:b,uploadNotify:G,selectFile:m,setFlagValues:E,updateErrorPercentage:p};return H;function B(){var I=new q(v.OPERATION_NAME.UPLOAD);I.displayName=w.instant("operationname.upload");I.explorers=[];e.log(I.name+c,1,I);I.start=function(){if((!I.selectedObjects||I.selectedObjects.length===0)&&(!I.selectedFolders||I.selectedFolders.length===0)){e.log(I.name+j,1,I);throw"Setup up the upload operation before start"}e.log(I.name+F,1,I);for(var K in I.selectedFolders){if(I.selectedFolders[K].objsCount===0){A(I.selectedFolders[K],I)}}var L=new o(1);for(var J in I.selectedObjects){L.add(k,{file:I.selectedObjects[J],operation:I,isDragAndDrop:false})}if(I.explorers&&I.explorers.length>0){t(0,I)}};I.cancel=function(){I.state=v.OPERATION_STATE.CANCEL;e.log(d,1,I);for(var J in I.selectedObjects){u.cancelUpload(I.selectedObjects[J].id,I)}};return I}function t(J,I){var K=I.explorers[J];J++;e.log(I.name+y,1,I,{explorerId:K.explorerId,selectedItems:K.getSelectedItems()});z(K,I).then(function(){var L=I.succeedKeyCount+I.failedKeyCount;if(J<I.explorers.length){t(J,I)}else{e.log(I.name+f,1,I,{expectedTotalObjsCount:I.totalObjectCount,numberOfFileUploadsAttempted:L,numberOfExplorersUploaded:I.explorers.length})}},function(L){e.log(I.name+f,0,I,L);I.cancel()})}function z(L,K,M){var J=M||C.defer(),I=[];if(K.state===v.OPERATION_STATE.CANCEL){J.reject("Operation was cancelled");return}L.getNext().then(function(Q){if(!Q){J.resolve();return}var O=Q.fileList,N=Q.emptyFolderToBeUploaded;if(N){I.push(A(N,K,true))}for(var P in O){I.push(k({file:O[P],operation:K,isDragAndDrop:true}))}if(I.length>0){C.all(I).then(function(){z(L,K,J)},function(){I[I.length-1].then(function(){z(L,K,J)},function(){z(L,K,J)})})}else{z(L,K,J)}},function(N){J.reject(N)});return J.promise}function A(K,J,I){var L=x.putObject(J,J.initialBucket,J.initialPath+K.fullPath,K.Prefix);L.then(function(M){e.log(J.name+g,1,J,{fullPath:J.initialPath+K.fullPath,isDragAndDrop:I,name:K.Prefix});M.operation=J;h(M)},function(M){e.log(J.name+g,0,J,M);M.operation=J;b(M)});return L}function k(L){var J=L.file;var M=L.operation;var O=L.isDragAndDrop;var K=J.file,Q=J.fullPath?M.initialPath+J.fullPath:M.initialPath,N=M.initialBucket,R=J.id,S=M.options;K.initialLastModified=K.lastModified||"";var I=u.upload(K,Q,N,R,M,S);e.log(l+M.name,1,M,{fullPath:M.initialPath+K.fullPath,isDragAndDrop:O,fileName:K.Key});M.files[L.file.Key]=L.file.Size;if(M.state===v.OPERATION_STATE.CANCEL){var P={operation:M,name:L.file.Key,errorMessage:w.instant("upload.cancelled")};b(P);return C.reject()}else{I.then(h,b,G);return I}}function s(L,J,K,I,M,N){L.selectedFolders=J;L.selectedObjects=K;L.totalObjectCount=I.files;L.totalBytes=I.size;L.totalUploadedBytes=0;L.options=M;L.uploadUiCallBack=N;L.currentUploadSpeed=0;L.lastNotifyTime=null;L.lastMarkBytes=0;L.files={}}function m(J,I){return u.fileSelected(J,I)}function E(I){if(I.errorPercentage===0){I.parameters.operationSuccessful=true}else{if(I.successPercentage===0){I.parameters.operationUnsuccessful=true}else{I.parameters.operationPartiallySuccessful=true}}}function p(I){if(I.successPercentage+I.errorPercentage!==100){I.errorPercentage=100-I.successPercentage}}function h(I){var J=I.operation;delete I.operation;e.log(J.name+n,1,J,I);J.succeedKeyCount+=1;J.totalOperatedObjectCount+=1;J.totalUploadedBytes+=J.files[I.name];J.successPercentage=J.totalUploadedBytes/J.totalBytes*100;J.uploadUiCallBack();E(J);if(J.succeedKeyCount+J.failedKeyCount===J.totalObjectCount){J.progressPercentage=100;if(J.succeedKeyCount===J.totalObjectCount){J.successPercentage=100}p(J);if(J.errorPercentage!==0){J.errorCallBack(J.id)}else{J.finishCallBack(J.id)}}}function b(I){var J=I.operation;delete I.operation;var K=I.errorMessage;var L=_.filter(J.errorTypes,function(N){return N.errorMessage===K});if(L.length===0){J.errorTypes.push({errorMessage:K,errorCount:1,errorPercentage:Number(J.files[I.name]/J.totalBytes*100).toFixed(2)})}else{L[0].errorCount+=1;L[0].errorPercentage=Number(J.files[I.name]/J.totalBytes*100).toFixed(2)}var M=Number(a(I));e.log(J.name+n,M,J,I);if(M===1){e.log(J.name+i,1,J,I.errorMessage)}if(J.errorDetails[K]){J.errorDetails[K].push(I.name)}else{J.errorDetails[K]=[I.name]}J.failedKeyCount+=1;J.totalOperatedObjectCount+=1;J.errorPercentage+=J.files[I.name]/J.totalBytes*100;J.successPercentage=J.totalUploadedBytes/J.totalBytes*100;J.progressPercentage=J.totalOperatedObjectCount/J.totalObjectCount*100;J.uploadUiCallBack();E(J);if(J.succeedKeyCount+J.failedKeyCount===J.totalObjectCount){if(J.failedKeyCount===J.totalObjectCount){J.errorPercentage=100}p(J);if(J.errorPercentage!==0){J.errorCallBack(J.id)}else{J.finishCallBack(J.id)}}}function G(K){var I=K.operation;if(K.totalBytes&&K.uploadedByte){var L=I.totalUploadedBytes;L+=K.uploadedByte;I.progressPercentage=L/I.totalBytes*100;I.successPercentage=I.progressPercentage;var J=r.Date.now();if(I.lastNotifyTime&&J!==I.lastNotifyTime){I.currentUploadSpeed=D((L-I.lastMarkBytes)/((J-I.lastNotifyTime)/1000))}I.lastMarkBytes=L;I.lastNotifyTime=J}delete K.operation;e.log("UploadProgress",1,I,K)}function a(I){return v.UPLOAD.USER_ERROR_MESSAGES.indexOf(I.errorMessage)!==-1||I.isCancelled===true}}])})();"use strict";(function(){angular.module("s3").service("MultipartCopyService",["$q","$translate","ConsoleOperation","PathService","SCLogService","S3Constants","S3CWSAPIService","UtilService",function(p,o,l,d,c,m,e,q){var n="MultipartCopyCompleted";var i="multipartCopyId:";var j="MultipartCopyPartCompleted";var r={completeMultipartCopy:h,doMultipartCopy:f,getEtagsFromResponse:b,recursivelyMultipartCopy:a,startMultipartCopyForFiles:g,updateResponseWithError:k};return r;function g(t,C,v,w,B,x,u,y){var A=p.defer();var s={};u.data.statusPerKey.forEach(function(D){if(D.result.additionalInfoWhenSuccess&&D.result.additionalInfoWhenSuccess.lastIndexOf(i)!==-1){for(var F in B){if(B[F].Key===D.key){var E=function(){var G=D.result.additionalInfoWhenSuccess.split(i)[1];s[G]={key:B[F]};s[G].dstKey=x[F];s[G].dstBucket=C;s[G].dstBucketRegion=v;s[G].srcBucketRegion=w;s[G].isCut=y;s[G].objectSizeInByte=B[F].Size;s[G].partCount=Math.ceil(B[F].Size/m.MULTIPART_COPY.PART_SIZE);Object.keys(s[G]).forEach(function(H){if(s[G][H]===undefined){c.log(n,0,t,s[G]);A.reject(o.instant("operation.errormessage.multipartcopyfailed"));return A.promise}});return"break"}();if(E==="break"){break}}}}});var z=Object.keys(s);r.recursivelyMultipartCopy(t,z,s,0,0,A,u);return A.promise}function f(s,t,u,v){var w={bucket:s.initialBucket,multipartCopyId:t,key:u.key.Key,dstBucket:u.dstBucket,dstKey:u.dstKey,objectSizeInByte:u.objectSizeInByte,dstBucketRegion:u.dstBucketRegion,region:u.dstBucketRegion,startPartNumber:v*m.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API+1,endPartNumber:Math.min((v+1)*m.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API,u.partCount)};return e.makeS3ConsoleOperationRequest(w,m.CWS_OPERATION_NAME.MULTIPART_COPY,{},s)}function b(s){var v=[];var t="";var u=null;s.data.statusPerKey.forEach(function(w){if(w.result.status===m.OPERATION_PER_KEY_STATUS.DONE){v.push({partNumber:Number(w.key),eTag:w.result.additionalInfoWhenSuccess})}else{if(w.result.status===m.OPERATION_PER_KEY_STATUS.ERROR){t=w.result.errorMessage;u=w.result.errorCode}}});if(!t){return v}else{return{errorMessage:t,errorCode:u}}}function h(s,t,u){var v={bucket:s.initialBucket,etags:u.partEtags,copyId:t,dstKey:u.dstKey,srcKey:u.key.Key,objectSize:u.objectSizeInByte,dstBucket:u.dstBucket,srcRegion:u.srcBucketRegion,region:u.dstBucketRegion,isCut:u.isCut};return e.makeS3ConsoleOperationRequest(v,m.CWS_OPERATION_NAME.COMPLETE_MULTIPART_COPY,{},s)}function k(u,s,v,t){s.data.statusPerKey.forEach(function(w){if(w.key===u){w.result.status=m.OPERATION_PER_KEY_STATUS.ERROR;w.result.errorMessage=t;w.result.errorCode=v}})}function a(u,s,w,z,y,t,v){if(z===s.length){t.resolve(v);return}var x=w[s[z]];r.doMultipartCopy(u,s[z],x,y).then(function(A){var B=b(A);if(B.errorMessage){c.log(j,0,u,{params:x,error:B.errorMessage});c.log(n,0,u);k(x.key.Key,v,B.errorCode,B.errorMessage);r.recursivelyMultipartCopy(u,s,w,z+1,0,t,v)}else{c.log(j,1,u,x);if(x.partEtags){x.partEtags=x.partEtags.concat(B)}else{x.partEtags=B}if(x.partEtags.length===x.partCount){r.completeMultipartCopy(u,s[z],x).then(function(){c.log(n,1,u)})["catch"](function(){c.log(n,0,u);k(x.key.Key,v,B.errorCode,B.errorMessage)});r.recursivelyMultipartCopy(u,s,w,z+1,0,t,v)}else{r.recursivelyMultipartCopy(u,s,w,z,y+1,t,v)}}})["catch"](function(A){c.log(j,0,u,{params:x,error:A});c.log(n,0,u);k(x.key.Key,v,A.status,q.handleErrors(A));r.recursivelyMultipartCopy(u,s,w,z+1,0,t,v)})}}])})();"use strict";(function(){angular.module("s3").controller("ObjectDetailsController",["$filter","$q","$route","$scope","$timeout","$translate","APIProxyService","AWSC","BulkOperationService","CachingService","ConsoleOperation","DownloadService","PathService","PermissionsUtilService","ObjectPropertiesService","OperationDispatcherService","S3Constants","S3CWSAPIService","SCLogService","UtilService",a]);function a(o,u,l,r,w,s,t,q,n,g,m,j,c,h,i,f,p,d,b,x){r.tabs=[{label:s.instant("details.tab.overview"),id:"overview"},{label:s.instant("details.tab.properties"),id:"properties"},{label:s.instant("details.tab.permissions"),id:"permissions"}];r.objectDetailError="";r.bucket=c.getCurrentBucket();r.key=c.getCurrentObject();r.obj=g.getCurrentObject();r.options={};r.versionLabel=s.instant("versionsdropdown.label.latestVersion");r.selectedTab="overview";r.showReplication=false;r.showRestoration=false;r.showExpiry=false;r.showVersionsDropdown={show:false};r.showSuccessMessage=false;r.showVersionId=false;r.permissionObj={};q.Clog.setPageId(p.CLOG_OBJECT_DETAILS_PAGE_ID);r.listVersions=function(y){y.stopPropagation();if(r.showVersionsDropdown.show){r.showVersionsDropdown.show=false}else{r.showVersionsDropdown.show=true;x.analyticsTrackClick(p.ANALYTICS.LATEST_VERSION,p.ANALYTICS.DETAILS)}};r.closeDownloadAsPanel=function(){r.downloadAsPanel=false};r.openDownloadAsPanel=function(){r.downloadAsPanel=true;x.analyticsTrackClick(p.ANALYTICS.DOWNLOAD_AS,p.ANALYTICS.DETAILS);r.downloadAsPanelGenerating=true;r.downloadPanelError=false;r.downloadPanel={};j.generatePresignedUrlForCurrentObject(r.obj).then(function y(A){r.downloadAsPanelGenerating=false;r.downloadPanel.url=A.data.presignedUrl},function z(A){r.downloadAsPanelGenerating=false;r.downloadPanelError=true})};r.downloadSelectedObject=function(){j.downloadCurrentSelection(r.obj)};r.openSelectedObject=function(){j.openInBrowser(r.obj.Key,r.obj.Size)};r.makePublic=function(){r.isMakingPublic=true;var y=n.createBulkOperation(p.OPERATION_NAME.MAKE_PUBLIC,[{Key:r.obj.Key}],[],1,{numberOfKeysPerBulkOperation:1});f.addOperation(y);b.log("MakePublicRequestReceived",1,y);y.defer.promise.then(function(z){var A=Object.keys(z);if(A.length>0){r.objectDetailError=x.handleErrors(A[0]);b.log("MakePublicRequestComplete",0,y)}else{r.cachedValue=angular.copy(r.obj);r.cardOpen=false;r.showSuccessMessage=true;r.successMessageString=s.instant("objectdetails.successmessage");w(function(){return r.showSuccessMessage=false},p.SUCCESS_MESSAGE_TIMEOUT);b.log("MakePublicRequestComplete",1,y);k(y)}})["catch"](function(z){y.error=z;b.log("MakePublicRequestComplete",0,y);r.objectDetailError=x.handleErrors(z)})["finally"](function(){r.isMakingPublic=false})};r.permissionObj.grantees={};r.putAcl=function(y){var z=new m("putObjectAcl");var A=r.key;b.log("putObjectACLReceived",1,z,{bucketName:r.bucket,key:A});var B="";return t.getObjectAcl(z,r.bucket,A).then(function(D){var C=D.response.AccessControlPolicy;B+='<AccessControlPolicy xmlns="http://s3.amazonaws.com/doc/2006-03-01/"><Owner><ID>'+C.Owner.ID+"</ID>";B+="<DisplayName>"+C.Owner.DisplayName+"</DisplayName></Owner><AccessControlList>";y.forEach(function(E){E.Grantee.Type=E.Grantee.URI?"Group":E.Grantee.EmailAddress?"AmazonCustomerByEmail":"CanonicalUser";B+='<Grant><Grantee xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="'+E.Grantee.Type+'">';B+=E.Grantee.ID?"<ID>"+E.Grantee.ID+"</ID>":"";B+=E.Grantee.DisplayName?"<DisplayName>"+E.Grantee.DisplayName+"</DisplayName>":"";B+=E.Grantee.EmailAddress?"<EmailAddress>"+E.Grantee.EmailAddress+"</EmailAddress>":"";B+=E.Grantee.URI?"<URI>"+E.Grantee.URI+"</URI>":"";B+="</Grantee>";B+="<Permission>"+E.Permission+"</Permission></Grant>"});B+="</AccessControlList></AccessControlPolicy>";return t.putObjectAcl(z,r.bucket,A,B).then(function(F){var E=F.response;b.logRequestComplete("putObjectAcl",z);return E})["catch"](function(E){b.log("putObjectAcl",0,z,{bucketName:r.bucket,key:A,error:E});return u.reject(x.handleErrors(E))})})["catch"](function(C){return u.reject(x.handleErrors(C))})};r.getStorageClassTranslation=function(){if(r.obj){return x.getStorageClassTranslations()[r.obj.StorageClass]}return""};r.getEncryptionTranslation=function(){if(r.obj){return x.getEncryptionTranslations()[r.obj.Encryption]}return""};r.getMetadata=function(A,B){var y=c.getCurrentObject();r.obj.UserDefinedMetadata={};r.obj.Encryption="NONE";r.options.kmsId="";var z=new m(p.OPERATION_NAME.GET_METADATA);b.log("GetObjectMetadataReceived",1,z);d.getMetadata(r.bucket,y,z).then(function(C){b.log("getObjectMetadataCWS",A,1,{bucketName:r.bucket,key:y});var E=C&&C.data&&C.data.metadata;if(E){r.obj.Metadata=E;var D=_.pick(r.obj.Metadata,function(G,F){return p.USER_DEFINED_METADATA.indexOf(F)>-1||F.indexOf(p.USER_DEFINED_METADATA_PREFIX)===0});r.obj.UserDefinedMetadata=_.merge(D,r.obj.UserDefinedMetadata)}})["catch"](function(C){b.log("getObjectMetadataCWS",A,0,{bucketName:r.bucket,key:y});r.objectPropertiesError=x.handleErrors(C)});t.getObjectMetadata(A,r.bucket,y,B).then(function(D){b.log("getObjectMetadataProxy",A,1,{bucketName:r.bucket,key:y});var F=D.headers();if(F){if(F[p.HEADERS.X_AMZ_REPLICATION_STATUS]){r.showReplication=true;r.obj.ReplicationStatus=D.headers()[p.HEADERS.X_AMZ_REPLICATION_STATUS]}if(F[p.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]){r.obj.Encryption=F[p.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]}if(F[p.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION_KMS_ID]){r.obj.KmsID=F[p.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION_KMS_ID];r.options.kmsId=F[p.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION_KMS_ID]}if(F[p.HEADERS.X_AMZ_RESTORE]){r.restorationExpiry=undefined;var C=F[p.HEADERS.X_AMZ_RESTORE];if(C){var E=x.extractFromQuotes(C);if(E==="true"){r.showRestoration=true}else{if(E==="false"){r.showRestoration=false;r.restorationExpiry=o("date")(new Date(x.extractFromQuotes(C,1)),"medium")}}}}if(F[p.HEADERS.X_AMZ_EXPIRATION]){r.showExpiry=true;var G=F[p.HEADERS.X_AMZ_EXPIRATION];r.obj.ExpirationDate=x.extractFromQuotes(G,0);r.obj.ExpirationRule=x.extractFromQuotes(G,1)}if(F[p.HEADERS.EXPIRES.toLowerCase()]){r.obj.UserDefinedMetadata[p.HEADERS.EXPIRES]=F[p.HEADERS.EXPIRES.toLowerCase()]}}})["catch"](function(C){b.log("getObjectMetadataProxy",A,0,{bucketName:r.bucket,key:y});r.objectPropertiesError=x.handleErrors(C)});t.getBucketLocation(A,r.bucket,{}).then(function(C){r.obj.Link=c.getObjectLink(y,C.region)});i.listVersions(r.bucket,r.key,new m(p.OPERATION_NAME.LIST_VERSIONS)).then(function(C){r.showVersionId=C&&C[0]&&C[0].VersionId&&C[0].VersionId!=="null"});v(A)};r.actionButtonsDisabled=function(){if(r.obj){return r.obj.StorageClass===p.STORAGE_CLASSES.GLACIER&&!r.restorationExpiry||_.isEmpty(r.obj.ETag)}return true};function k(y){t.getObjectAcl(y,r.bucket,c.getCurrentObject()).then(function(A){var z=A.response.AccessControlPolicy.AccessControlList.Grant;b.log("getObjectACL",1,y,{bucketName:r.bucket,key:c.getCurrentObject()});if(z){if(Array.isArray(z)){z.forEach(function(B){h.updateGranteesHelperFunction(B,r.permissionObj.grantees)})}else{h.updateGranteesHelperFunction(z,r.permissionObj.grantees)}r.permissionObj.grantees=h.updateGrantees(r.permissionObj.grantees);r.permissionObj.aclGrants=Array.isArray(z)?z:[z]}})["catch"](function(z){b.log("getObjectACL",0,y,{bucketName:r.bucket,key:c.getCurrentObject()});r.aclError=x.handleErrors(z)})}function v(y){if(r.obj.StorageClass===p.STORAGE_CLASSES.GLACIER&&!r.restorationExpiry){r.warning=s.instant("objectdetail.glacierwarning")}else{r.warning="";k(y)}}function e(){var y=new m(p.OPERATION_NAME.GET_OBJECT_DETAILS);if(!r.obj){(function(){var z={bucket:r.bucket,prefix:r.key,maxKeys:1,cacheAllowed:true};t.listObjects(y,z).then(function(A){r.obj=A.response.ListBucketResult.Contents[0];q.Timer.customerReady();b.log(p.OPERATION_NAME.GET_OBJECT_DETAILS,1,y,z);r.obj.ETag=r.obj.ETag.replace(/[\\"]+/g,"");if(r.obj.Key.lastIndexOf("/")!==-1){r.obj.Key=r.obj.Key.substring(r.obj.Key.lastIndexOf("/")+1)}r.getMetadata(y)})["catch"](function(A){q.Timer.customerReady();r.objectDetailError=x.handleErrors(A);b.log(p.OPERATION_NAME.GET_OBJECT_DETAILS,0,y,A)})})()}else{b.log("GetObjectDetailsCacheHit",1,y,{bucket:r.bucket,key:r.obj.Key});r.obj.ETag=r.obj.ETag.replace(/[\\"]+/g,"");r.getMetadata(y)}}e()}})();"use strict";(function(){angular.module("s3").service("KeySelectionService",["PathService","UtilService","$location","$rootScope",function(e,b,h,a){function f(k){for(var j=0;j<k.length;j++){k[j].selected=false}}function d(i,j){if(i){f(i)}if(j){f(j)}}function g(j,k){if(k.length!==1){return false}var i=k[0];return j===e.getAbsolutePathToObjectWithBucket(b.escapePath(i.Key))}function c(i){var j={sizeDataMissing:false,totalObjs:i.objects.length,totalSize:0,totalFolders:i.folders.length};angular.forEach(i.objects,function(k){if(k.Size){j.totalSize+=k.Size}else{j.sizeDataMissing=true}});return j}return{isCurrentlySelectedObject:g,setSelectedFlagAsFalse:d,countCurrLevelFiles:c}}])})();"use strict";function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}(function(){angular.module("s3").directive("acl",[function(){return{restrict:"E",scope:{permissionObj:"=",putAcl:"=",error:"=",bucket:"=?",isBucketPermission:"=",isGlacier:"=?"},templateUrl:"/s3/partials/acl.html",controller:"AclController"}}]);angular.module("s3").controller("AclController",["$filter","$scope","$translate","APIProxyService","BucketPropertiesService","ConsoleOperation","PathService","PermissionsUtilService","S3Constants","SCLogService","UtilService",a]);function a(k,n,o,p,h,j,c,f,l,b,u){var s;n.granteeList={};n.radioSelect={displayName:null};n.granteeList.inputItem="";n.granteeList.inputError="";n.predefinedGroups=[{value:"AllUsers",text:o.instant("permissions.acl.everyone"),Type:"Group",URI:"http://acs.amazonaws.com/groups/global/AllUsers"},{value:"AuthenticatedUsers",text:o.instant("permissions.acl.any"),Type:"Group",URI:"http://acs.amazonaws.com/groups/global/AuthenticatedUsers"},{value:"LogDelivery",text:o.instant("permissions.acl.log"),Type:"Group",URI:"http://acs.amazonaws.com/groups/s3/LogDelivery"}];n.granteeListPlaceholder=o.instant("permissions.granteelist.placeholder");n.isAddGranteeRowDisplayed=false;n.showAddGranteeRow=function(){n.isAddGranteeRowDisplayed=true;u.analyticsTrackClick(l.ANALYTICS.ADD_GRANTEE,l.ANALYTICS.DETAILS);n.selectedGrantee=undefined;n.onPanelClose()};var q=[n.predefinedGroups[0].text,n.predefinedGroups[1].text,n.predefinedGroups[2].text];n.addNewGranteeToACL=function(v){n.addingGrantee=true;var w=_.cloneDeep(n.permissionObj.aclGrants);v.inputItem=v.inputItem.trim();if(q.indexOf(v)===-1){if(u.validateEmail(v.inputItem)){v={EmailAddress:v.inputItem,grantPermissions:v.grantPermissions}}else{v={ID:v.inputItem,grantPermissions:v.grantPermissions}}}f.addNewPermissions(v.grantPermissions,v,w);n.putAcl(w).then(function(){n.granteeList.inputItem=null;n.granteeList.inputError=null;i(n.isBucketPermission===true)})["catch"](function(x){n.granteeList.inputError=x;n.addingGrantee=false})};n.getPublicPermissionDisplayName=function(v){if(l.PUBLIC_PERMISSIONS_LIST.indexOf(v)>-1){return e[v]}return v};var e=(s={},_defineProperty(s,l.PUBLIC_PERMISSIONS_LIST[0],_.find(l.BUCKET_PERMISSIONS.INITIALIZE_ACLS.publicPermissions,{detail:{value:l.PUBLIC_PERMISSIONS_LIST[0]}}).detail.text),_defineProperty(s,l.PUBLIC_PERMISSIONS_LIST[1],_.find(l.BUCKET_PERMISSIONS.INITIALIZE_ACLS.publicPermissions,{detail:{value:l.PUBLIC_PERMISSIONS_LIST[1]}}).detail.text),s);function m(v){h.getBucketGrantees(n.bucket,v).then(function(w){b.log("GetBucketPermissions",1,v,{bucketName:n.bucket});n.permissionObj.grantees=f.updateGrantees(w);h.getBucketACL(n.bucket,v).then(function(x){b.log("getBucketAcls",1,v,{bucketName:n.bucket});if(x){n.permissionObj.aclGrants=Array.isArray(x)?x:[x]}})["catch"](function(x){b.log("getBucketAcls",0,v,{bucketName:n.bucket});n.aclError=x})})["catch"](function(w){b.log("GetBucketPermissions",0,v,{bucketName:n.bucket});n.aclError=w})["finally"](function(){r()})}function g(w,v){if(_.some(n.predefinedGroups,function(x){return x.value===w})){f.updateGranteesHelperFunction(v,n.permissionObj.grantees.group)}else{f.updateGranteesHelperFunction(v,n.permissionObj.grantees.accounts)}}function t(v){p.getObjectAcl(v,n.bucket,c.getCurrentObject()).then(function(x){var w=x.response.AccessControlPolicy.AccessControlList.Grant;b.log("getObjectACL",1,v,{bucketName:n.bucket,key:c.getCurrentObject()});if(w){if(Array.isArray(w)){w.forEach(function(z){var A=f.extractGranteeKey(z);g(A,z)})}else{var y=f.extractGranteeKey(w);g(y,w)}n.permissionObj.aclGrants=Array.isArray(w)?w:[w]}})["catch"](function(w){b.log("getObjectACL",0,v,{bucketName:n.bucket,key:c.getCurrentObject()});n.aclError=u.handleErrors(w)})["finally"](function(){r()})}function i(w){if(w){var v=new j("BucketPermissions","getPermissions");m(v)}else{var v=new j("ObjectPermissions","getPermissions");t(v)}}n.updateGrantee=function(w){n.updatingGrantee=true;n.granteeList.inputError=null;var y=_.cloneDeep(n.permissionObj.aclGrants);var v=undefined,x=undefined;if(w.granteeDetails.DisplayName){x=false;v=w.granteeDetails.DisplayName}else{if(w.granteeDetails.URI){x=true;v=w.granteeDetails.URI.split("/")[5]}else{x=false;v=w.granteeDetails.ID}}var z={allPermissionsRevoked:true,fullControlAdded:false};if(x){f.aclsUpdate(y,n.permissionObj.grantees.group,w.permissions,w.granteeDetails,v,z)}else{f.aclsUpdate(y,n.permissionObj.grantees.accounts,w.permissions,w.granteeDetails,v,z)}n.putAcl(y).then(function(){if(!_.isEmpty(n.permissionObj)){n.permissionObj.aclGrants=y}if(z.allPermissionsRevoked===true){if(x){n.permissionObj.grantees.group[v]=_.clone(w.permissions)}else{delete n.permissionObj.grantees.accounts[v]}}else{if(x){n.permissionObj.grantees.group[v]=_.clone(w.permissions)}else{n.permissionObj.grantees.accounts[v]=_.clone(w.permissions)}}n.onPanelClose()})["catch"](function(A){n.granteeList.inputError=A})["finally"](function(){n.updatingGrantee=false;n.panelCancel()})};n.onPanelClose=function(){n.panelHide=true;n.radioSelect.displayName=null};n.panelCancel=function(){n.onPanelClose();n.selectedGrantee=undefined};n.selectGrantee=function(v,w){n.isAddGranteeRowDisplayed=false;n.radioSelect.displayName=v;n.selectedGrantee={displayedValue:v,granteeDetails:d(v),permissions:w?_.clone(n.permissionObj.grantees.group[v]):_.clone(n.permissionObj.grantees.accounts[v])};n.panelOpen=true;n.panelHide=false};n.resetInputError=function(){if(!_.isEmpty(n.granteeList.inputError)){n.granteeList.inputError=null}};n.deleteAccountGrantee=function(){if(!n.disableDeleteButton()){n.selectedGrantee.permissions={READ:false,WRITE:false,READ_ACP:false,WRITE_ACP:false};n.updateGrantee(n.selectedGrantee)}};n.disableDeleteButton=function(){return n.isGlacier||!(n.radioSelect&&!_.isEmpty(n.radioSelect.displayName)&&l.PUBLIC_PERMISSIONS_LIST.indexOf(n.radioSelect.displayName)===-1&&n.radioSelect.displayName!==l.LOG_DELIVERY_VALUE&&n.selectedGrantee&&n.selectedGrantee.displayedValue===n.radioSelect.displayName)};function d(x){for(var w in n.permissionObj.aclGrants){var v=n.permissionObj.aclGrants[w];if(v.Grantee.DisplayName===x||v.Grantee.ID===x||v.Grantee.URI&&v.Grantee.URI.split("/")[5]===x){return v.Grantee}}return _.find(l.BUCKET_PERMISSIONS.INITIALIZE_ACLS.publicPermissions,{detail:{value:x}}).detail}function r(){n.isAddGranteeRowDisplayed=false;n.granteeList.inputItem=null;n.granteeList.inputError=null;n.addingGrantee=false;n.granteeList.grantPermissions=null}n.save=function(){n.granteeList.inputError=null;n.addNewGranteeToACL(n.granteeList)};n.cancel=function(){n.granteeList.inputError=null;r()}}})();"use strict";(function(){angular.module("s3").service("UtilService",["$cookies","$document","$filter","$location","$q","$translate","$window","AWSC","EZCRCService","FAC","Region","S3Constants",a]);function a(n,u,k,g,s,p,i,m,f,h,d,l){var j="aws-userInfo";var t="s3console_crr_iam_template";var e="s3.amazonaws.com";var o=$("body");var b=300;this.createQueue=function(C){var w=[],A=0;if(Array.isArray(C)){w=C}function B(){if(A===w.length){return undefined}var D=w[A];A++;if(A>=(w.length-1)/2){w=w.slice(A);A=0}return D}function x(D){w.push(D)}function z(){return w.length-A}function y(){return w[A]}return{dequeue:B,enqueue:x,getLength:z,peek:y}};this.escapePath=function(A){var z=A.split(l.DELIMITER);var B=[];for(var y=0;y<z.length;y++){var x=encodeURIComponent(z[y]);var w=x.replace("*","%2A").replace("(","%28").replace(")","%29").replace("!","%21").replace("'","%27");B.push(w)}return B.join("/")};this.extractTopicName=function(w){return w.substring(w.lastIndexOf(":")+1)};this.extractQueueName=function(w){return w.substring(w.lastIndexOf("/")+1)};this.getIconClassFromFilename=function(w){if(w){var x=w.substr(w.lastIndexOf(".")+1);if(l.FILE_EXTENSIONS_ICON_MAP.hasOwnProperty(x)){return l.FILE_EXTENSIONS_ICON_MAP[x]}}return l.FILE_EXTENSIONS_ICON_MAP["default"]};this.getStorageClassTranslations=function(){return{STANDARD:p.instant("uploadmodal.label.standard"),"STANDARD-IA":p.instant("versionsdropdown.label.standard_ia"),STANDARD_IA:p.instant("versionsdropdown.label.standard_ia"),REDUCED_REDUNDANCY:p.instant("uploadmodal.label.reduced_redundancy"),GLACIER:p.instant("versionsdropdown.label.glacier")}};this.getEncryptionTranslations=function(){return{NONE:p.instant("sse.none"),AES256:p.instant("sse.aes256"),"aws:kms":p.instant("sse.aws.kms")}};this.transformListOfOptionsToDropdown=function(w){return _.map(w,function(x){return{text:x,value:x,disabled:false}})};this.getStorageClassOptions=function(x){var y=this;var w=[];angular.forEach(x,function(z){var A=y.getStorageClassTranslations()[z];if(!A){A=z}w.push({value:z,text:A})});if(w.length>0){return w}return null};this.transformObjectToArray=function(x){if(!Array.isArray(x)){var w=x;x=[w]}return x};this.parseFunctionArn=function(y){var A={};var z=this.getLambdaARNPrefix();var x=y.substring(y.indexOf(z)+z.length+1);var w=x.split(":");A.region=w[0];A.accountNum=w[1];A.functionName=w[3];return A};this.getFACRegions=function(x,w){if(_.isEmpty(w)){_.forEach(x,function(y){if(l.FALLBACK_REGION_LIST[r()].indexOf(y.value)>-1){w.push(y)}})}};function r(){var w=d.DOMAINS.PUBLIC.NAME;var x=g.host();_.each(d.DOMAINS,function(z,y){if(_.contains(x,z.SUFFIX)||_.contains(x,z.GAMMA)){w=z.NAME}});return w}this.getCloudSystem=r;var q=this.getCloudSystem();this.getUserAccountId=function(){try{return JSON.parse(n.get(j)).arn.match(/[0-9]{12}/)[0]}catch(w){return null}};this.getCookie=function(w){var x="; "+document.cookie,y=x.split("; "+w+"=");if(y.length===2){return y.pop().split(";").shift()}return undefined};this.analyticsTrackClick=function(y,x){var w=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];w.s_fid=this.getCookie("s_fid");w["session-id"]=this.getCookie("session-id");m.Analytics.trackClick({id:y,context:x,metaData:w})};this.analyticsTrackView=function(y,x){var w=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];w.s_fid=this.getCookie("s_fid");w["session-id"]=this.getCookie("session-id");m.Analytics.trackView({id:y,context:x,metaData:w})};this.createOrUpdateRoleForReplication=function(z,A,x,C){var B=this.getUserAccountId();var D=s.defer();if(B===null){D.reject();return D.promise}var E={accountId:B,srcbucket:x,dstbucket:C};var y=this.getIamARNPrefix();var w=""+y+B+":";return f.zeroClickRoleCreation(z,A,e,t,2,w+"policy/service-role/"+A,E,l.IAM_REGION).then(function(){D.resolve(w+"role/service-role/"+z);return D.promise})["catch"](function(F){D.reject(F);return D.promise})};this.convertToArray=function(w){if(!Array.isArray(w)){var x=w;w=[];w.push(x)}return w};this.convertStringToBoolean=function(w){if(w==="true"){return true}else{if(w==="false"){return false}else{return undefined}}};this.isNumeric=function(w){return !isNaN(parseFloat(w))&&isFinite(w)};this.encodeXml=function(w){return w.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")};this.scrollCardToView=function(x){var w=document.getElementById(x);w.scrollIntoView()};this.scrollCardToViewSmoothly=function(w){$("html, body").animate({scrollTop:_.isEmpty(w)?0:$(w).offset().top},b)};var v=function v(x,w){if(_.isEmpty(x)){if(w.status&&Object.keys(l.STATUS_CODE_MAP).indexOf(w.status.toString())>-1){return l.STATUS_CODE_MAP[w.status.toString()]}}return x};this.handleErrors=function(w){if(!_.isEmpty(w)){if(_.isString(w)){return w}if(_.isString(w.response)){return v(w.response,w)}if(w.response&&w.response.Error&&_.isString(w.response.Error.Message)){return v(w.response.Error.Message,w)}if(w.response&&_.isString(w.response.Message)){return v(w.response.Message,w)}if(w.Error&&w.Error.Message&&_.isString(w.Error.Message)){return v(w.Error.Message,w)}if(w.response&&w.response.message&&_.isString(w.response.message)){return v(w.response.message,w)}}if(Array.isArray(w)&&w[0]===l.SESSION_TIMEOUT_MESSAGE){return c()}return p.instant("utilities.unknown.error")};this.isValidBucketName=function(y){var w=arguments.length<=1||arguments[1]===undefined?[]:arguments[1];if(!y){w.push(p.instant("createbucketmodal.validation.invalid.error"));return false}var A="\0";var C="";for(var x=0;x<y.length;x++){var z=y.charAt(x);var B="";if(/[A-Z]/.test(z)){var D=p.instant("createbucketmodal.validation.uppercase.error");if(w.indexOf(D)===-1){w.push(D)}}if(z==="."){if(A==="\0"){B=p.instant("createbucketmodal.validation.start.error")}if(A==="."){B=p.instant("createbucketmodal.validation.periods.error")}if(A==="-"){B=p.instant("createbucketmodal.validation.dashperiod.error")}}else{if(z==="-"){if(A==="\0"){B=p.instant("createbucketmodal.validation.start.error")}if(A==="."){B=p.instant("createbucketmodal.validation.dashperiod.error")}}else{if(!/[a-z0-9]/.test(z)&&C.indexOf(z)===-1){if(!/[A-Z]/.test(z)){C+=z}if(A==="\0"){B=p.instant("createbucketmodal.validation.start.error")}}}}if(B&&w.indexOf(B)===-1){w.push(B)}A=z}if(A==="."||A==="-"){w.push(p.instant("createbucketmodal.validation.end.error"))}if(C.length>0){w.push(p.instant("createbucketmodal.validation.badchars.error")+" '"+C+"'")}if(y.length<3||y.length>63){w.push(p.instant("createbucketmodal.validation.length.error"))}if(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/.test(y)){w.push(p.instant("createbucketmodal.validation.ipaddress.error"))}return w.length===0};this.bodyFreezeScroll=function(w,y){var A=undefined;if(w){A=o.width();o.addClass("noscroll");var x=o.innerWidth()-A;o.css("paddingRight",x);if(y){$(".storage-console-config-panel").css("marginRight",x)}}else{A=o.innerWidth();var z=A-o.innerWidth();o.css("paddingRight",z);if(y){$(".storage-console-config-panel").css("marginRight",z)}o.removeClass("noscroll")}};this.isIE=function(){var w=i.navigator.userAgent.toLowerCase();return w.indexOf("windows")!==-1||w.indexOf("msie")!==-1||w.indexOf("edge")!==-1};this.getRegionGroups=function(){var w={};angular.forEach(d.regionMapping,function(z){var x=z.value;var y=x.substr(0,2);if(w[y]){w[y].push(x)}else{w[y]=[x]}});return w};this.getRegionOrder=function(){var A=l.IAM_REGION;try{A=d.getCurrentRegion()}catch(z){}var y=A.substr(0,2);var x=this.getRegionGroups();var w=[];w=_.union(w,x[y]);x=_.omit(x,y);angular.forEach(x,function(B){w=_.union(w,B)});return w};this.validateEmail=function(w){var x=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return x.test(w)};this.reduceObjectArrayToObject=function(w){var x={};w.forEach(function(z){var y=Object.keys(z);x[z[y[0]]]=z[y[1]]});return x};this.extractFromQuotes=function(y){var x=arguments.length<=1||arguments[1]===undefined?0:arguments[1];var w=y;if(/"/.test(y)){w=y.match(/"(.*?)"/ig);w=w[x].substring(1,w[x].length-1)}return w};this.formatWithUnits=function(w){if(w<1024){return w+" B"}else{if(w<1024*1024){return Math.round(w/1024)+" KB"}else{if(w<1024*1024*1024){return(w/1024/1024).toFixed(1)+" MB"}else{if(w<1024*1024*1024*1024){return(w/1024/1024/1024).toFixed(2)+" GB"}else{if(w<1024*1024*1024*1024*1024){return(w/1024/1024/1024/1024).toFixed(2)+" TB"}else{return(w/1024/1024/1024/1024/1024).toFixed(2)+" PB"}}}}}};this.copyToClipboard=function(y){if(i.clipboardData&&i.clipboardData.setData){return i.clipboardData.setData("Text",y)}else{if(u[0].queryCommandSupported&&u[0].queryCommandSupported("copy")){var w=u[0].createElement("textarea");w.textContent=y;u[0].body.appendChild(w);w.select();try{return u[0].execCommand("copy")}catch(x){return false}finally{u[0].body.removeChild(w)}}}};this.getBucketARN=function(w){var x=this.getARNPrefix(l.AWS_SERVICE.S3);return""+x+w};this.getLambdaARNPrefix=function(){return this.getARNPrefix(l.AWS_SERVICE.LAMBDA)};this.getIamARNPrefix=function(){return this.getARNPrefix(l.AWS_SERVICE.IAM)};this.getSqsARNPrefix=function(){return this.getARNPrefix(l.AWS_SERVICE.SQS)};this.getSnsARNPrefix=function(){return this.getARNPrefix(l.AWS_SERVICE.SNS)};this.getARNPrefix=function(w){var y=d.DOMAINS[q].ARN;var x=l.ARN_SERVICE[w];return""+y+x};var c=function c(){var w=i.confirm(p.instant("sessionauth.expired"));if(w){i.location.reload()}else{return s.reject(l.SESSION_TIMEOUT_MESSAGE)}}}})();"use strict";(function(){angular.module("s3").directive("stickyNav",function(){function b(d,e){if(d[0].firstElementChild){$(d[0].firstElementChild).css({position:"fixed",top:e})}}function a(d,e){if(d[0].firstElementChild){$(d[0].firstElementChild).css({position:"absolute",top:e})}}return{restrict:"A",link:function c(h,f,e){var k=e.stickyNav,i=parseInt(e.stickyNavPaddingTop,10),d=e.isSidePanel,j=e.panelNavToggle,g=e.panelNavRemove;$(window).on("scroll",function(){if($(window).scrollTop()>=i){d?b(f,j):f.addClass(k)}else{d?a(f,g):f.removeClass(k)}})}}})})();"use strict";(function(){angular.module("s3").directive("breadcrumbs",[function(){return{restrict:"E",templateUrl:"/s3/partials/breadcrumbs.html",scope:{},controller:"BreadcrumbsController"}}]);angular.module("s3").controller("BreadcrumbsController",["$routeParams","$scope","PathService","Region","S3Constants",a]);function a(f,b,d,e,c){b.currentRegion=e.getCurrentRegion();b.objects=d.getFolderList();b.objects.forEach(function(g){if(g.path){g.path="buckets"+g.path+"?region="+b.currentRegion+"&tab=overview";if(f[c.SHOW_DELETED_PARAM]){g.path=g.path+"&"+c.SHOW_DELETED_PARAM+"="+f[c.SHOW_DELETED_PARAM]}}});b.condenseBreadcrumbs=false;if(b.objects.length>5){b.condenseBreadcrumbs=true}}})();"use strict";(function(){angular.module("s3").directive("search",[function(){return{restrict:"E",templateUrl:"/s3/partials/search.html",scope:{fetchOnePagePrefix:"&?",fetchOnePageTag:"&?",filters:"=?",markers:"=?",noBackendCalls:"=?",searchError:"=?",showTag:"=?",tagContinuationTokens:"=?",tagSearchSelected:"=?",tagQueryDeferred:"=?",empty:"=?"},controller:"SearchController"}}]);angular.module("s3").controller("SearchController",["$filter","$routeParams","$scope","$translate","FAC","focusOn","PathService","S3Constants",function(h,k,l,a,j,n,i,e){var m=new RegExp(/[^+ \- = . _ : /A-Za-z0-9 ]/g),d=new RegExp(/[^+ \- = . _ : , /A-Za-z0-9 ]/g),g=new RegExp(/,[^ ](?!\1)|,$/g);l.objectTaggingEnabled=(l.noBackendCalls||_.isUndefined(i.getCurrentAbsoluteFolderPath()))&&j.isFeatureEnabled(e.FAC.OBJECT_TAGGING);if(!l.noBackendCalls&&!j.isFeatureEnabled(e.FAC.TAG_QUERY)){l.objectTaggingEnabled=false}l.inputDropdownText=l.objectTaggingEnabled?a.instant("tagsearch.dropdowntext"):a.instant("prefixsearch.dropdowntext");l.getInputPlaceholder=function(){if(l.empty){return a.instant("prefixtagsearch.optional.placeholder")}if(l.noBackendCalls){return a.instant("prefixtagsearch.placeholder")}if(!l.objectTaggingEnabled){return a.instant("prefixsearch.placeholder")}else{if(l.filters&&l.filters.tagFilters.length>0){return a.instant("tagsearch.addfilter")}else{return a.instant("tagsearch.placeholder")}}};l.clearFilterInput=function(){l.filters.input=""};l.highlightRow=function(o){l.tagSearchSelected=o};l.filterKeyDown=function(o){l.dropdownOpen=true;if(o&&o.keyCode===e.KEY_CODES.ESC){l.clearFilterInput();b();l.prefixSearch()}if(o&&o.keyCode===e.KEY_CODES.ENTER){if(_.isEmpty(l.filters.input)&&l.noBackendCalls){return}if(l.showTag){l.tagSearch(true);l.closeDropdown()}else{if(l.tagSearchSelected){l.selectTag()}else{l.prefixSearch();l.closeDropdown();if(l.noBackendCalls){l.filters.input=""}}}}if(l.objectTaggingEnabled&&o&&o.keyCode===e.KEY_CODES.DOWN){o.preventDefault();l.tagSearchSelected=true}if(l.objectTaggingEnabled&&o&&o.keyCode===e.KEY_CODES.UP){o.preventDefault();l.tagSearchSelected=false}};l.shouldShowTag=function(){if(!l.filters||!l.filters.input||!l.objectTaggingEnabled){return false}var o=l.filters.input;if(o.search(/.+ \| /g)>-1){l.showTag=true;return true}else{l.showTag=false;return false}};l.selectTag=function(){l.searchError="";l.showTag=true;l.filters.input=l.filters.input+" | ";n("prefixSearchInput")};l.openDropdown=function(){l.dropdownOpen=true};l.closeDropdown=function(){l.dropdownOpen=false;l.tagSearchSelected=false};l.isSearchEmpty=function(){if(l.filters&&_.isEmpty(l.filters.input)){l.searchError="";l.tagSearchSelected=false;l.showTag=false;return true}else{return false}};l.removePrefixFilter=function(o){l.filters.input="";for(var p=0;p<l.filters.prefixFilters.length;p++){if(o===l.filters.prefixFilters[p]){l.filters.prefixFilters.splice(p,1)}}l.prefixSearch()};l.removeTagFilter=function(o){if(l.tagQueryDeferred){l.tagQueryDeferred.reject()}for(var p=0;p<l.filters.tagFilters.length;p++){if(o===l.filters.tagFilters[p]){l.filters.tagFilters.splice(p,1)}}if(l.filters.tagFilters.length>0){l.tagSearch(false)}else{if(!l.noBackendCalls){l.fetchOnePagePrefix({prefix:""})}}};l.prefixSearch=function(){l.searchError="";var q=l.filters.input.indexOf("/");if(l.noBackendCalls&&q===0){l.bucketName=k[e.PATH_SEGMENTS.BUCKET_NAME];l.prefixInfo=l.filters.input}else{l.bucketName="";l.prefixInfo=""}if(!l.noBackendCalls&&q!==-1){l.searchError=a.instant("prefixsearch.validation.error")}else{var p="";var o=l.filters.input;if(!l.noBackendCalls){l.filters.tagFilters=[];p=i.getCurrentAbsoluteFolderPath()||"";p=p.concat(o)}if(o!==""){l.filters.prefixFilters=[o];if(l.noBackendCalls){l.filters.input=""}l.closeDropdown()}else{l.filters.prefixFilters=[]}if(!l.noBackendCalls){if(l.tagQueryDeferred){l.tagQueryDeferred.reject()}l.markers=[];l.fetchOnePagePrefix({prefix:p})}}};l.tagSearch=function(o){l.tagContinuationTokens=[];l.searchError="";if(o){(function(){var q=l.filters.input,s=q.split(" | "),r=s[0],u=s[1],t=u.split(",");if(r.length>e.ENTITY_MAX_LENGTH.TAG_KEY){l.searchError=a.instant("tagKey.length.error")}else{if(!c(t)){l.searchError=a.instant("tagVal.length.error")}else{if(r.search(m)>-1){l.searchError=a.instant("tagKey.validation.error")}else{if(u.search(d)>-1||u.search(g)>-1){l.searchError=a.instant("tagVal.validation.error")}else{if(f(r,t)){l.searchError=a.instant("tagsearch.duplicate.error")}else{var p=true;l.filters.input="";if(!l.noBackendCalls){angular.forEach(l.filters.tagFilters,function(v){if(v.tagKey===r){v.tagVal+=", "+u;p=false}})}if(p){l.filters.tagFilters=l.filters.tagFilters.concat({tagKey:r,tagVal:u})}}}}}}})()}l.tagSearchSelected=false;l.showTag=false;if(!l.noBackendCalls){if(l.tagQueryDeferred){l.tagQueryDeferred.reject()}l.filters.prefixFilters=[];l.fetchOnePageTag()}};function c(p){var o=true;angular.forEach(p,function(q){if(q.length>e.ENTITY_MAX_LENGTH.TAG_VALUE){o=false}});return o}function f(o,p){var q=false;angular.forEach(l.filters.tagFilters,function(r){if(r.tagKey===o){angular.forEach(p,function(s){if(r.tagVal.indexOf(s)>-1){q=true}})}});return q}function b(){l.searchError="";l.tagSearchSelected=false;l.showTag=false;l.tagContinuationTokens=[];if(l.filters){l.filters.input="";l.filters.prefixFilters=[];l.filters.tagFilters=[]}else{l.filters={input:"",prefixFilters:[],tagFilters:[]}}}if(!l.noBackendCalls){b()}}])})();"use strict";(function(){angular.module("s3").directive("filedrop",["S3Constants","SCLogService",function(a,b){return{restrict:"A",link:function c(f,e,d){function g(k){for(var j in k){if(k[j].kind==="file"){return true}}return false}function h(){e.off("drop");e.off("dragdrop");e.off("dragover")}e.on("drop",function(i){i.stopPropagation();i.preventDefault();if(!i.originalEvent.dataTransfer||!g(i.originalEvent.dataTransfer.items)){return}f.$apply(function(){f.$emit("fileDropEvent",i.originalEvent.dataTransfer.items)})});e.on("dragdrop",function(i){i.stopPropagation();i.preventDefault()});e.on("dragover",function(i){i.stopPropagation();i.preventDefault()});f.$on("$destroy",h)}}}])})();"use strict";(function(){angular.module("s3").service("BucketPropertiesUtilService",["BucketPropertiesService","S3Constants","$filter","$q","$translate","UtilService","XMLParser",function(g,l,k,q,m,t,u){function h(v,x){if(v.BucketLoggingStatus&&v.BucketLoggingStatus.LoggingEnabled){var w=v.BucketLoggingStatus.LoggingEnabled;x.selectedValue=l.BUCKET_PROPERTIES.ENABLE;x.targetPrefix=_.isEmpty(w.TargetPrefix)?"":w.TargetPrefix;x.targetBucket=w.TargetBucket;if(w.TargetGrants){x.targetGrants=w.TargetGrants.Grant}else{x.targetGrants=[]}}else{x.selectedValue=l.BUCKET_PROPERTIES.DISABLE;x.targetPrefix="";x.targetBucket="";x.targetGrants=[]}}function r(w){var v="<RoutingRule>";if(w.Condition){v+="<Condition>";if(w.Condition.KeyPrefixEquals){v+="<KeyPrefixEquals>"+w.Condition.KeyPrefixEquals+"</KeyPrefixEquals>"}if(w.Condition.HttpErrorCodeReturnedEquals){v+="<HttpErrorCodeReturnedEquals>"+w.Condition.HttpErrorCodeReturnedEquals+"</HttpErrorCodeReturnedEquals>"}v+="</Condition>"}if(w.Redirect){v+="<Redirect>";if(w.Redirect.Protocol){v+="<Protocol>"+w.Redirect.Protocol+"</Protocol>"}if(w.Redirect.HostName){v+="<HostName>"+w.Redirect.HostName+"</HostName>"}if(w.Redirect.ReplaceKeyPrefixWith){v+="<ReplaceKeyPrefixWith>"+w.Redirect.ReplaceKeyPrefixWith+"</ReplaceKeyPrefixWith>"}if(w.Redirect.ReplaceKeyWith){v+="<ReplaceKeyWith>"+w.Redirect.ReplaceKeyWith+"</ReplaceKeyWith>"}if(w.Redirect.HttpRedirectCode){v+="<HttpRedirectCode>"+w.Redirect.HttpRedirectCode+"</HttpRedirectCode>"}v+="</Redirect>"}v+="</RoutingRule>";return v}function p(v,z){if(v&&v.WebsiteConfiguration){var w=v.WebsiteConfiguration;if(w.RedirectAllRequestsTo){z.selectedValue=l.BUCKET_PROPERTIES.WEBSITE.REDIRECT_REQUEST;z.targetDomain=angular.copy(w.RedirectAllRequestsTo.HostName);z.redirectRequestProtocol=_.isEmpty(w.RedirectAllRequestsTo.Protocol)?"":w.RedirectAllRequestsTo.Protocol;z.websiteEnabledOption=m.instant("bucketproperties.website.footer.redirectallrequests");z.websiteEnabledContent=angular.copy(z.targetDomain);z.indexDocument="";z.errorDocument="";z.routingXML=""}else{if(w.IndexDocument){z.selectedValue=l.BUCKET_PROPERTIES.WEBSITE.USE_BUCKET;z.indexDocument=angular.copy(w.IndexDocument.Suffix);z.websiteEnabledOption=m.instant("bucketproperties.website.footer.buckethosting");z.websiteEnabledContent=angular.copy(z.indexDocument);if(w.ErrorDocument){z.errorDocument=angular.copy(w.ErrorDocument.Key)}if(w.RoutingRules){var C="<RoutingRules>";var B=t.transformObjectToArray(w.RoutingRules.RoutingRule);if(B.length){for(var y=0,A=B.length;y<A;y++){var x=B[y];C+=r(x)}}C+="</RoutingRules>";z.routingXML=angular.copy(C);z.routingXMLToggle=true}else{z.routingXML=""}z.targetDomain="";z.redirectRequestProtocol=""}}}else{z.selectedValue=l.BUCKET_PROPERTIES.DISABLE;s(z)}}function c(v,x){if(v.Tagging.TagSet.Tag.length){for(var w=0;w<v.Tagging.TagSet.Tag.length;w++){x.push({Key:v.Tagging.TagSet.Tag[w].Key,Value:_.isEmpty(v.Tagging.TagSet.Tag[w].Value)?"":v.Tagging.TagSet.Tag[w].Value})}}else{x.push({Key:v.Tagging.TagSet.Tag.Key,Value:_.isEmpty(v.Tagging.TagSet.Tag.Value)?"":v.Tagging.TagSet.Tag.Value})}}function s(v){v.websiteEnabledOption="";v.websiteEnabledContent="";v.indexDocument="";v.errorDocument="";v.routingXML="";v.targetDomain="";v.redirectRequestProtocol=""}function n(y,z,v,C,A){v.rulesArray=[];var x=u.convertXmlStringToJson(y);if(x.ReplicationConfiguration&&x.ReplicationConfiguration.Rule){var B=x.ReplicationConfiguration.Rule;if(Array.isArray(B)){v.isEnabled=l.REPLICATION.DISABLED;v.destinationBucket=i(B[0].Destination.Bucket);v.replicationType="prefix";B.forEach(function(D){v.isEnabled=v.isEnabled===l.REPLICATION.ENABLED||D.Status===l.REPLICATION.ENABLED?l.REPLICATION.ENABLED:l.REPLICATION.DISABLED;e(D,v.rulesArray)})}else{v.isEnabled=B.Status;v.destinationBucket=i(B.Destination.Bucket);if(z===B.ID){v.replicationType="bucket";v.storageClass=B.Destination.StorageClass&&!_.isEmpty(B.Destination.StorageClass)?B.Destination.StorageClass:l.STORAGE_CLASSES.DEFAULT}else{v.replicationType="prefix";e(B,v.rulesArray)}}v.role=x.ReplicationConfiguration.Role;return g.getBucketLocation(v.destinationBucket).then(function(D){if(!A){v.resetDestinationBucket=true}v.destinationRegion=!_.isEmpty(C)?_.find(C,{value:D}):D})}else{v.role="";v.destinationBucket="";v.destinationRegion="";v.storageClass="";v.rulesArray=[];v.replicationType="";v.isEnabled=l.REPLICATION.DISABLED;v.response="";var w=q.defer();return w.promise}}function d(w,v){if(v.replicationType==="bucket"){v.rules=[{id:w,prefix:"",status:v.isEnabled}];if(v.storageClass!=="default"){v.rules[0].storageClass=v.storageClass}}else{v.rules=[];v.rulesArray.forEach(function(y){if(!y.markedForDelete){var x=_.clone(y);if(x.storageClass==="default"){delete x.storageClass}if(v.isEnabled===l.REPLICATION.DISABLED){x.status=l.REPLICATION.DISABLED}v.rules.push(x)}})}}function i(v){return v.substring(v.lastIndexOf(":")+1)}function e(v,w){w.push({id:v.ID,prefix:v.Prefix,status:v.Status,storageClass:v.Destination.StorageClass&&!_.isEmpty(v.Destination.StorageClass)?v.Destination.StorageClass:l.STORAGE_CLASSES.DEFAULT,markedForDelete:false})}function f(v){var y=[{name:l.EVENTS.TOPIC,value:l.EVENTS.TOPICCONFIG,display:l.EVENTS.SNS,dropdown:"SNS topics"},{name:l.EVENTS.QUEUE,value:l.EVENTS.QUEUECONFIG,display:l.EVENTS.SQS,dropdown:"SQS queues"},{name:l.EVENTS.CLOUDFN,value:l.EVENTS.CLOUDCONFIG,display:l.EVENTS.LAMBDA,dropdown:"Lambda functions"}];var w={};var x=v.NotificationConfiguration;y.forEach(function(A){var z=[];var B=x[A.value];if(B){B=t.convertToArray(B);B.forEach(function(C){z.push(j(C,A))})}w[A.name]=z});return w}function j(w,y){var z={};z.id=w.Id;if(w.Filter&&w.Filter.S3Key&&w.Filter.S3Key.FilterRule){var v=t.convertToArray(w.Filter.S3Key.FilterRule);v.forEach(function(A){if(A.Name===l.EVENTS.PREFIX&&A.Value&&!_.isEmpty(A.Value)&&A.Value!==""){z.prefix=A.Value}if(A.Name===l.EVENTS.SUFFIX&&A.Value&&!_.isEmpty(A.Value)&&A.Value!==""){z.suffix=A.Value}})}z.arn=w[y.name];z.events=[];var x=t.convertToArray(w.Event);x.forEach(function(A){z.events.push(A)});z.type=y.display;return z}function o(B,x,A){var w=B.length;if(w===1){for(var z=0;z<x[0].length;z++){x[0][z].disabled=false}}else{if(w===2){for(var z=0;z<w;z++){for(var y=0;y<x[z].length;y++){x[z][y].disabled=false}}if(!_.isEmpty(B[0].action)){var C=A[B[0].action];for(var z=0;z<=C;z++){x[1][z].disabled=true}}if(!_.isEmpty(B[1].action)){var v=A[B[1].action];for(var z=v;z<x[0].length;z++){x[0][z].disabled=true}}}else{if(w===x.length){for(var z=0;z<w;z++){for(var y=0;y<w;y++){x[z][y].disabled=z!==y?true:false}}}}}}function a(v,x){if(x.length===l.LIFECYCLE.TOTAL_OPTIONS){return true}else{for(var w=0;w<x.length;w++){if(x[w].action===v){return true}}return false}}function b(w){if(w){var v=w.lastIndexOf(":");return w.substring(v+1)}return w}return{clearAllWebsiteFields:s,populateLoggingFields:h,populateWebsiteFields:p,populateTagsFields:c,generateRoutingRuleXML:r,handleRules:d,populateReplicationObj:n,parseBucketNotificationConfig:f,updateLifecycleDropdown:o,isTransitionDisabled:a,stripBucketARN:b}}])})();"use strict";(function(){angular.module("s3").directive("actionDropdown",[function(){return{restrict:"E",scope:{text:"@",items:"=",bucketname:"=",isSingleObjectOnlySelected:"=",getSelectedFolders:"=",getSelectedObjects:"=",showDeleted:"=?",tagFilterLength:"="},template:'<awsui-button-dropdown ng-click="takeAction()" item-click="triggerItem(event)" items="items" text="{{text}}"></awsui-button-dropdown>',controller:"ActionDropdownController"}}]);angular.module("s3").controller("ActionDropdownController",["$scope","BucketPropertiesService","ConsoleOperation","CopyService","KeySelectionService","S3Constants",a]);function a(m,c,h,b,i,d){var l=["getinfo","download","rename","initiaterestore","dropdowndelete","cut","copy","changestorageclass","changeencryption","makeobjectpublic","addobjecttags"];var f=["download","rename","addobjecttags"];var j=["getinfo","makeobjectpublic","initiaterestore","dropdowndelete"];var g=["download","rename","initiaterestore"];var e=["undodelete"];function k(w){var s=function s(y,x){_.forEach(y,function(z){w[z].disabled=x})};var q=m.getSelectedObjects(),p=m.getSelectedFolders(),r=_.isEmpty(q)&&_.isEmpty(p),n=b.getClipboardOperation()!==null,v=m.isSingleObjectOnlySelected(),t=p.length>=1,o=p.length===1&&q.length===0,u=p.length===0&&_.every(q,{StorageClass:"GLACIER"});w.paste.disabled=!n;if(r){s(l,true)}else{if(m.showDeleted){s(l,true);s(e,true);if(!t){s(e,false)}}else{if(u||v&&u){s($(l).not(j),true);s(j,false)}else{if(t){s(f,true);s($(l).not(f),false)}else{if(!v&&!o){s(g,true);s($(l).not(g),false)}else{if(m.tagFilterLength>0){s($(l).not(["initiaterestore","rename"]),false);s(["initiaterestore","rename"],true)}else{s($(l).not(["initiaterestore"]),false);s(["initiaterestore"],true)}}}}}}}m.takeAction=function(){if(m.items&&m.items[0].items){var n={getinfo:m.items[0].items[0],download:m.items[0].items[1],rename:m.items[1].items[0],dropdowndelete:m.items[1].items[1],undodelete:m.items[1].items[2],showdeleteobjs:m.items[1].items[3],cut:m.items[2].items[0],copy:m.items[2].items[1],paste:m.items[2].items[2],changestorageclass:m.items[3].items[0],initiaterestore:m.items[3].items[1],changeencryption:m.items[3].items[2],makeobjectpublic:m.items[3].items[3],addobjecttags:m.items[3].items[4]};k(n)}};m.triggerItem=function(p){var q=p.originalEvent.detail.id;function n(r){if(r.id==q){return r}if(r.items){return r.items.filter(n)[0]}}var o=m.items.map(n).filter(function(r){return r})[0];o.action()}}})();"use strict";(function(){angular.module("s3").service("CountService",["ConsoleOperation","KeySelectionService","PathService","S3Constants","SCLogService","S3CWSAPIService","$q",function(h,i,k,b,o,n,e){var f="generateCountInvoked";var m="generateCountBucket";var a="generateCountRequest";var g="CountCompleted";var d={generateCountForOperation:j,generateCountForFullPathFoldersWithContinuationTokens:c,countAllFiles:l};return d;function j(q){var p=e.defer();q.countResultEachFolder={};var v=Math.ceil(q.selectedFolders.length/b.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API);var u=0;function t(x){d.generateCountForFullPathFoldersWithContinuationTokens(q,x,[]).then(function(z){u+=1;if(u===v){o.log(g,1,z);p.resolve(z)}else{var y=[];var B=z.selectedFolders.length<=(u+1)*b.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API?z.selectedFolders.length:(u+1)*b.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API;for(var A=u*b.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API;A<B;A++){y.push(z.selectedFolders[A].Prefix)}t(y)}})["catch"](function(y){p.reject(y);o.log(g,0,q)})}var s=[];var w=q.selectedFolders.length<=b.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API?q.selectedFolders.length:b.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API;for(var r=0;r<w;r++){s.push(q.selectedFolders[r].Prefix)}t(s);return p.promise}function c(p,s,t){var r=p.initialBucket;var u=p.initialPath;var q={};q.bucket=r;q.path=u;q.selectedFolders=s;o.log(f,1,p,q);if(s.length===0){o.log(m,1,p,q);s=[""]}return n.generateCount(r,s,t,p).then(function(v){if(v&&v.data&&v.data.statusPerKey){o.logRequestComplete(a,p);var x=[];var w=[];_.each(v.data.statusPerKey,function(z){if(z.result&&z.result.additionalInfoWhenSuccess){var y=z.result.additionalInfoWhenSuccess;if(p.countResultEachFolder[z.key]){p.countResultEachFolder[z.key].count+=y.count;p.countResultEachFolder[z.key].totalSize+=y.totalSize}else{p.countResultEachFolder[z.key]=y}p.keyCount+=y.count;p.totalSizeInBytes+=y.totalSize;if(y.continuationToken){x.push(y.continuationToken);w.push(z.key)}}});if(x.length>0){return e.resolve(c(p,w,x))}return e.resolve(p)}return e.reject(v)})["catch"](function(v){o.log(a,0,p,{bucketName:r,path:u,error:v});p.keyCount=-1;return e.reject(v)})}function l(t,p,q,s){s.flag=true;var r=i.countCurrLevelFiles(t);p.sizeDataMissing=r.sizeDataMissing;p.folders=r.totalFolders;p.currLevelObjs=r.totalObjs;p.objects=r.totalObjs;p.size=r.totalSize;p.flag=true;if(t.folders&&!_.isEmpty(t.folders)){d.generateCountForOperation(q).then(function(){o.log("generateCountForOperation",1,q);p.objects+=q.keyCount;p.size+=q.totalSizeInBytes;angular.forEach(q.countResultEachFolder,function(v,u){p.countResultEachFolder[u]=v})})["catch"](function(u){p.error=u;o.log("generateCountForOperation",0,q,{errorMessage:u})})["finally"](function(){s.flag=false})}else{s.flag=false}}}])})();"use strict";(function(){angular.module("s3").service("DownloadService",["ConsoleOperation","KeySelectionService","PathService","S3CWSAPIService","SCLogService","$q","$window",function(l,q,d,e,c,t,m){var h="objectDownload";var a="objDLPresignFetchStart";var i="fetchPresignedUrl";var n="DownloadSize";var f="Content-Disposition";var o="attachment";var r="inline";var g="GET";function s(A,B,z,x,v){var y={};y[f]=v?r:o;return e.fetchPresignedUrl(B,A,g,y,{},null,null,x).then(function u(C){c.log(n,z,x);c.log(i,1,x,{key:A,bucket:B});return t.resolve(C)},function w(D){var C={};C.error=D;C.key=A;C.bucket=B;c.log(i,0,x,C);return t.reject(C)})}function b(y,x){var w=d.getCurrentBucket();var v=new l(h,a);return s(y,w,x,v).then(function u(z){m.location.href=z.data.presignedUrl;return t.resolve(z)})}function p(v){if(v&&v.Key){return b(d.relativeToAbsoluteObjectPath(v.Key),v.Size)}var u=t.defer();u.reject(v);return u.promise}function j(w){var x=d.getCurrentBucket();var v=new l(h,a);if(w&&w.Key){return s(d.relativeToAbsoluteObjectPath(w.Key),x,w.Size,v)}var u=t.defer();u.reject(w);return u.promise}function k(y,x){var w=d.getCurrentBucket();var v=new l(h,a);s(d.relativeToAbsoluteObjectPath(y),w,x,v,true).then(function u(z){m.open(z.data.presignedUrl,"_blank")})}return{downloadCurrentSelection:p,generatePresignedUrlForCurrentObject:j,openInBrowser:k}}])})();"use strict";(function(){angular.module("s3").directive("addEventsForm",function(){return{restrict:"E",scope:{isOpen:"=",selectedEvent:"=",updateEvents:"=",eventTypes:"=",currentConfig:"=",resourceTypes:"=",forCreateBucketModal:"=?",modalInfo:"=?",cardState:"="},templateUrl:"/s3/partials/addeventsform.html",controller:"AddEventController"}});angular.module("s3").controller("AddEventController",["$filter","$scope","$translate","BucketPropertiesService","ConsoleOperation","LambdaService","PathService","APIProxyService","S3Constants","SCLogService","SNSService","SQSService","UtilService","XMLParser",function(h,j,k,e,f,m,c,l,i,b,r,n,p,q){var a=function a(){j.showCustomArn=false;j.eventResources=[];j.eventsChecked={};j.eventTypes.forEach(function(s){j.eventsChecked[s.complexName]=false});j.resourceTypesDropdown=[];j.resourceTypes.forEach(function(s){j.resourceTypesDropdown.push({text:s.dropdown,value:s.display})});j.selectValue={value:""};j.bucket=c.getCurrentBucket();j.currentEventType=j.eventTypes[0];j.S3Constants=i;j.selectedEvent.events.forEach(function(s){j.eventsChecked[s]=true});j.updateEventResources()};var o=function o(t){if(j.selectedEvent.arn===""){return}var s=_.find(j.eventResources,function(u){return u.text===t.arn.substring(t.arn.lastIndexOf(":")+1)});if(s===undefined){j.selectValue.value=i.EVENTS.CUSTOM;j.showCustomArn=true}else{j.selectValue.value=s.value}};j.updateEventResources=function(){j.eventResources=[];if(j.forCreateBucketModal){return g(j.modalInfo.region)}else{return e.getBucketLocation(j.bucket).then(function(s){return g(s)})["catch"](function(s){j.cardState.errorMessage=s.response;j.cardState.showError=true})}};j.getCustomArnLabel=function(){var s=undefined;switch(j.selectedEvent.type){case i.EVENTS.SNS:s=k.instant("events.label.customsnsarn");j.customarn_placeholder=p.getARNPrefix(i.AWS_SERVICE.SNS)+i.EVENTS.CUSTOM_PLACEHOLDER.SNS;break;case i.EVENTS.SQS:s=k.instant("events.label.customsqsarn");j.customarn_placeholder=p.getARNPrefix(i.AWS_SERVICE.SQS)+i.EVENTS.CUSTOM_PLACEHOLDER.SQS;break;case i.EVENTS.LAMBDA:s=k.instant("events.label.customlambdaarn");j.customarn_placeholder=p.getARNPrefix(i.AWS_SERVICE.LAMBDA)+i.EVENTS.CUSTOM_PLACEHOLDER.LAMBDA;break}return s};function g(t){var s=new f("updateResource");j.updateCurrentEventType(j.selectedEvent.type);j.isLoadingResources=true;if(j.selectedEvent.type===i.EVENTS.SNS){return l.makeProxyRequest(r.listTopics,{region:t},i.PROXY_API_NAMES.SNS.LIST_TOPICS,s).then(function(u){var v=u.response.ListTopicsResponse.ListTopicsResult.Topics;if(v){v.forEach(function(w){j.eventResources.push({value:w.TopicArn,text:p.extractTopicName(w.TopicArn)})})}j.eventResources.push({value:i.EVENTS.CUSTOM,text:k.instant("events.option.customsnsarn")});j.isLoadingResources=false;o(j.selectedEvent)})["catch"](function(u){j.cardState.listTopicError=p.handleErrors(u)})}else{if(j.selectedEvent.type===i.EVENTS.SQS){return l.makeProxyRequest(n.listQueues,{region:t},i.PROXY_API_NAMES.SQS.LIST_QUEUES,s).then(function(v){var u=v.response.ListQueuesResponse.ListQueuesResult.queueUrls;if(u){u.forEach(function(w){j.eventResources.push({value:d(w),text:p.extractQueueName(w)})})}j.eventResources.push({value:i.EVENTS.CUSTOM,text:k.instant("events.option.customsqsarn")});j.isLoadingResources=false;o(j.selectedEvent)})["catch"](function(u){j.cardState.listTopicError=p.handleErrors(u)})}else{if(j.selectedEvent.type===i.EVENTS.LAMBDA){return l.makeProxyRequest(m.listFunctions,{region:t},i.PROXY_API_NAMES.LAMBDA.LIST_FUNCTIONS,s).then(function(v){var u=v.response.Functions;if(u){u.forEach(function(w){j.eventResources.push({value:w.FunctionArn,text:w.FunctionName})})}j.eventResources.push({value:i.EVENTS.CUSTOM,text:k.instant("events.option.customlambdaarn")});j.isLoadingResources=false;o(j.selectedEvent)})["catch"](function(u){j.cardState.listTopicError=p.handleErrors(u)})}}}}function d(t){var w=p.getARNPrefix(i.AWS_SERVICE.SQS);var v=t.substring(t.indexOf(".")+1);var u=v.substring(0,v.indexOf("."));var s=v.substring(v.indexOf("/")).replaceAll("/",":");return w+u+s}j.updateCurrentEventType=function(s){switch(s){case i.EVENTS.SNS:j.currentEventType=j.eventTypes[0];break;case i.EVENTS.SQS:j.currentEventType=j.eventTypes[1];break;case i.EVENTS.LAMBDA:j.currentEventType=j.eventTypes[2];break}};j.selectChanged=function(){if(j.selectValue.value!==i.EVENTS.CUSTOM){j.selectedEvent.arn=j.selectValue.value}};j.handleCheckboxes=function(){j.selectedEvent.events=_.filter(_.keys(j.eventsChecked),function(s){return j.eventsChecked[s]})};a()}])})();"use strict";(function(){angular.module("s3").directive("events",[function(){return{restrict:"E",scope:{cardOpen:"=",forCreateBucketModal:"=?",createBucketObj:"=?",modalInfo:"=?",id:"@?"},templateUrl:"/s3/partials/events.html",controller:"EventsController"}}]);angular.module("s3").controller("EventsController",["$filter","$q","$scope","$timeout","$translate","APIProxyService","AwsUrlsService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","FAC","LambdaService","PathService","Region","S3Constants","SCLogService","SNSService","SQSService","UtilService","XMLParser",a]);function a(q,z,u,B,w,x,d,l,i,n,m,y,f,g,r,e,E,A,C,D){var v,p,o,j;function h(){u.cardSummaryObj.isActive=u.eventsTable.length>0;if(u.cardSummaryObj.isActive>0){u.cardSummaryObj.activeSummary.text=u.eventsTable.length+w.instant("bucketproperties.events.activenotifications")}else{u.cardSummaryObj.inactiveSummary.text=u.eventsTable.length+w.instant("bucketproperties.events.activenotifications")}}function c(){u.cardState={errorMessage:"",headerTitle:w.instant("event.table.newevent"),isAdding:true,isSaving:false,radioValue:"",selectedEventObj:null,selectedEventTable:null,showError:false};u.eventTypes=[{simpleName:w.instant("events.eventTypes.objectlost"),complexName:r.BUCKET_EVENTS.RRS_OBJECT_LOST},{simpleName:w.instant("events.eventTypes.put"),complexName:r.BUCKET_EVENTS.PUT},{simpleName:w.instant("events.eventTypes.post"),complexName:r.BUCKET_EVENTS.POST},{simpleName:w.instant("events.eventTypes.copy"),complexName:r.BUCKET_EVENTS.COPY},{simpleName:w.instant("events.eventTypes.completeMultipartUpload"),complexName:r.BUCKET_EVENTS.COMPLETE_MULTIPART_UPLOAD},{simpleName:w.instant("events.eventTypes.delete"),complexName:r.BUCKET_EVENTS.DELETE},{simpleName:w.instant("events.eventTypes.deleteMarker"),complexName:r.BUCKET_EVENTS.DELETE_MARKER_CREATED},{simpleName:w.instant("events.eventTypes.objectCreate"),complexName:r.BUCKET_EVENTS.CREATE_OBJECT_ALL},{simpleName:w.instant("events.eventTypes.objectDelete"),complexName:r.BUCKET_EVENTS.DELETE_OBJECT_ALL}];u.eventsMap={};u.eventTypes.forEach(function(H){u.eventsMap[H.simpleName]=H.complexName;u.eventsMap[H.complexName]=H.simpleName});u.scrollCardId="#"+u.id;u.cardSummaryObj=_.cloneDeep(r.CARD_SUMMARY_INIT);v=new n("BucketNotification","getBucketNotification");p=new n("BucketNotification","putBucketNotification");o=f.getCurrentBucket();u.eventsTable=[];j=g.getCurrentRegion();var G={name:r.EVENTS.CLOUDFN,value:r.EVENTS.CLOUDCONFIG,display:r.EVENTS.LAMBDA,dropdown:w.instant("events.label.lambdafunction")};u.resourceTypes=[{name:r.EVENTS.TOPIC,value:r.EVENTS.TOPICCONFIG,display:r.EVENTS.SNS,dropdown:w.instant("events.label.snstopic")},{name:r.EVENTS.QUEUE,value:r.EVENTS.QUEUECONFIG,display:r.EVENTS.SQS,dropdown:w.instant("events.label.sqsqueue")},G];if(u.forCreateBucketModal){j=u.modalInfo.region;if(!u.isFeatureEnabled("s3-la-"+j)){u.resourceTypes.pop()}}else{l.getBucketLocation(o).then(function(H){j=H;if(!u.isFeatureEnabled("s3-la-"+j)){u.resourceTypes.pop()}})}if(u.forCreateBucketModal){u.$watch("cardOpen",function(I,H){B(function(){C.scrollCardToView(r.BUCKET_PROPERTIES.EVENTS.CREATE_BUCKET_CARD)},1)})}if(u.forCreateBucketModal){if(u.modalInfo.copySettingsSourceBucket){var F=D.convertXmlStringToJson(u.createBucketObj.response);u.currentEvents=i.parseBucketNotificationConfig(F);u.createBucketObj.currentEvents=u.currentEvents}else{if(u.createBucketObj.currentEvents){u.currentEvents=u.createBucketObj.currentEvents}else{u.currentEvents={Topic:[],Queue:[],CloudFunction:[]}}}u.updateTable()}else{u.updateEvents().then(function(){u.updateTable();h()})}}u.updateEvents=function(){return l.getBucketNotification(o,v).then(function(H){var G=H.response;var F=D.convertXmlStringToJson(G);u.currentEvents=i.parseBucketNotificationConfig(F)})["catch"](function(F){k(F)})};u.updateTable=function(){u.eventsTable=[];if(!u.currentEvents){return}u.resourceTypes.forEach(function(F){u.currentEvents[F.name].forEach(function(H){var G={id:H.id,type:H.type};G.events=_.map(H.events,function(I){return u.eventsMap[I]}).toString();G.filter=s(H.prefix,H.suffix);G.isEditing=false;u.eventsTable.push(G)})});u.cardState.isAdding=false};function s(F,G){if(F&&G){return F+", "+G}else{if(F){return F}else{if(G){return G}else{return""}}}}function t(F){return _.find(u.resourceTypes,function(G){return G.display===F.type})}u.selectEvent=function(G){u.closeAddEvents();var H=G;u.cardState.selectedEventTable=_.find(u.eventsTable,function(I){return I.id===H.id});var F=t(H);u.cardState.selectedEventObj=_.find(u.currentEvents[F.name],function(I){return I.id===H.id});u.cardState.radioValue=JSON.stringify(u.cardState.selectedEventTable)};u.addEvent=function(){u.cardState.selectedEventObj={id:"",type:null,prefix:"",suffix:"",arn:"",events:[]};u.cardState.selectedEventTable={id:"",type:r.EVENTS.SNS,filter:"",events:[],isEditing:true};u.cardState.isAdding=true;u.cardState.radioValue="";u.cardState.headerTitle=w.instant("events.table.newevent");u.eventsTable.unshift(u.cardState.selectedEventTable)};u.closeCard=function(F){F.stopPropagation();u.cardOpen=false};u.closeAddEvents=function(){if(u.cardState.isAdding){var F=_.findIndex(u.eventsTable,function(G){return G===u.cardState.selectedEventTable});u.eventsTable.splice(F,1);u.cardState.isAdding=false}else{if(u.cardState.selectedEventTable&&u.cardState.selectedEventTable.isEditing){u.cardState.selectedEventTable.isEditing=false;u.updateTable()}}u.cardState.selectedEventTable=null;u.cardState.selectedEventObj=null;u.cardState.radioValue=""};u.deletePressed=function(){var G=t(u.cardState.selectedEventObj);var F=_.findIndex(u.currentEvents[G.name],function(H){return H.id===u.cardState.selectedEventObj.id});u.currentEvents[G.name].splice(F,1);u.cardState.selectedEventTable=null;u.cardState.selectedEventObj=null;u.cardState.radioValue="";u.updateTable()};u.editPressed=function(){u.cardState.headerTitle=u.cardState.selectedEventTable.id;u.cardState.selectedEventTable.isEditing=true;u.cardState.isAdding=false};u.cancelPressed=function(F){C.analyticsTrackClick(r.ANALYTICS.CANCEL_EVENTS,r.ANALYTICS.DETAILS);c();u.closeCard(F)};u.savePressed=function(G){C.analyticsTrackClick(r.ANALYTICS.SAVE_EVENTS,r.ANALYTICS.DETAILS);u.cardState.isSaving=true;if(u.cardState.selectedEventObj){var H=t(u.cardState.selectedEventObj);var F=_.findIndex(u.currentEvents[H.name],function(I){return I.id===u.cardState.selectedEventObj.id});if(F===-1){u.currentEvents[H.name].push(u.cardState.selectedEventObj)}else{u.currentEvents[H.name][F]=u.cardState.selectedEventObj}}if(u.forCreateBucketModal){u.createBucketObj.response=l.parseBucketNotificationObject(u.currentEvents);u.createBucketObj.currentEvents=u.currentEvents;if(u.cardState.selectedEventObj){u.cardState.selectedEventTable.isEditing=false;u.cardState.selectedEventTable=null;u.cardState.selectedEventObj=null;u.cardState.radioValue=""}u.closeCard(G);u.cardState.isSaving=false}else{(function(){var I=[];u.currentEvents.CloudFunction.forEach(function(K){e.log("LambdaAddPermissionsReceived",1,p,{bucket:o,lambda:K.arn});var J=C.parseFunctionArn(K.arn);var M=C.getUserAccountId();if(M===null){e.log("LambdaAddPermission",0,p,{bucket:o,lambda:K.arn});k(w.instant("events.addpermissions.error"));return}var L={Action:"lambda:InvokeFunction",Principal:"s3.amazonaws.com",SourceAccount:M,SourceArn:C.getBucketARN(o),StatementId:"event_permissions_for_"+K.id+"_from_"+o};I.push(y.addPermission({region:j,path:"/2015-03-31/functions/"+J.functionName+"/policy",content:JSON.stringify(L)}).then(function(){e.log("LambdaAddPermission",1,p,{bucket:o,lambda:K.arn})})["catch"](function(N){e.log("LambdaAddPermission",0,p,{bucket:o,lambda:K.arn});k(N)}))});z.all(I).then(function(){b(G)})})()}};function b(F){l.putBucketNotification(o,p,u.currentEvents).then(function(){u.closeCard(F);if(u.cardState.selectedEventObj){u.cardState.selectedEventTable.isEditing=false}u.cardState.selectedEventTable=null;u.cardState.selectedEventObj=null;u.cardState.radioValue="";u.cardState.isSaving=false;u.cardState.showError=false;u.cardState.isAdding=false;u.updateEvents().then(function(){u.updateTable();h()})})["catch"](function(H){k(H);if(u.cardState.selectedEventObj){var I=t(u.cardState.selectedEventObj);var G=_.findIndex(u.currentEvents[I.name],function(J){return J.id===u.cardState.selectedEventObj.id});u.currentEvents[I.name].splice(G,1)}})}function k(F){u.cardState.showError=true;u.cardState.errorMessage=C.handleErrors(F);u.cardState.isSaving=false}u.isFeatureEnabled=function(F){return m.isFeatureEnabled(F)};u.docLink=d.getDocUrl(r.LEARN_MORE_LINKS.EVENTS);c()}})();"use strict";(function(){angular.module("s3").directive("modalPermissions",[function(){return{restrict:"E",scope:{publicPermissions:"=",userPermissions:"=",owner:"="},templateUrl:"/s3/partials/modalpermissions.html",controller:"ModalPermissionsController"}}]);angular.module("s3").controller("ModalPermissionsController",["$filter","$scope","$translate",function(d,a,c){b();a.manageUserTitles=[{txt:c.instant("modal.manageusertitles.userid"),info:c.instant("modal.userid.tooltip"),pos:"right"},{txt:c.instant("modal.manageusertitles.objects"),info:c.instant("modal.objects.tooltip"),pos:"right"},{txt:c.instant("modal.manageusertitles.objectspermissions"),info:c.instant("modal.objectspermissions.tooltip"),pos:"left"}];a.publicpermissionsecTitles=[{txt:c.instant("modal.publicpermissionsectitles.group"),info:c.instant("modal.group.tooltip"),pos:"right"},{txt:c.instant("modal.manageusertitles.objects"),info:c.instant("modal.objects.tooltip"),pos:"right"},{txt:c.instant("modal.manageusertitles.objectspermissions"),info:c.instant("modal.objectspermissions.tooltip"),pos:"left"}];a.addOwnerPermissions=function(){if(a.userPermissions[0].revokeAll){a.userPermissions[0].revokeAll=false}};function b(){var e={AuthenticatedUsers:c.instant("modal.permission.authenticatedusers"),AllUsers:c.instant("modal.permission.allusers")};angular.forEach(e,function(h,f){var g=_.findIndex(a.publicPermissions,{detail:{value:f}});a.publicPermissions[g].detail.text=h})}}])})();"use strict";(function(){angular.module("s3").directive("permissionsSubModal",function(){return{restrict:"E",scope:{isPublic:"=",aclModalTitles:"=",permissions:"="},templateUrl:"/s3/partials/permissionsSubModal.html",controller:"PermissionSubModalController"}});angular.module("s3").controller("PermissionSubModalController",["$scope",function(a){a.deleteUserAcl=function(b){a.permissions[b].revokeAll=true;angular.forEach(a.permissions[b].permissions,function(d,c){a.permissions[b].permissions[c]=false})}}])})();"use strict";(function(){angular.module("s3").service("PermissionsUtilService",["S3Constants",function(i){function b(n,m){angular.forEach(n,function(o){if(_.isArray(o)){angular.forEach(o,function(p){p.permissions=p.detail.value?_.clone(m[p.detail.value]):_.clone(m[p.detail.DisplayName])})}})}function e(m,o){var n=_.cloneDeep(m.aclGrants);n=!_.isEmpty(n)&&!Array.isArray(n)?[n]:_.isEmpty(n)?[]:n;n=!_.isEmpty(n)?l(n,m,o):a(o);return n}function a(o){var n=[],m=[];m=m.concat(o.userPermissions,o.publicPermissions);angular.forEach(m,function(p){j(p.permissions,p.detail,n)});return n}function k(n,m,o){o.forEach(function(p,q){if((p.Grantee.URI&&p.Grantee.URI.indexOf(n)!==-1||p.Grantee.DisplayName&&p.Grantee.DisplayName===n||p.Grantee.ID&&p.Grantee.ID===n)&&p.Permission===m){o.splice(q,1)}});return o}function g(o,r,p,n,m,q){if(_.values(p).indexOf(false)>-1&&_.values(r[m]).indexOf(false)===-1&&_.findIndex(o,{Permission:i.ACL_PERMISSIONS.FULL_CONTROL})>-1){k(m,i.ACL_PERMISSIONS.FULL_CONTROL,o);angular.forEach(p,function(t,s){if(t===true){h(n,s,o)}})}else{if(_.values(p).indexOf(false)===-1&&_.values(r[m]).indexOf(false)>-1){h(n,i.ACL_PERMISSIONS.FULL_CONTROL,o);angular.forEach(i.ACL_PERMISSIONS,function(t,s){if(s!==i.ACL_PERMISSIONS.FULL_CONTROL){k(m,t,o)}});q.fullControlAdded=true;q.allPermissionsRevoked=false}}if(!q.fullControlAdded){_.keys(p).forEach(function(s){if(p[s]!==r[m][s]){if(p[s]===false||p[s]===undefined&&r[m][s]===true){k(m,s,o)}else{if(p[s]===true){h(n,s,o);q.allPermissionsRevoked=false}}}else{if(r[m][s]===true){q.allPermissionsRevoked=false}}})}}function j(o,n,m){if(o&&Object.keys(o).length===4&&_.values(o).indexOf(false)===-1){h(n,i.ACL_PERMISSIONS.FULL_CONTROL,m)}else{if(o){h(n,o,m)}}}function l(n,m,p){var o={AllUsers:_.find(p.publicPermissions,{detail:{value:"AllUsers"}}),AuthenticatedUsers:_.find(p.publicPermissions,{detail:{value:"AuthenticatedUsers"}})};angular.forEach(p.userPermissions,function(q){var r=q.detail.DisplayName?q.detail.DisplayName:q.detail.ID;if(r){o[r]=q}});angular.forEach(o,function(r,q){if(!m.grantees[q]){j(r.permissions,r.detail,n)}else{if(!_.isEqual(r.permissions,m.grantees[q])){var s={allPermissionsRevoked:true,fullControlAdded:false};g(n,m.grantees,r.permissions,r.detail,q,s)}}});return n}function h(m,o,n){if(!Array.isArray(n)){var p=n;n=_.isEmpty(p)?[]:[p]}var q={Type:m.Type,DisplayName:m.DisplayName,EmailAddress:m.EmailAddress,ID:m.ID,URI:m.URI};if(_.isString(o)){n.push({Grantee:q,Permission:o})}else{if(o){_.forEach(o,function(s,r){if(s){n.push({Grantee:q,Permission:r})}})}}return n}function f(m){return m.Grantee.DisplayName?m.Grantee.DisplayName:m.Grantee.URI?m.Grantee.URI.split("/").pop():m.Grantee.ID}function c(m,n){var o=f(m);if(o){if(!n[o]){n[o]={READ:false,WRITE:false,READ_ACP:false,WRITE_ACP:false}}if(m.Permission==="FULL_CONTROL"){n[o]={READ:true,WRITE:true,READ_ACP:true,WRITE_ACP:true}}else{n[o][m.Permission]=true}}}function d(m){var n={group:{},accounts:{}};_.forEach(m,function(p,o){if(i.PUBLIC_PERMISSIONS_LIST.indexOf(o)>-1){n.group[o]=p}else{if(o!==i.LOG_DELIVERY_VALUE){n.accounts[o]=p}}});_.forEach(i.PUBLIC_PERMISSIONS_LIST,function(o){if(_.isEmpty(n.group[o])){n.group[o]={READ:false,WRITE:false,WRITE_ACP:false,READ_ACP:false}}});return n}return{populateAclsFields:b,updateAcl:e,aclsUpdate:g,addNewPermissions:j,updateGranteesHelperFunction:c,updateGrantees:d,extractGranteeKey:f}}])})();"use strict";(function(){angular.module("s3").directive("bucketReplication",[function(){return{restrict:"E",scope:{cardOpen:"=",forCreateBucketModal:"=?",replicationObj:"=?",modalInfo:"=?",versioningStatus:"=",id:"@?"},templateUrl:"/s3/partials/replication.html",controller:"BucketReplicationController"}}]);angular.module("s3").controller("BucketReplicationController",["$filter","$scope","$timeout","$translate","APIProxyService","AwsUrlsService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","IAMService","PathService","Region","S3Constants","SCLogService","UtilService",a]);function a(o,r,w,s,t,c,j,h,l,p,e,f,q,d,y){var m,i,k,n;function b(){r.cardState={ruleBeingEdited:null,isExpanded:false,isSaving:false};if(!r.forCreateBucketModal){r.replicationObj={role:"",destinationBucket:null,storageClass:"",rulesArray:[],replicationType:"",isEnabled:q.REPLICATION.DISABLED}}r.errorMessage="";r.bucketList=[];r.allMyBuckets=[];r.S3Constants=q;k=new l("getBucketReplication","getBucketReplication");r.iamRoles=[];r.iamRoles.push({text:s.instant("replication.roles.createnew"),value:q.REPLICATION.NEWROLE});r.scrollCardId="#"+r.id;r.cardSummaryObj=_.cloneDeep(q.CARD_SUMMARY_INIT);if(r.forCreateBucketModal){r.$watch("cardOpen",function(A,z){w(function(){y.scrollCardToView(q.BUCKET_PROPERTIES.REPLICATION.CREATE_BUCKET_CARD)},1)})}if(r.forCreateBucketModal){m=r.modalInfo.name;i=r.modalInfo.region;r.regionMapping=[];f.regionMapping.forEach(function(z){if(z.value!==i){r.regionMapping.push(z)}});r.sourceRegion=f.twoWayMapping[i]+" ("+i+")"}else{m=e.getCurrentBucket();j.getBucketLocation(m).then(function(z){i=z;r.regionMapping=[];var A=[];y.getFACRegions(f.regionMapping,A);A.forEach(function(B){if(B.value!==i){r.regionMapping.push(B)}});r.sourceRegion=f.twoWayMapping[z]+" ("+z+")"})["catch"](function(z){r.errorMessage=y.handleErrors(z)})}r.sources=[{value:"bucket",text:s.instant("replication.label.bucket")},{value:"prefix",text:s.instant("replication.label.prefix")}];r.storageClasses=[{value:q.STORAGE_CLASSES.DEFAULT,text:s.instant("replication.storageclasses.default")},{value:q.STORAGE_CLASSES.STANDARD,text:s.instant("replication.storageclasses.standard")},{value:q.STORAGE_CLASSES.STANDARD_INFREQUENT_ACCESS,text:s.instant("replication.storageclasses.standardia")},{value:q.STORAGE_CLASSES.REDUCED_REDUNDANCY,text:s.instant("replication.storageclasses.reducedredundancy")}];r.storageClassesMap={};r.storageClasses.forEach(function(z){r.storageClassesMap[z.value]=z.text;r.storageClassesMap[z.text]=z.value});d.log("ListAllMyBucketsRequestReceived",1,k);t.listAllMyBuckets(k).then(function(z){var A=z.response.ListAllMyBucketsResult.Buckets.Bucket;d.log("ListAllMyBucketsSuccess",1,k);r.allMyBuckets=A;r.updateBucketList(false)})["catch"](function(z){d.log("ListAllMyBucketsSuccess",0,k);r.errorMessage=y.handleErrors(z)});v();u(m,false)}r.resetError=function(){r.errorMessage=null};r.$watchCollection("replicationObj.destinationRegion",function(A,z){if(!_.isEmpty(A)&&!_.isEqual(A,z)){if(r.replicationObj.resetDestinationBucket){r.replicationObj.destinationBucket=null}r.updateBucketList();r.resetError();r.replicationObj.resetDestinationBucket=true}});r.displayListRoleError=function(){return !_.isEmpty(r.listRoleError)&&$(".crr-listrole span.awsui-select-target.awsui-select-open.awsui-select-target-focused").length>0};function v(){d.log("ListRolesRequestReceived",1,k);t.makeProxyRequest(p.listRoles,{region:q.IAM_REGION},q.PROXY_API_NAMES.IAM.LIST_ROLES,k).then(function(A){var z=A.response.ListRolesResponse.ListRolesResult.Roles;d.log("ListRolesSuccess",1,k);z.forEach(function(B){if(B!==r.replicationObj.role){r.iamRoles.push({text:B.RoleName,value:B.Arn})}});r.listRoleError=null})["catch"](function(A){d.log("ListRolesSuccess",0,k);var z=y.handleErrors(A);r.listRoleError=z})}function u(z,A){if(!r.forCreateBucketModal){j.getBucketReplication(z,k).then(function(C){var B=C.response;r.replicationObj.resetDestinationBucket=A;h.populateReplicationObj(B,z,r.replicationObj,r.regionMapping,!A).then(function(){r.updateBucketList(A);g()});r.replicationObj.configExists=true})["catch"](function(B){if(B===q.REPLICATION.CONFIGNOTFOUND){r.replicationObj.configExists=false}else{r.errorMessage=y.handleErrors(B)}g()})["finally"](function(){if(r.replicationObj&&r.replicationObj.role){var B=_.clone(r.replicationObj.role);r.iamRoles.push({text:_.last(B.split("/")),value:B})}})}else{if(r.replicationObj&&r.replicationObj.response!==undefined){h.populateReplicationObj(r.replicationObj.response,z,r.replicationObj).then(function(){r.updateBucketList(A)})}}}r.removeRule=function(B,A,z){if(z){A.stopPropagation()}r.replicationObj.rulesArray.splice(_.findIndex(r.replicationObj.rulesArray,function(C){return B===C}),1);B.storageClass="";B.prefix="";B.markedForDelete=true};r.updateBucketList=function(A){var z=[];r.allMyBuckets.forEach(function(B){j.getBucketLocation(B.Name).then(function(C){if(r.replicationObj&&r.replicationObj.destinationRegion&&(C===r.replicationObj.destinationRegion||C===r.replicationObj.destinationRegion.value)){z.push(B.Name)}if(A){r.errorMessage=""}r.bucketList=y.transformListOfOptionsToDropdown(z)})})};r.allRulesEmpty=function(){return _.every(r.replicationObj.rulesArray,function(z){return z.prefix===""&&z.storageClass===""})};r.addRule=function(z){z.stopPropagation();if(r.completeEdit()){r.cardState.isExpanded=true;var A={prefix:"",status:q.REPLICATION.ENABLED,storageClass:"",isEditing:true};r.replicationObj.rulesArray.push(A);r.cardState.ruleBeingEdited=A}};r.completeEdit=function(){var z=r.cardState.ruleBeingEdited;if(!z){return true}else{if(z.prefix!==""&&z.storageClass!==""||z.markedForDelete){z.prefixError=false;z.storageError=false;z.isEditing=false;r.cardState.ruleBeingEdited=null;return true}else{if(z.prefix===""&&z.storageClass===""){z.storageError=false;z.prefixError=false;r.removeRule(z,"",false);return true}else{if(z.prefix===""){z.prefixError=true;z.storageError=false}else{z.storageError=true;z.prefixError=false}return false}}}};r.editRule=function(A,z){z.stopPropagation();if(r.completeEdit()){A.isEditing=true;r.cardState.ruleBeingEdited=A}};r.isDisable=function(){return r.replicationObj.isEnabled===q.REPLICATION.ENABLED&&(r.replicationObj.destinationBucket===null||r.replicationObj.role===""||r.replicationObj.replicationType==="bucket"&&r.replicationObj.storageClass===""||r.replicationObj.replicationType=="prefix"&&(r.replicationObj.rulesArray.length===0||r.allRulesEmpty()))};r.savePressed=function(C){if(r.isDisable(r.replicationObj)){return}y.analyticsTrackClick(q.ANALYTICS.SAVE_REPLICATION,q.ANALYTICS.DETAILS);if(!r.completeEdit()){return}r.replicationObj.rules=[];h.handleRules(m,r.replicationObj);var A=r.replicationObj.destinationBucket.value||r.replicationObj.destinationBucket;var z="";if(r.replicationObj.role===q.REPLICATION.NEWROLE){z="replication_role_for_"+m+"_to_"+A}else{var B=r.replicationObj.role.split("/");z=B[B.length-1]}var D="replication_policy_for_"+m+"_to_"+A;if(z.length>q.ENTITY_MAX_LENGTH.ROLE){z=z.substr(0,q.ENTITY_MAX_LENGTH.ROLE)}if(D.length>q.ENTITY_MAX_LENGTH.POLICY){D=D.substr(0,q.ENTITY_MAX_LENGTH.POLICY)}y.createOrUpdateRoleForReplication(z,D,m,A).then(function(E){r.replicationObj.role=E;x(C)})["catch"](function(E){if(E&&E.Error&&E.Error.Code==="EntityAlreadyExists"){x(C)}else{r.errorMessage=y.handleErrors(E)}})};function x(A){var z=new l("putBucketReplication","putBucketReplication");if(r.forCreateBucketModal){r.replicationObj.response=j.parseBucketReplicationObject(r.replicationObj);r.closeCard(A)}else{r.cardState.isSaving=true;j.putBucketReplication(m,z,r.replicationObj).then(function(){u(m,true);r.closeCard(A)})["catch"](function(B){r.errorMessage=y.handleErrors(B)})["finally"](function(){r.cardState.isSaving=false;r.replicationObj.role=""})}}r.toggleRuleStatus=function(A,z){z.stopPropagation();if(A.markedForDelete){A.markedForDelete=false}else{if(A.status===q.REPLICATION.DISABLED){A.status=q.REPLICATION.ENABLED}else{if(A.status===q.REPLICATION.ENABLED){A.status=q.REPLICATION.DISABLED}}}};r.cancelPressed=function(z){y.analyticsTrackClick(q.ANALYTICS.CANCEL_REPLICATION,q.ANALYTICS.DETAILS);r.closeCard(z);b()};r.deletePressed=function(){var z=new l("deleteReplicationConfiguration","deleteReplicationConfiguration");r.deleting=true;j.deleteBucketReplication(m,z).then(function(A){r.replicationObj.isEnabled=q.REPLICATION.DISABLED;r.replicationObj.configExists=false;r.closeCard();return A})["catch"](function(A){r.errorMessage=y.handleErrors(A)})["finally"](function(){r.deleting=false})};r.closeCard=function(z){if(z){z.stopPropagation()}r.cardOpen=false};function g(){if(r.replicationObj.isEnabled===q.REPLICATION.ENABLED){r.cardSummaryObj.isActive=true;r.cardSummaryObj.activeSummary.text=s.instant("bucketproperties.crossregionreplication.destinationbucket");r.cardSummaryObj.isMultiValue=true;r.cardSummaryObj.activeSummary.value=r.replicationObj.destinationBucket.value||r.replicationObj.destinationBucket}else{r.cardSummaryObj.isActive=false;r.cardSummaryObj.isMultiValue=false;r.cardSummaryObj.inactiveSummary.text=s.instant("bucketproperty.disabled")}}r.docLink=c.getDocUrl(q.LEARN_MORE_LINKS.REPLICATION);b()}})();"use strict";(function(){angular.module("s3").directive("objectProperties",[function(){return{restrict:"E",scope:{obj:"=",options:"=",getMetadata:"&"},templateUrl:"/s3/partials/object-details/objectproperties.html",controller:"ObjectPropertiesController"}}]);angular.module("s3").controller("ObjectPropertiesController",["$scope","ConsoleOperation","S3Constants",a]);function a(b,d,c){b.updateData=function(){var e=new d(c.OPERATION_NAME.CHANGE_SSE);b.getMetadata({operation:e})}}})();"use strict";(function(){angular.module("s3").directive("objectStorageClass",[function(){return{restrict:"E",scope:{obj:"=",id:"@?"},templateUrl:"/s3/partials/object-details/objectstorageclass.html",controller:"ObjectStorageClassController"}}]);angular.module("s3").controller("ObjectStorageClassController",["$filter","$scope","AwsUrlsService","BulkOperationService","OperationDispatcherService","PathService","S3Constants","SCLogService","UtilService",a]);function a(d,h,b,k,i,e,c,g,f){h.docLink=b.getDocUrl(c.LEARN_MORE_LINKS.STORAGE_CLASS);h.cachedValue=angular.copy(h.obj);h.cancel=function(l){f.analyticsTrackClick(c.ANALYTICS.CANCEL_OBJECT_STORAGE_CLASS,c.ANALYTICS.DETAILS);l.stopPropagation();h.storageClassError="";h.cardOpen=false;h.obj.StorageClass=h.cachedValue.StorageClass};h.getStorageClassTranslation=function(){return f.getStorageClassTranslations()[h.obj.StorageClass]};h.scrollCardId="#"+h.id;h.cardSummaryObj=_.cloneDeep(c.CARD_SUMMARY_INIT);j();function j(){var l=h.getStorageClassTranslation();h.cardSummaryObj.isActive=h.obj.StorageClass!==c.STORAGE_CLASSES.GLACIER;if(h.cardSummaryObj.isActive){h.cardSummaryObj.activeSummary.text=l}else{h.cardSummaryObj.inactiveSummary.text=l}}h.save=function(m){f.analyticsTrackClick(c.ANALYTICS.SAVE_OBJECT_STORAGE_CLASS,c.ANALYTICS.DETAILS);m.stopPropagation();h.storageClassError="";h.isSaving=true;var o=[h.obj];var n={targetStorageClass:h.obj.StorageClass,numberOfKeysPerBulkOperation:1};var l=k.createBulkOperation(c.OPERATION_NAME.CHANGE_STORAGE_CLASS,o,[],1,n);i.addOperation(l);g.log("ChangeStorageClassReceived",1,l);l.defer.promise.then(function(p){var q=Object.keys(p);if(q.length>0){h.storageClassError=q[0];g.log("ChangeStorageClassComplete",0,l)}else{h.cachedValue.StorageClass=h.obj.StorageClass;h.cardOpen=false;g.log("ChangeStorageClassComplete",1,l)}})["catch"](function(p){g.log("ChangeStorageClassComplete",0,l);h.storageClassError=p})["finally"](function(){h.isSaving=false;j()})}}})();"use strict";(function(){angular.module("s3").directive("objectEncryption",[function(){return{restrict:"E",scope:{obj:"=",options:"=",updateData:"&",id:"@?"},templateUrl:"/s3/partials/object-details/objectsse.html",controller:"ObjectSSEController"}}]);angular.module("s3").controller("ObjectSSEController",["$scope","$translate","AwsUrlsService","APIProxyService","BulkOperationService","ConsoleOperation","KMSService","OperationDispatcherService","PathService","S3Constants","SCLogService","UtilService",a]);function a(l,b,d,c,o,h,g,m,i,e,k,j){l.docLink=d.getDocUrl(e.LEARN_MORE_LINKS.ENCRYPTION);l.scrollCardId="#"+l.id;l.cachedValue=angular.copy(l.obj);l.cancel=function(p){j.analyticsTrackClick(e.ANALYTICS.CANCEL_OBJECT_SSE,e.ANALYTICS.DETAILS);p.stopPropagation();l.sseError="";l.cardOpen=false;l.obj.Encryption=l.cachedValue.Encryption};var f=function f(){l.kmsKeys=[];var q=new h("GetKMSKeysForObjectSSE");var p={};c.getKmsKeys(q,i.getCurrentBucket(),p).then(function(s){var r=s.response.Keys;k.log("GetKMSKeys",1,q);angular.forEach(r,function(t,u){l.kmsKeys.push({value:t.KeyId,text:t.KeyArn})});l.kmsKeys.push({value:e.OBJECT_SSE.CUSTOM_ARN,text:b.instant("objectproperties.kms.customarn")})})["catch"](function(r){l.KMSServiceError=j.handleErrors(r);l.sseError=j.handleErrors(r);k.log("GetKMSKeys",0,q,r)})};l.updateKMSKey=function(p){if(p===e.OBJECT_SSE.KMS_ENCRYPTION){f()}else{if(!_.isEmpty(l.sseError)&&l.sseError===l.KMSServiceError){l.sseError=null}l.KMSServiceError=null}};l.save=function(q){j.analyticsTrackClick(e.ANALYTICS.SAVE_OBJECT_SSE,e.ANALYTICS.DETAILS);q.stopPropagation();l.sseError="";l.isSaving=true;var s=[l.obj];var t=undefined;if(l.obj.Encryption===e.OBJECT_SSE.KMS_ENCRYPTION){if(l.options.kmsId.value===e.OBJECT_SSE.CUSTOM_ARN){t=l.options.kmsARN}else{t=l.options.kmsId.value}}var r={sseAlgo:l.obj.Encryption,numberOfKeysPerBulkOperation:1,sseKmsKeyId:t};var p=o.createBulkOperation(e.OPERATION_NAME.CHANGE_SSE,s,[],1,r);m.addOperation(p);k.log("ChangeSSERequestReceived",1,p);p.defer.promise.then(function(u){var v=Object.keys(u);if(v.length>0){l.sseError=v[0];k.log("ChangeSSERequestComplete",0,p)}else{l.cachedValue.Encryption=l.obj.Encryption;l.cardOpen=false;k.log("ChangeSSERequestComplete",1,p);if(l.obj.Encryption!=="aws:kms"){l.obj.KmsID=undefined}n();l.updateData()}})["catch"](function(u){k.log("ChangeSSERequestComplete",0,p);l.sseError=u})["finally"](function(){l.isSaving=false})};l.getEncryptionTranslation=function(){return j.getEncryptionTranslations()[l.obj.Encryption]};if(l.obj.Encryption===e.OBJECT_SSE.KMS_ENCRYPTION){f()}l.cardSummaryObj=_.cloneDeep(e.CARD_SUMMARY_INIT);l.cardSummaryObj.inactiveSummary.text=b.instant("sse.none");n();function n(){l.cardSummaryObj.isActive=l.obj.Encryption!==e.OBJECT_SSE.NONE;l.cardSummaryObj.activeSummary.text=l.getEncryptionTranslation()}}})();"use strict";(function(){angular.module("s3").directive("objectMetadata",[function(){return{restrict:"E",scope:{obj:"=",id:"@?"},templateUrl:"/s3/partials/object-details/objectmetadata.html",controller:"ObjectMetadataController"}}]);angular.module("s3").controller("ObjectMetadataController",["$filter","$scope","$translate","AwsUrlsService","BulkOperationService","ConsoleOperation","OperationDispatcherService","S3Constants","SCLogService","UtilService",a]);function a(p,s,t,b,o,n,f,r,d,x){s.scrollCardId="#"+s.id;s.docLink=b.getDocUrl(r.LEARN_MORE_LINKS.METADATA);s.newMetadataList=[];s.revokeAll=false;s.selectedRow={scopeIndex:null};s.addMetadata=function(z){s.newMetadataList.splice(0,0,{metadataKey:null,metadataValue:null});i("newMetadataList:0");z.scopeIndex="newMetadataList:0"};s.predefinedMetadata=[{value:r.USER_DEFINED_METADATA[0],text:t.instant("objectdetail.metadata.cache-control")},{value:r.USER_DEFINED_METADATA[1],text:t.instant("objectdetail.metadata.content-disposition")},{value:r.USER_DEFINED_METADATA[2],text:t.instant("objectdetail.metadata.content-encoding")},{value:r.USER_DEFINED_METADATA[3],text:t.instant("objectdetail.metadata.content-language")},{value:r.USER_DEFINED_METADATA[4],text:t.instant("objectdetail.metadata.content-type"),dropDownValue:r.CONTENT_TYPE_VALUES},{value:r.USER_DEFINED_METADATA[5],text:t.instant("objectdetail.metadata.expires")},{value:r.USER_DEFINED_METADATA[6],text:t.instant("objectdetail.metadata.website-redirect-location")},{value:r.USER_DEFINED_METADATA_PREFIX,text:t.instant("objectdetail.metadata.x-amz-meta-"),displayTextField:true}];s.getObjectMetadataCount=function(){if(!s.obj||!s.obj.UserDefinedMetadata){return 0}s.userDefinedMetadata=q();return Object.keys(s.obj.UserDefinedMetadata).length};s.cardSummaryObj=_.cloneDeep(r.CARD_SUMMARY_INIT);s.cardSummaryObj.isActive=s.getObjectMetadataCount()!==0;s.cardSummaryObj.activeSummary.text=s.getObjectMetadataCount()+t.instant("objectdetail.metadata.keyvalue");s.cardSummaryObj.inactiveSummary.text="0"+t.instant("objectdetail.metadata.keyvalue");s.$watch("userDefinedMetadata",function(B,z){y(B,z,"userDefinedMetadata");s.validationError="";if(s.userDefinedMetadata){var A=m(s.userDefinedMetadata.concat(s.newMetadataList));if(!_.isEmpty(A)){s.validationError=A}}},true);s.$watch("newMetadataList",function(B,z){y(B,z,"newMetadataList");s.validationError="";if(s.newMetadataList){var A=m(s.newMetadataList.concat(s.userDefinedMetadata));if(!_.isEmpty(A)){s.validationError=A}}},true);s.getIndex=function(z){return _.findIndex(s.userDefinedMetadata,function(A){return _.isEqual(A,z)})};s.isDeleteAndEditDisabled=function(z){return z===undefined||s.revokeAll||z.scopeIndex===null||s.obj&&s.obj.StorageClass==="GLACIER"||z.scopeIndex&&z.scopeIndex.indexOf("newMetadataList")>-1};s.removeNewMetadata=function(B,C,D){C.stopPropagation();if(D&&D.scopeIndex){var E=D.scopeIndex.split(":"),A=E[0],z=parseInt(E[1]);if(A==="newMetadataList"&&z===B){D.scopeIndex=null}if(A==="newMetadataList"&&B<z){z-=1;D.scopeIndex=A+":"+z}}s.newMetadataList.splice(B,1)};s.switchSelectedRow=function(z){i(z.scopeIndex,false)};s.editMetadata=function(z){i(z.scopeIndex,true)};s.deleteMetadata=function(z){var A=z.scopeIndex.split(":");if(A[0]==="userDefinedMetadata"){s.userDefinedMetadata.splice(A[1],1)}z.scopeIndex=null;if(_.isEmpty(s.userDefinedMetadata)){s.revokeAll=true}};function e(){var z=s.getObjectMetadataCount();s.cardSummaryObj.isActive=z>0;if(z>0){s.cardSummaryObj.activeSummary.text=z+t.instant("objectdetail.metadata.keyvalue")}}s.cachedConvertedValue=_.cloneDeep(s.userDefinedMetadata);s.cachedValue=_.cloneDeep(s.obj);s.cancel=function(z){x.analyticsTrackClick(r.ANALYTICS.CANCEL_OBJECT_METADATA,r.ANALYTICS.DETAILS);z.stopPropagation();w();e()};s.save=function(C){x.analyticsTrackClick(r.ANALYTICS.SAVE_OBJECT_METADATA,r.ANALYTICS.DETAILS);C.stopPropagation();s.isSaving=true;s.metadataError="";s.validationError="";var z=s.userDefinedMetadata?s.userDefinedMetadata.concat(s.newMetadataList):s.newMetadataList;if(!u(z)){s.isSaving=false;return}var B=h(z);if(_.isEqual(B,s.obj.UserDefinedMetadata)){s.isSaving=true;w();return}var E=[s.obj];var D=l(s.obj.UserDefinedMetadata,B);var A=o.createBulkOperation(r.OPERATION_NAME.CHANGE_METADATA,E,[],1,D);f.addOperation(A);d.log("ChangeMetadataRequestReceived",1,A);A.defer.promise.then(function(F){var G=Object.keys(F);if(G.length>0){s.metadataError=G[0];d.log("ChangeMetadataRequestComplete",0,A)}else{g(B,z);d.log("ChangeMetadataRequestComplete",1,A)}e()})["catch"](function(F){d.log("ChangeMetadataRequestComplete",0,A);s.metadataError=F})["finally"](function(){s.isSaving=false})};function q(){var z=[];_.forEach(s.obj.UserDefinedMetadata,function(C,B){var A=_.find(s.predefinedMetadata,{value:B})||{value:B,text:B};z.push({metadataKey:A,metadataValue:{text:C}})});return z}function y(D,C,B){if(!_.isEqual(D,C)&&s.selectedRow.scopeIndex){var E=s.selectedRow.scopeIndex.split(":"),A=E[0],z=E[1];if(A===B&&C[z]&&D[z]&&C[z].metadataKey&&D[z].metadataKey&&C[z].metadataKey.value!==D[z].metadataKey.value||A===B&&D[z].metadataKey===undefined){s[B][z].metadataValue=null}else{if(A===B&&D[z]&&C[z]&&D[z].metadataValue&&C[z].metadataValue&&!_.isEqual(D[z].metadataValue,C[z].metadataValue)&&D[z].metadataValue.text!==C[z].metadataValue.text){s[B][z].metadataValue.inputError=null}else{if(A===B&&D[z]&&C[z]&&D[z].metadataKey&&C[z].metadataKey&&!D[z].metadataKey.hasOwnProperty("inputValue")&&D[z].metadataKey.text&&C[z].metadataKey.text&&!_.isEqual(D[z].metadataKey,C[z].metadataKey)&&D[z].metadataKey.text!==C[z].metadataKey.text){s[B][z].metadataKey.error=null}else{if(A===B&&D[z]&&C[z]&&D[z].metadataKey&&C[z].metadataKey&&D[z].metadataKey.hasOwnProperty("inputValue")&&!_.isEqual(D[z].metadataKey,C[z].metadataKey)&&D[z].metadataKey.inputValue!==C[z].metadataKey.inputValue){s[B][z].metadataKey.error=null}}}}}}function i(A,C){var D=A.split(":"),z=D[0],B=parseInt(D[1]);if(z==="newMetadataList"){_.forEach(s.newMetadataList,function(F,E){F.isEditing=E===B});_.forEach(s.userDefinedMetadata,function(E){E.isEditing=false})}else{if(z==="userDefinedMetadata"){_.forEach(s.userDefinedMetadata,function(F,E){F.isEditing=E!==B?false:C});_.forEach(s.newMetadataList,function(E){E.isEditing=false})}}}function k(){_.forEach(s.newMetadataList,function(z){z.isEditing=false});_.forEach(s.userDefinedMetadata,function(z){z.isEditing=false})}function g(A,z){s.obj.UserDefinedMetadata=A;s.userDefinedMetadata=z;s.newMetadataList=[];s.cachedConvertedValue=_.cloneDeep(s.userDefinedMetadata);s.cachedValue.UserDefinedMetadata=_.cloneDeep(s.obj.UserDefinedMetadata);s.cachedValue.Metadata=_.cloneDeep(s.obj.Metadata);s.selectedRow={scopeIndex:null};k();s.cardOpen=false}function w(){s.metadataError="";s.validationError="";s.newMetadataList=[];s.userDefinedMetadata=_.cloneDeep(s.cachedConvertedValue);s.obj.UserDefinedMetadata=_.cloneDeep(s.cachedValue.UserDefinedMetadata);s.obj.Metadata=_.cloneDeep(s.cachedValue.Metadata);s.selectedRow={scopeIndex:null};k();s.cardOpen=false}function c(z){if(!(z.metadataKey&&z.metadataKey.error)){if(z.metadataKey.hasOwnProperty("inputValue")&&!_.startsWith(z.metadataKey.inputValue,r.USER_DEFINED_METADATA_PREFIX)){z.metadataKey.error=t.instant("metadatacard.startingwith")}else{z.metadataKey.error=""}}}function v(z){if(!(z.metadataKey&&z.metadataKey.error)){if(z.metadataKey&&!/^[\x20-\x7E]+$/.test(z.metadataKey.text)){z.metadataKey.error=t.instant("metadatacard.nonasc")}else{if(z.metadataKey.hasOwnProperty("inputValue")&&!/^[\x20-\x7E]+$/.test(z.metadataKey.inputValue)){z.metadataKey.error=t.instant("metadatacard.nonasc")}else{z.metadataKey.error=""}}}}function j(z){if(!(z.metadataValue&&z.metadataValue.inputError)){if(z.metadataValue&&!_.isEmpty(z.metadataValue.text)&&!/^[\x20-\x7E]+$/.test(z.metadataValue.text)){z.metadataValue.inputError=t.instant("metadatacard.nonasc")}else{z.metadataValue.inputError=""}}}function u(z){z.forEach(function(B){if(!B.metadataKey){B.metadataKey={error:t.instant("objectdetail.metadata.emptyvaluewarning")}}else{if(B.metadataKey.hasOwnProperty("inputValue")&&_.isEmpty(B.metadataKey.inputValue)){B.metadataKey.error=t.instant("objectdetail.metadata.emptyvaluewarning")}else{if(_.isEmpty(B.metadataKey.text)){B.metadataKey.error=t.instant("objectdetail.metadata.emptyvaluewarning")}else{B.metadataKey.error=""}}}if(!B.metadataValue||B.metadataValue&&_.isEmpty(B.metadataValue.text)){if(B.metadataValue){B.metadataValue.inputError=t.instant("objectdetail.metadata.emptyvaluewarning")}else{B.metadataValue={inputError:t.instant("objectdetail.metadata.emptyvaluewarning")}}}else{if(B.metadataKey&&B.metadataKey.value===r.USER_DEFINED_METADATA[6]){if(!_.startsWith(B.metadataValue.text,"/")&&!_.startsWith(B.metadataValue.text,"http://")&&!_.startsWith(B.metadataValue.text,"https://")){B.metadataValue.inputError=t.instant("objectdetail.metadata.websitevaluewarning")}else{B.metadataValue.inputError=""}}else{B.metadataValue.inputError=""}}c(B);v(B);j(B)});var A=m(z);if(!_.isEmpty(A)){s.validationError=A}return _.isEmpty(A)&&_.findIndex(z,function(B){return B.metadataValue.inputError&&B.metadataValue.inputError.length>0})===-1&&_.findIndex(z,function(B){return B.metadataKey.error&&B.metadataKey.error.length>0})===-1}function m(z){if(_.isEmpty(z)){return""}var B={};z.forEach(function(D){if(D&&D.metadataKey){var C=D.metadataKey.hasOwnProperty("inputValue")?D.metadataKey.inputValue:D.metadataKey.text;if(C){B[C]=B.hasOwnProperty(C)?B[C]+1:1}}});var A="";_.forEach(B,function(D,C){if(D>1){A+=C+", "}});return A.slice(0,A.lastIndexOf(","))}function h(A){var z={};_.forEach(A,function(C){var B=C.metadataKey.inputValue||C.metadataKey.value,D=C.metadataValue.text;z[B]=D});return z}function l(A,B){var z={addAndChangeMetadata:{},deleteMetadata:[],numberOfKeysPerBulkOperation:1};_.forEach(B,function(D,C){if(!A.hasOwnProperty(C)||A[C]!==D){z.addAndChangeMetadata[C]=D}});_.forEach(A,function(D,C){if(!B.hasOwnProperty(C)){z.deleteMetadata.push(C)}});return z}}})();"use strict";(function(){angular.module("s3").directive("objectTag",[function(){return{restrict:"E",scope:{obj:"=",id:"@?"},templateUrl:"/s3/partials/object-details/objecttag.html",controller:"ObjectTagController"}}]);angular.module("s3").controller("ObjectTagController",["$scope","$translate","APIProxyService","AwsUrlsService","ConsoleOperation","ObjectPropertiesService","PathService","S3Constants","SCLogService","UtilService","XMLParser",a]);function a(m,n,o,b,j,i,d,k,c,r,s){var h="getObjectTags";var q="getObjectVersionTags";var f="putObjectTags";var l="putObjectVersionTags";var p="getObjectTagsReceived";var g="putObjectTagsReceived";m.docLink=b.getDocUrl(k.LEARN_MORE_LINKS.OBJECT_TAGGING);m.scrollCardId="#"+m.id;m.tagError=false;m.tagErrorMessage="";m.cachedObjectTags={tags:[]};m.tagCount=0;m.maxAllowedTags=k.TAGGING.MAX_ALLOWED_TAGS;m.cardSummaryObj=_.cloneDeep(k.CARD_SUMMARY_INIT);m.cardSummaryObj.isActive=m.tagCount>0;m.cardSummaryObj.activeSummary.text=m.tagCount+n.instant("objectproperties.tags.keyvalue");m.cardSummaryObj.inactiveSummary.text="0"+n.instant("objectproperties.tags.keyvalue");m.cancelObjectTagging=function(t){r.analyticsTrackClick(k.ANALYTICS.CANCEL_OBJECT_TAGS,k.ANALYTICS.DETAILS);t.stopPropagation();m.obj.Tagging=angular.copy(m.cachedObjectTags.tags);m.tagError=false;m.tagErrorMessage="";m.cardOpen=false};m.removeTag=function(t){m.obj.Tagging.splice(t,1)};m.addTag=function(){if(!m.obj.Tagging){m.obj.Tagging=[]}if(m.obj.Tagging.length<k.TAGGING.MAX_ALLOWED_TAGS){m.obj.Tagging.push({Key:"",Value:""})}};m.isAnyKeyEmpty=function(){return !_.isEmpty(m.obj.Tagging)&&_.some(m.obj.Tagging,function(t){return _.isEmpty(t.Key)})};function e(){m.cardSummaryObj.isActive=m.tagCount>0;if(m.cardSummaryObj.isActive){m.cardSummaryObj.activeSummary.text=m.tagCount+n.instant("objectproperties.tags.keyvalue")}}m.getObjectTags=function(){var t=new j(k.OPERATION_NAME.GET_OBJECT_TAGGING);var w=d.getCurrentObject();var v=d.getCurrentBucket();c.log(p,1,t,{objectName:w});m.obj.Tagging=[];var u=m.obj.versionId;o.getObjectTag(t,v,w,u).then(function(A){var x=A.response;if(!u){c.log(h,1,t,{objectName:w})}else{c.log(q,1,t,{objectName:w,versionId:u})}m.tagError=false;if(x){var y=s.convertXmlStringToJson(x);if(y.Tagging.TagSet.Tag){var z=[].concat(y.Tagging.TagSet.Tag);angular.forEach(z,function(B){if(_.isEmpty(B.Value)){B.Value=""}B.errorMessage=""});m.obj.Tagging=z;m.tagCount=z.length||0}}m.cachedObjectTags.tags=angular.copy(m.obj.Tagging);e()})["catch"](function(x){if(x){if(x.status===k.HTTP_STATUS_CODES.NOT_FOUND){if(x.response.Error.Code===k.TAGGING.ERROR_CODES.NO_SUCH_TAG_SET){if(!u){c.log(h,0,t,{objectName:w,error:x})}else{c.log(q,0,t,{objectName:w,versionId:u,error:x})}m.tagCount=0;m.obj.Tagging=[]}}}m.cachedObjectTags.tags=angular.copy(m.obj.Tagging)})};m.getObjectTags();m.saveObjectTagging=function(v){r.analyticsTrackClick(k.ANALYTICS.SAVE_OBJECT_TAGS,k.ANALYTICS.DETAILS);v.stopPropagation();m.tagError=false;m.tagErrorMessage="";var u=m.obj.Tagging;var t=new j(k.OPERATION_NAME.PUT_OBJECT_TAGGING);var x=d.getCurrentObject();var w=m.obj.versionId;c.log(g,1,t,{objectName:x});if(u){angular.forEach(u,function(y){if(_.isEmpty(y.Key)){y.errorMessage=n.instant("objectproperties.tags.emptykeyname");m.tagError=true}else{y.errorMessage=""}})}if(!m.tagError){i.putObjectTagging(x,w,u,t).then(function(A){if(!w){c.log(f,1,t,{objectName:x})}else{c.log(l,1,t,{objectName:x,versionId:w})}var z=s.convertXmlStringToJson(A.request.contentString);var y;if(!_.isEmpty(z.Tagging.TagSet.Tag)){y=[].concat(z.Tagging.TagSet.Tag);angular.forEach(y,function(B){if(_.isEmpty(B.Value)){B.Value=""}})}m.obj.Tagging=_.isEmpty(y)?[]:[].concat(y);m.tagCount=m.obj.Tagging.length;m.cachedObjectTags.tags=angular.copy(m.obj.Tagging);m.cardOpen=false;e()})["catch"](function(y){if(!w){c.log(f,0,t,{objectName:x,error:y})}else{c.log(f,0,t,{objectName:x,error:y,versionId:w})}m.tagError=true;if(y){m.tagErrorMessage=r.handleErrors(y)}else{m.tagErrorMessage=n.instant("objectproperties.tags.genericerror")}})}}}})();"use strict";function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}(function(){angular.module("s3").directive("dialogModal",function(){return{restrict:"E",templateUrl:"/s3/partials/dialogmodal.html",scope:{isOpen:"=",closeCallback:"&?",headerTitle:"=",hasWarningMsg:"=?",countInfo:"=?",pasteInfo:"=?",sourceDstInfo:"=?"},transclude:true,compile:multiTransclude(),controller:"DialogModalController"}});angular.module("s3").controller("DialogModalController",["$scope","PathService","$filter","$translate","UtilService",function(d,e,g,f,c){var b;var a=(b={},_defineProperty(b,f.instant("confirmationmodal.delete.title"),"dialog-delete-image"),_defineProperty(b,f.instant("confirmationmodal.storageclass.title"),"dialog-storage-image"),_defineProperty(b,f.instant("confirmationmodal.public.title"),"dialog-public-image"),_defineProperty(b,f.instant("confirmationmodal.deletebucket.title"),"dialog-delete-image"),_defineProperty(b,f.instant("confirmationmodal.emptybucket.title"),"dialog-delete-image"),_defineProperty(b,f.instant("confirmationmodal.initiaterestore.title"),"dialog-public-image"),b);d.getClass=function(){return a[d.headerTitle]};d.closeModal=function(){d.isOpen.flag=false;d.closeCallback();c.bodyFreezeScroll(d.isOpen&&d.isOpen.flag)};d.dstFolderPath=e.getCurrentAbsoluteFolderPath()||e.getCurrentBucket()}])})();"use strict";function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}(function(){angular.module("s3").directive("confirmationDialogModal",function(){return{restrict:"E",scope:{isOpen:"=",operation:"=?",countInfo:"=?"},templateUrl:"/s3/partials/confirmationdialogmodal.html",controller:"ConfirmationDialogModalController"}});angular.module("s3").controller("ConfirmationDialogModalController",["$scope","$filter","$translate","BulkOperationService","OperationDispatcherService","S3Constants","CopyService","KeySelectionService","CountService","UtilService","SCLogService",function(p,m,q,k,e,o,i,n,f,r,b){var j;var d="ttlObj";var h="ttlSize";var l={STANDARD:q.instant("replication.storageclasses.standard"),STANDARD_IA:q.instant("replication.storageclasses.standardia")};var c=(j={},_defineProperty(j,o.OPERATION_NAME.DELETE_OBJECTS,{headTitle:q.instant("confirmationmodal.delete.title"),buttonName:q.instant("confirmationmodal.delete.buttonname"),warningInfo:{flag:true,text:"confirmationmodal.delete.warningtext"}}),_defineProperty(j,o.OPERATION_NAME.RESTORE_OBJECTS,{headTitle:q.instant("confirmationmodal.undodelete.text"),buttonName:q.instant("confirmationmodal.undodelete.text"),warningInfo:{flag:true,text:"confirmationmodal.undodelete.warningtext"}}),_defineProperty(j,o.OPERATION_NAME.MAKE_PUBLIC,{headTitle:q.instant("confirmationmodal.public.title"),buttonName:q.instant("confirmationmodal.public.buttonname"),warningInfo:{flag:true,text:"confirmationmodal.public.warningtext"}}),_defineProperty(j,o.OPERATION_NAME.CHANGE_STORAGE_CLASS,{headTitle:q.instant("confirmationmodal.storageclass.title"),buttonName:q.instant("confirmationmodal.storageclass.buttonname"),warningInfo:{flag:true,text:"confirmationmodal.paste.warningtext",val:p.operation.panelSettingValues?l[p.operation.panelSettingValues.setting]:""}}),_defineProperty(j,o.OPERATION_NAME.CHANGE_SSE,{headTitle:q.instant("confirmationmodal.sse.title"),buttonName:q.instant("confirmationmodal.sse.buttonname"),warningInfo:{flag:true,text:"confirmationmodal.sse.warningtext"}}),_defineProperty(j,o.OPERATION_NAME.CUT,{headTitle:q.instant("confirmationmodal.cutpaste.title"),buttonName:q.instant("confirmationmodal.paste.buttonname"),warningInfo:{flag:true,text:"confirmationmodal.paste.warningtext"}}),_defineProperty(j,o.OPERATION_NAME.COPY,{headTitle:q.instant("confirmationmodal.copypaste.title"),buttonName:q.instant("confirmationmodal.paste.buttonname"),warningInfo:{flag:true,text:"confirmationmodal.paste.warningtext"}}),_defineProperty(j,o.OPERATION_NAME.INITIATE_RESTORE,{headTitle:q.instant("confirmationmodal.initiaterestore.title"),buttonName:q.instant("confirmationmodal.initiaterestore.buttonname"),warningInfo:{flag:true,text:"confirmationmodal.initialrestore.warningtext"}}),_defineProperty(j,o.OPERATION_NAME.ADD_OBJECT_TAG,{headTitle:q.instant("confirmationmodal.addtags.title"),buttonName:q.instant("confirmationmodal.addtags.buttonname"),warningInfo:{flag:true,text:"confirmationmodal.addtags.warningtext",val:p.operation.panelSettingValues&&p.operation.panelSettingValues.values?p.operation.panelSettingValues.values.length:0}}),_defineProperty(j,o.OPERATION_NAME.GET_INFO,{headTitle:q.instant("confirmationmodal.getinfo.title"),buttonName:q.instant("confirmationmodal.getinfo.buttonname"),warningInfo:{flag:false}}),j);var a={flag:true,folders:0,objects:0,size:0,currLevelObjs:0,countResultEachFolder:{}};p.closeIconShow=false;p.selected={selectedItems:{currFolderPathPrefix:p.operation.initialPath,folders:p.operation.selectedFolders,objects:p.operation.selectedKeys}};if(!p.countInfo||!p.countInfo.countFinish){p.countInfo=_.cloneDeep(a);p.isCounting={flag:false};p.$watch(function(){return p.countInfo},function(t,s){if(t!==s){angular.forEach(p.selected.selectedItems.folders,function(u){var v=p.countInfo.countResultEachFolder&&p.countInfo.countResultEachFolder[u.Prefix];if(v){u.objsCount=p.countInfo.countResultEachFolder[u.Prefix].count;u.folderSize=p.countInfo.countResultEachFolder[u.Prefix].totalSize}})}},true);f.countAllFiles(p.selected.selectedItems,p.countInfo,p.operation,p.isCounting)}else{angular.forEach(p.selected.selectedItems.folders,function(s){var t=p.countInfo.countResultEachFolder&&p.countInfo.countResultEachFolder[s.Prefix];if(t){s.objsCount=p.countInfo.countResultEachFolder[s.Prefix].count;s.folderSize=p.countInfo.countResultEachFolder[s.Prefix].totalSize}})}p.modalInfo=c[p.operation.name];var g=p.operation.name===o.OPERATION_NAME.CUT||p.operation.name===o.OPERATION_NAME.COPY;p.sourceDstInfo={flag:g,source:p.operation.initialPath||p.operation.initialBucket};p.closeConfirmationModal=function(){p.isOpen.flag=false;p.isOpen.dialogOpen.flag=false;p.isOpen.sidePanelOpen=false;p.selected={selectedItems:{currFolderPathPrefix:"",folders:[],objects:[]}};p.countInfo=_.cloneDeep(a);p.countInfo.flag=false;p.modalInfo={headTitle:"",buttonName:"",warningInfo:{flag:false,text:""}};p.operation=null;p.panelSettingValues=null};p.operationFunc=function(){if(p.operation.name===o.OPERATION_NAME.CHANGE_STORAGE_CLASS){p.operation.additionalInfo={targetStorageClass:p.operation.panelSettingValues.setting,numberOfKeysPerBulkOperation:o.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API}}else{if(p.operation.name===o.OPERATION_NAME.CHANGE_SSE){p.operation.additionalInfo={sseAlgo:p.operation.panelSettingValues.setting,numberOfKeysPerBulkOperation:o.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API}}else{if(p.operation.name===o.OPERATION_NAME.INITIATE_RESTORE){p.operation.additionalInfo={expirationDays:p.operation.panelSettingValues.setting,numberOfKeysPerBulkOperation:o.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API}}else{if(p.operation.name===o.OPERATION_NAME.ADD_OBJECT_TAG){p.operation.additionalInfo={tags:r.reduceObjectArrayToObject(p.operation.panelSettingValues.values),numberOfKeysPerBulkOperation:o.BULK_OPERATION_KEYS_PER_REQUEST.CWS_API}}else{if(p.operation.name===o.OPERATION_NAME.GET_INFO){p.closeConfirmationModal();return}}}}}p.operation.totalObjectCount=p.countInfo.objects;b.log(p.operation.name.replace(/\s/g,"")+d,p.operation.totalObjectCount,p.operation);b.log(p.operation.name.replace(/\s/g,"")+h,p.countInfo.size,p.operation);g?i.startClipboardOperation():e.addOperation(p.operation);p.closeConfirmationModal()};p.save=function(s){s.stopPropagation();p.isOpen.dialogOpen.flag=true;p.isOpen.sidePanelOpen=false};p.cancel=function(s){s.stopPropagation();p.closeConfirmationModal()}}])})();"use strict";(function(){angular.module("s3").directive("fileListInModal",function(){return{restrict:"E",scope:{removeItemFromUpload:"&?",closeIconShow:"=?",forUploads:"=",selected:"="},templateUrl:"/s3/partials/fileslistinmodal.html",controller:"FileListInModalController"}});angular.module("s3").controller("FileListInModalController",["$scope","$filter","UtilService",function(b,c,a){b.$watchCollection("selected",function(){b.selectedItems=b.selected.selectedItems});b.closeIconFunc=function(d){if(b.forUploads&&b.removeItemFromUpload){b.removeItemFromUpload({item:d})}};b.getFileIconClass=function(d){return a.getIconClassFromFilename(d.Key)};b.haveSelectedItems=function(){return b.selectedItems&&b.selectedItems.folders&&!_.isEmpty(b.selectedItems.folders)||b.selectedItems&&b.selectedItems.objects&&!_.isEmpty(b.selectedItems.objects)}}])})();"use strict";function _defineProperty(c,a,b){if(a in c){Object.defineProperty(c,a,{value:b,enumerable:true,configurable:true,writable:true})}else{c[a]=b}return c}(function(){angular.module("s3").directive("bucketLifecycle",[function(){return{restrict:"E",scope:{},templateUrl:"/s3/partials/bucketlifecycle.html",controller:"BucketLifecycleController"}}]);angular.module("s3").controller("BucketLifecycleController",["$filter","$scope","$translate","AWSC","BucketPropertiesService","BucketPropertiesUtilService","CachingService","ConsoleOperation","FAC","PathService","S3Constants","UtilService","XMLParser",a]);function a(r,u,v,t,k,e,i,q,m,c,s,B,D){var C;u.moreOptions=[{id:s.LIFECYCLE.CONFIRMATION_MODAL.ENABLE_POLICY,text:v.instant("bucketlifecycle.more.enablelifecycle"),action:function w(){u.showConfirmationModal(s.LIFECYCLE.CONFIRMATION_MODAL.ENABLE_POLICY)},disabled:true},{id:s.LIFECYCLE.CONFIRMATION_MODAL.DISABLE_POLICY,text:v.instant("bucketlifecycle.more.disablelifecycle"),action:function w(){u.showConfirmationModal(s.LIFECYCLE.CONFIRMATION_MODAL.DISABLE_POLICY)},disabled:true}];u.showConfirmationModal=function(E){if(u.lifecycle.ruleToBeEdited){u.lifecycle.selectedRule=u.lifecycle.ruleToBeEdited;u.lifecycle.selectedRuleIndex=u.lifecycle.editRuleIndex;u.warningMessage=u.warningList[E];u.actionType=E;u.headerTitle=u.confirmationModalHeadersList[E];o();u.isConfirmationModalOpen.flag=true}};u.warningList={enablePolicy:v.instant("lifecycleconfirmationmodal.warning.enablemessage"),disablePolicy:v.instant("lifecycleconfirmationmodal.warning.disablemessage"),deletePolicy:v.instant("lifecycleconfirmationmodal.warning.deletemessage")};u.confirmationModalHeadersList={enablePolicy:v.instant("bucketlifecycle.more.enablelifecycle"),disablePolicy:v.instant("bucketlifecycle.more.disablelifecycle"),deletePolicy:v.instant("bucketlifecycle.more.deletelifecycle")};u.isConfirmationModalOpen={flag:false};u.isLifecycleModalOpen={flag:false};u.showLifecycleModalForEdit=function(){if(u.lifecycle.ruleToBeEdited){u.lifecycle.selectedRule=x(u.lifecycle.ruleToBeEdited);u.lifecycle.selectedRule.showCurrent=!_.isEmpty(u.lifecycle.selectedRule.currentRuleActions);u.lifecycle.selectedRule.showPrevious=!_.isEmpty(u.lifecycle.selectedRule.noncurrentRuleActions);u.lifecycle.selectedRule.indexVal=u.lifecycle.editRuleIndex;u.isLifecycleModalOpen.flag=true;o();u.forEdit=true}};function o(){B.analyticsTrackClick(s.ANALYTICS.LIFECYCLE_RULES_MODAL,s.ANALYTICS.DETAILS)}u.showLifecycleModalForCreate=function(){B.analyticsTrackClick(s.ANALYTICS.START_LIFECYCLE,s.ANALYTICS.LIFECYCLE_S3);B.analyticsTrackView(s.ANALYTICS.NAME_SCOPE_LIFECYCLE,s.ANALYTICS.LIFECYCLE_S3);p();u.forEdit=false;u.lifecycle.selectedRule={};u.lifecycle.selectedRule.ID="";u.lifecycle.selectedRule.Status=s.LIFECYCLE.ENABLED;u.lifecycle.selectedRule.Prefix="";u.lifecycle.selectedRule.applied=s.LIFECYCLE.WHOLE_BUCKET;u.lifecycle.selectedRule.tags=[];u.lifecycle.selectedRule.currentRuleActions=[];u.lifecycle.selectedRule.noncurrentRuleActions=[];u.lifecycle.selectedRule.summary={currentTransitionsList:["","",""],noncurrentTransitionsList:["","",""],rldm:false,amu:"",ID:"",prefix:""};u.lifecycle.selectedRule.amu={enabled:false,days:""};u.lifecycle.selectedRule.expiration={enabled:false,days:""};u.lifecycle.selectedRule.permanentlyDelete={enabled:false,days:""};u.lifecycle.selectedRule.showRldm=true;u.lifecycle.selectedRule.rldmValue=false;u.lifecycle.selectedRule.containsRldmAsFalse=false;u.lifecycle.selectedRule.removeExpire=false;u.lifecycle.selectedRule.expiration={enabled:false,days:""};u.lifecycle.selectedRule.showCurrent=false;u.lifecycle.selectedRule.showPrevious=false;u.lifecycle.selectedRule.currentRuleOptions=A(n);u.lifecycle.selectedRule.noncurrentRuleOptions=A(n);u.lifecycle.selectedRule.isAddCurrentTransitionDisabled=false;u.lifecycle.selectedRule.isAddPrevTransitionDisabled=false;u.lifecycle.selectedRule.isNextButtonDisabled=true;u.lifecycle.selectedRule.showStep3CurrentVersion=false;u.lifecycle.selectedRule.showStep3PreviousVersion=false;u.lifecycle.selectedRule.filterUsed=u.filterUsed;u.lifecycle.selectedRule.filters={input:"",prefixFilters:[],tagFilters:[]};u.lifecycle.selectedRule.prefixUsed=false;o();u.isLifecycleModalOpen.flag=true};function p(){if(u.lifecycleConfiguration&&u.lifecycleConfiguration.Rules){for(var E=0;E<u.lifecycleConfiguration.Rules.length;E++){u.lifecycle.listViewRules[E].selected=false}}}function h(F,E){u.moreOptions[0].disabled=F;u.moreOptions[1].disabled=E}function n(){var F=[{text:v.instant("lifecyclemodal.sia"),value:s.LIFECYCLE.SIA,disabled:false}];var E={text:v.instant("lifecyclemodal.glacier"),value:s.LIFECYCLE.GLACIER,disabled:false};if(u.glacierEnabled){F.push(E)}return F}function A(F){var G=[];for(var E=0;E<s.LIFECYCLE.TOTAL_OPTIONS;E++){G.push(F())}return G}function z(G,F){if(G.NoncurrentVersionTransition){var H=B.transformObjectToArray(G.NoncurrentVersionTransition);for(var E=0;E<H.length;E++){if(H[E].NoncurrentDays){F.noncurrentRuleActions.push({action:s.LIFECYCLE.RULE_ACTIONS_MAP[H[E].StorageClass],value:H[E].NoncurrentDays})}}}}function l(F,E){if(F.NoncurrentVersionExpiration){if(F.NoncurrentVersionExpiration.NoncurrentDays){E.permanentlyDelete={enabled:true,days:F.NoncurrentVersionExpiration.NoncurrentDays};E.showStep3PreviousVersion=true}}}function b(G,F){if(G.Transition){var H=B.transformObjectToArray(G.Transition);for(var E=0;E<H.length;E++){if(H[E].Days){F.currentRuleActions.push({action:s.LIFECYCLE.RULE_ACTIONS_MAP[H[E].StorageClass],value:H[E].Days})}}}}function d(F,E){if(F.Expiration){if(F.Expiration.Days){E.expiration={enabled:true,days:F.Expiration.Days};E.removeExpire=false;E.showRldm=false;E.showStep3CurrentVersion=true}else{if(F.Expiration.ExpiredObjectDeleteMarker){if(F.Expiration.ExpiredObjectDeleteMarker===s.LIFECYCLE.TRUE){E.removeExpire=true}else{E.containsRldmAsFalse=true}}}}}function y(F,E){E.amu={enabled:false,days:""};if(F.AbortIncompleteMultipartUpload){E.amu.enabled=true;E.amu.days=F.AbortIncompleteMultipartUpload.DaysAfterInitiation}}function x(I){var H=_.cloneDeep(I);var G={};G.ID=H.ID;G.Status=H.Status;G.tagSet=[];G.Prefix="";G.prefixUsed=true;G.filters={input:"",prefixFilters:[],tagFilters:[]};if(H.Prefix){G.filterUsed=false;G.Prefix=H.Prefix;G.filters.prefixFilters.push(G.Prefix)}else{if(H.Filter){G.filterUsed=true;if(H.Filter.Prefix){G.Prefix=H.Filter.Prefix;G.filters.prefixFilters.push(G.Prefix)}else{if(H.Filter.And&&H.Filter.And.Prefix){G.Prefix=H.Filter.And.Prefix;G.filters.prefixFilters.push(G.Prefix)}else{G.prefixUsed=false}}}}if(H.Filter){var E=[];if(!_.isEmpty(H.Filter.Tag)){E=B.transformObjectToArray(H.Filter.Tag)}else{if(H.Filter.And&&!_.isEmpty(H.Filter.And.Tag)){E=B.transformObjectToArray(H.Filter.And.Tag)}}for(var F=0;F<E.length;F++){G.filters.tagFilters.push({tagKey:E[F].Key,tagVal:E[F].Value})}}G.applied=!_.isEmpty(G.Prefix)?s.LIFECYCLE.PREFIX:s.LIFECYCLE.WHOLE_BUCKET;G.currentRuleActions=[];G.noncurrentRuleActions=[];G.expiration={enabled:false,days:""};G.permanentlyDelete={enabled:false,days:""};G.removeExpire=false;G.showCurrent=false;G.showPrevious=false;G.showRldm=true;b(H,G);d(H,G);z(H,G);l(H,G);y(H,G);G.currentRuleOptions=A(n);G.noncurrentRuleOptions=A(n);G.isAddCurrentTransitionDisabled=e.isTransitionDisabled(s.LIFECYCLE.GLACIER,G.currentRuleActions);e.updateLifecycleDropdown(G.currentRuleActions,G.currentRuleOptions,s.LIFECYCLE.CURRENT_RULE_OPTIONS_MAP);G.isAddPrevTransitionDisabled=e.isTransitionDisabled(s.LIFECYCLE.GLACIER,G.noncurrentRuleActions);e.updateLifecycleDropdown(G.noncurrentRuleActions,G.noncurrentRuleOptions,s.LIFECYCLE.NONCURRENT_RULE_OPTIONS_MAP);G.summary={currentTransitionsList:["","",""],noncurrentTransitionsList:["","",""],rldm:false,amu:"",ID:"",prefix:""};G.isNextButtonDisabled=false;return G}u.isEdit=true;u.isDelete=true;u.selectRule=function(F,E){u.lifecycle.selectedRule={};u.lifecycle.ruleToBeEdited=angular.copy(u.lifecycleConfiguration.Rules[E]);u.lifecycle.editRuleIndex=E;p();F.selected=true;if(!F.containsDate){u.isEdit=false}u.isDelete=false;if(F.Status===s.LIFECYCLE.ENABLED){h(true,false)}else{h(false,true)}};u.lifecycle={listViewRules:[],ruleToBeEdited:{}};u.lifecycleConfiguration={Rules:[]};u.bucketName=c.getCurrentBucket();var j=(C={},_defineProperty(C,s.LIFECYCLE.LIST_VIEW.STANDARD_IA,v.instant("lifecycle.listview.standia")),_defineProperty(C,s.LIFECYCLE.LIST_VIEW.GLACIER,v.instant("lifecycle.listview.glacier")),_defineProperty(C,s.LIFECYCLE.LIST_VIEW.PREFIX,v.instant("lifecycle.listview.prefix")),_defineProperty(C,s.LIFECYCLE.LIST_VIEW.WHOLE,v.instant("lifecycle.listview.whole")),_defineProperty(C,s.LIFECYCLE.EXPIRE,v.instant("lifecycle.expire")),C);function f(){u.lifecycle.listViewRules=[];u.filterUsed=false;var F=function F(H){var K={};var J=angular.copy(u.lifecycleConfiguration.Rules[H]);K.ID=J.ID;if(typeof J.Prefix!=="undefined"){K.Prefix=J.Prefix!==""?j[s.LIFECYCLE.LIST_VIEW.PREFIX]+" : "+J.Prefix:j[s.LIFECYCLE.LIST_VIEW.WHOLE]}else{if(J.Filter){u.filterUsed=true;if(J.Filter.Prefix){K.Prefix=j[s.LIFECYCLE.LIST_VIEW.PREFIX]+" : "+J.Filter.Prefix}else{if(J.Filter.And&&J.Filter.And.Prefix){K.Prefix=j[s.LIFECYCLE.LIST_VIEW.PREFIX]+" : "+J.Filter.And.Prefix}else{K.Prefix=v.instant("lifecycle.listview.whole")}}if(K.Prefix.length>s.LIFECYCLE.LIST_VIEW_MAX_LENGTH){K.Prefix=K.Prefix.substring(0,22);K.Prefix=K.Prefix+"... "}var O=[];if(J.Filter.Tag){O=B.transformObjectToArray(J.Filter.Tag)}else{if(J.Filter.And&&!_.isEmpty(J.Filter.And.Tag)){O=B.transformObjectToArray(J.Filter.And.Tag)}}if(!_.isEmpty(O)){(function(){var P=s.LIFECYCLE.TAGS;var R=s.LIFECYCLE.KEY_STRING;var S=s.LIFECYCLE.VALUE_STRING;var Q=", "+P+" : ";angular.forEach(O,function(T){Q=Q+" [ "+R+": "+T.Key+" , "+S+" : "+T.Value+" ]"});if(Q.length>s.LIFECYCLE.LIST_VIEW_MAX_LENGTH){Q=Q.substring(0,22);Q=Q+"..."}K.Prefix=K.Prefix+" "+Q})()}}}K.Status=J.Status;var I=[];if(J.Transition){var M=B.transformObjectToArray(J.Transition);for(var G=0;G<M.length;G++){if(M[G].Days){I.push(j[s.LIFECYCLE.LIST_VIEW[M[G].StorageClass]])}else{if(M[G].Date){I.push(j[s.LIFECYCLE.LIST_VIEW[M[G].StorageClass]]+" ("+v.instant("bucketlifecycle.date")+(" "+M[G].Date+")"));K.containsDate=true}}}}if(J.Expiration){if(J.Expiration.Days){I.push(j[s.LIFECYCLE.EXPIRE])}else{if(J.Expiration.Date){I.push(j[s.LIFECYCLE.EXPIRE]+" ("+v.instant("bucketlifecycle.date")+(" "+J.Expiration.Date+")"));K.containsDate=true}}}K.transitionsList="";for(var N=0;N<I.length;N++){K.transitionsList=K.transitionsList+" / "+I[N]}if(!_.isEmpty(K.transitionsList)){K.transitionsList=K.transitionsList.substring(3)}else{K.transitionsList="-"}I=[];K.prevActions="";if(J.NoncurrentVersionTransition){var L=B.transformObjectToArray(J.NoncurrentVersionTransition);angular.forEach(L,function(P){if(P.NoncurrentDays){I.push(j[s.LIFECYCLE.LIST_VIEW[P.StorageClass]])}})}if(J.NoncurrentVersionExpiration){I.push(s.LIFECYCLE.LIST_VIEW[s.LIFECYCLE.PERMANENTLY_DELETE])}angular.forEach(I,function(P){K.prevActions=K.prevActions+" / "+P});if(!_.isEmpty(K.prevActions)){K.prevActions=K.prevActions.substring(3)}else{K.prevActions="-"}if(K.transitionsList==="-"&&K.prevActions==="-"&&J.AbortIncompleteMultipartUpload){K.transitionsList=v.instant("lifecyclemodal.step3.imucleanup")}u.lifecycle.listViewRules.push(K)};for(var E=0;E<u.lifecycleConfiguration.Rules.length;E++){F(E)}}u.operation=new q(s.LIFECYCLE.BUCKET_LIFECYCLE);u.glacierEnabled=true;function g(){k.getBucketLocation(u.bucketName).then(function(E){if(!m.isFeatureEnabled("s3-gl-"+E)){u.glacierEnabled=false}})}u.initialize=function(){var E=new X2JS({stripWhitespaces:false});u.lifecycle.initialXML="";u.lifecycleConfiguration.Rules=[];u.operation.step=s.LIFECYCLE.GET_BUCKET_LIFECYCLE;k.getBucketLifecycle(u.bucketName,u.operation).then(function(G){i.evictBucketProperty(u.bucketName,s.LIFECYCLE.NAME);var F=E.xml_str2json(G);if(F&&F.LifecycleConfiguration&&F.LifecycleConfiguration.Rule){u.lifecycleConfiguration.Rules=B.transformObjectToArray(F.LifecycleConfiguration.Rule);u.showEmptyScreen=u.lifecycleConfiguration.Rules.length===0;u.lifecycle.initialXML=G;f()}})["catch"](function(F){if(F!==s.LIFECYCLE.LIFECYCLE_DOES_NOT_EXIST_MESSAGE){u.lifecycleError=F}else{u.showEmptyScreen=true}})};u.initialize();g()}})();"use strict";(function(){angular.module("s3").directive("lifecycleModal",[function(){return{restrict:"E",scope:{isOpen:"=",selectedRule:"=",initialResponse:"=",initialize:"=",isEditing:"=",initialXml:"=",operation:"=",disableEdit:"=",disableDelete:"=",ruleToBeEdited:"=",moreOptions:"="},templateUrl:"/s3/partials/lifecyclemodal.html",controller:"LifecycleModalController"}}]);angular.module("s3").controller("LifecycleModalController",["$filter","$scope","$timeout","$translate","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","FAC","PathService","S3Constants","SCLogService","UtilService","XMLParser",a]);function a(t,v,B,w,o,g,r,p,f,u,e,C,E){v.STEP={NAME_AND_SCOPE:{name:"NAME_AND_SCOPE",value:w.instant("lifecyclemodal.label.nameandscope")},TRANSITION:{name:"TRANSITION",value:w.instant("lifecyclemodal.transitions")},EXPIRATION:{name:"EXPIRATION",value:w.instant("lifecyclemodal.expiration")},REVIEW:{name:"REVIEW",value:w.instant("lifecyclemodal.label.review")}};v.transitionNumber=[w.instant("bucketlifecycle.firsttransition"),w.instant("bucketlifecycle.secondtransition"),w.instant("bucketlifecycle.thirdtransition")];v.$watch("selectedRule",function(H,G){if(v.selectedRule&&v.selectedRule.filters&&v.selectedRule.filters.tagFilters.length>0){if(v.selectedRule.amu.enabled&&v.selectedRule.amu.days||v.selectedRule.removeExpire){v.clearLDMAMUWarning=true;v.selectedRule.amu.enabled=false;v.selectedRule.amu.days="";v.selectedRule.removeExpire=false}v.showV2FormatWarning=!v.selectedRule.filterUsed&&!_.isEmpty(v.initialResponse)}else{v.showV2FormatWarning=false;v.clearLDMAMUWarning=false}},true);v.isAddPrevTransitionDisabled=false;v.isAddCurrentTransitionDisabled=false;v.showOverlappingPrefixWarning=false;function c(){v.selectedRule.isAddCurrentTransitionDisabled=g.isTransitionDisabled(u.LIFECYCLE.GLACIER,v.selectedRule.currentRuleActions);g.updateLifecycleDropdown(v.selectedRule.currentRuleActions,v.selectedRule.currentRuleOptions,u.LIFECYCLE.CURRENT_RULE_OPTIONS_MAP)}function D(){v.selectedRule.isAddPrevTransitionDisabled=g.isTransitionDisabled(u.LIFECYCLE.GLACIER,v.selectedRule.noncurrentRuleActions);g.updateLifecycleDropdown(v.selectedRule.noncurrentRuleActions,v.selectedRule.noncurrentRuleOptions,u.LIFECYCLE.NONCURRENT_RULE_OPTIONS_MAP)}function n(H,G){if(H.action===u.LIFECYCLE.SIA){H.value=u.LIFECYCLE.RECOMMENDED_DAYS.SIA}else{if(H.action===u.LIFECYCLE.GLACIER){H.value=u.LIFECYCLE.RECOMMENDED_DAYS.GLACIER;if(G.length>1){H.value=(parseInt(G[G.length-2].value)+u.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS.SIA).toString()}}}}function A(H,G){H.days=u.LIFECYCLE.RECOMMENDED_DAYS.EXPIRATION;if(G.length>0){H.days=(parseInt(G[G.length-1].value)+parseInt(H.days)).toString()}}v.selectNoncurrentRuleAction=function(H,G){if(G===v.selectedRule.noncurrentRuleActions.length-1){v.hasPrevError=false}v.notANumberErrorNoncurrent.SIA=false;v.notANumberErrorNoncurrent.Glacier=false;v.minimumDaysNoncurrent.SIA=false;v.minimumDaysNoncurrent.Glacier=false;D();if(v.selectedRule.noncurrentRuleActions[G].value===""){n(v.selectedRule.noncurrentRuleActions[G],v.selectedRule.noncurrentRuleActions)}v.validateDays(G,u.LIFECYCLE.NONCURRENT);v.updateNextButtonDisabled()};v.selectCurrentRuleAction=function(H,G){if(G===v.selectedRule.currentRuleActions.length-1){v.hasCurrentError=false}v.notANumberErrorCurrent.SIA=false;v.notANumberErrorCurrent.Glacier=false;v.minimumDaysCurrent.SIA=false;v.minimumDaysCurrent.Glacier=false;c();if(v.selectedRule.currentRuleActions[G].value===""){n(v.selectedRule.currentRuleActions[G],v.selectedRule.currentRuleActions)}v.validateDays(G,u.LIFECYCLE.CURRENT);v.updateNextButtonDisabled()};v.addCurrentRuleAction=function(){if(v.selectedRule.isAddCurrentTransitionDisabled){return}v.selectedRule.currentRuleActions.push({action:"",value:""});c();v.selectedRule.isAddCurrentTransitionDisabled=true;v.updateNextButtonDisabled()};v.removeCurrentRuleAction=function(G){if(v.selectedRule.currentRuleActions.length-1===G){v.hasCurrentError=false}var H=v.selectedRule.currentRuleActions[G].action;v.notANumberErrorCurrent[H]=false;v.minimumDaysCurrent[H]=false;v.highlightTextBoxErrorCurrent[G]=false;v.selectedRule.currentRuleActions.splice(G,1);c();q(v.selectedRule.currentRuleActions,u.LIFECYCLE.CURRENT);v.updateNextButtonDisabled();if(v.selectedRule.expiration.enabled){v.validateCurrentExpiration()}};v.addNoncurrentRuleAction=function(){if(v.selectedRule.isAddPrevTransitionDisabled){return}v.selectedRule.noncurrentRuleActions.push({action:"",value:""});D();v.selectedRule.isAddPrevTransitionDisabled=true;v.updateNextButtonDisabled()};v.removeNoncurrentRuleAction=function(H){if(v.selectedRule.noncurrentRuleActions.length-1===H){v.hasPrevError=false}var G=v.selectedRule.noncurrentRuleActions[H].action;v.notANumberErrorNoncurrent[G]=false;v.minimumDaysNoncurrent[G]=false;v.highlightTextBoxErrorNonCurrent[H]=false;v.selectedRule.noncurrentRuleActions.splice(H,1);D();q(v.selectedRule.noncurrentRuleActions,u.LIFECYCLE.NONCURRENT);v.updateNextButtonDisabled();if(v.selectedRule.permanentlyDelete.enabled){v.validateNoncurrentExpiration()}};v.state=v.STEP.NAME_AND_SCOPE;v.headerTitle=w.instant("lifecyclemodal.header.title");v.generateSummary=function(){if(v.state===v.STEP.NAME_AND_SCOPE){C.analyticsTrackClick(u.ANALYTICS.NAME_SCOPE_LIFECYCLE,u.ANALYTICS.LIFECYCLE_S3);C.analyticsTrackView(u.ANALYTICS.TRANSITION_LIFECYCLE,u.ANALYTICS.LIFECYCLE_S3);v.selectedRule.summary.ruleName=angular.copy(v.selectedRule.ID);if(v.showOldUI){v.selectedRule.summary.prefix=!_.isEmpty(v.selectedRule.Prefix)?angular.copy(v.selectedRule.Prefix):w.instant("lifecyclemodal.step1.wholebucket")}else{var N=v.selectedRule.filters&&!_.isEmpty(v.selectedRule.filters.prefixFilters)?angular.copy(v.selectedRule.filters.prefixFilters[0]):w.instant("lifecyclemodal.step1.wholebucket");var I=u.LIFECYCLE.TAGSET;I=I+" : ";for(var K=0;K<v.selectedRule.filters.tagFilters.length;K++){var M=u.LIFECYCLE.KEY;var T=u.LIFECYCLE.VALUE;var J="[ "+M+" "+v.selectedRule.filters.tagFilters[K].tagKey+" , "+T+" : "+v.selectedRule.filters.tagFilters[K].tagVal+" ]";I=I+" "+J}v.selectedRule.summary.prefix=""+N;if(!_.isEmpty(v.selectedRule.filters.tagFilters)){v.selectedRule.summary.prefix=N+" , "+I}}}else{if(v.state===v.STEP.TRANSITION){v.selectedRule.summary.currentTransitionsList=[];v.selectedRule.summary.noncurrentTransitionsList=[];var H=w.instant("lifecyclemodal.step3.afterdays");var Q=w.instant("lifecyclemodal.days");for(var K=0;K<v.selectedRule.currentRuleActions.length;K++){var S=angular.copy(v.selectedRule.currentRuleActions[K].value);var R=u.LIFECYCLE.REVIEW_SECTION_TRANSITIONS[v.selectedRule.currentRuleActions[K].action];var L=R+" "+H+" "+S+" "+Q;v.selectedRule.summary.currentTransitionsList.push(L)}for(var K=v.selectedRule.currentRuleActions.length;K<u.LIFECYCLE.TOTAL_OPTIONS;K++){v.selectedRule.summary.currentTransitionsList.push("")}for(var K=0;K<v.selectedRule.noncurrentRuleActions.length;K++){var O=angular.copy(v.selectedRule.noncurrentRuleActions[K].value);var R=u.LIFECYCLE.REVIEW_SECTION_TRANSITIONS[v.selectedRule.noncurrentRuleActions[K].action];var P=R+" "+H+" "+O+" "+Q;v.selectedRule.summary.noncurrentTransitionsList.push(P)}for(var K=v.selectedRule.noncurrentRuleActions.length;K<u.LIFECYCLE.TOTAL_OPTIONS;K++){v.selectedRule.summary.noncurrentTransitionsList.push("")}v.selectedRule.summary.currentVersionHeader=_.some(v.selectedRule.summary.currentTransitionsList,function(U){return U!==""});v.selectedRule.summary.noncurrentVersionHeader=_.some(v.selectedRule.summary.noncurrentTransitionsList,function(U){return U!==""});var G={};if(v.selectedRule.currentRuleActions.length>0){G.transition_to_standard_IA=v.selectedRule.currentRuleActions[0].value}if(v.selectedRule.currentRuleActions.length===2){G.transition_to_glacier=v.selectedRule.currentRuleActions[1].value}C.analyticsTrackClick(u.ANALYTICS.TRANSITION_LIFECYCLE,u.ANALYTICS.LIFECYCLE_S3,G);C.analyticsTrackView(u.ANALYTICS.EXPIRATIONS_LIFECYCLE,u.ANALYTICS.LIFECYCLE_S3)}else{if(v.state===v.STEP.EXPIRATION){v.searchOverlappingPrefixes();if(v.selectedRule.amu&&v.selectedRule.amu.enabled&&v.selectedRule.amu.days!==""){v.selectedRule.summary.amu=angular.copy(v.selectedRule.amu.days)}else{v.selectedRule.summary.amu=""}if(v.selectedRule.removeExpire&&v.selectedRule.expiration&&!v.selectedRule.expiration.enabled){v.selectedRule.summary.rldm=true}else{v.selectedRule.summary.rldm=false}C.analyticsTrackClick(u.ANALYTICS.EXPIRATIONS_LIFECYCLE,u.ANALYTICS.LIFECYCLE_S3);C.analyticsTrackView(u.ANALYTICS.REVIEW_LIFECYCLE,u.ANALYTICS.LIFECYCLE_S3)}}}v.nextState();v.selectedRule.isNextButtonDisabled=true;v.updateNextButtonDisabled()};v.searchOverlappingPrefixes=function(){v.showOverlappingPrefixWarning=false;v.overlappingRule="";for(var H=0;H<v.initialResponse.length;H++){if(v.isEditing&&H==v.selectedRule.indexVal){continue}var I="";var G="";if(v.showOldUI){G=v.selectedRule.Prefix}else{G=!_.isEmpty(v.selectedRule.filters.prefixFilters)?v.selectedRule.filters.prefixFilters[0]:""}var J=v.initialResponse[H];if(J.Prefix){I=J.Prefix}else{if(J.Filter){if(J.Filter.Prefix){I=J.Filter.Prefix}else{if(J.Filter.And&&J.Filter.And.Prefix){I=J.Filter.And.Prefix}}}}if(_.startsWith(G,I)||_.startsWith(I,G)){v.showOverlappingPrefixWarning=true;if(!v.selectedRule.filterUsed){v.showOverlappingNewFormatWarning=true}v.overlappingRule=J.ID;break}}};function x(J,M,K){var I={};I.LifecycleConfiguration={};I.LifecycleConfiguration.Rule=J;delete J._xmlns;var H=v.initialXml;var G=M.json2xml_str(I);var L=v.isEditing?M.json2xml_str(v.initialResponse[v.selectedRule.indexVal]):"";o.putBucketLifecycle(f.getCurrentBucket(),H,G,L,K,v.operation).then(function(){v.lifecycleError=undefined;v.disableEdit=true;v.disableDelete=true;v.ruleToBeEdited=undefined;v.moreOptions[0].disabled=true;v.moreOptions[1].disabled=true;v.initialize();v.closeLifecycleModal()})["catch"](function(N){v.lifecycleError=N})}v.detectStateChange=function(){v.operation.step=u.LIFECYCLE.GET_BUCKET_LIFECYCLE;o.getBucketLifecycle(f.getCurrentBucket(),v.operation).then(function(G){if(G!==v.initialXml){v.showContinue=true;v.stateChangeWarning=w.instant("lifecyclemodal.step3.statechange")}else{v.showContinue=false;v.stateChangeWarning=undefined;v.saveLifecycle()}})["catch"](function(G){if(G===u.LIFECYCLE.LIFECYCLE_DOES_NOT_EXIST_MESSAGE){if(v.initialXml!==""){v.showContinue=true;v.stateChangeWarning=w.instant("lifecyclemodal.step3.statechange")}else{v.showContinue=false;v.stateChangeWarning=undefined;v.saveLifecycle()}}else{v.lifecycleError=G}})};function b(H,G){return Object.keys(H).some(function(I){return I!==u.LIFECYCLE.PREFIX_PROPERTY&&!_.isEqual(H[I],G[I])})}v.saveLifecycle=function(){var H={};var I=false;C.analyticsTrackClick(u.ANALYTICS.END_LIFECYCLE,u.ANALYTICS.LIFECYCLE_S3,{s_fid:C.getCookie("s_fid"),"session-id":C.getCookie("session-id")});v.operation.step=u.LIFECYCLE.ENABLED_LIFECYCLE_RULE_ACTIONS;var Q=angular.copy(v.selectedRule);H.ID=Q.ID;if(!v.selectedRule.filterUsed&&_.isEmpty(v.selectedRule.filters.tagFilters)&&!v.showOverlappingPrefixWarning){if(v.showOldUI){H.Prefix=Q.applied===u.LIFECYCLE.PREFIX?Q.Prefix:""}else{if(!_.isEmpty(v.initialResponse)){H.Prefix=_.isEmpty(Q.filters.prefixFilters)?"":Q.filters.prefixFilters[0]}else{H.Filter={};H.Filter.Prefix=_.isEmpty(Q.filters.prefixFilters)?"":Q.filters.prefixFilters[0];I=true}}}else{if(!_.isEmpty(Q.filters.tagFilters)){if(Q.filters.tagFilters.length==1&&!Q.prefixUsed&&(v.showOldUI&&_.isEmpty(Q.Prefix)||!v.showOldUI&&_.isEmpty(Q.filters.prefixFilters))){H.Filter={};H.Filter.Tag=[];H.Filter.Tag.push({Key:Q.filters.tagFilters[0].tagKey,Value:Q.filters.tagFilters[0].tagVal})}else{H.Filter={};H.Filter.And={};if(v.showOldUI){H.Filter.And.Prefix=Q.applied===u.LIFECYCLE.PREFIX?Q.Prefix:""}else{H.Filter.And.Prefix=_.isEmpty(Q.filters.prefixFilters)?"":Q.filters.prefixFilters[0]}H.Filter.And.Tag=[];for(var J=0;J<Q.filters.tagFilters.length;J++){H.Filter.And.Tag.push({Key:Q.filters.tagFilters[J].tagKey,Value:Q.filters.tagFilters[J].tagVal})}}}else{H.Filter={};if(v.showOldUI){H.Filter.Prefix=Q.applied===u.LIFECYCLE.PREFIX?Q.Prefix:""}else{H.Filter.Prefix=_.isEmpty(Q.filters.prefixFilters)?"":Q.filters.prefixFilters[0]}}if(!v.selectedRule.filterUsed){I=true}}H.Status=Q.Status;H.Transition=[];for(var J=0;J<Q.currentRuleActions.length;J++){if(Q.currentRuleActions[J].action===u.LIFECYCLE.SIA){var M={};M.StorageClass=u.STORAGE_CLASSES.STANDARD_INFREQUENT_ACCESS;M.Days=Q.currentRuleActions[J].value;H.Transition.push(M);e.log("LifecycleCurrentSIARule",1,v.operation)}else{if(Q.currentRuleActions[J].action===u.LIFECYCLE.GLACIER){var P={};P.StorageClass=u.STORAGE_CLASSES.GLACIER;P.Days=Q.currentRuleActions[J].value;H.Transition.push(P);e.log("LifecycleCurrentGlacierRule",1,v.operation)}}}if(H.Transition.length===0){delete H.Transition}H.NoncurrentVersionTransition=[];for(var J=0;J<Q.noncurrentRuleActions.length;J++){if(Q.noncurrentRuleActions[J].action===u.LIFECYCLE.SIA){var G={};G.StorageClass=u.STORAGE_CLASSES.STANDARD_INFREQUENT_ACCESS;G.NoncurrentDays=Q.noncurrentRuleActions[J].value;H.NoncurrentVersionTransition.push(G);e.log("LifecycleNoncurrentSIARule",1,v.operation)}else{if(Q.noncurrentRuleActions[J].action===u.LIFECYCLE.GLACIER){var L={};L.StorageClass=u.STORAGE_CLASSES.GLACIER;L.NoncurrentDays=Q.noncurrentRuleActions[J].value;H.NoncurrentVersionTransition.push(L);e.log("LifecycleNoncurrentGlacierRule",1,v.operation)}}}if(H.NoncurrentVersionTransition.length===0){delete H.NoncurrentVersionTransition}if(Q.expiration&&Q.expiration.enabled&&Q.expiration.days!==""){H.Expiration={};H.Expiration.Days=Q.expiration.days;e.log("LifecycleExpirationRule",1,v.operation)}if(Q.permanentlyDelete&&Q.permanentlyDelete.enabled&&Q.permanentlyDelete.days!==""){H.NoncurrentVersionExpiration={};H.NoncurrentVersionExpiration.NoncurrentDays=Q.permanentlyDelete.days;e.log("LifecycleNoncurrentExpirationRule",1,v.operation)}if(Q.removeExpire){if(!(H.Expiration&&H.Expiration.Days)){H.Expiration={};H.Expiration.ExpiredObjectDeleteMarker=u.LIFECYCLE.TRUE;e.log("LifecycleExpiredLDMTrueRule",1,v.operation)}}if(Q.amu&&Q.amu.enabled&&Q.amu.days!==""){H.AbortIncompleteMultipartUpload={};H.AbortIncompleteMultipartUpload.DaysAfterInitiation=Q.amu.days;e.log("LifecycleAbortIncompleteUploadRule",1,v.operation)}if(Q.containsRldmAsFalse){if(!H.Expiration){H.Expiration={};H.Expiration.ExpiredObjectDeleteMarker=u.LIFECYCLE.FALSE;e.log("LifecycleExpiredLDMFalseRule",1,v.operation)}}var K=angular.copy(v.initialResponse);if(I){for(var J=0;J<K.length;J++){if(typeof K[J].Prefix!=="undefined"){K[J].Filter={};K[J].Filter.Prefix=angular.copy(K[J].Prefix);delete K[J].Prefix}}}var N=new X2JS({stripWhitespaces:false});var O=false;if(v.isEditing){K[Q.indexVal]=H;if(!v.selectedRule.filterUsed){for(var J=0;J<v.initialResponse.length;J++){if(J!==Q.indexVal){if(b(v.initialResponse[J],K[J])){e.log(u.METRIC_NAME.LIFECYCLE_RULE_MISMATCH,1,v.operation,{initialRule:v.initialResponse[J],finalRule:K[J]});O=true;break}}}}else{for(var J=0;J<v.initialResponse.length;J++){if(J!==Q.indexVal&&!_.isEqual(v.initialResponse[J],K[J])){e.log(u.METRIC_NAME.LIFECYCLE_RULE_MISMATCH,1,v.operation,{initialRule:v.initialResponse[J],finalRule:K[J]});O=true;break}}}if(!O){e.log("LifecycleRuleVerification",1,v.operation,{initialResponse:v.initialResponse,finalResponse:K});v.operation.step=u.LIFECYCLE.EDIT_BUCKET_LIFECYCLE;x(K,N,H)}else{e.log("LifecycleRuleVerification",0,v.operation,{initialResponse:v.initialResponse,finalResponse:K})}}else{for(var J=0;J<v.initialResponse.length;J++){if(b(v.initialResponse[J],K[J])){e.log(u.METRIC_NAME.LIFECYCLE_RULE_MISMATCH,1,v.operation,{initialRule:v.initialResponse[J],finalRule:K[J]});O=true;break}}v.operation.step=u.LIFECYCLE.CREATE_BUCKET_LIFECYCLE;K.push(H);if(!O){e.log("LifecycleRuleVerification",1,v.operation,{initialResponse:v.initialResponse,finalResponse:K});x(K,N,H)}else{e.log("LifecycleRuleVerification",0,v.operation,{initialResponse:v.initialResponse,finalResponse:K})}}};function m(){v.notANumberErrorCurrent={};v.notANumberErrorCurrent.SIA=false;v.notANumberErrorCurrent.Glacier=false;v.notANumberErrorCurrent.Expire=false;v.minimumDaysCurrent={};v.minimumDaysCurrent.SIA=false;v.minimumDaysCurrent.Glacier=false;v.minimumDaysCurrent.Expire=false;v.greaterThanCurrentError={};v.greaterThanCurrentError.GlacierGreaterThanSIA=false;v.greaterThanCurrentError.DeleteGreaterThanSIA=false;v.greaterThanCurrentError.DeleteGreaterThanGlacier=false;v.highlightTextBoxErrorCurrent=[false,false,false];v.notANumberErrorNoncurrent={};v.notANumberErrorNoncurrent.SIA=false;v.notANumberErrorNoncurrent.Glacier=false;v.notANumberErrorNoncurrent.PermanentlyDelete=false;v.minimumDaysNoncurrent={};v.minimumDaysNoncurrent.SIA=false;v.minimumDaysNoncurrent.Glacier=false;v.minimumDaysNoncurrent.PermanentlyDelete=false;v.greaterThanNonCurrentError={};v.greaterThanNonCurrentError.GlacierGreaterThanSIA=false;v.greaterThanNonCurrentError.DeleteGreaterThanSIA=false;v.greaterThanNonCurrentError.DeleteGreaterThanGlacier=false;v.highlightTextBoxErrorNonCurrent=[false,false,false];v.currentGlacierGreaterThanSIAValue="";v.expireGreaterThanSIAValue="";v.expireGreaterThanGlacierValue="";v.noncurrentGlacierGreaterThanSIAValue="";v.permanentlyDeleteGreaterThanSIAValue="";v.permanentlyDeleteGreaterThanGlacierValue="";v.tag={error:""};v.tagSearchSelected=false;v.showTag=false;v.markers=[];v.tagContinuationTokens=[];v.higherNumberErrorCurrent={};v.higherNumberErrorCurrent.SIA=false;v.higherNumberErrorCurrent.Glacier=false;v.higherNumberErrorCurrent.Expire=false;v.higherNumberErrorNoncurrent={};v.higherNumberErrorNoncurrent.SIA=false;v.higherNumberErrorNoncurrent.Glacier=false;v.higherNumberErrorNoncurrent.PermanentlyDelete=false}v.showStep2CurrentVersionChange=function(){if(!v.selectedRule.showCurrent){var G=v.selectedRule.currentRuleActions.length;for(var H=0;H<G;H++){v.removeCurrentRuleAction(0)}}if(v.selectedRule.expiration.enabled){v.validateCurrentExpiration()}};v.showStep2PreviousVersionChange=function(){if(!v.selectedRule.showPrevious){var G=v.selectedRule.noncurrentRuleActions.length;for(var H=0;H<G;H++){v.removeNoncurrentRuleAction(0)}}if(v.selectedRule.permanentlyDelete.enabled){v.validateNoncurrentExpiration()}};v.showStep3CurrentVersionChange=function(){if(!v.selectedRule.showStep3CurrentVersion){v.selectedRule.expiration.enabled=false;v.selectedRule.expiration.days="";v.selectedRule.showRldm=true;v.notANumberErrorCurrent[u.LIFECYCLE.EXPIRE]=false;v.minimumDaysCurrent[u.LIFECYCLE.EXPIRE]=false;v.higherNumberErrorCurrent.Expire=false;v.greaterThanCurrentError[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_SIA]=false;v.greaterThanCurrentError[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=false;v.highlightTextBoxErrorCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=false;v.updateNextButtonDisabled()}else{if(!v.selectedRule.expiration.enabled){v.selectedRule.expiration.enabled=true;v.selectedRule.showRldm=false;v.selectedRule.removeExpire=false;B(function(){return $("#expiration-days input").focus()});if(v.selectedRule.expiration.days===""){A(v.selectedRule.expiration,v.selectedRule.currentRuleActions)}v.updateNextButtonDisabled()}}};v.showStep3PreviousVersionChange=function(){if(!v.selectedRule.showStep3PreviousVersion){v.selectedRule.permanentlyDelete.enabled=false;v.selectedRule.permanentlyDelete.days="";v.notANumberErrorNoncurrent[u.LIFECYCLE.PERMANENTLY_DELETE]=false;v.minimumDaysNoncurrent[u.LIFECYCLE.PERMANENTLY_DELETE]=false;v.higherNumberErrorNoncurrent.PermanentlyDelete=false;v.greaterThanNonCurrentError[u.LIFECYCLE.DELETE_RULE_ACTION_GREATER_THAN_SIA]=false;v.greaterThanNonCurrentError[u.LIFECYCLE.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=false;v.highlightTextBoxErrorNonCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=false;v.updateNextButtonDisabled()}else{if(!v.selectedRule.permanentlyDelete.enabled){v.selectedRule.permanentlyDelete.enabled=true;B(function(){return $("#permanently-delete-days input").focus()});if(v.selectedRule.permanentlyDelete.days===""){A(v.selectedRule.permanentlyDelete,v.selectedRule.noncurrentRuleActions)}v.updateNextButtonDisabled()}}};function l(){v.notANumberAmuError=false;v.minimumDaysAmuError=false;v.higherNumberErrorAmu=false;v.hasCurrentError=false;v.hasPrevError=false}function k(){m();l()}function s(N,L,K,I,G,J){var H=N.length;if(H>=1){if(N[0].action===u.LIFECYCLE.SIA){if(H==2&&N[1].action===u.LIFECYCLE.GLACIER){if(N[1].value-N[0].value<u.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS.SIA){K[u.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER_GREATER_THAN_SIA]=true;I[u.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER]=true;var M=parseInt(N[0].value)+30;if(J===u.LIFECYCLE.CURRENT){v.currentGlacierGreaterThanSIAValue=M}else{v.noncurrentGlacierGreaterThanSIAValue=M}return}else{if(N[0].value<u.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS.SIA){G[u.LIFECYCLE.SIA]=true;I[u.LIFECYCLE.RULE_ACTION_ERRORS.SIA]=true;return}else{K[u.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER_GREATER_THAN_SIA]=false;I[u.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER]=false}}}}if(L!==""&&L-N[H-1].value<u.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS.Delete){var M=parseInt(N[H-1].value)+1;if(N[H-1].action===u.LIFECYCLE.SIA){K[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_SIA]=true;I[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=true;if(J===u.LIFECYCLE.CURRENT){v.expireGreaterThanSIAValue=M}else{v.permanentlyDeleteGreaterThanSIAValue=M}return}else{if(N[H-1].action===u.LIFECYCLE.GLACIER){K[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=true;I[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=true;if(J===u.LIFECYCLE.CURRENT){v.expireGreaterThanGlacierValue=M}else{v.permanentlyDeleteGreaterThanGlacierValue=M}return}}}else{K[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=false;I[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=false}}}v.validateDays=function(J,I){if(I===u.LIFECYCLE.CURRENT){var G=v.selectedRule.currentRuleActions[J].action;v.notANumberErrorCurrent.SIA=false;v.notANumberErrorCurrent.Glacier=false;v.highlightTextBoxErrorCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.SIA]=false;v.highlightTextBoxErrorCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER]=false;v.highlightTextBoxErrorCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=false;v.minimumDaysCurrent.SIA=false;v.minimumDaysCurrent.Glacier=false;v.higherNumberErrorCurrent.SIA=false;v.higherNumberErrorCurrent.Glacier=false;v.greaterThanCurrentError[u.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER_GREATER_THAN_SIA]=false;v.greaterThanCurrentError[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_SIA]=false;v.greaterThanCurrentError[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=false;if(v.selectedRule.currentRuleActions.length>0&&v.selectedRule.currentRuleActions[J].action!==""){if(isNaN(v.selectedRule.currentRuleActions[J].value)||v.selectedRule.currentRuleActions[J].value%1!==0||v.selectedRule.currentRuleActions[J].value.indexOf(u.LIFECYCLE.EXPONENTIAL)!==-1){v.notANumberErrorCurrent[G]=true;v.highlightTextBoxErrorCurrent[J]=true}else{if(v.selectedRule.currentRuleActions[J].value>u.LIFECYCLE.MAX_DAYS_ALLOWED){v.higherNumberErrorCurrent[G]=true;v.highlightTextBoxErrorCurrent[J]=true}else{if(v.selectedRule.currentRuleActions[J].value<u.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS[v.selectedRule.currentRuleActions[J].action]){v.minimumDaysCurrent[G]=true;v.highlightTextBoxErrorCurrent[J]=true}else{s(v.selectedRule.currentRuleActions,v.selectedRule.expiration.days,v.greaterThanCurrentError,v.highlightTextBoxErrorCurrent,v.minimumDaysCurrent,u.LIFECYCLE.CURRENT)}}}}v.updateNextButtonDisabled();return y(u.LIFECYCLE.CURRENT)}else{var H=v.selectedRule.noncurrentRuleActions[J].action;v.notANumberErrorNoncurrent.SIA=false;v.notANumberErrorNoncurrent.Glacier=false;v.highlightTextBoxErrorNonCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.SIA]=false;v.highlightTextBoxErrorNonCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER]=false;v.highlightTextBoxErrorNonCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=false;v.minimumDaysNoncurrent.SIA=false;v.minimumDaysNoncurrent.Glacier=false;v.higherNumberErrorNoncurrent.SIA=false;v.higherNumberErrorNoncurrent.Glacier=false;v.greaterThanNonCurrentError[u.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER_GREATER_THAN_SIA]=false;v.greaterThanNonCurrentError[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_SIA]=false;v.greaterThanNonCurrentError[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=false;if(v.selectedRule.noncurrentRuleActions.length>0&&v.selectedRule.noncurrentRuleActions[J].action!==""){if(isNaN(v.selectedRule.noncurrentRuleActions[J].value)||v.selectedRule.noncurrentRuleActions[J].value%1!==0||v.selectedRule.noncurrentRuleActions[J].value.indexOf(u.LIFECYCLE.EXPONENTIAL)!==-1){v.notANumberErrorNoncurrent[H]=true;v.highlightTextBoxErrorNonCurrent[J]=true}else{if(v.selectedRule.noncurrentRuleActions[J].value>u.LIFECYCLE.MAX_DAYS_ALLOWED){v.higherNumberErrorNoncurrent[H]=true;v.highlightTextBoxErrorNonCurrent[J]=true}else{if(v.selectedRule.noncurrentRuleActions[J].value<u.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS[v.selectedRule.noncurrentRuleActions[J].action]){v.minimumDaysNoncurrent[H]=true;v.highlightTextBoxErrorNonCurrent[J]=true}else{s(v.selectedRule.noncurrentRuleActions,v.selectedRule.permanentlyDelete.days,v.greaterThanNonCurrentError,v.highlightTextBoxErrorNonCurrent,v.minimumDaysNoncurrent,u.LIFECYCLE.NONCURRENT)}}}}v.updateNextButtonDisabled();return y(u.LIFECYCLE.NONCURRENT)}};v.validateCurrentExpiration=function(){v.notANumberErrorCurrent.Expire=false;v.minimumDaysCurrent.Expire=false;v.greaterThanCurrentError.DeleteGreaterThanSIA=false;v.greaterThanCurrentError.DeleteGreaterThanGlacier=false;v.higherNumberErrorCurrent.Expire=false;v.highlightTextBoxErrorCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=false;if(isNaN(v.selectedRule.expiration.days)||v.selectedRule.expiration.days%1!==0||v.selectedRule.expiration.days.indexOf(u.LIFECYCLE.EXPONENTIAL)!==-1){v.notANumberErrorCurrent.Expire=true;v.highlightTextBoxErrorCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=true}else{if(v.selectedRule.expiration.days>u.LIFECYCLE.MAX_DAYS_ALLOWED){v.higherNumberErrorCurrent.Expire=true;v.highlightTextBoxErrorCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=true}else{if(v.selectedRule.expiration.days<u.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS[u.LIFECYCLE.EXPIRE]){v.minimumDaysCurrent.Expire=true;v.highlightTextBoxErrorCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=true}else{s(v.selectedRule.currentRuleActions,v.selectedRule.expiration.days,v.greaterThanCurrentError,v.highlightTextBoxErrorCurrent,v.minimumDaysCurrent,u.LIFECYCLE.CURRENT)}}}v.updateNextButtonDisabled()};v.validateNoncurrentExpiration=function(){v.notANumberErrorNoncurrent.PermanentlyDelete=false;v.minimumDaysNoncurrent.PermanentlyDelete=false;v.greaterThanNonCurrentError.DeleteGreaterThanSIA=false;v.greaterThanNonCurrentError.DeleteGreaterThanGlacier=false;v.higherNumberErrorNoncurrent.PermanentlyDelete=false;v.highlightTextBoxErrorNonCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=false;if(isNaN(v.selectedRule.permanentlyDelete.days)||v.selectedRule.permanentlyDelete.days%1!==0||v.selectedRule.permanentlyDelete.days.indexOf(u.LIFECYCLE.EXPONENTIAL)!==-1){v.notANumberErrorNoncurrent.PermanentlyDelete=true;v.highlightTextBoxErrorNonCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=true}else{if(v.selectedRule.permanentlyDelete.days>u.LIFECYCLE.MAX_DAYS_ALLOWED){v.higherNumberErrorNoncurrent.PermanentlyDelete=true;v.highlightTextBoxErrorNonCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=true}else{if(v.selectedRule.permanentlyDelete.days<u.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS[u.LIFECYCLE.PERMANENTLY_DELETE]){v.minimumDaysNoncurrent.PermanentlyDelete=true;v.highlightTextBoxErrorNonCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=true}else{s(v.selectedRule.noncurrentRuleActions,v.selectedRule.permanentlyDelete.days,v.greaterThanNonCurrentError,v.highlightTextBoxErrorNonCurrent,v.minimumDaysNoncurrent,u.LIFECYCLE.NONCURRENT)}}}v.updateNextButtonDisabled()};function y(G){if(G==u.LIFECYCLE.CURRENT){return v.minimumDaysCurrent.SIA||v.minimumDaysCurrent.Glacier||v.minimumDaysCurrent.Expire||v.higherNumberErrorCurrent.Expire||v.greaterThanCurrentError.GlacierGreaterThanSIA||v.greaterThanCurrentError.DeleteGreaterThanSIA||v.greaterThanCurrentError.DeleteGreaterThanGlacier||_.indexOf(v.highlightTextBoxErrorCurrent,true)!==-1}else{return v.minimumDaysNoncurrent.SIA||v.minimumDaysNoncurrent.Glacier||v.minimumDaysNoncurrent.PermanentlyDelete||v.higherNumberErrorNoncurrent.PermanentlyDelete||v.greaterThanNonCurrentError.GlacierGreaterThanSIA||v.greaterThanNonCurrentError.DeleteGreaterThanSIA||v.greaterThanNonCurrentError.DeleteGreaterThanGlacier||_.indexOf(v.highlightTextBoxErrorNonCurrent,true)!==-1}}function h(){return _.some(v.selectedRule.currentRuleActions,function(G){return G.action===""||G.value===""})}function d(){return _.some(v.selectedRule.noncurrentRuleActions,function(G){return G.action===""||G.value===""})}function z(){return v.highlightTextBoxErrorCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.SIA]||v.highlightTextBoxErrorCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER]||v.highlightTextBoxErrorNonCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.SIA]||v.highlightTextBoxErrorNonCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.GLACIER]}function j(){return v.selectedRule.expiration.enabled&&v.selectedRule.expiration.days===""||v.selectedRule.permanentlyDelete.enabled&&v.selectedRule.permanentlyDelete.days===""||v.selectedRule.amu.enabled&&v.selectedRule.amu.days===""||v.highlightTextBoxErrorCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]||v.highlightTextBoxErrorNonCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]||v.amuError}function F(){if(v.state.name===v.STEP.TRANSITION.name){v.selectedRule.isNextButtonDisabled=h()||d()||z()}else{if(v.state.name===v.STEP.EXPIRATION.name){v.selectedRule.isNextButtonDisabled=j()||_.isEmpty(v.selectedRule.currentRuleActions)&&_.isEmpty(v.selectedRule.noncurrentRuleActions)&&!v.selectedRule.expiration.enabled&&!v.selectedRule.amu.enabled&&!v.selectedRule.permanentlyDelete.enabled&&!v.selectedRule.removeExpire}}}v.updateNextButtonDisabled=function(){v.selectedRule.isNextButtonDisabled=false;B(F,1)};function q(I,H){for(var G=0;G<I.length;G++){if(v.validateDays(G,H)){break}}}v.validateAmuDays=function(){if(isNaN(v.selectedRule.amu.days)){v.amuError=true;v.notANumberAmuError=true}else{if(v.selectedRule.amu.days<u.LIFECYCLE.LIFECYCLE_RULE_ACTION_MIN_DAYS.AMU){v.amuError=true;v.minimumDaysAmuError=true}else{if(v.selectedRule.amu.days>u.LIFECYCLE.MAX_DAYS_ALLOWED){v.amuError=true;v.higherNumberErrorAmu=true}else{v.notANumberAmuError=false;v.minimumDaysAmuError=false;v.higherNumberErrorAmu=false;v.amuError=false}}}v.updateNextButtonDisabled()};v.selectCurrentExpiration=function(){if(v.selectedRule.expiration.enabled){v.selectedRule.removeExpire=false;v.selectedRule.showRldm=false;if(v.selectedRule.expiration.days===""){A(v.selectedRule.expiration,v.selectedRule.currentRuleActions)}}else{v.selectedRule.expiration.days="";v.selectedRule.showRldm=true;v.notANumberErrorCurrent[u.LIFECYCLE.EXPIRE]=false;v.minimumDaysCurrent[u.LIFECYCLE.EXPIRE]=false;v.higherNumberErrorCurrent.Expire=false;v.greaterThanCurrentError[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_SIA]=false;v.greaterThanCurrentError[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=false;v.highlightTextBoxErrorCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=false}v.updateNextButtonDisabled()};v.selectNoncurrentExpiration=function(){if(!v.selectedRule.permanentlyDelete.enabled){v.selectedRule.permanentlyDelete.days="";v.notANumberErrorNoncurrent[u.LIFECYCLE.PERMANENTLY_DELETE]=false;v.minimumDaysNoncurrent[u.LIFECYCLE.PERMANENTLY_DELETE]=false;v.higherNumberErrorNoncurrent.PermanentlyDelete=false;v.greaterThanNonCurrentError[u.LIFECYCLE.DELETE_RULE_ACTION_GREATER_THAN_SIA]=false;v.greaterThanNonCurrentError[u.LIFECYCLE.DELETE_RULE_ACTION_GREATER_THAN_GLACIER]=false;v.highlightTextBoxErrorNonCurrent[u.LIFECYCLE.RULE_ACTION_ERRORS.DELETE_RULE_ACTION]=false}else{if(v.selectedRule.permanentlyDelete.days===""){A(v.selectedRule.permanentlyDelete,v.selectedRule.noncurrentRuleActions)}}v.updateNextButtonDisabled()};v.selectAmuAction=function(){if(!v.selectedRule.amu.enabled){v.selectedRule.amu.days="";v.notANumberAmuError=false;v.minimumDaysAmuError=false;v.higherNumberErrorAmu=false}else{if(_.isEmpty(v.selectedRule.amu.days)){v.selectedRule.amu.days=u.LIFECYCLE.AMU_DEFAULT_DAYS}}v.updateNextButtonDisabled()};function i(){v.showOldUI=!p.isFeatureEnabled("s3-ot")}k();i();v.goToPreviousStep=function(){v.lifecycleError=undefined;v.previousState();v.updateNextButtonDisabled()};v.closeLifecycleModal=function(){k();v.isOpen.flag=false;v.state=v.STEP.NAME_AND_SCOPE;v.selectedRule=undefined;v.lifecycleError=undefined;v.showContinue=false;v.showOverlappingPrefixWarning=false;v.showOverlappingNewFormatWarning=false;v.showV2FormatWarning=false;v.overlappingRule="";v.stateChangeWarning=undefined;v.currentGlacierGreaterThanSIAValue="";v.expireGreaterThanSIAValue="";v.expireGreaterThanGlacierValue="";v.noncurrentGlacierGreaterThanSIAValue="";v.permanentlyDeleteGreaterThanSIAValue="";v.permanentlyDeleteGreaterThanGlacierValue="";v.clearLDMAMUWarning=false}}})();"use strict";(function(){angular.module("s3").directive("lifecycleConfirmationModal",function(){return{restrict:"E",scope:{isOpen:"=",warningMessage:"=",initialResponse:"=",initialize:"=",initialXml:"=",selectedRule:"=",selectedRuleIndex:"=",actionType:"=",headerTitle:"=",listRules:"=",ruleToBeEdited:"=",disableEdit:"=",disableDelete:"=",moreOptions:"=",operation:"="},templateUrl:"/s3/partials/lifecycleconfirmationmodal.html",controller:"LifecycleConfirmationModalController"}});angular.module("s3").controller("LifecycleConfirmationModalController",["$scope","$filter","$translate","BucketPropertiesService","PathService","ConsoleOperation","S3Constants","SCLogService",function(k,h,b,d,i,g,e,j){k.closeConfirmationModal=function(){k.isOpen.flag=false;k.showContinue=false;k.stateChangeWarning=undefined;k.selectedRuleIndex=undefined;k.selectedRule=undefined;k.lifecycleError=undefined};function m(){k.lifecycleError=undefined;k.showContinue=false;k.stateChangeWarning=undefined;k.saveLifecycle()}function c(){k.showContinue=true;k.stateChangeWarning=b.instant("lifecyclemodal.step3.statechange")}k.detectStateChange=function(){k.operation.step=e.LIFECYCLE.GET_BUCKET_LIFECYCLE;d.getBucketLifecycle(i.getCurrentBucket(),k.operation).then(function(n){if(n===k.initialXml){m()}else{c()}})["catch"](function(n){if(n===e.LIFECYCLE.LIFECYCLE_DOES_NOT_EXIST_MESSAGE){if(k.initialXml===""){m()}else{c()}}else{k.lifecycleError=n}})};function a(){k.lifecycleError=undefined;k.ruleToBeEdited=undefined;k.disableEdit=true;k.disableDelete=true;k.moreOptions[0].disabled=true;k.moreOptions[1].disabled=true;k.initialize();k.closeConfirmationModal()}function l(n){for(var o=0;o<k.initialResponse.length;o++){if(o!==k.selectedRuleIndex&&!_.isEqual(k.initialResponse[o],n[o])){j.log(e.METRIC_NAME.LIFECYCLE_RULE_MISMATCH,1,k.operation,{initialRule:k.initialResponse[o],finalRule:n[o]});return true}}return false}function f(o){var n=k.initialResponse.length;for(var p=0,q=0;p<n;p++,q++){if(p==k.selectedRuleIndex){q++}if(q<n&&!_.isEqual(k.initialResponse[q],o[p])){j.log(e.METRIC_NAME.LIFECYCLE_RULE_MISMATCH,1,k.operation,{initialRule:k.initialResponse[q],finalRule:o[p]});return true}}return false}k.saveLifecycle=function(){var q=angular.copy(k.initialResponse);var v=angular.copy(k.selectedRule);var t=false;if(k.actionType===e.LIFECYCLE.CONFIRMATION_MODAL.ENABLE_POLICY){k.operation.step=e.LIFECYCLE.ENABLE_LIFECYCLE_POLICY;v.Status=e.LIFECYCLE.ENABLED;q[k.selectedRuleIndex]=v;t=l(q)}else{if(k.actionType===e.LIFECYCLE.CONFIRMATION_MODAL.DISABLE_POLICY){k.operation.step=e.LIFECYCLE.DISABLE_LIFECYCLE_POLICY;v.Status=e.LIFECYCLE.DISABLED;q[k.selectedRuleIndex]=v;t=l(q)}else{if(k.actionType===e.LIFECYCLE.CONFIRMATION_MODAL.DELETE_POLICY){k.operation.step=e.LIFECYCLE.DELETE_LIFECYCLE_POLICY;q.splice(k.selectedRuleIndex,1);t=f(q)}}}if(!t){j.log("LifecycleRuleVerification",1,k.operation,{initialResponse:k.initialResponse,finalResponse:q});var s=new X2JS({stripWhitespaces:false});var u="";var o=s.json2xml_str(k.initialResponse[k.selectedRule.indexVal]);var p=k.actionType===e.LIFECYCLE.CONFIRMATION_MODAL.DELETE_POLICY?"":s.json2xml_str(v);var r=k.initialXml;if(q.length>0){var n={};n.LifecycleConfiguration={};n.LifecycleConfiguration.Rule=q;delete q._xmlns;u=s.json2xml_str(n);d.putBucketLifecycle(i.getCurrentBucket(),r,u,o,p,k.operation).then(function(){a()})["catch"](function(w){k.lifecycleError=w})}else{d.deleteBucketLifecycle(i.getCurrentBucket(),r,u,o,p,k.operation).then(function(){k.listRules=[];k.initialResponse=[];k.ruleToBeEdited=undefined;k.lifecycleError=undefined;k.disableEdit=true;k.disableDelete=true;k.moreOptions[0].disabled=true;k.moreOptions[1].disabled=true;k.initialize();k.closeConfirmationModal()})["catch"](function(w){k.lifecycleError=w})}}else{j.log("LifecycleRuleVerification",0,k.operation,{initialResponse:k.initialResponse,finalResponse:q})}}}])})();"use strict";(function(){angular.module("s3").directive("scroll",["$timeout",function(c){var a=30;function b(e){if(Math.ceil($(window).scrollTop()+$(window).height())+a>=$(document).height()){$(e[0]).addClass("progressbarbottom")}else{$(e[0]).removeClass("progressbarbottom")}}return{restrict:"A",link:function d(g,f,e){g.$watch(function(){return e.totalOperation},function(i,h){if(i!==h){c(b(f),1)}},true);$(window).resize(function(){b(f)});$(window).scroll(function(){b(f)})}}}])})();"use strict";(function(){angular.module("s3").directive("bucketConfirmationModal",function(){return{restrict:"E",scope:{isOpen:"=",warningMessage:"=",headerTitle:"=",operation:"=",isDelete:"=?"},templateUrl:"/s3/partials/bucketconfirmationmodal.html",controller:"BucketConfirmationModalController"}});angular.module("s3").controller("BucketConfirmationModalController",["$scope","$filter","BucketPropertiesService","OperationDispatcherService","S3Constants",function(b,e,d,f,c){b.confirmationModal={bucketName:undefined};function a(){b.isDelete=false;b.showIncorrectBucketError=false;b.confirmationModal={bucketName:undefined};b.isOpen.flag=false}b.closeConfirmationModal=function(){a()};b.compareBucketNames=function(g){if(g&&g.keyCode===c.KEY_CODES.ENTER){b.showIncorrectBucketError=_.trim(b.confirmationModal.bucketName)!==b.operation.initialBucket?true:false}};b.saveOperation=function(){d.getBucketVersioning(b.operation.initialBucket,b.operation).then(function(g){b.operation.additionalInfo={numberOfKeysPerBulkOperation:c.BULK_OPERATION_KEYS_PER_REQUEST.S3_API,versioning:g};if(_.trim(b.confirmationModal.bucketName)===b.operation.initialBucket){f.addOperation(b.operation);a()}else{b.showIncorrectBucketError=true}})["catch"](function(g){b.errorMessage=g})}}])})();"use strict";(function(){angular.module("s3").directive("emptyState",[function(){return{restrict:"E",scope:{type:"=",openModal:"="},templateUrl:"/s3/partials/emptystate.html",controller:"EmptyStateController"}}]);angular.module("s3").controller("EmptyStateController",["$scope","AwsUrlsService","S3Constants",function(a,c,b){a.getLearnMoreLink=function(d){return c.getDocUrl(b.LEARN_MORE_LINKS[a.type][d])}}])})();"use strict";(function(){angular.module("s3").directive("updateObject",function(){return{restrict:"E",scope:{showOperation:"=",fetchObjects:"=",currentMarker:"@?",defaultValue:"@?",operation:"=",defaultPlaceholder:"@?",resetSelection:"="},templateUrl:"/s3/partials/updateobject.html",controller:"UpdateObjectController"}});angular.module("s3").controller("UpdateObjectController",["$filter","$scope","$translate","S3Constants","ConsoleOperation","APIProxyService","SCLogService","CopyService",function(k,m,b,h,j,d,l,c){m.updateObject={errorMessage:undefined,name:m.defaultValue||""};m.previousName=m.defaultValue;var g=m.operation.name;m.triggerAction=function(n){n.stopPropagation();switch(g){case"CreateFolder":i();break;case"Rename":f();break}};m.resetOperationState=function(n,o){m.fetchObjects(false,false);if(n){n.stopPropagation()}m.showOperation=false;switch(g){case"CreateFolder":a();break;case"Rename":e();m.resetSelection();break}m.operation=null};m.triggerKeyboardEvt=function(n){if(n&&n.keyCode===h.KEY_CODES.ENTER){m.triggerAction(n)}};function i(){var n=m.operation;var r="createFolder";var q=n.initialBucket;var o=n.initialPath;var p=_.get(m.updateObject,"name");if(p.indexOf(h.DELIMITER)!==-1){m.updateObject.errorMessage=b.instant("createfolder.input.errormessage.includesSlash")}else{if(p===""){a()}else{l.log("checkFolderExists",1,n);d.getObjectMetadata(n,q,""+o+p+"/").then(function(){m.updateObject.errorMessage=b.instant("createfolder.input.errormessage.exists",{name:p})})["catch"](function(s){if(s.status===h.HTTP_STATUS_CODES.NOT_FOUND){var t={};t[h.HEADERS.X_AMZ_SERVER_SIDE_ENCRYPTION]=h.OBJECT_SSE.AES256;t[h.HEADERS.CONTENT_TYPE]=h.DIRECTORY_CONTENT_TYPE;d.putObject(m.operation,q,o,p,t).then(function(){l.log(r,1,n,{name:p});m.resetOperationState()},function(u){l.log(r,0,n,u);m.updateObject.errorMessage=b.instant("createfolder.input.errormessage.generic",{name:p})})}else{l.log(r,0,n,s);m.updateObject.errorMessage=b.instant("createfolder.input.errormessage.generic",{name:p})}})}}}function a(){m.updateObject.name=m.defaultValue||"";m.updateObject.errorMessage=""}function f(){var n="renameObject";var o=m.operation,q=false,p=m.updateObject.name;if(p!==""){if(!o.selectedFolders||o.selectedFolders&&o.selectedFolders.length===0){if(p.indexOf(h.DELIMITER)!==-1){m.updateObject.errorMessage=b.instant("renameobject.input.errormessage.includesSlash")}else{c.startClipboardOperation(true,{name:p});o.defer.promise.then(function(){l.log(n,1,o,{name:p,isFolder:q});m.resetOperationState()},function(){l.log(n,0,o,{name:p,isFolder:q});m.updateObject.errorMessage=b.instant("renameobject.input.errormessage.generic",{name:p})})}}}}function e(){m.updateObject.errorMessage=""}}])})();"use strict";(function(){angular.module("s3").directive("storageManagement",[function(){return{restrict:"E",scope:{},templateUrl:"/s3/partials/storagemanagement.html",controller:"StorageManagementController"}}]);angular.module("s3").controller("StorageManagementController",["$scope","S3Constants",function(a,b){a.S3Constants=b;a.viewId=b.MANAGEMENT.VIEWS.LIFECYCLE;a.showView=function(c){a.viewId=c};a.viewEnabled=function(c){return a.viewId===c}}])})();"use strict";(function(){angular.module("s3").controller("StorageMetricsController",["$anchorScroll","$routeParams","$scope","$translate","S3Constants","StorageMonitoringService","UtilService",function(i,g,n,o,m,b,t){n.deepLinks=[];var a=60;var l=60*a;var h={MINUTE:a,QUARTER_HOUR:15*a,HALF_HOUR:30*a,HOUR:60*a,QUARTER_DAY:6*l,HALF_DAY:12*l,DAY:24*l};var s=l*1000;var k=g[m.PATH_SEGMENTS.BUCKET_NAME];var e={H1:s,H3:3*s,H12:12*s,H24:24*s,D3:3*24*s,W1:7*24*s,W2:7*2*24*s};var p={H1:o.instant("management.metrics.period.minute.one"),H3:o.instant("management.metrics.period.hour.quarter"),H12:o.instant("management.metrics.period.hour.half"),H24:o.instant("management.metrics.period.hour.one"),D3:o.instant("management.metrics.period.day.quarter"),W1:o.instant("management.metrics.period.day.half"),W2:o.instant("management.metrics.period.day.one"),Count:o.instant("management.metrics.unit.count"),Bytes:o.instant("management.metrics.unit.bytes"),Milliseconds:o.instant("management.metrics.unit.milliseconds")};var r={H1:h.MINUTE,H3:h.QUARTER_HOUR,H12:h.HALF_HOUR,H24:h.HOUR,D3:h.QUARTER_DAY,W1:h.HALF_DAY,W2:h.DAY};var j={H1:"1H",H3:"3H",H12:"12H",H24:"1D",D3:"3D",W1:"7D",W2:"14D"};n.statistic=n.statistic?n.statistic:"Average";n.timestamp=n.timestamp?n.timestamp:"Timestamp";function d(u){var v="";angular.forEach(u,function(y){var w=y.Name;var x=y.Value;v+="~'"+w+"~'"+x});return v}function c(u){var v="";angular.forEach(u,function(x,w){v+=x.Name;if(w!==u.length-1){v+=","}});return v}function q(w,A,v){var y="/cloudwatch/home?region=<region>#metricsV2:graph=~(view~'timeSeries~stacked~false~start~'-P<start>~end~'P0D~region~'<region>~metrics~(~(~'AWS*2fS3~'<metric-name>";var z="~(period~<period>~stat~'<statistic>))));namespace=<namespace>;dimensions=";z+=c(w.Dimensions);var u=y+d(w.Dimensions)+z;var x=u.replace(new RegExp("<region>","g"),w.region);x=x.replace("<metric-name>",w.MetricName).replace("<namespace>",w.Namespace).replace("<period>",A).replace("<start>",j[v]).replace("<statistic>",w.statistic);return x}n.getAllMetricData=function(u){var v=e[u];var w=r[u];n.deepLinks=[];angular.forEach(n.metricList,function(x){n.deepLinks.push(q(x,w,u));b.requestMetricStatistics(x,v,x.statistic,w).then(function(y){x.error="";x.chartId=x.MetricName;x.heading=x.MetricName;x.chartId="s3_"+x.chartId;if(x.statistics&&x.statistics.Datapoints&&x.statistics.Datapoints.length>0){x.heading+=" ("+f(x,u)+")"}angular.forEach(x.Dimensions,function(z){x.chartId+="_"+z.Value})})["catch"](function(y){x.error=o.instant("management.metrics.data.error",{name:x.MetricName,message:t.handleErrors(y)})})})};function f(w,x){var u=w.statistics.Datapoints[0];var v="";switch(u.Unit){case m.METRICS.UNIT.COUNT:case m.METRICS.UNIT.BYTES:v+=p[u.Unit]+" / "+p[x];break;case m.METRICS.UNIT.MILLIS:v+=p[m.METRICS.UNIT.MILLIS];break;default:v+=u.Unit.toLowerCase()}return v}n.getChartLabels=function(u){var v=[];angular.forEach(u.Dimensions,function(w){if(w.Name!=="BucketName"){v.push(w.Value)}});return v};n.$watch("zoom",function(v,u){if(v!==u){n.getAllMetricData(v)}});n.$watch("metricList",function(v,u){if(v!==u){n.getAllMetricData(n.zoom)}});n.getAllMetricData(n.zoom)}]);angular.module("s3").directive("metricsMonitoring",[function(){return{scope:{metricList:"=",zoom:"=",statistic:"=?",timestamp:"=?"},templateUrl:"/s3/partials/storagemetrics.html",controller:"StorageMetricsController"}}])}).call(undefined);"use strict";(function(){angular.module("s3").service("StorageMonitoringService",["$q","$routeParams","CloudWatchService","BucketPropertiesService","S3Constants","SCLogService",function(a,f,e,d,b,c){this.requestMetricsList=function(h){var i=f[b.PATH_SEGMENTS.BUCKET_NAME];var g=[];return d.getBucketLocation(i).then(function(j){angular.forEach(h,function(m,l){var n={Namespace:"AWS/S3","Dimensions.member.1.Name":"BucketName","Dimensions.member.1.Value":i,"Dimensions.member.2.Name":m.Name};if(m.Value){n["Dimensions.member.2.Value"]=m.Value}var k=e.listMetrics({region:j,params:n});k.then(function(o){var p=o.response.ListMetricsResponse.ListMetricsResult.Metrics;angular.forEach(p,function(q){q.region=j});c.log("ListMetrics",1);return p})["catch"](function(o){c.log("ListMetrics",0,{err:o});return a.reject(o)});g.push(k)});return a.all(g).then(function(k){var l=[];angular.forEach(k,function(m){var n=m.response.ListMetricsResponse.ListMetricsResult.Metrics;l=l.concat(n)});return l})["catch"](function(k){return a.reject(k)})})};this.requestMetricStatistics=function(j,g,i,l){var h=new Date();var k=new Date(h-g);return e.getMetricStatistics({region:j.region,params:{MetricName:j.MetricName,Namespace:j.Namespace,StartTime:k.toISOString(),EndTime:h.toISOString(),Period:l,"Statistics.member.1":i,"Dimensions.member.1.Name":j.Dimensions[0].Name,"Dimensions.member.1.Value":j.Dimensions[0].Value,"Dimensions.member.2.Name":j.Dimensions[1]?j.Dimensions[1].Name:undefined,"Dimensions.member.2.Value":j.Dimensions[1]?j.Dimensions[1].Value:undefined}}).then(function(m){j.statistics=m.response.GetMetricStatisticsResponse.GetMetricStatisticsResult;j.period=l;j.endTime=h.getTime();j.startTime=k.getTime();c.log("GetMetricStatistics",1);return j})["catch"](function(m){c.log("GetMetricStatistics",0,m);return a.reject(m)})}}])})();"use strict";(function(){angular.module("s3").directive("cloudwatchMetrics",[function(){return{restrict:"E",scope:{},templateUrl:"/s3/partials/cloudwatch.html",controller:"CloudwatchMetricsController"}}]);angular.module("s3").controller("CloudwatchMetricsController",["$anchorScroll","$route","$routeParams","$scope","$translate","APIProxyService","AwsUrlsService","ConsoleOperation","PathService","S3Constants","SCLogService","StorageMonitoringService","UtilService","XMLParser",function(m,s,k,v,x,y,b,t,e,u,d,g,D,E){var j="Prefix",f="Tag";var z=u.MANAGEMENT.ACTION;var B="EntireBucket";var A=new t(u.OPERATION_NAME.METRICS_GET_CONFIG);v.bucketName=k[u.PATH_SEGMENTS.BUCKET_NAME];v.metricsLoading=true;v.metrics={};v.timestamp="Timestamp";v.xScaleBy=1000;v.selectedTimeFrame="W2";v.selectedMetricGroup="";v.selectedMetricType=u.METRICS.TYPE.STORAGE;v.selectedMetricLink="";v.S3Constants=u;v.error="";m.yOffset=100;v.bucketRegion=e.getCurrentBucket();v.validFilter=false;v.filterList=[];v.bucketFilterList=[];v.models={filterName:null,filterValue:null,filterError:null,savingFilter:false,applyingConfig:false,showAddFilter:false,editFilter:false,configLoading:true,toggleMetricsConfig:false,searchText:"",bucketChecked:true,allFilters:false,updatedOn:null,addInfoMessage:false,deleteFilter:false};v.filters={input:"",prefixFilters:[],tagFilters:[]};v.metricTypes={storage:{id:u.METRICS.TYPE.STORAGE,group:x.instant("management.metric.type.storage"),title:x.instant("management.metric.type.title.storage"),disable:true,checked:true,state:true,info:x.instant("management.metrics.cost.free"),dimension:"StorageType",metrics:[{name:"BucketSizeBytes",display:x.instant("management.metric.type.display.storage.size"),selected:true,statistic:"Average"},{name:"NumberOfObjects",display:x.instant("management.metric.type.display.storage.count"),selected:true,statistic:"Average"}]},requests:{id:u.METRICS.TYPE.REQUESTS,group:x.instant("management.metric.type.requests"),title:x.instant("management.metric.type.title.requests"),disable:false,checked:false,state:false,info:x.instant("management.metrics.cost.paid"),dimension:"FilterId",metrics:[{name:"GetRequests",display:"GET",selected:true,statistic:"Sum"},{name:"PutRequests",display:"PUT",selected:true,statistic:"Sum"},{name:"ListRequests",display:"LIST",selected:true,statistic:"Sum"},{name:"AllRequests",display:"ALL",selected:true,statistic:"Sum"},{name:"PostRequests",display:"POST",selected:true,statistic:"Sum"},{name:"DeleteRequests",display:"DELETE",selected:true,statistic:"Sum"},{name:"HeadRequests",display:"HEAD",selected:true,statistic:"Sum"},{name:"4xxErrors",display:x.instant("management.metric.type.display.requests.errors4xx"),selected:true,statistic:"Sum"},{name:"5xxErrors",display:x.instant("management.metric.type.display.requests.errors5xx"),selected:true,statistic:"Sum"}]},data:{id:u.METRICS.TYPE.DATA,group:x.instant("management.metric.type.data"),title:x.instant("management.metric.type.title.data"),disable:false,checked:false,state:false,info:x.instant("management.metrics.cost.paid"),dimension:"FilterId",metrics:[{name:"TotalRequestLatency",display:x.instant("management.metric.type.display.data.total"),selected:true,statistic:"Average"},{name:"FirstByteLatency",display:x.instant("management.metric.type.display.data.first"),selected:true,statistic:"Average"},{name:"BytesDownloaded",display:x.instant("management.metric.type.display.data.uploaded"),selected:true,statistic:"Sum"},{name:"BytesUploaded",display:x.instant("management.metric.type.display.data.downloaded"),selected:true,statistic:"Sum"}]}};v.checkAllPaidMetrics=function(H){angular.forEach(v.metricTypes,function(I){if(H.id!==u.METRICS.TYPE.STORAGE&&I.id!==u.METRICS.TYPE.STORAGE&&H.id!==I.id){I.checked=H.checked}})};v.viewAllFilters=function(){angular.forEach(v.filterList,function(H){H.checked=v.models.allFilters});v.getCloudwatchMetrics()};v.filterKeyDown=function(H){if(H&&H.keyCode===u.KEY_CODES.ESC){$(".input-field").blur();v.models.searchText=""}};function l(){var H={prefixes:[],tags:[]};angular.forEach(v.filters.prefixFilters,function(I){H.prefixes.push({Prefix:I})});angular.forEach(v.filters.tagFilters,function(I){H.tags.push({Tag:{Key:I.tagKey,Value:I.tagVal}})});return H}v.getGroupTitle=function(H){return v.metricTypes[H].group};v.getLearnMoreLink=function(H){return b.getDocUrl(u.LEARN_MORE_LINKS["storage-management"][H])};function C(I){var H=I.Filter;if(H){if(!H.And){if(H.Prefix){v.filters.prefixFilters.push(H.Prefix)}else{if(H.Tag){v.filters.tagFilters.push({tagKey:H.Tag.Key,tagVal:H.Tag.Value})}}}else{angular.forEach(H.And,function(K,J){if(J===j){v.filters.prefixFilters.push(K)}if(J===f){K=[].concat(K);angular.forEach(K,function(L){v.filters.tagFilters.push({tagKey:L.Key,tagVal:L.Value})})}})}}}v.configureMetrics=function(){if(v.models.toggleMetricsConfig){v.cancelMetricsConfig()}else{v.models.toggleMetricsConfig=!v.models.toggleMetricsConfig}};v.addFilter=function(H){if(!v.models.showAddFilter){v.models.filterNameError="";v.models.filterValueError="";if(H){v.models.filterName=H.Id;v.models.editFilter=true;C(H)}else{v.models.filterName="";v.models.filterValue=""}v.models.showAddFilter=true}};v.validateFilter=function(J){var I=true;if(!J){J=l()}v.models.filterNameError="";v.models.filterValueError="";if(!v.models.filterName){return false}else{v.models.filterName=v.models.filterName.trim()}if(!u.MANAGEMENT.FILTER_NAME_REGEX.test(v.models.filterName)){v.models.filterNameError=x.instant("management.config.filtername.error.format");I=false}if(v.filters.input){v.models.filterValueError=x.instant("management.config.filtervalue.error.format",{text:v.filters.input});I=false}if(!v.models.editFilter){var H=_.filter(v.filterList,function(K){return K.Id===v.models.filterName});if(H.length>0){v.models.filterNameError=x.instant("management.metrics.side.filter.error.dup");I=false}}return I};v.cancelFilter=function(){v.models.showAddFilter=false;v.models.editFilter=false;v.models.filterError=false;h()};v.refresh=function(){v.getCloudwatchMetrics()};v.goToChart=function(H){v.selectedMetricLink=H;m(H)};v.setMetricGroup=function(H){v.selectedMetricGroup=H};v.setTimeRange=function(H){v.selectedTimeFrame=H};v.setSelectedMetricType=function(H){v.selectedMetricType=H;v.getCloudwatchMetrics()};v.filterChanged=function(H){if(!H.checked){v.models.allFilters=false}v.getCloudwatchMetrics()};function G(){var H=v.metricTypes[v.selectedMetricType].dimension;var I=[];if(v.selectedMetricType===u.METRICS.TYPE.STORAGE){I.push({Name:H,Value:null})}else{if(v.models.bucketChecked){angular.forEach(v.bucketFilterList,function(J){I.push({Name:H,Value:J.Id})})}angular.forEach(v.filterList,function(J){if(J.checked){I.push({Name:H,Value:J.Id})}})}return I}v.getCloudwatchMetrics=function(){var H=G();v.info="";v.error="";if(H.length>0){g.requestMetricsList(H).then(function(I){v.metrics[v.selectedMetricType]=c(I);if(I.length===0){v.info=x.instant("management.metrics.notavailable",{type:v.metricTypes[v.selectedMetricType].group})}else{v.info="";v.error=""}})["catch"](function(I){v.error=x.instant("management.metrics.error",{message:D.handleErrors(I)})})["finally"](function(){v.metricsLoading=false;v.models.updatedOn=x.instant("management.metrics.updatedon",{time:new Date().toLocaleString()})})}else{if(v.models.bucketChecked&&!v.metricTypes.requests.state){v.info=x.instant("management.metrics.not.enabled")}else{v.info=x.instant("management.metrics.not.selected")}v.metrics[v.selectedMetricType]=c([]);v.metricsLoading=false;v.models.updatedOn=x.instant("management.metrics.updatedon",{time:new Date().toLocaleString()})}};function c(I){var J=[];var K=v.metricTypes[v.selectedMetricType];var H=_.groupBy(I,function(L){return L.MetricName});v.metricsWithStats=[];angular.forEach(K.metrics,function(L){if(H[L.name]){J=J.concat(H[L.name]);v.metricsWithStats.push({display:L.display,ref:H[L.name][0]});angular.forEach(H[L.name],function(M){M.statistic=L.statistic})}});return J}function o(H){v.models[H]=true;h();v.bucketFilterList=[];v.filterList=[];F(H)}function F(H){var I=arguments.length<=1||arguments[1]===undefined?null:arguments[1];var J={};if(I){angular.extend(J,{params:{"continuation-token":I}})}y.getBucketProperty(A,v.bucketName,"metrics",J,false).then(function(P){var K=P.response;d.log("getBucketMetrics",1,A);var O=E.convertXmlStringToJson(K);var L=O.ListMetricsConfigurationsResult;var N=L.MetricsConfiguration;var M=[];if(N){M=D.transformObjectToArray(N)}v.bucketFilterList=v.bucketFilterList.concat(_.filter(M,function(Q){return Q.Id===B}));v.filterList=v.filterList.concat(_.filter(M,function(Q){if(Q.Id!==B||Q.Id===B&&Q.Filter){Q.checked=v.models.allFilters;return true}return false}));if(L.IsTruncated==="true"){F(H,L.NextContinuationToken)}else{n();v.getCloudwatchMetrics();w(H)}})["catch"](function(K){d.log("getBucketMetrics",0,A);w(H);p(H,K)})}function n(){v.models.editFilter=false;v.metricTypes.requests.checked=v.bucketFilterList.length>0;v.metricTypes.requests.state=v.metricTypes.requests.checked;v.metricTypes.data.checked=v.metricTypes.requests.checked;v.metricTypes.data.state=v.metricTypes.data.checked}function h(){v.models.filterName="";v.filters.input="";v.filters.tagFilters=[];v.filters.prefixFilters=[]}function w(H){v.models[H]=false;if(H===z.SAVING_FILTER||H==z.DELETE_FILTER){v.models.showAddFilter=false;v.models.filterError=""}if(H===z.APPLYING_CONFIG){v.models.toggleMetricsConfig=false}v.filters.input="";v.filters.tagFilters=[];v.filters.prefixFilters=[]}v.deleteFilter=function(){if(!v.models.deleteFilter||!v.models.savingFilter){var H={params:{id:v.models.filterName}};i(H,z.DELETE_FILTER)}};v.applyMetricsConfig=function(){if(v.metricTypes.requests.checked){var J={params:{id:B}};var I={},H=undefined;I.MetricsConfiguration={};I.MetricsConfiguration.Id=B;H=E.jsonToXml(I);r(H,J,z.APPLYING_CONFIG)}else{angular.forEach(v.bucketFilterList,function(K){var L={params:{id:K.Id}};i(L,z.APPLYING_CONFIG)})}};v.cancelMetricsConfig=function(){v.metricTypes.requests.checked=v.metricTypes.requests.state;v.metricTypes.data.checked=v.metricTypes.requests.state;v.models.toggleMetricsConfig=false};v.saveFilter=function(){if(!v.models.savingFilter&&!v.models.deleteFilter){var H=l();v.models.filterError="";if(v.validateFilter(H)){(function(){var K={params:{id:v.models.filterName}};var J={},I=undefined;J.MetricsConfiguration={};J.MetricsConfiguration.Id=v.models.filterName;if(H.tags.length+H.prefixes.length){J.MetricsConfiguration.Filter={};if(H.tags.length>1||H.tags.length+H.prefixes.length>1){J.MetricsConfiguration.Filter.And={};if(H.tags.length>0){J.MetricsConfiguration.Filter.And.Tag=[];angular.forEach(H.tags,function(M){var L=M.Tag;return J.MetricsConfiguration.Filter.And.Tag.push(L)})}if(H.prefixes.length>0){J.MetricsConfiguration.Filter.And.Prefix=[];angular.forEach(H.prefixes,function(M){var L=M.Prefix;return J.MetricsConfiguration.Filter.And.Prefix.push(L)})}}else{if(H.prefixes.length>0){J.MetricsConfiguration.Filter=H.prefixes[0]}if(H.tags.length>0){J.MetricsConfiguration.Filter.Tag=H.tags[0].Tag}}}I=E.jsonToXml(J);r(I,K,z.SAVING_FILTER)})()}}};function r(K,J,H){var I=new t(u.OPERATION_NAME.METRICS_PUT_CONFIG);v.models[H]=true;K=q(K);if(H===z.SAVING_FILTER){v.filterError=""}y.putBucketProperty(I,v.bucketName,"metrics",K,J).then(function(M){var L=M.response;d.log("putBucketMetrics",1,I);o(H);v.models.addInfoMessage=true})["catch"](function(L){d.log("putBucketMetrics",0,I);p(H,L);v.models[H]=false})}function i(J,H){var I=new t(u.OPERATION_NAME.METRICS_DELETE_CONFIG);if(H===z.SAVING_FILTER||H===z.DELETE_FILTER){v.models.filterError=""}v.models[H]=true;y.deleteBucketProperty(I,v.bucketName,"metrics",J).then(function(L){var K=L.response;d.log("deleteBucketMetrics",1,I);o(H)})["catch"](function(K){d.log("deleteBucketMetrics",0,I);p(H,K);v.models[H]=false})}function p(H,I){if(H===z.SAVING_FILTER){v.models.filterError=D.handleErrors(I)}else{v.error=D.handleErrors(I)}}function q(H){return H.replace("<MetricsConfiguration>",'<MetricsConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">')}function a(){o(z.CONFIG_LOADING)}a()}])})();"use strict";(function(){angular.module("s3").directive("bucketReports",[function(){return{restrict:"E",scope:{},templateUrl:"/s3/partials/bucketreports.html",controller:"ReportsController"}}]);angular.module("s3").controller("ReportsController",["$filter","$q","$scope","$timeout","$translate","APIProxyService","AwsUrlsService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","FAC","PathService","Region","S3Constants","SCLogService","UtilService","XMLParser",function(B,a,i,w,p,E,t,A,x,c,L,y,l,K,e,m,C){var I,G;var h=K.BUCKET_PROPERTIES;var q=K.BUCKET_PERMISSIONS;var F=K.ENTRY_STATE;var v=K.LEARN_MORE_LINKS;i.finishedLoading=false;i.selectingBucket={selected:false};i.exampleEmptyReport=g();i.flags={displayDelayWarning:false};var z="-";function d(){G=y.getCurrentBucket();I=new c("GetBuckets");i.showAdvancedSettingsDropdown=true;i.rowBeingEdited=null;i.headerTitle=p.instant("report.label.new");i.isAdding=false;i.isSaving=false;i.radioValue={value:0};i.selectedRowIndex=-1;i.selectedRow=null;i.showError=false;i.isEditingRow=false;i.regions=l.regionMapping;i.reportsTable=[];if(!i.bucketList){i.bucketList=[]}i.configPattern=new RegExp("^[a-zA-Z0-9-_.]+$");i.freqTypes=[{value:h.REPORTS.FREQUENCY.DAILY,text:p.instant("report.freq.daily")},{value:h.REPORTS.FREQUENCY.WEEKLY,text:p.instant("report.freq.weekly")}];i.versionTypes=[{value:h.REPORTS.VERSIONING.ALL,text:p.instant("report.versions.all")},{value:h.REPORTS.VERSIONING.CURRENT,text:p.instant("report.versions.current")}];k()}i.getLearnMoreLink=function(N){return t.getDocUrl(v["storage-management"][N])};i.toggleAdvancedSettingsDropdown=function(){i.showAdvancedSettingsDropdown=!i.showAdvancedSettingsDropdown};function g(){return{name:"",type:h.REPORTS.TYPE.OBJECT,filter:"",bucket:"",prefix:"",freq:h.REPORTS.FREQUENCY.DAILY,versioning:h.REPORTS.VERSIONING.CURRENT,status:h.REPLICATION.DISABLED,isEditing:true,state:F.CREATE,optional:M(),accountId:null,bucketError:false,nameError:false}}function u(P){var O=g();O.name=P.Id;O.freq=P.Schedule.Frequency.toUpperCase();O.bucket=x.stripBucketARN(P.Destination.S3BucketDestination.Bucket);if(P.Filter){O.filter=P.Filter.Prefix}if(P.Destination.S3BucketDestination.Prefix){O.prefix=P.Destination.S3BucketDestination.Prefix}if(P.Destination.S3BucketDestination.AccountId){O.accountId=P.Destination.S3BucketDestination.AccountId}O.isEditing=false;if(P.OptionalFields&&P.OptionalFields.Field){var N=[].concat(P.OptionalFields.Field);N.forEach(function(Q){O.optional[Q]=true})}if(P.IncludedObjectVersions===h.REPORTS.VERSIONING.CURRENT){O.versioning=P.IncludedObjectVersions}else{O.versioning=h.REPORTS.VERSIONING.ALL}return O}function J(P){var N=P.InventoryConfiguration;if(N){var O=[].concat(N);O.forEach(function(Q){i.reportsTable.push(u(Q))})}}function k(O){var N=new c("getObjectInventory");e.log("getObjectInventoryReceived",1,N);var P={path:G};if(O){P.params={"continuation-token":O}}E.getObjectInventory(N,G,P).then(function(S){var R=S.response;e.logRequestComplete("getObjectInventory",N);if(R){var U=C.convertXmlStringToJson(R);J(U.ListInventoryConfigurationsResult);var Q=U.ListInventoryConfigurationsResult.IsTruncated==="true";if(Q){var T=U.ListInventoryConfigurationsResult.NextContinuationToken;k(T)}else{if(i.reportsTable.length>0){i.radioValue.value=0;i.selectedRowIndex=0}i.finishedLoading=true}}})["catch"](function(Q){if(Q){r(Q)}})["finally"](function(){i.finishedLoading=true})}i.validatePrefix=function(){var O=i.rowBeingEdited;var N=O.bucket;i.filterInfo="";i.prefixInfo="";if(O.filter&&O.filter.indexOf(K.DELIMITER)===0){i.filterInfo=O.filter;i.bucketName=G}if(O.prefix&&O.prefix.indexOf(K.DELIMITER)===0){i.prefixInfo=O.prefix;i.bucketNamePre=O.bucket}};i.validateName=function(O){var N=_.countBy(i.reportsTable,function(P){return P.name===O.name?"dups":"unique"});O.invalidNameMessage="";if(N.dups>1){O.invalidNameMessage=p.instant("report.name.error.duplicate")}else{if(O.name.length<1||O.name.length>64){O.invalidNameMessage=p.instant("report.name.error.length")}else{if(!i.configPattern.test(O.name)){O.invalidNameMessage=p.instant("report.name.error.characters")}}}if(O.invalidNameMessage){O.nameError=true}else{O.nameError=false}};i.validateForm=function(N){i.validateName(N);if(N.bucket){N.bucketError=false}else{N.bucketError=true}N.hasErrors=N.nameError||N.bucketError;return !N.hasErrors};i.selectRow=function(N){if(i.isEditingRow){i.radioValue.value=i.selectedRowIndex}else{if(i.completeEdit()){i.selectedRowIndex=N;i.radioValue.value=N}}i.flags.displayDelayWarning=false};i.closeAddReport=function(N){s();if(N){if(i.rowBeingEdited.state===F.CREATE){i.rowBeingEdited.state=F.ADDED}}i.isExpanded=false;i.rowBeingEdited=null};i.deletePressed=function(){if(i.radioValue.value.length==0){return}var O=i.reportsTable[i.selectedRowIndex];var N=_.findIndex(i.reportsTable,function(P){return P.name===O.name});if(N!==-1&&j(i.reportsTable[N])){i.reportsTable.splice(N,1);i.radioValue.value="";i.selectedRowIndex=-1}i.flags.displayDelayWarning=false};i.cancelPressed=function(N){N.stopPropagation();o(i.reportsTable[i.selectedRowIndex]);if(i.isAdding){i.selectedRowIndex--;i.isAdding=false;i.reportsTable.shift()}else{i.reportsTable[i.selectedRowIndex]=i.tempRow;i.tempRow=null}i.radioValue.value=i.selectedRowIndex;i.completeEdit(false);i.isEditingRow=false;i.rowBeingEdited.isEditing=false;i.showAdvancedSettingsDropdown=false;i.closeAddReport(false);i.radioValue.value=i.selectedRowIndex};i.successAddHandler=function(){if(i.isAdding){i.selectedRowIndex=0;i.radioValue.value=i.selectedRowIndex;i.isAdding=false}};i.successSaveHandler=function(){i.isEditingRow=false;i.showAdvancedSettingsDropdown=false};i.savePressed=function(N){N.stopPropagation();i.isSaving=true;var P=null;if(i.isAdding){P=i.reportsTable[0]}else{P=i.reportsTable[i.selectedRowIndex]}i.validateForm(P);if(P.hasErrors||P.bucketUnknown){i.isSaving=false;return}var O=false;if(i.isAdding){O=true}i.saveReport(P,O);i.radioValue.value=i.selectedRowIndex};function j(N){var O=new c("deleteObjectInventoryConfig");E.deleteObjectInventoryConfig(O,G,{path:G,params:{id:N.name}}).then(function(P){e.logRequestComplete("deleteObjectInventoryConfig",O);i.isEditingRow=false;i.showAdvancedSettingsDropdown=false})["catch"](function(P){r(P);e.log("deleteObjectInventoryConfig",0,O,{objectName:N,error:P});return false});return true}function n(N){if(N.length===0){return}else{if(N.length===1){return N.charAt(0).toUpperCase()}else{return N.charAt(0).toUpperCase()+N.substr(1).toLowerCase()}}}function b(O){var N={};N.Format=h.REPORTS.FORMAT.CSV;if(O.accountId){N.AccountId=O.accountId}N.Bucket=m.getBucketARN(O.bucket);if(O.prefix.length>0){N.Prefix=O.prefix}return{S3BucketDestination:N}}function f(O){var N=O.optional;var P=[];if(N.Size){P.push("Size")}if(N.LastModifiedDate){P.push("LastModifiedDate")}if(N.StorageClass){P.push("StorageClass")}if(N.ETag){P.push("ETag")}if(N.ReplicationStatus){P.push("ReplicationStatus")}return P}function D(O){var N={};N.Id=O.name;N.IsEnabled="true";if(O.filter.length>0){N.Filter={Prefix:O.filter}}N.Destination=b(O);N.Schedule={Frequency:n(O.freq)};N.IncludedObjectVersions=O.versioning;N.OptionalFields={Field:f(O)};return N}function H(N){return'<?xml version="1.0" encoding="UTF-8"?><InventoryConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">'+N+"</InventoryConfiguration>"}i.saveReport=function(N,Q){var O=new c("putObjectInventoryConfig");var R=D(N);var P=H(C.jsonToXml(R));e.log("putObjectInventoryConfigReceived",1,O);E.putObjectInventoryConfig(O,G,{path:G,params:{id:N.name},content:P}).then(function(S){e.logRequestComplete("putObjectInventoryConfig",O);i.isSaving=false;i.rowBeingEdited.isEditing=false;if(!Q&&N.name!==i.tempRow.name){j(i.tempRow)}else{i.successAddHandler();i.closeAddReport(true);i.successSaveHandler()}i.flags.displayDelayWarning=true;return true})["catch"](function(S){e.log("putObjectInventoryConfig",0,O,{objectName:N,error:S});r(S);return false});return true};function r(N){i.showError=true;i.errorMessage=m.handleErrors(N);i.isSaving=false}function s(){i.showError=false}i.completeEdit=function(N){var O=i.rowBeingEdited;if(!O){return true}else{o(O);if(O.name!==""&&!O.invalidNameMessage&&O.bucket!==""){return true}else{if(O.state===F.CREATE&&O.name===""&&O.bucket===""&&O.filter===""&&O.prefix===""){return true}else{if(N&&O.state===F.CREATE){return false}if(O.name===""){O.nameError=true}if(O.bucket===""){O.bucketError=true}return false}}}};function o(N){if(N){N.nameError=false;N.bucketError=false}}function M(){return{Size:null,LastModifiedDate:null,StorageClass:null,ETag:null,ReplicationStatus:null}}i.addRow=function(O){O.stopPropagation();if(i.completeEdit()){i.isAdding=true;i.isExpanded=true;var N=g();i.reportsTable.unshift(N);i.rowBeingEdited=N;i.selectedRowIndex++;i.radioValue.value=0;i.isEditingRow=true;i.showAdvancedSettingsDropdown=true;i.prefixInfo="";i.filterInfo=""}i.flags.displayDelayWarning=false};i.editRow=function(O){O.stopPropagation();i.showAdvancedSettingsDropdown=true;var N=i.selectedRowIndex;var P=i.reportsTable[N];if(P){i.tempRow=JSON.parse(JSON.stringify(P))}if(i.completeEdit()){P.isEditing=true;i.rowBeingEdited=i.reportsTable[i.selectedRowIndex];i.isEditingRow=true}i.flags.displayDelayWarning=false;i.radioValue.value=false};i.getPrefixValue=function(N){if(N.length===0){return z}else{return N}};i.getTranslationValue=function(N){switch(N){case h.REPORTS.TYPE.OBJECT:return p.instant("report.type.object");case h.REPORTS.FREQUENCY.DAILY:return p.instant("report.freq.daily");case h.REPORTS.FREQUENCY.WEEKLY:return p.instant("report.freq.weekly")}};i.getFilterValue=function(N){return N||p.instant("report.filter.bucket")};i.resetDelayWarning=function(){i.flags.displayDelayWarning=false};d()}])})();"use strict";(function(){angular.module("s3").service("AnalyticsDataProcessor",["$q","APIProxyService","BucketPropertiesService","ConsoleOperation","S3Constants","SCLogService","UtilService",function(x,t,h,p,r,a,y){var j=new p(r.OPERATION_NAME.ANALYTICS_GET_DATA);var u="<account-id>/<bucket-name>/<config-id>/data.csv";var q="s3-analytics-export-shared-<region>-prod";var l=0;var c=3;var v=4;var o=5;var m=6;var i=7;var g=8;var z=9;var d=10;var s=11;var b=12;var k=",";var f="ALL";this.retrieveData=function(A,B){return h.getBucketLocation(A).then(function(D){var F=y.getUserAccountId();if(!F){return x.reject(r.ANALYTICS.ERROR.USER_INFO_MISSING)}var E=u.replace("<account-id>",F).replace("<bucket-name>",A).replace("<config-id>",B);var C=q.replace("<region>",D);return t.getObject(j,C,E).then(function(G){a.log("getAnalyticsData",1,j);return e(G)})["catch"](function(G){a.log("getAnalyticsData",0,j);return x.reject(G)})})};function n(D){var B=1024*1024;var C={objectCount:isNaN(parseFloat(D[o]))?0:parseFloat(D[o]),dataUploaded:isNaN(parseFloat(D[m]))?0:parseFloat(D[m])*B,storage:isNaN(parseFloat(D[i]))?0:parseFloat(D[i])*B,dataRetrieved:isNaN(parseFloat(D[g]))?0:parseFloat(D[g])*B,getRequestCount:isNaN(parseFloat(D[z]))?0:parseFloat(D[z]),CRR:isNaN(parseFloat(D[d]))?0:parseFloat(D[d]),objectAge:D[v],storageClass:D[c]};if(D[v]===f){C.recommendedAgeTransition=D[b];if(C.recommendedAgeTransition&&C.recommendedAgeTransition!=="-1"){var A=parseInt(C.recommendedAgeTransition);if(A>=0&&A<=29){C.recommendation="30"}else{C.recommendation=A.toString()}}C.ageTransition=D[s];if(C.storage===0){C.percentage=0}else{C.percentage=C.dataRetrieved/C.storage*100}}C.timestamp=new Date(D[l]).getTime();return C}function w(C){var D={};var F={};var E={};var G=[];var B=0;angular.forEach(C,function(L,J){var N=L.split(k);if(L){var I=N[l].trim();var H=D[I];if(!(I in D)){D[I]=B;G.push({date:I,stats:[],timestamp:new Date(I).getTime()});H=B;B+=1}var M=n(N);var K=N[c].toUpperCase();if(!F[K]){F[K]=K}G[H].stats.push(M);if(N[v]===f){if(!E[K]){E[K]=[]}E[K].push({date:I,row:M,timestamp:M.timestamp,percentage:M.percentage})}}});G.sort(function(I,H){return I.timestamp-H.timestamp});angular.forEach(E,function(I,H){I.sort(function(K,J){return K.timestamp-J.timestamp})});var A={all:E,rows:G,classes:F};return A}function e(B){var A=B.split("\n");if(A.length===0){return null}A.shift();return w(A)}}])})();"use strict";(function(){angular.module("s3").directive("barChartCard",[function(){return{restrict:"E",controller:"BarChartController",scope:{width:"=?",height:"=?",chartTitle:"=",data:"=",labels:"=?",colors:"=?",maxValue:"=?",footer:"=?"},link:function a(b){b.$watch("data",function(c){if(c){b.generateChart()}})},templateUrl:"/s3/partials/barchartcard.html"}}]);angular.module("s3").controller("BarChartController",["$scope","$window","$element","UtilService",function(g,a,h,d){var i=a.d3;g.width=g.width||270;g.height=g.height||205;var c=g.maxValue;var e=0.94;g.generateChart=function(){var p=10;var o,j=25,s=j*g.data.length;f();var l=[];for(var m=0;m<g.data.length;m++){var n=m%g.colors.bars.length;var k=g.colors.bars[n];l.push({id:m,color:k,value:g.data[m]})}if(i.select(h[0].children[0].children[1])){i.select(h[0].children[0].children[1]).select("svg").remove()}o=i.select(h[0].children[0].children[1]).append("svg").attr("class","chart").attr("width",g.width*e).attr("height",s);var r=i.scale.linear().domain([0,c]).range([0,g.width*e]);var q=i.scale.ordinal().domain(l.map(function(t){return t.id})).rangeBands([0,s]);o.selectAll("rect").data(l).enter().append("svg:rect").attr("y",function(t){return q(t.id)}).attr("width",function(t){return r(t.value)}).attr("height",j-p).attr("fill",function(t){return t.color});o.selectAll("text").data(l).enter().append("svg:text").attr("x",function(t){return r(t.value)}).attr("y",function(t){return q(t.id)+q.rangeBand()/2}).attr("dx",3).attr("text-anchor","start").text(function(t){return d.formatWithUnits(t.value)}).attr("fill",function(t){return t.color})};function b(){if(!c){c=i.max(g.data)}if(!g.units){g.units=""}if(!g.colors){if(!g.colors.bars){g.colors.bars=["blue"]}if(!g.colors.row){g.colors.row="green"}}if(!g.row){g.row={};if(!g.row.color){g.row.color="blue"}}c/=0.75}function f(){c=g.maxValue;c/=0.75}b()}])})();"use strict";function _toConsumableArray(a){if(Array.isArray(a)){for(var c=0,b=Array(a.length);c<a.length;c++){b[c]=a[c]}return b}else{return Array.from(a)}}(function(){angular.module("s3").directive("objectFrequencyAnalytics",[function(){return{restrict:"E",scope:{data:"=",storageClass:"="},controller:"ObjectFrequencyAnalyticsController",templateUrl:"/s3/partials/objectfrequencyanalytics.html",link:function a(b){b.$watch("storageClass.value",function(d,c){if(d!==c){b.processData()}})}}}]);angular.module("s3").controller("ObjectFrequencyAnalyticsController",["$scope","$translate","APIProxyService","ConsoleOperation","AnalyticsDataProcessor","S3Constants","UtilService",function(s,t,u,o,f,r,z){var e=[["0-29","000-029"],["30-44","030-044"],["45-59","045-059"],["60-74","75-89","060-074","075-089"],["90-179","090-179"],["180-364","365+"]];var g={};var m=r.ANALYTICS.STORAGE_CLASS.STANDARD;var k=r.ANALYTICS.STORAGE_CLASS.STANDARD_IA;var h="ALL";s.objectTypes=[];var w="#7394CB";var d="#9066A7";s.barColors=[w,d];s.frequentColor="green";s.infrequentColor="orange";s.emptyColor="gray";var b=t.instant("storageanalysis.footer.text.frequent");var v=t.instant("storageanalysis.footer.text.infrequent");var j=t.instant("storageanalysis.footer.text.move");var n=t.instant("storageanalysis.footer.text.empty");s.width=310;s.height=210;s.labels=[t.instant("storageanalysis.label.storage"),t.instant("storageanalysis.label.dataRetrieved")];function a(){if(s.data){c();s.titles=[];s.titles.push(t.instant("storageanalysis.title.30"));s.titles.push(t.instant("storageanalysis.title.45"));s.titles.push(t.instant("storageanalysis.title.60"));s.titles.push(t.instant("storageanalysis.title.90"));s.titles.push(t.instant("storageanalysis.title.180"));s.titles.push(t.instant("storageanalysis.title.180plus"));x()}}function x(){if(s.data&&s.data.rows){s.objectTypes=z.getStorageClassOptions(s.data.classes);s.daysAnalyzed=s.data.rows.length;s.processData()}}s.processData=function(){p();q()};function c(){angular.forEach(e,function(B,C){angular.forEach(B,function(D){g[D]=C})})}function A(B){var C=parseInt(B);if(isNaN(C)){throw"Passed in date range is not a number"}if(C===-1){return -1}else{if(C<30){return 0}else{if(C<45){return 1}else{if(C<60){return 2}else{if(C<90){return 3}else{if(C<180){return 4}else{return 5}}}}}}}function i(){var C=[];for(var B=0;B<e.length;B++){C.push(0)}return C}function y(D,B,C){angular.forEach(D.stats,function(F){var G=F.storageClass.toUpperCase()===s.storageClass.value;var H=F.objectAge in g;if(G&&H){var E=g[F.objectAge];B[E]+=F[C]}})}function l(C,B){angular.forEach(C,function(E,D){C[D]*=B})}function q(){var B,C;var D=s.data.rows;var F=i();var E=i();angular.forEach(D,function(G){y(G,F,"storage");y(G,E,"dataRetrieved")});l(F,1/D.length);l(E,1/D.length);s.storage=F;s.dataRetrieved=E;s.maxValue=Math.max((B=Math).max.apply(B,_toConsumableArray(s.storage)),(C=Math).max.apply(C,_toConsumableArray(s.dataRetrieved)))}function p(){var E=s.data.all[s.storageClass.value];s.frequencyTypes=[];if(E.length>0){var F=E[E.length-1].row;var C="";if(F.recommendedAgeTransition.length>0){C=A(F.recommendedAgeTransition)}for(var D=0;D<e.length;D++){if(s.storageClass.value!==m){s.frequencyTypes.push({title:"",text:"",color:s.emptyColor});continue}var H=b;var B=s.frequentColor;var G="";if(C===""){H=n;B=s.emptyColor}else{if(D>=C&&C>=0){H=v;G=j;B=s.infrequentColor}}s.frequencyTypes.push({title:H,text:G,color:B})}}}a()}])})();"use strict";(function(){angular.module("s3").directive("analytics",[function(){return{restrict:"E",scope:{},templateUrl:"/s3/partials/analytics.html",controller:"AnalyticsController"}}]);angular.module("s3").controller("AnalyticsController",["$anchorScroll","$route","$routeParams","$scope","$translate","AnalyticsDataProcessor","APIProxyService","AwsUrlsService","BucketPropertiesService","BucketPropertiesUtilService","ConsoleOperation","PathService","S3Constants","SCLogService","StorageMonitoringService","UtilService","XMLParser",function(C,t,P,k,w,S,L,z,F,D,c,E,R,f,A,s,I){var n="Prefix",m="Tag";var y=R.MANAGEMENT.ACTION;var J=R.ANALYTICS.STORAGE_CLASS;var u=3600*1000*24;var v=new c(R.OPERATION_NAME.ANALYTICS_GET_CONFIG);k.bucketName=P[R.PATH_SEGMENTS.BUCKET_NAME];k.allData={};k.metrics={};k.selectedMetricType=R.METRICS.TYPE.STORAGE;k.S3Constants=R;k.selectedFilter=null;k.selectedFilterTmp=null;k.bucketRegion=E.getCurrentBucket();k.validFilter=false;k.filterList=[];k.stdSize=w.instant("storage.size.zero.default");k.stdRet=w.instant("storage.size.zero.default");k.stdiaSize=w.instant("storage.size.zero.default");k.stdiaRet=w.instant("storage.size.zero.default");k.stdDate="";k.stdiaDate="";k.startedOn=H(new Date());k.updatedOn=H(new Date());k.recommendation=null;k.numDays=0;k.selectedStorageClass={value:J.STANDARD};k.percentageGraphId="percentageGraphId";k.percentageGraphHeading="";k.percentageXMin=new Date().getTime()-u;k.percentageXMax=new Date().getTime();k.percentageGraphXValue="timestamp";k.percentageGraphYValue="percentage";k.storageAreaChartId="storageVsDataTransferId";k.xmin=null;k.xmax=null;k.graphData={area:[],percentage:[]};k.storageOptions=null;k.exportFilterInfo={bucket:{},prefix:""};k.models={filterName:null,filterValue:null,filterError:null,savingFilter:false,applyingConfig:false,showAddFilter:false,editFilter:false,configLoading:true,toggleAnalyticsConfig:false,searchText:"",bucketChecked:false,allFilters:false,updatedOn:null,analyzingData:false,dataLoading:true,error:"",deleteFilter:false};k.filters={input:"",prefixFilters:[],tagFilters:[]};k.metricTypes={storage:{id:R.METRICS.TYPE.STORAGE,group:w.instant("management.analytics.type.analysis"),title:w.instant("management.analytics.type.analysis"),disable:false,checked:false,state:false,recommendation:-1,info:w.instant("management.metrics.cost.paid"),dimension:"StorageType",metrics:[{name:"BucketSizeBytes",display:w.instant("management.metric.type.display.storage.size"),selected:true},{name:"NumberOfObjects",display:w.instant("management.metric.type.display.storage.count"),selected:true}]}};k.filterKeyDown=function(T){if(T&&T.keyCode===R.KEY_CODES.ESC){$(".input-field").blur();k.models.searchText=""}};function G(){var T={prefixes:[],tags:[]};angular.forEach(k.filters.prefixFilters,function(U){T.prefixes.push({Prefix:U})});angular.forEach(k.filters.tagFilters,function(U){T.tags.push({Tag:{Key:U.tagKey,Value:U.tagVal}})});return T}k.getGroupTitle=function(T){return k.metricTypes[T].group};function r(U){var T="";if(U){if(!U.And){if(U.Prefix){T+=U.Prefix}else{if(U.Tag){T+=U.Tag.Key+" | "+U.Tag.Value}}}else{angular.forEach(U.And,function(W,V){if(V===n){T+=W+" | "}if(V===m){W=[].concat(W);angular.forEach(W,function(Y,X){T+=Y.Key+"="+Y.Value;if(X!=W.length-1){T+=" | "}})}});T=T.replace(/\|$/,"")}}else{T=" "}return T}k.addFilter=function(T){if(!k.models.showAddFilter){a();k.models.filterNameError="";k.models.filterValueError="";if(T){k.models.editFilter=true;B(T);k.selectedFilterTmp=T}else{k.models.filterName="";k.models.filterValue=""}k.models.showAddFilter=true}};k.validateFilter=function(){var U=true;k.models.filterNameError="";k.models.filterValueError="";if(!k.models.filterName){return false}else{k.models.filterName=k.models.filterName.trim()}if(!R.MANAGEMENT.FILTER_NAME_REGEX.test(k.models.filterName)){k.models.filterNameError=w.instant("management.config.filtername.error.format");U=false}if(k.filters.input){k.models.filterValueError=w.instant("management.config.filtervalue.error.format",{text:k.filters.input});U=false}if(!k.models.editFilter){var T=_.filter(k.filterList,function(V){return V.Id===k.models.filterName});if(T.length>0){k.models.filterNameError=w.instant("management.metrics.side.filter.error.dup");U=false}}return U};k.cancelFilter=function(){k.models.showAddFilter=false;k.models.editFilter=false;k.models.filterError=false;k.selectedFilterTmp=null};k.filterChanged=function(T){if(k.selectedFilter===T){return}if(T){o();if(k.selectedFilter){k.selectedFilter.checked=false;k.selectedFilter=T;k.selectedFilter.checked=true}else{k.selectedFilter=T;k.selectedFilter.checked=true}k.getHeatData()}};k.getLearnMoreLink=function(T){return z.getDocUrl(R.LEARN_MORE_LINKS["storage-management"][T])};function o(){k.cancelFilter();k.cancelMetricsConfig();k.allData.data={};k.graphData.area=[];k.graphData.percentage=[];k.stdSize=w.instant("storage.size.zero.default");k.stdRet=w.instant("storage.size.zero.default");k.stdiaSize=w.instant("storage.size.zero.default");k.stdiaRet=w.instant("storage.size.zero.default");k.stdDate="";k.stdiaDate="";k.startedOn=H(new Date());k.updatedOn=H(new Date());k.numDays=0;k.recommendation=null;k.selectedStorageClass={value:J.STANDARD};k.percentageGraphId="percentageGraphId";k.percentageGraphHeading="";k.percentageXMin=new Date().getTime()-u;k.percentageXMax=new Date().getTime();k.percentageGraphXValue="timestamp";k.percentageGraphYValue="percentage";k.storageOptions=null;k.xmax=new Date().getTime();k.xmin=k.xmax-30*u}k.setSelectedMetricType=function(T){k.selectedMetricType=T};function i(T){k.models[T]=true;a();k.startedOn=H(new Date());k.updatedOn=H(new Date());k.filterList=[];if(T===y.DELETE_FILTER){if(k.selectedFilterTmp===k.selectedFilter){k.selectedFilterTmp=null;k.selectedFilter=null}else{k.selectedFilterTmp=null}}M(T)}function M(T){var U=arguments.length<=1||arguments[1]===undefined?null:arguments[1];var V={};if(U){angular.extend(V,{params:{"continuation-token":U}})}L.getBucketProperty(v,k.bucketName,"analytics",V,false).then(function(aa){var W=aa.response;f.log(R.OPERATION_NAME.ANALYTICS_GET_CONFIG,1,v);var X=I.convertXmlStringToJson(W);var Z=X.ListBucketAnalyticsConfigurationsResult;var Y=[];if(Z&&Z.AnalyticsConfiguration){Y=s.transformObjectToArray(Z.AnalyticsConfiguration)}angular.forEach(Y,function(ab){if(k.selectedFilterTmp&&k.selectedFilterTmp.Id===ab.Id){k.selectedFilterTmp=ab;ab.checked=true}else{ab.checked=false}if(k.selectedFilter&&k.selectedFilter.Id===ab.Id){k.selectedFilter=ab;ab.checked=true}ab.filterText=r(ab.Filter)});k.filterList=k.filterList.concat(Y);if(Z.IsTruncated==="true"){M(T,Z.NextContinuationToken)}else{q();h(T)}})["catch"](function(W){f.log(R.OPERATION_NAME.ANALYTICS_GET_CONFIG,0,v);h(T);N(T,W)})}function q(){if(!k.selectedFilter&&!k.selectedFilterTmp){if(k.filterList.length>0){k.filterList[0].checked=true;k.selectedFilterTmp=k.filterList[0]}}else{if(k.selectedFilter===k.selectedFilterTmp){k.selectedFilter=null}}k.models.editFilter=false;k.filterChanged(k.selectedFilterTmp)}function B(V){var T=k.exportFilterInfo;if(V.StorageClassAnalysis&&V.StorageClassAnalysis.DataExport&&V.StorageClassAnalysis.DataExport.Destination&&V.StorageClassAnalysis.DataExport.Destination.S3BucketDestination){var U=V.StorageClassAnalysis.DataExport.Destination.S3BucketDestination;if(U.Prefix){T.prefix=U.Prefix}if(U.BucketAccountId){T.bucket.accountId=U.BucketAccountId}if(U.Bucket){T.bucket.bucket=D.stripBucketARN(U.Bucket)}}k.models.filterName=V.Id;k.models.filterValue=V.filterText}function a(){k.models.filterName="";k.filters.input="";k.filters.tagFilters=[];k.filters.prefixFilters=[];k.exportFilterInfo={bucket:{},prefix:""}}function h(T){k.models[T]=false;if(T===y.SAVING_FILTER||T===y.DELETE_FILTER){k.models.showAddFilter=false;k.models.filterError=""}if(T===y.APPLYING_CONFIG){k.models.toggleAnalyticsConfig=false}k.filters.tagFilters=[];k.filters.prefixFilters=[]}k.deleteFilter=function(){if(!k.models.deleteFilter&&!k.models.savingFilter){var T={params:{id:k.models.filterName}};p(T,y.DELETE_FILTER)}};k.cancelMetricsConfig=function(){k.metricTypes.storage.checked=k.metricTypes.storage.state;k.models.toggleAnalyticsConfig=false};k.getHeatData=function(){if(k.selectedFilter){k.models[y.DATA_LOADING]=true;var T=k.selectedFilter.Id;S.retrieveData(k.bucketName,T).then(function(U){j(U)})["catch"](function(U){if(U===R.ANALYTICS.ERROR.USER_INFO_MISSING){k.models.error=w.instant("management.analytics.data.error.userinfo.missing")}})["finally"](function(U){k.models[y.DATA_LOADING]=false})}else{k.models[y.DATA_LOADING]=false}};function l(){if(k.allData.data.classes){var T=_.filter(k.allData.data.classes,function(U){return U===J.STANDARD});if(T.length>0){k.selectedStorageClass.value=J.STANDARD}else{k.selectedStorageClass.value=k.allData.data.classes[0]}}else{k.selectedStorageClass.value=J.STANDARD}}function j(V){if(V){k.allData.data=V;l()}if(!k.allData.data.all||!k.allData.data.rows){return}var T=k.allData.data.all[J.STANDARD];if(T&&T.length>0){var U=T[T.length-1];if(U.row.recommendation>=0){k.recommendation=U.row.recommendation;k.selectedFilter.recommendation=k.recommendation}}if(k.allData.data.rows.length>0){k.numDays=x(k.allData.data.rows[0].date);k.startedOn=H(k.allData.data.rows[0].date);k.updatedOn=H(k.allData.data.rows[k.allData.data.rows.length-1].date)}O();Q();b()}function Q(){if(k.allData.data&&k.allData.data.all[k.selectedStorageClass.value]){var X=k.allData.data.all[k.selectedStorageClass.value];var T=[];var W=X.length;if(W>30){var V=W-31;for(var U=W-1;U>V;U--){T.push(X[U])}X=T;k.xmax=T[0].timestamp;k.xmin=T[T.length-1].timestamp}else{if(W>0){k.xmax=X[W-1].timestamp;k.xmin=X[0].timestamp}else{k.xmax=new Date().getTime();k.xmin=k.xmax-30*u}}k.graphData.area=X}else{k.graphData.area=[]}}k.$watch("selectedStorageClass.value",function(U,T){if(U!==T){k.setSelectedStorageClass()}});k.setSelectedStorageClass=function(){j()};function O(){k.storageOptions=s.getStorageClassOptions(k.allData.data.classes)}function b(){var X=k.allData.data.all[k.selectedStorageClass.value];k.percentageGraphId="percentageGraphId";k.percentageGraphHeading="%";k.percentageXMin=new Date().getTime()-30*u;k.percentageXMax=new Date().getTime();if(X){var T=[];var W=X.length;if(W>30){var V=X.length-31;for(var U=W-1;U>V;U--){T.push(X[U])}X=T}k.graphData.percentage=X}else{k.graphData.percentage=[]}}function x(U){var V=24*60*60*1000;var W=new Date(U);var T=new Date();return Math.round(Math.abs((T.getTime()-W.getTime())/V))}function H(V){var T=new Date(V);var X=T.getUTCMonth()+1;var U=T.getUTCDate();var W=T.getUTCFullYear();return X+"/"+U+"/"+W}k.saveFilter=function(){var U=k.exportFilterInfo;if(!k.models.deleteFilter&&!k.models.savingFilter&&!(!U.bucket.bucket&&U.prefix)){var T=G();k.models.filterError="";if(k.validateFilter(T)){(function(){var X={params:{id:k.models.filterName}};var W={},V=undefined;W.AnalyticsConfiguration={};W.AnalyticsConfiguration.Id=k.models.filterName;if(k.models.editFilter){W.AnalyticsConfiguration.Filter=k.selectedFilter.Filter}else{if(T.tags.length+T.prefixes.length>0){W.AnalyticsConfiguration.Filter={};if(T.tags.length>1||T.tags.length+T.prefixes.length>1){W.AnalyticsConfiguration.Filter.And={};if(T.tags.length>0){W.AnalyticsConfiguration.Filter.And.Tag=[];angular.forEach(T.tags,function(Z){var Y=Z.Tag;return W.AnalyticsConfiguration.Filter.And.Tag.push(Y)})}if(T.prefixes.length>0){W.AnalyticsConfiguration.Filter.And.Prefix=[];angular.forEach(T.prefixes,function(Z){var Y=Z.Prefix;return W.AnalyticsConfiguration.Filter.And.Prefix.push(Y)})}}else{if(T.prefixes.length>0){W.AnalyticsConfiguration.Filter=T.prefixes[0]}if(T.tags.length>0){W.AnalyticsConfiguration.Filter.Tag=T.tags[0].Tag}}}}g(W);V=I.jsonToXml(W);e(V,X,y.SAVING_FILTER)})()}}};k.getClassNameTranslation=function(T){var U=s.getStorageClassTranslations()[T];if(!U){U=T.charAt(0)+T.substring(1).toLowerCase()}return U};k.getMostRecentTotalSize=function(T){return s.formatWithUnits(T[T.length-1].row.storage)};k.getMostRecentDate=function(T){return H(T[T.length-1].date)};k.getMostRecentDataRetrieved=function(T){return s.formatWithUnits(T[T.length-1].row.dataRetrieved)};function e(W,V,T){var U=new c(R.OPERATION_NAME.ANALYTICS_PUT_CONFIG);k.models[T]=true;W=K(W);if(T===y.SAVING_FILTER){k.filterError=""}L.putBucketProperty(U,k.bucketName,"analytics",W,V).then(function(Y){var X=Y.response;f.log(R.OPERATION_NAME.ANALYTICS_PUT_CONFIG,1,U);i(T)})["catch"](function(X){f.log("putBucketMetrics",0,U);N(T,X);k.models[T]=false})}function p(V,T){var U=new c(R.OPERATION_NAME.ANALYTICS_DELETE_CONFIG);if(T===y.SAVING_FILTER||T===y.DELETE_FILTER){k.models.filterError=""}k.models[T]=true;L.deleteBucketProperty(U,k.bucketName,"analytics",V).then(function(X){var W=X.response;f.log(R.OPERATION_NAME.ANALYTICS_DELETE_CONFIG,1,U);if(k.selectedFilterTmp===k.selectedFilter){k.selectedFilterTmp=null;k.selectedFilter=null}else{k.selectedFilterTmp=null}i(T)})["catch"](function(W){f.log(R.OPERATION_NAME.ANALYTICS_DELETE_CONFIG,0,U);N(T,W);k.models[T]=false})}function N(T,U){if(T===y.SAVING_FILTER||T===y.DELETE_FILTER){k.models.filterError=s.handleErrors(U)}else{k.models.error=s.handleErrors(U)}}function g(X){X.AnalyticsConfiguration.StorageClassAnalysis="";var U=k.exportFilterInfo;if(U.bucket.bucket){var T=U.bucket.bucket;var V=k.bucketName;var W=U.bucket.region;var Y=null;X.AnalyticsConfiguration.StorageClassAnalysis={};X.AnalyticsConfiguration.StorageClassAnalysis.DataExport={OutputSchemaVersion:"V_1",Destination:{S3BucketDestination:{Format:"CSV",Bucket:s.getBucketARN(T)}}};if(U.prefix){X.AnalyticsConfiguration.StorageClassAnalysis.DataExport.Destination.S3BucketDestination.Prefix=U.prefix}if(U.bucket.accountId){X.AnalyticsConfiguration.StorageClassAnalysis.DataExport.Destination.S3BucketDestination.BucketAccountId=U.bucket.accountId}}}function K(T){return T.replace("<AnalyticsConfiguration>",'<?xml version="1.0" encoding="UTF-8"?> <AnalyticsConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">')}function d(){i(y.CONFIG_LOADING)}d()}])})();"use strict";(function(){angular.module("s3").directive("analyticsExport",[function(){return{restrict:"E",controller:"AnalyticsExportController",scope:{data:"=",saving:"=",editFilter:"="},templateUrl:"/s3/partials/analysisexport.html"}}]);angular.module("s3").controller("AnalyticsExportController",["$scope","AwsUrlsService","BucketPropertiesService","FACService","PathService","S3Constants","UtilService",function(b,e,d,g,f,c,a){g.isBucketFeatureEnabled(c.FAC.QUICKSIGHT).then(function(h){b.showQuicksight=h});b.getLearnMoreLink=function(h){return e.getDocUrl(c.LEARN_MORE_LINKS["storage-management"][h])};b.getQuicksightLink=function(){return c.LEARN_MORE_LINKS["storage-management"]["quicksight"]};b.validatePrefix=function(){if(b.data.prefix&&b.data.prefix.indexOf(c.DELIMITER)===0&&b.data.bucket.bucket){b.prefixInfo=b.data.prefix}else{b.prefixInfo=""}}}])})();"use strict";(function(){angular.module("s3").directive("analyticsAreaChart",[function(){return{restrict:"E",scope:{data:"=",width:"=?",height:"=?",bcolor:"=?",tcolor:"=?",chartId:"=",xmin:"=?",xmax:"=?"},controller:"AnalyticsAreaChartController",templateUrl:"/s3/partials/analytics-area-chart.html",link:function a(b){b.$watch("data",function(c){if(c){b.draw()}})}}}]);angular.module("s3").controller("AnalyticsAreaChartController",["$scope","$translate","$window",function(a,c,e){a.labels=[c.instant("storageanalysis.label.storage"),c.instant("storageanalysis.label.dataRetrieved")];var b=e.d3;a.draw=function(){var l=a.data;var j=b.time.format("%m/%d");var s=9;var k={top:10,right:20,bottom:30,left:80},g=(a.width||960)-k.left-k.right,t=(a.height||500)-k.top-k.bottom;l.sort(function(w,v){return b.ascending(w.timestamp,v.timestamp)});var r=b.time.scale().range([0,g]);var p=b.scale.linear().range([t,0]);var h=b.svg.axis().scale(r).orient("bottom").ticks(5).tickFormat(j);var f=b.svg.axis().scale(p).orient("left").ticks(s).tickFormat(d);var u=b.svg.area().x(function(v){return r(v.timestamp)}).y0(t).y1(function(v){return p(v.row.storage)});var i=b.svg.area().x(function(v){return r(v.timestamp)}).y0(t).y1(function(v){return p(v.row.storage+v.row.dataRetrieved)});b.select("#"+a.chartId).selectAll("svg").remove();var m=b.select("#"+a.chartId).append("svg").attr("width",g+k.left+k.right).attr("height",t+k.top+k.bottom).append("g").attr("transform","translate("+k.left+","+k.top+")");if(a.xmin&&a.xmax){r.domain([a.xmin,a.xmax]).nice()}else{r.domain(b.extent(l,function(v){return v.timestamp})).nice()}if(l.length>0){var n=b.extent(l,function(v){return v.row.storage+v.row.dataRetrieved});var o=n[1];var q=o*0.3;if(q===0){if(o!==0){q=o*0.1}else{q=1;s=2;f.ticks(s)}}o+=q;p.domain([0,o]);p.nice([0,o])}else{p.domain([0,5]);p.nice([0,5])}m.append("path").datum(l).attr("class","data-fill").attr("d",i);m.append("path").datum(l).attr("class","storage-fill").attr("d",u);m.append("g").attr("class","x axis").attr("transform","translate(0,"+t+")").call(h);m.append("g").attr("class","y axis").call(f)};var d=function d(g){var f=b.format(".1f");if(g<1024){return f(g)}else{if(g<1024*1024){return f(g/1024)+" KB"}else{if(g<1024*1024*1024){return f(g/1024/1024)+" MB"}else{if(g<1024*1024*1024*1024){return f(g/1024/1024/1024)+" GB"}else{if(g<1024*1024*1024*1024*1024){return f(g/1024/1024/1024/1024)+" TB"}else{return f(g/1024/1024/1024/1024/1024)+" PB"}}}}}}}])})();"use strict";(function(){angular.module("s3").directive("targetmbox",["TargetMediatorScripts",function(a){return{restrict:"E",templateUrl:"/s3/partials/targetmbox.html",scope:{},controller:"TargetMboxController",link:function b(e,d,c){e.$watch(function(){return $(d).find(".js-mbox").css("visibility")},function(f){if(f==="visible"){a.setMBoxContent()}})}}}]);angular.module("s3").controller("TargetMboxController",["$scope","TargetMediatorScripts","InvokeTargetMediator",function(d,b,c){d.scriptsInvoked=c.getScriptCount();if(d.scriptsInvoked>0){var a=b.getMBoxContent();d.mBoxContent=a!==undefined?a:"";d.showDefault=false}else{d.showDefault=true}}]).filter("trusted",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}])})();"use strict";(function(){angular.module("s3").factory("TargetMediatorScripts",["$document","$window","S3Constants",function(e,a,f){function i(j){var k=j!==undefined?j.toLowerCase():"en";return f.TARGET_MEDIATOR.LANGUAGE_MAP[k]||"en"}function g(){return{pageLanguage:i($('meta[property="requestLocale"]').attr("content")),supportedLanguages:f.TARGET_MEDIATOR.SUPPORTED_LANGUAGES,isLoadedAtPageEnd:true}}function b(){var m=document.createElement("noscript");m.innerHTML="<style>.js-mbox { visibility: visible; }</style>";document.body.appendChild(m);var l="var AWS = {};";l+="AWS.TargetMediator = ";l+=JSON.stringify(g())+";";var k=document.createElement("script");k.innerHTML=l;document.body.appendChild(k);var j=document.createElement("script");j.type="text/javascript";j.defer=true;j.src="/s3/lib/target/aws-target-mediator.js";document.body.appendChild(j)}var c;function h(){var j=$("targetmbox").find(".js-mbox");if(j.length){c=j.get(0).innerHTML}else{c=""}}function d(){return c}return{addScripts:b,getLanguage:i,getMediatorObject:g,getMBoxContent:d,setMBoxContent:h}}]);angular.module("s3").factory("InvokeTargetMediator",["$document","TargetMediatorScripts",function(c,b){angular.injector(["ng","s3"]).invoke(function(){b.addScripts()});function a(){var d=$('script[src="/s3/lib/target/aws-target-mediator.js"]');return c.find(d).length}return{getScriptCount:a}}])})();"use strict";(function(){angular.module("s3").directive("bucketAccelerate",[function(){return{restrict:"E",scope:{cardOpen:"=",id:"@?"},templateUrl:"/s3/partials/bucketaccelerate.html",controller:"BucketAccelerateController"}}]);angular.module("s3").controller("BucketAccelerateController",["$scope","$timeout","$translate","AwsUrlsService","BucketPropertiesService","ConsoleOperation","PathService","S3Constants","UtilService",a]);function a(k,c,b,d,e,h,i,g,j){k.accelerateStates={enabled:"Enabled",suspended:"Suspended"};k.accelerate={};k.accelerate.selectedValue=k.accelerateStates.suspended;k.learnMoreLink=d.getDocUrl(g.LEARN_MORE_LINKS.ACCELERATE);k.accelerate.endpoint=""+i.getCurrentBucket()+g.ACCELERATE.ENDPOINT.PUBLIC;k.scrollCardId="#"+k.id;k.cardSummaryObj=_.cloneDeep(g.CARD_SUMMARY_INIT);k.cardSummaryObj.activeSummary.text=b.instant("bucketproperty.acceleration.endpoint");k.cardSummaryObj.inactiveSummary.text=b.instant("bucketproperty.suspended");m();function m(){if(k.accelerate.selectedValue===k.accelerateStates.enabled){k.cardSummaryObj.isActive=true;k.cardSummaryObj.isMultiValue=true;k.cardSummaryObj.activeSummary.value=k.accelerate.endpoint}else{k.cardSummaryObj.isActive=false;k.cardSummaryObj.isMultiValue=false}}function l(){var o=i.getCurrentBucket();var n=new h(g.ANALYTICS.GET_BUCKET_ACCELERATE);k.error=undefined;e.getBucketLocation(o).then(function(p){k.comparisonEndpoint=g.ACCELERATE.COMPARISON_ENDPOINT+"region="+p+"&origBucketName="+o});e.getBucketAccelerate(o,n).then(function(p){if(p===k.accelerateStates.enabled){k.accelerate.selectedValue=k.accelerateStates.enabled}})["catch"](function(p){k.error=j.handleErrors(p)})["finally"](function(){k.cachedAccelerate=angular.copy(k.accelerate);m()})}k.cancelBucketAccelerate=function(n){j.analyticsTrackClick(g.ANALYTICS.CANCEL_ACCELERATE,g.ANALYTICS.DETAILS);n.stopPropagation();k.accelerate=angular.copy(k.cachedAccelerate);k.cardSummaryObj.isActive=k.accelerate.selectedValue===k.accelerateStates.enabled;k.error=undefined;k.cardOpen=false};k.saveBucketAccelerate=function(n){j.analyticsTrackClick(g.ANALYTICS.SAVE_ACCELERATE,g.ANALYTICS.DETAILS);n.stopPropagation();k.error=undefined;k.saving=true;e.putBucketAccelerate(i.getCurrentBucket(),new h(g.ANALYTICS.PUT_BUCKET_ACCELERATE),k.accelerate.selectedValue).then(function(){k.cachedAccelerate.selectedValue=angular.copy(k.accelerate.selectedValue);k.cardOpen=false})["catch"](function(o){k.error=o})["finally"](function(){k.saving=false;m()})};function f(){l()}f()}})();"use strict";(function(){angular.module("s3").service("FACService",["BucketPropertiesService","FAC","PathService",a]);function a(c,b,d){this.isBucketFeatureEnabled=function(e){return c.getBucketLocation(d.getCurrentBucket()).then(function(f){return b.isFeatureEnabled(e+"-"+f)})}}})();"use strict";(function(){angular.module("s3").directive("hint",[function(){return{restrict:"E",templateUrl:"/s3/partials/hint.html",scope:{},controller:"HintController"}}]);angular.module("s3").controller("HintController",["$scope","$interval","$translate","$window","$cookies","ConsoleOperation","Region","S3Constants","SCLogService","UtilService",function(m,g,a,d,e,h,n,f,l,j){m.goToOldConsole=function(){var o=new h(f.OPERATION_NAME.SWITCH_BACK_TO_OLD_CONSOLE);l.log(f.OPERATION_NAME.SWITCH_BACK_TO_OLD_CONSOLE,1,o);e.put(f.OPT_OUT_COOKIE.COOKIE_KEY,f.OPT_OUT_COOKIE.VALUE[j.getCloudSystem()],{path:f.OPT_OUT_COOKIE.PATH});d.location.reload()};m.goToVideo=function(){d.open("https://www.youtube.com/watch?v=OrECPD2layQ&feature=youtu.be","_blank")};m.showVideo=function(){var o=n.getCurrentRegion();return f.FALLBACK_REGION_LIST.CN.indexOf(o)===-1&&f.FALLBACK_REGION_LIST.ISO.indexOf(o)===-1};var c=8;var b=10000;var k=0;m.hintMessage=a.instant("hint.message."+k);var i=function i(){k=(k+1)%c;m.hintMessage=a.instant("hint.message."+k)};g(i,b)}])})();angular.module("s3").run(["$templateCache",function(a){a.put("/s3/partials/acl.html",'<div class="manage-grantee-title" translate="permissions.manageusers"></div>\n<div class="acl-add-new">\n     <awsui-button variant="primary" data-disabled="isGlacier" text="{{\'permissions.button.addgrantee\'  | translate}}" icon="plus" click="showAddGranteeRow()"></awsui-button>\n     <awsui-button data-disabled="disableDeleteButton() " text="{{\'permissions.button.deletegrantee\'  | translate}}" click="deleteAccountGrantee()"></awsui-button>\n </div>\n<awsui-radio-group class="permission-radio-group" ng-model="radioSelect.displayName">\n    <table class="table">\n        <thead class="table-header">\n        <tr>\n            <th class="grantee-radio"></th>\n            <th class="grantee-header">\n                {{\'permissions.acl.grantee\' | translate}}\n                <awsui-tooltip text="{{ \'permissions.acl.granteeTooltip\' | translate }}" position="right" size="small" initialized="true">\n                    <i class="awsui-icon alert-info-circle"></i>\n                </awsui-tooltip>\n            </th>\n            <th>\n                {{\'permissions.acl.objectaccess\' | translate}}\n                <awsui-tooltip text="{{ isBucketPermission ? \'permissions.acl.bucket_objectaccessTooltip\' : \'permissions.acl.object_objectaccessTooltip\' | translate }}" position="right" size="small" initialized="true">\n                    <i class="awsui-icon alert-info-circle"></i>\n                </awsui-tooltip>\n            </th>\n            <th>\n                {{\'permissions.acl.permissionsaccess\' | translate}}\n                <awsui-tooltip text="{{ isBucketPermission ?  \'permissions.acl.bucket_permissionsaccessTooltip\' : \'permissions.acl.object_permissionsaccessTooltip\'| translate }}" position="right" size="small" initialized="true">\n                    <i class="awsui-icon alert-info-circle"></i>\n                </awsui-tooltip>\n            </th>\n        </tr>\n        </thead>\n        <tbody class="table-body">\n        <tr ng-if="isAddGranteeRowDisplayed">\n            <td></td>\n            <td class="add-grantee-options">\n                <awsui-control-group validation-message="{{ granteeList.inputError }}">\n                    <awsui-textfield class="grantee-list" placeholder="{{ \'permissions.addnewgratee.placeholder\' | translate }}" ng-change="resetInputError()" ng-model="granteeList.inputItem"></awsui-textfield>\n                </awsui-control-group>\n\n                <awsui-button id="save-grantee" variant="primary" text="{{ \'permissions.button.save\' | translate }}" class="awsui-util normal-button add-grantee-buttons" disabled="!granteeList.inputItem  || (!granteeList.grantPermissions.READ && !granteeList.grantPermissions.WRITE && !granteeList.grantPermissions.READ_ACP && !granteeList.grantPermissions.WRITE_ACP) || granteeList.inputError" click="save()" loading="addingGrantee">\n                </awsui-button>\n                <awsui-button id="cancel-grantee" variant="normal" text="{{ \'permissions.button.cancel\' | translate }}" class="awsui-util normal-button add-grantee-buttons" click="cancel()">\n                </awsui-button>\n            </td>\n            <td class="grantee-checkboxes">\n                <awsui-checkbox class="awsui awsui-checkbox" disabled="!granteeList.inputItem || granteeList.inputError" ng-model="granteeList.grantPermissions.READ">{{ \'permissions.value.read\' | translate }}</awsui-checkbox>\n                <awsui-checkbox class="awsui awsui-checkbox" disabled="!granteeList.inputItem || granteeList.inputError" ng-model="granteeList.grantPermissions.WRITE">{{ \'permissions.value.write\' | translate }}</awsui-checkbox>\n            </td>\n            <td class="grantee-checkboxes">\n                <awsui-checkbox class="awsui awsui-checkbox" disabled="!granteeList.inputItem || granteeList.inputError" ng-model="granteeList.grantPermissions.READ_ACP">{{ \'permissions.value.read\' | translate }}</awsui-checkbox>\n                <awsui-checkbox class="awsui awsui-checkbox" disabled="!granteeList.inputItem || granteeList.inputError" ng-model="granteeList.grantPermissions.WRITE_ACP">{{ \'permissions.value.write\' | translate }}</awsui-checkbox>\n            </td>\n        </tr>\n        <tr ng-repeat="(name, permissions) in permissionObj.grantees.accounts" class="grantee-row" ng-click="selectGrantee(name, false)" ng-class="{\'grantee-selected\': name === selectedGrantee.displayedValue, \'row-hover\' : hoverUser }" ng-mouseenter="hoverUser = true" ng-mouseleave="hoverUser = false">\n            <td ng-click="selectGrantee(name, false)">\n                <awsui-radio-button value="{{name}}">\n            <td>{{name}}</td>\n            <td>\n                <span ng-if="permissions.READ && !permissions.WRITE" translate="permissions.value.read"></span>\n                <span ng-if="permissions.READ && permissions.WRITE">{{ \'permissions.value.read\' | translate }}, </span>\n                <span ng-if="permissions.WRITE" translate="permissions.value.write"></span>\n            </td>\n            <td>\n                <span ng-if="permissions.READ_ACP && !permissions.WRITE_ACP" translate="permissions.value.read"></span>\n                <span ng-if="permissions.READ_ACP && permissions.WRITE_ACP">{{ \'permissions.value.read\' | translate }}, </span>\n                <span ng-if="permissions.WRITE_ACP" translate="permissions.value.write"></span>\n            </td>\n            </awsui-radio-button>\n            </td>\n        </tr>\n        <tr>\n            <storage-console-config-panel ng-class="{\'side-config-panel acl-side-panel\': panelOpen, \'hide-config-panel acl-side-panel\': panelHide}" panel-open="panelOpen">\n                <header>\n                    <div class="truncate side-panel-header bucket-config-panel-header-image">{{ selectedGrantee.displayedValue }}</div>\n                    <span class="panel-close-icon" ng-click="panelCancel()"></span>\n                    \n                </header>\n                <content>\n                    <div class="permissions-side-panel-content">\n                        <p class="subheader" translate="permissions.acl.objectaccess"></p>\n                        <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.READ">{{ \'permissions.value.read\' | translate }}</awsui-checkbox>\n                        <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.WRITE">{{ \'permissions.value.write\' | translate }}</awsui-checkbox>\n                        <p class="subheader padding-top-30" translate="permissions.acl.permissionsaccess"></p>\n                        <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.READ_ACP">{{ \'permissions.value.read\' | translate }}</awsui-checkbox>\n                        <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.WRITE_ACP">{{ \'permissions.value.write\' | translate }}</awsui-checkbox>\n                    </div>\n                </content>\n                <footer>\n                    <awsui-button variant="primary" text="{{ \'permissions.button.save\' | translate}}" class="awsui-util-f-r primary-button" click="updateGrantee(selectedGrantee)" loading="updatingGrantee"></awsui-button>\n                    <awsui-button variant="normal" text="{{ \'permissions.button.cancel\' | translate}}" class="awsui-util-f-r normal-button" click="panelCancel()"></awsui-button>\n                </footer>\n            </storage-console-config-panel>\n        </tr>\n        </tbody>\n    </table>\n<div class="manage-public-permission-title" translate="permissions.managepublicpermissions"> </div>\n<table class="table">\n     <thead class="table-header">\n     <tr>\n         <th class="grantee-radio"></th>\n         <th class="grantee-header">\n             {{\'permissions.acl.group\' | translate}}\n             <awsui-tooltip text="{{ \'permissions.acl.groupTooltip\' | translate }}" position="right" size="small" initialized="true">\n                 <i class="awsui-icon alert-info-circle"></i>\n             </awsui-tooltip>\n         </th>\n         <th>\n             {{\'permissions.acl.objectaccess\' | translate}}\n             <awsui-tooltip text="{{ isBucketPermission ? \'permissions.acl.bucket_objectaccessTooltip\' : \'permissions.acl.object_objectaccessTooltip\' | translate }}" position="right" size="small" initialized="true">\n                 <i class="awsui-icon alert-info-circle"></i>\n             </awsui-tooltip>\n         </th>\n         <th>\n             {{\'permissions.acl.permissionsaccess\' | translate}}\n             <awsui-tooltip text="{{ isBucketPermission ?  \'permissions.acl.bucket_permissionsaccessTooltip\' : \'permissions.acl.object_permissionsaccessTooltip\'| translate }}" position="right" size="small" initialized="true">\n                 <i class="awsui-icon alert-info-circle"></i>\n             </awsui-tooltip>\n         </th>\n     </tr>\n     </thead>\n     <tbody class="table-body">\n     <tr ng-repeat="(name, permissions) in permissionObj.grantees.group" ng-click="selectGrantee(name, true)" class="grantee-row" ng-class="{\'grantee-selected\': name === selectedGrantee.displayedValue, \'row-hover\': hoverGroup}" ng-mouseenter="hoverGroup = true" ng-mouseleave="hoverGroup = false">\n         <td ng-click="selectGrantee(name, true)">\n             <awsui-radio-button value="{{name}}">\n         <td>{{ getPublicPermissionDisplayName(name)}}</td>\n         <td>\n             <span ng-if="permissions.READ && !permissions.WRITE" translate="permissions.value.read"></span>\n             <span ng-if="permissions.READ && permissions.WRITE">{{ \'permissions.value.read\' | translate }}, </span>\n             <span ng-if="permissions.WRITE" translate="permissions.value.write"></span>\n         </td>\n         <td>\n             <span ng-if="permissions.READ_ACP && !permissions.WRITE_ACP" translate="permissions.value.read"></span>\n             <span ng-if="permissions.READ_ACP && permissions.WRITE_ACP">{{ \'permissions.value.read\' | translate }}, </span>\n             <span ng-if="permissions.WRITE_ACP" translate="permissions.value.write"></span>\n         </td>\n         </awsui-radio-button>\n         </td>\n     </tr>\n     <tr>\n         <storage-console-config-panel ng-class="{\'side-config-panel acl-side-panel\': panelOpen, \'hide-config-panel acl-side-panel\': panelHide}" panel-open="panelOpen">\n             <header>\n                 <div class="truncate side-panel-header bucket-config-panel-header-image">{{ getPublicPermissionDisplayName(selectedGrantee.displayedValue) }}</div>\n                 <span class="panel-close-icon" ng-click="panelCancel()"></span>\n                 \n             </header>\n             <content>\n                 <div class="permissions-side-panel-content">\n                     <p class="subheader" translate="permissions.acl.objectaccess"></p>\n                     <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.READ">{{ \'permissions.value.read\' | translate }}</awsui-checkbox>\n                     <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.WRITE">{{ \'permissions.value.write\' | translate }}</awsui-checkbox>\n                     <p class="subheader padding-top-30" translate="permissions.acl.permissionsaccess"></p>\n                     <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.READ_ACP">{{ \'permissions.value.read\' | translate }}</awsui-checkbox>\n                     <awsui-checkbox class="awsui awsui-checkbox panel-checkbox" ng-model="selectedGrantee.permissions.WRITE_ACP">{{ \'permissions.value.write\' | translate }}</awsui-checkbox>\n                 </div>\n             </content>\n             <footer>\n                 <awsui-button variant="primary" text="{{ \'permissions.button.save\' | translate}}" class="awsui-util-f-r primary-button" click="updateGrantee(selectedGrantee)" loading="updatingGrantee"></awsui-button>\n                 <awsui-button variant="normal" text="{{ \'permissions.button.cancel\' | translate}}" class="awsui-util-f-r normal-button" click="panelCancel()"></awsui-button>\n             </footer>\n         </storage-console-config-panel>\n     </tr>\n     </tbody>\n </table>\n</awsui-radio-group>');a.put("/s3/partials/addeventsform.html",'<div class="add-events-body">\n        <translate class="events-label-header">events.label.name</translate>\n        <awsui-tooltip text="{{ \'events.tooltip.name\' | translate }}" position="right" size="small" initialized="true">\n            <i class="awsui-icon alert-info-circle"></i>\n        </awsui-tooltip>\n        <awsui-control-group class="label-text">\n            <awsui-textfield class="input-text" placeholder="{{\'events.placeholder.name\' | translate}}" ng-model="selectedEvent.id"></awsui-textfield>\n        </awsui-control-group>\n        <translate class="events-label-header">events.label.events</translate>\n        <awsui-tooltip text="{{ \'events.tooltip.events\' | translate }}" position="right" size="small" initialized="true">\n            <i class="awsui-icon alert-info-circle"></i>\n        </awsui-tooltip>\n        <awsui-control-group class="checkboxes">\n            <awsui-checkbox ng-repeat="eventType in eventTypes" ng-model="eventsChecked[eventType.complexName]" change="handleCheckboxes()">{{ eventType.simpleName }}\n            </awsui-checkbox>\n        </awsui-control-group>\n        <translate class="events-label-header">events.label.prefix</translate>\n        <awsui-tooltip text="{{ \'events.tooltip.prefix\' | translate }}" position="right" size="small" initialized="true">\n            <i class="awsui-icon alert-info-circle"></i>\n        </awsui-tooltip>\n        <awsui-control-group class="label-text">\n            <awsui-textfield class="input-text" placeholder="{{\'events.placeholder.prefix\' | translate}}" ng-model="selectedEvent.prefix"></awsui-textfield>\n        </awsui-control-group>\n        <translate class="events-label-header">events.label.suffix</translate>\n        <awsui-tooltip text="{{ \'events.tooltip.suffix\' | translate }}" position="right" size="small" initialized="true">\n            <i class="awsui-icon alert-info-circle"></i>\n        </awsui-tooltip>\n        <awsui-control-group class="label-text">\n            <awsui-textfield class="input-text" placeholder="{{\'events.placeholder.suffix\' | translate}}" ng-model="selectedEvent.suffix"></awsui-textfield>\n        </awsui-control-group>\n        <translate class="events-label-header">events.label.sendto</translate>\n        <awsui-tooltip text="{{ \'events.tooltip.sendto\' | translate }}" position="right" size="small" initialized="true">\n            <i class="awsui-icon alert-info-circle"></i>\n        </awsui-tooltip>\n        <awsui-control-group class="label-text" validation-message="{{cardState.listTopicError}}">\n            <awsui-select placeholder="{{ \'addeventmodal.sendtoplaceholder\' | translate }}" items="resourceTypesDropdown" ng-model="selectedEvent.type" change="updateEventResources()"></awsui-select>\n        </awsui-control-group>\n        <awsui-control-group class="label-text" label="{{ selectedEvent.type }}">\n            <awsui-select items="eventResources" disabled="isLoadingResources || !selectedEvent.type" ng-model="selectValue.value" change="selectChanged()"></awsui-select>\n        </awsui-control-group>\n\n        <awsui-control-group class="label-text" label="{{getCustomArnLabel()}}" ng-if="selectValue.value === S3Constants.EVENTS.CUSTOM">\n            <awsui-textfield class="input-text" placeholder="{{customarn_placeholder}}" ng-model="selectedEvent.arn"></awsui-textfield>\n        </awsui-control-group>\n    </div>');a.put("/s3/partials/analysisexport.html",'<div class="analysis-export-form">\n    <awsui-expandable-section class="export-form-dropdown" header="{{\'management.analytics.export.title\' | translate}}" expanded="editFilter">\n        <div class="export-form-hr"></div>\n        <div class="dropdown-text section">\n            <div class="export-form-labels" translate="report.label.bucket"></div>\n            <bucket-selector class="export-form-bucket" ng-class="{ \'bucket-missing\': data.prefix && !data.bucket.bucket}" selected-report="data.bucket" show-bucket-name-only="false" choose-accounts="true" same-region="true" editable="true" disabled="saving"></bucket-selector>\n            <div class="export-form-policy">\n                {{ \'management.analytics.bucket.policy.info\' | translate }} <a href="{{ getLearnMoreLink(\'analytics-storage-class\') }}" target="_blank" translate="">learn.more</a>\n            </div>\n            <div class="export-form-labels" translate="report.label.prefix"></div>\n            <awsui-textfield class="export-form-prefix" placeholder="{{ \'management.analytics.export.prefix.placeholder\' | translate}}" ng-keyup="validatePrefix()" data-disabled="saving || !data.bucket.bucket" ng-model="data.prefix"></awsui-textfield>\n\n            <div class="search-prefix-info" ng-if="prefixInfo" translate="" translate-values="{ bucket1 : data.bucket.bucket + \'/\' + prefixInfo, bucket2: data.bucket.bucket + prefixInfo }">prefixsearch.validation.slash.start.warning</div>\n\n            <div class="export-quicksight" translate="management.analytics.quicksight.export" translate-values="{quicksightLink : getQuicksightLink()}" ng-if="showQuicksight">\n            </div>\n        </div>\n    </awsui-expandable-section>\n</div>');a.put("/s3/partials/analytics-area-chart.html",'<div id="{{ chartId }}"></div>');a.put("/s3/partials/analytics.html",'<table class="metrics-content-table">\n\n    <tr>\n        <td class="metrics-content-cell management-side-panel-color">\n            <div class="select-metrics-side-panel">\n                <span class="awsui-icon awsui-spinner awsui-spinner-large config-spinner" ng-if="models.configLoading"></span>\n                <table border="0px" class="select-metrics-table" ng-if="!models.configLoading">\n                    <tr>\n                        <td>\n                            <span class="metrics-header">{{ \'management.view.analytics\' | translate }}</span>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <table class="search-box prefix-search-box">\n                                <tbody>\n                                <tr>\n                                    <td class="search-icon"><i class="awsui-icon search"></i></td>\n                                    <td><input type="text" class="input-field ng-pristine ng-valid ng-empty ng-touched" ng-model="models.searchText" ng-keydown="filterKeyDown($event)" placeholder="{{ \'management.search.placeholder\' | translate }}"></td>\n                                </tr>\n                                </tbody>\n                            </table>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td class="filter-header">\n                            <table class="filters-table-header">\n                                <tr>\n                                    <td>\n                                        <div class="filter-title-analytics" translate="management.metrics.side.filter.header" translate-values="{count: filterList.length}"></div>\n                                    </td>\n                                    <td>\n                                        <div class="filter-add" ng-click="addFilter()">\n                                            <div class="awsui-icon awsui-icon-link plus">\n                                                {{\'management.metrics.side.filter.add\'|translate}}\n                                            </div>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n\n                    <tr ng-if="models.showAddFilter">\n                        <td class="bucket-dropdown-config dark">\n                            <table>\n                                <tr>\n                                    <td class="filter-title-cell">\n                                        <div class="filter-add-title">\n                                            {{ models.editFilter ? \'management.metrics.side.filter.dropdown.edit\' :\n                                            \'management.metrics.side.filter.dropdown.add\' | translate}}\n                                        </div>\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <td>\n                                        <div class="new-filter-params">\n                                            <div class="new-filter-text">\n                                                {{ \'management.metrics.side.filter.name.title\' | translate }}\n                                            </div>\n                                            <div class="new-filter-input">\n                                                <awsui-control-group validation-message="{{models.filterNameError}}">\n                                                    <awsui-textfield placeholder="{{ \'management.metrics.side.filter.name.placeholder\' | translate}}" ng-keyup="validateFilter()" data-disabled="models.editFilter || models.savingFilter" ng-model="models.filterName"></awsui-textfield>\n                                                </awsui-control-group>\n                                            </div>\n\n                                            <div class="new-filter-text">\n                                                {{ \'management.metrics.side.filter.prefix.optional.title\' | translate }}\n                                            </div>\n                                            <div class="new-filter-input" ng-class="{\'new-filter-input-search\' : models.filterValue || (filters.tagFilters.length + filters.prefixFilters.length) > 0 }">\n                                                <awsui-textarea ng-if="models.editFilter" placeholder="{{ \'management.metrics.side.filter.prefix.placeholder\' | translate}}" ng-keyup="validateFilter()" data-disabled="true" rows="1" ng-model="models.filterValue"></awsui-textarea>\n                                                <search empty="true" filters="filters" no-backend-calls="true" ng-if="!models.editFilter" search-error="models.filterValueError"></search>\n                                            </div>\n\n                                            <div>\n                                                <analytics-export data="exportFilterInfo" saving="models.savingFilter" edit-filter="models.editFilter">\n                                                </analytics-export>\n                                            </div>\n\n                                            <div class="select-analytics-buttons">\n                                                <table>\n                                                    <tr>\n                                                        <td colspan="2">\n                                                            <div class="filter-delete">\n                                                                <awsui-button data-disabled="models.deleteFilter || models.savingFilter" variant="link" ng-click="deleteFilter()" loading="models.deleteFilter" ng-if="models.editFilter" text="{{ \'management.metrics.action.delete\' | translate }}">\n                                                                </awsui-button>\n                                                            </div>\n                                                        </td>\n                                                    </tr>\n                                                    <tr>\n                                                        <td class="analytics-button-spacing">\n                                                            <awsui-button variant="primary" text="{{ \'button.save\'   | translate}}" data-disabled="models.savingFilter || models.deleteFilter\n                                                                          || (!models.filterName || models.filterNameError)\n                                                                          || (exportFilterInfo.prefix.length > 0 && !exportFilterInfo.bucket.bucket)" class="normal-button" loading="models.savingFilter" ng-click="saveFilter()"></awsui-button>\n                                                        </td>\n                                                        <td>\n                                                            <awsui-button variant="normal" text="{{ \'button.cancel\' | translate}}" class="normal-button" data-disabled="models.savingFilter || models.deleteFilter" click="cancelFilter()"></awsui-button>\n                                                        </td>\n                                                    </tr>\n                                                </table>\n                                                <div class="filter-error">\n                                                    <awsui-alert type="error" header="{{\'error.header\'|translate}}" ng-if="models.filterError">{{models.filterError}}\n                                                    </awsui-alert>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n\n                    <tr ng-if="!models.showAddFilter && filterList.length > 0" class="filter-header">\n                        <td>\n                            <table class="filters-table">\n                                <tr ng-repeat="row in filterList | filter:models.searchText " ng-class="{\'bucket-selected row-highlight\' : row.checked}" ng-click="filterChanged(row)">\n                                    <td>\n                                        <div class="row-checkbox">\n                                            <span class="orange-lightbulb lightbulb-icon" ng-if="!row.recommendation"></span>\n                                            <span class="lightbulb-icon" ng-class="{\'enabled-lightbulb-blue-image\' : !row.checked,\n                                                            \'enabled-lightbulb-white-image\':row.checked}" ng-if="row.recommendation"></span>\n                                        </div>\n                                    </td>\n                                    <td class="filter-name-row">\n                                        <div>\n                                            {{row.Id}}\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <span class="awsui-icon awsui-icon-link pencil buckets-cog" ng-class="{\'awsui-icon-light\': row.checked}" ng-click="addFilter(row)"></span>\n                                    </td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n                    <tr ng-if="!models.showAddFilter && filterList.length === 0">\n                        <td>\n                            <div class="side-panel-metrics-help">\n\n                                <span> {{ \'storageanalysis.empty.additionalInformation\' | translate }}{{ \'management.metrics.cost.paid\' | translate}} </span> <br>\n\n                                <a href="{{ getLearnMoreLink(\'analytics-storage-class\') }}" target="_blank" class="ng-binding" translate="">learn.more</a>\n                                <br>\n                                <br>\n                                <awsui-button data-disabled="false" loading="false" icon="plus" variant="primary" ng-click="addFilter()">\n                                    {{ \'management.metrics.side.filter.add\' | translate }}\n                                </awsui-button>\n                            </div>\n                        </td>\n                    </tr>\n                </table>\n            </div>\n        </td>\n        <td class="metrics-content-cell">\n\n            <div class="analytics-content">\n                <div>\n                    <div class="si-top-right-header analytics-padding">\n                        <div class="title labels">\n                            {{ getGroupTitle(S3Constants.METRICS.TYPE.STORAGE) }}\n                        </div>\n                    </div>\n\n                    <div class="empty-storage-class-analysis" ng-if="!models.configLoading && !models.savingFilter && !models.deleteFilter && filterList.length === 0">\n                        <span class="no-storage-class-analysis storage-class-analysis-icon"></span>\n                        <div class="empty-header" translate="">storageanalysis.empty.header</div>\n                        <div class="empty-additional-information" translate="">\n                            storageanalysis.empty.additionalInformation\n                        </div>\n                        <table class="empty-buttons">\n                            <tbody>\n                            <tr>\n                                <td>\n                                    <awsui-button variant="link" text="{{ \'storageanalysis.empty.addfilter\' | translate }}" ng-click="addFilter()"></awsui-button>\n                                </td>\n                            </tr>\n                            </tbody>\n                        </table>\n                    </div>\n\n                    <div class="storage-management-error-box">\n                        <awsui-alert type="error" header="{{\'error.header\'|translate}}" ng-if="models.error">{{models.error}}\n                        </awsui-alert>\n                    </div>\n\n                    <div ng-if="!models.configLoading && !models.savingFilter && !models.deleteFilter && filterList.length > 0">\n                        <div class="metrics-loading" ng-if="models.dataLoading">\n                            <span class="awsui-icon awsui-spinner awsui-spinner-large"></span>\n                        </div>\n\n                        <div class="analyzing-data" ng-if="!models.dataLoading && !recommendation">\n                            <div class="info-box">\n                                <table class="info-table">\n                                    <tr>\n                                        <td><span class="info-icon orange-lightbulb lightbulb-icon"></span></td>\n                                        <td class="info-text-cell">\n                                            <div class="info-text" translate="management.analytics.analyzing.title"></div>\n                                            <div class="info-text" translate="management.analytics.analyzing.date" translate-values="{ date: startedOn }" ng-if="allData.data && allData.data.rows && allData.data.rows.length > 0"></div>\n\n                                        </td>\n                                        <td>\n                                            <div class="info-desc" translate="management.analytics.analyzing.desc"></div>\n                                        </td>\n                                    </tr>\n                                </table>\n                            </div>\n\n                            <div class="analyzing-data-no-data" ng-if="!allData.data.rows || allData.data.rows.length == 0 ">\n                                <span class="no-graph-image no-graph-image-class"></span>\n                                <div class="no-data-available" translate="">management.analytics.data.not.available</div>\n                            </div>\n\n                        </div>\n\n                        <div class="analytics-data-analysis" ng-if="!models.dataLoading && allData.data && allData.data.rows && allData.data.rows.length > 0 ">\n                            <div class="info-box" ng-if="recommendation">\n                                <table class="info-table">\n                                    <tr>\n                                        <td><span class="info-icon enabled-lightbulb-blue-image lightbulb-icon lightbulb-adj"></span></td>\n                                        <td class="info-text-cell">\n                                            <div class="info-text" translate="management.analytics.data.info.recommendation.title"></div>\n                                            <div class="info-text" translate="management.analytics.data.info.updated.date" translate-values="{ date: updatedOn }"></div>\n                                        </td>\n                                        <td>\n                                            <div class="info-desc" translate="management.analytics.data.info.recommendation.desc" translate-values="{ range: numDays, rec: recommendation }"></div>\n                                        </td>\n                                    </tr>\n                                </table>\n                            </div>\n\n                            <div class="info-box-storage" ng-repeat="(key, value) in allData.data.all">\n                                <table class="info-table-storage">\n                                    <tr>\n                                        <td class="info-cell-type" translate="{{getClassNameTranslation(key)}}"></td>\n                                        <td class="info-cell-size">\n                                            <div class="info-type" translate="management.analytics.data.size"></div>\n                                            <div class="info-date" translate="management.analytics.data.date" translate-values="{date: getMostRecentDate(value)}"></div>\n                                            <div class="info-gb">{{getMostRecentTotalSize(value)}}</div>\n                                        </td>\n                                        <td class="info-cell-size">\n                                            <div class="info-type" translate="management.analytics.data.retrieved"></div>\n                                            <div class="info-date" translate="management.analytics.data.for" translate-values="{date: getMostRecentDate(value)}"></div>\n                                            <div class="info-gb">{{getMostRecentDataRetrieved(value)}}</div>\n                                        </td>\n                                    </tr>\n                                </table>\n                            </div>\n\n                            <div class="info-question">\n                                <span class="info-icon enabled-lightbulb-blue-image lightbulb-icon-question"></span>\n                                <div class="info-question-text" translate="management.analytics.data.info.retrieved.question">\n                                </div>\n                                <div class="info-storage-select" ng-if="storageOptions">\n                                    <awsui-select items="storageOptions" ng-model="selectedStorageClass.value" ng-change="setSelectedStorageClass()"></awsui-select>\n                                </div>\n                                <div class="info-legend-group">\n                                    <div class="info-legend">\n                                        <div class="info-color-box storage-back"></div>\n                                        <span class="storage-color" translate="storageanalysis.label.storage"></span>\n                                    </div>\n                                    <div class="info-legend">\n                                        <div class="info-color-box data-back"></div>\n                                        <span class="data-color" translate="storageanalysis.label.dataRetrieved"></span>\n                                    </div>\n                                </div>\n                            </div>\n\n                            <div class="info-area-chart">\n                                <analytics-area-chart chart-id="storageAreaChartId" data="graphData.area" height="360" xmin="xmin" xmax="xmax"></analytics-area-chart>\n                            </div>\n\n                            <div class="info-question">\n                                <span class="info-icon enabled-lightbulb-blue-image lightbulb-icon-question"></span>\n                                <div class="info-question-text" translate="management.analytics.data.info.percentage.question">\n                                </div>\n\n                                <div class="info-per-legend">\n                                    <div class="info-dotted-line"></div>\n                                    <div class="info-per-text" translate="management.analytics.data.info.retrieved.label"></div>\n                                </div>\n                            </div>\n\n                            <div class="info-percentage-graph">\n                                <storage-console-line-chart chartid="percentageGraphId" data="graphData.percentage" heading="percentageGraphHeading" isxdate="true" xticks="8" xid="percentageGraphXValue" yid="percentageGraphYValue" xmin="xmin" xmax="xmax" totalwidth="940" totalheight="300" dotted="\'3px\'" color="\'#9066A7\'" pattern="\'3, 3\'" template-url="partials/storageConsoleLineChartAnalytics.html">\n                                </storage-console-line-chart>\n                                <hr class="hr-props">\n                            </div>\n\n                            <div class="info-age-tiers">\n                                <object-frequency-analytics data="allData.data" storage-class="selectedStorageClass"></object-frequency-analytics>\n                            </div>\n                        </div>\n\n                    </div>\n                </div>\n            </div>\n\n        </td>\n    </tr>\n</table>');a.put("/s3/partials/barchartcard.html",'<div class="bar-chart-card" ng-style="{width: width + \'px\', height: height + \'px\'}">\n    <div class="card-header-text">{{chartTitle}}</div>\n\n    <div id="chart"></div>\n    <hr ng-style="{\'background-color\': colors.row || \'gray\'}" class="line">\n    <div id="footer-layout">\n        <table>\n            <tr ng-if="footer.title">\n                <td class="footer-title">\n                    {{footer.title}}\n                </td>\n            </tr>\n            <tr ng-if="footer.text">\n                <td class="footer-text">\n                    {{footer.text}}\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>');a.put("/s3/partials/breadcrumbs.html",'<div class="breadcrumbs-container">\n    <span class="s3-logo-icon logo"></span>\n    <awsui-breadcrumb-group class="breadcrumbs" ng-if="!condenseBreadcrumbs">\n        <awsui-breadcrumb-item text="{{ \'breadcrumbs.amazons3\' | translate }}" href="/s3/home?region={{currentRegion}}"></awsui-breadcrumb-item>\n        <awsui-breadcrumb-item ng-repeat="object in objects" text="{{object.name}}" href="{{object.path}}"></awsui-breadcrumb-item>\n    </awsui-breadcrumb-group>\n    <awsui-breadcrumb-group class="breadcrumbs" ng-if="condenseBreadcrumbs">\n        <awsui-breadcrumb-item text="{{ \'breadcrumbs.amazons3\' | translate }}" href="/s3/buckets?region={{currentRegion}}"></awsui-breadcrumb-item>\n        <awsui-breadcrumb-item text="...." href=""></awsui-breadcrumb-item>\n        <awsui-breadcrumb-item text="{{objects[objects.length-2].name}}" href="{{objects[objects.length-2].path}}"></awsui-breadcrumb-item>\n        <awsui-breadcrumb-item text="{{objects[objects.length-1].name}}"></awsui-breadcrumb-item>\n    </awsui-breadcrumb-group>\n</div>');a.put("/s3/partials/bucketaccelerate.html",'<card card-id="scrollCardId" card-summary-obj="cardSummaryObj" is-open="cardOpen" ng-class="{ \'card-disable-bolt-water-mark\': !cardOpen, \'card-enable-bolt-water-mark\': cardOpen }">\n    <div transclude-name="header">\n        <span translate="bucketproperties.label.accelerate"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="cancelBucketAccelerate($event)"></div>\n    </div>\n    <div transclude-name="content">\n        <p ng-if="!cardOpen" class="bucketproperties-summary" translate="bucketproperties.summary.accelerate"></p>\n        <p class="accelerate-endpoint" ng-if="cardOpen" translate="bucketproperties.acceleration.endpoint" translate-values="{ endpoint: \'{{accelerate.endpoint}}\' }"></p>\n        <p class="accelerate-description" ng-if="cardOpen" translate="bucketproperties.description.accelerate"></p>\n        <a class="accelerate-compare" ng-if="cardOpen" target="_blank" href="{{comparisonEndpoint}}" translate="bucketproperties.compare.accelerate"></a>\n        <div ng-if="cardOpen" class="padding-bottom-20"></div>\n        <div class="awsui-container" ng-if="cardOpen">\n            <awsui-radio-group ng-model="accelerate.selectedValue">\n                <div class="awsui-row card-content-row">\n                    \n                    <awsui-radio-button class="enableAccelerate" value="Enabled" ng-model="accelerate.selectedValue" label="{{ \'bucketproperty.enabled\' | translate }}"></awsui-radio-button>\n                </div>\n                <div class="awsui-row card-content-row">\n                    <awsui-radio-button class="suspendAccelerate" value="Suspended" ng-model="accelerate.selectedValue" label="{{ \'bucketproperty.suspended\' | translate }}">\n                    </awsui-radio-button>\n                </div>\n            </awsui-radio-group>\n        </div>\n        <awsui-alert type="error" class="error-alert" ng-if="error && cardOpen"> {{ error }}</awsui-alert>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{learnMoreLink}}" translate="">learn.more</a>\n        <div ng-if="cardOpen" class="padding-bottom-20"></div>\n    </div>\n    <div transclude-name="footer">\n        <div class="bucket-properties-buttons" ng-if="cardOpen">\n            <awsui-button id="cancel-bucket-accelerate" ng-click="cancelBucketAccelerate($event)" text="{{ \'button.cancel\' | translate }}"></awsui-button>\n            <awsui-button id="save-bucket-accelerate" ng-click="saveBucketAccelerate($event)" text="{{ \'button.save\' | translate }}" variant="primary" loading="saving"></awsui-button>\n        </div>\n    </div>\n</card>');a.put("/s3/partials/bucketconfirmationmodal.html",'<div class="confirmation-modal">\n    <dialog-modal class="bucket-confirmation-modal" is-open="isOpen" close-callback="closeConfirmationModal()" header-title="headerTitle">\n        <div transclude-name="content">\n            <awsui-alert class="confirmation-warning" visible="!showContinue" type="warning"> {{ warningMessage }} </awsui-alert>\n            <p class="label"> {{ \'confirmationmodal.typebucketname\' | translate }} </p>\n            <awsui-textfield ng-keydown="compareBucketNames($event)" class="bucket-name" ng-model="confirmationModal.bucketName"></awsui-textfield>\n            <awsui-alert class="confirmation-warning" type="warning" dismissable="true" ng-if="isDelete">\n                {{ \'confirmationmodal.uniquebucketwarning\' | translate }}\n            </awsui-alert>\n            <awsui-alert class="confirmation-warning" type="error" dismissible="false" visible="showIncorrectBucketError">\n                {{ \'confirmationmodal.incorrectbucketerror\' | translate }}\n            </awsui-alert>\n        </div>\n        <div transclude-name="footer">\n            <awsui-button id="cancel" text="{{ \'createbucketmodal.footer.cancel\' | translate }}" variant="normal" click="closeConfirmationModal()"></awsui-button>\n            <awsui-button id="save" click="saveOperation()" variant="primary" text="{{ \'confirmationmodal.footer.confirm\' | translate }}" class="awsui-util-f-r primary-button">\n            </awsui-button>\n        </div>\n    </dialog-modal>\n</div>');a.put("/s3/partials/bucketdetails.html",'<div class="header-section watermark-wrapper">\n    <div class="watermark-bucket watermark"></div>\n    <breadcrumbs></breadcrumbs>\n</div>\n<awsui-tabs class="bucket-tabs bucket-details-tabs" tabs="tabs" ng-model="selectedTab" ng-switch="selectedTab" ng-click="setTabParam(selectedTab)">\n    <div ng-switch-default="">\n        <ng-include src="\'/s3/partials/objects.html\'"></ng-include>\n    </div>\n    <div ng-switch-when="properties">\n        <ng-include src="\'/s3/partials/bucketproperties.html\'"></ng-include>\n    </div>\n    <div ng-switch-when="permissions">\n        <bucketpermissions></bucketpermissions>\n    </div>\n    <div ng-switch-when="management" fac-id="s3-si">\n        <storage-management></storage-management>\n    </div>\n</awsui-tabs>\n<div operation-manager="" selected-tab="selectedTab"></div>');a.put("/s3/partials/bucketlifecycle.html",'<div>\n    <div class="action-strip">\n        <awsui-button id="add-rule" class="action-button-spacing" text="{{\'bucketlifecycle.label.addlifecyclepolicy\' | translate}}" icon="plus" click="showLifecycleModalForCreate()" variant="primary"></awsui-button>\n        <awsui-button id="edit-rule" class="action-button-spacing" text="{{ \'bucketlifecycle.label.edit\' | translate }}" data-disabled="isEdit" click="showLifecycleModalForEdit()"></awsui-button>\n        <awsui-button class="action-button-spacing" text="{{ \'bucketlifecycle.label.delete\' | translate }}" data-disabled="isDelete" click="showConfirmationModal(\'deletePolicy\')"></awsui-button>\n        <action-dropdown class="bucket-more-dropdown" text="{{ \'bucketlifecycle.label.more\' | translate }}" items="moreOptions"></action-dropdown>\n    </div>\n    <empty-state ng-if="showEmptyScreen" open-modal="showLifecycleModalForCreate" type="\'lifecycle\'"></empty-state>\n    <div ng-if="!showEmptyScreen" class="columbia-table">\n        <table class="table table-condensed">\n            <thead>\n            <tr class="black-header">\n                <th></th>\n                <th><a translate="bucketlifecycle.policy"></a></th>\n                <th><a translate="bucketlifecycle.applied"></a></th>\n                <th><a translate="bucketlifecycle.currentversiontransition"></a></th>\n                <th><a translate="bucketlifecycle.previousversionaction"></a></th>\n            </tr>\n            </thead>\n            <tbody>\n            <tr ng-class="{\'row-selected\' : rule.selected, \'row-hover\': hoverRule && !rule.selected}" ng-mouseenter="hoverRule = true" ng-mouseleave="hoverRule = false" ng-repeat="rule in lifecycle.listViewRules" ng-click="selectRule(rule, $index); $event.stopPropagation();">\n                <td><span class="lifecycle-rule-status enabled-icon" ng-if="rule.Status === \'Enabled\'"></span>\n                    <span class="lifecycle-rule-status disabled-icon" ng-if="rule.Status === \'Disabled\'"></span>\n                </td>\n                <td> {{ rule.ID }} </td>\n                <td> {{ rule.Prefix }} </td>\n                <td> {{ rule.transitionsList }} </td>\n                <td> {{ rule.prevActions }} </td>\n            </tr>\n            </tbody>\n        </table>\n    </div>\n    <lifecycle-modal is-open="isLifecycleModalOpen" selected-rule="lifecycle.selectedRule" rule-to-be-edited="lifecycle.ruleToBeEdited" disable-edit="isEdit" disable-delete="isDelete" is-editing="forEdit" initial-response="lifecycleConfiguration.Rules" initialize="initialize" initial-xml="lifecycle.initialXML" more-options="moreOptions" operation="operation"></lifecycle-modal>\n    <lifecycle-confirmation-modal selected-rule="lifecycle.selectedRule" rule-to-be-edited="lifecycle.ruleToBeEdited" disable-edit="isEdit" disable-delete="isDelete" list-rules="lifecycle.listViewRules" header-title="headerTitle" is-open="isConfirmationModalOpen" action-type="actionType" warning-message="warningMessage" initial-xml="lifecycle.initialXML" selected-rule-index="lifecycle.selectedRuleIndex" initial-response="lifecycleConfiguration.Rules" operation="operation" initialize="initialize" more-options="moreOptions"></lifecycle-confirmation-modal>\n</div>');a.put("/s3/partials/bucketlogging.html",'<card card-summary-obj="cardSummaryObj" card-id="scrollCardId" is-open="cardOpen" ng-class="{ \'card-disable-logging-water-mark\': !cardOpen, \'card-enable-logging-water-mark\': cardOpen }">\n    <div transclude-name="header">\n        <span translate="bucketproperties.logging.label.logging"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="cancelBucketLogging($event)"></div>\n    </div>\n    <div transclude-name="content">\n        <p class="bucketproperties-summary" ng-if="!cardOpen" translate="bucketproperties.logging.summary"></p>\n        <div class="awsui-container" ng-if="cardOpen">\n            <div class="awsui-row card-content-row">\n                <awsui-radio-group ng-model="logging.selectedValue">\n                    <awsui-radio-button value="enable" ng-model="logging.selectedValue" label="{{ \'bucketproperties.logging.label.enablelogging\' | translate }}"></awsui-radio-button>\n                </awsui-radio-group>\n            </div>\n            <div ng-if="logging.selectedValue === \'enable\'">\n                <div class="awsui-row card-content-row">\n                    <label class="target-value" translate="bucketproperties.logging.label.targetbucket"></label>\n                </div>\n                <div class="awsui-row card-content-row">\n                    <awsui-select class="logging-select target-value" items="logging.targetBucketOptions" placeholder="{{ \'bucketproperties.logging.placeholder.selectbucket\' | translate }}" ng-model="logging.targetBucket"></awsui-select>\n                </div>\n                <div class="awsui-row card-content-row">\n                    <label class="target-value" translate="bucketproperties.logging.label.targetprefix"></label>\n                </div>\n                <div class="awsui-row card-content-row">\n                    <input type="text" class="properties-placeholder" ng-model="logging.targetPrefix" placeholder="{{ \'bucketproperties.logging.placeholder.entertargetprefix\' | translate }}">\n                    <awsui-tooltip text="{{\'bucketproperties.logging.targetprefix.tooltip\' | translate}}" position="top" size="small">\n                        <i class="awsui-icon alert-info-circle"></i>\n                    </awsui-tooltip>\n                </div>\n            </div>\n            <div class="awsui-row card-content-row">\n                <awsui-radio-group ng-model="logging.selectedValue">\n                    <awsui-radio-button value="disable" ng-model="logging.selectedValue" label="{{ \'bucketproperties.logging.label.disablelogging\' | translate }}">\n                    </awsui-radio-button>\n                </awsui-radio-group>\n            </div>\n        </div>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n        <awsui-alert type="error" class="error-alert" readonly="readonly" ng-if="loggingError && cardOpen">{{loggingErrorMessage}}</awsui-alert>\n    </div>\n    <div transclude-name="footer">\n        <div id="logging-properties-buttons" ng-if="cardOpen" class="bucket-properties-buttons">\n            <awsui-button id="cancel-bucket-logging" ng-click="cancelBucketLogging($event)" text="{{ \'button.cancel\' | translate }}"></awsui-button>\n            <awsui-button id="save-bucket-logging" ng-click="saveBucketLogging($event)" text="{{ \'button.save\' | translate }}" variant="primary" loading="saving"></awsui-button>\n        </div>\n    </div>\n</card>');a.put("/s3/partials/bucketpermissions.html",'<div>\n    <div class="permissions-header">\n        <awsui-button-group class="si-category-buttons">\n            <awsui-tooltip id="acl-button-tooltip" text="{{\'permissions.types.tooltip.acl\'|translate}}" position="top">\n                <awsui-button id="permission-acl-button" class="permission-action-button" text="{{ \'permissions.types.acl\' | translate }}" ng-click="showView(S3Constants.BUCKET_PERMISSION_TYPE.ACL)" variant="{{ permissions.selectedItem.value === S3Constants.BUCKET_PERMISSION_TYPE.ACL ? \'primary\' : \'\' }}"></awsui-button>\n            </awsui-tooltip>\n            <awsui-tooltip text="{{\'permissions.types.tooltip.policy\'|translate}}" position="top">\n                <awsui-button id="permission-policy-button" class="permission-action-button" text="{{ \'permissions.types.policy\' | translate }}" variant="{{ permissions.selectedItem.value === S3Constants.BUCKET_PERMISSION_TYPE.POLICY ? \'primary\' : \'\' }}" ng-click="showView(S3Constants.BUCKET_PERMISSION_TYPE.POLICY)"></awsui-button>\n            </awsui-tooltip>\n            <awsui-tooltip text="{{\'permissions.types.tooltip.cors\'|translate}}" position="top">\n                <awsui-button id="permission-cors-button" class="permission-action-button" text="{{ \'permissions.types.cors\' | translate }}" variant="{{ permissions.selectedItem.value === S3Constants.BUCKET_PERMISSION_TYPE.CORS ? \'primary\' : \'\' }}" ng-click="showView(S3Constants.BUCKET_PERMISSION_TYPE.CORS)"></awsui-button>\n            </awsui-tooltip>\n        </awsui-button-group>\n    </div>\n    <div class="permissions-container" ng-switch="permissions.selectedItem.value">\n        <awsui-alert visible="error" class="block permissions-error small-top-margin" type="error" dismissible="false" header="{{ \'permissions.error.header\' | translate }}"> {{ error }}\n        </awsui-alert>\n        <table class="editor-header">\n            <tr>\n                <td ng-switch-when="policy">\n                    <div class="description-container">\n                        <span class="ace-editor-title">{{ \'permissions.policy.header\' | translate}} </span>\n                        <span translate="permissions.label.bucketarn"></span>\n                        <span>{{bucketARN}}</span>\n                        <div class="ace-editor-description" translate="permissions.policy.description"></div>\n                    </div>\n                </td>\n                <td ng-switch-when="cors" class="permissions-editor">\n                    <div class="description-container">\n                        <span class="ace-editor-title">{{ \'permissions.cors.header\' | translate}} </span>\n                        <span translate="permissions.label.bucketarn"></span>\n                        <span> {{ bucketARN }}</span>\n                        <div class="ace-editor-description" translate="permissions.cors.description"></div>\n                    </div>\n                </td>\n                <td class="editor-buttons" ng-if="permissions.selectedItem.value===\'policy\' || permissions.selectedItem.value===\'cors\'">\n                    <awsui-button id="delete" variant="normal" text="{{ \'permissions.button.delete\' | translate }}" class="awsui-util normal-button" click="deletePermission()" loading="isDeleting" data-disabled="isSaving || isDeleting || (permissions.selectedItem.value===\'policy\' && !policy|| permissions.selectedItem.value===\'cors\' && !cors)">\n                    </awsui-button>\n                    <awsui-button id="cancel" variant="normal" text="{{ \'permissions.button.cancel\' | translate }}" class="awsui-util normal-button" click="cancel()" data-disabled="isSaving || isDeleting || (permissions.selectedItem.value===\'policy\' && !policyChanged || permissions.selectedItem.value===\'cors\' && !corsChanged)">\n                    </awsui-button>\n                    <awsui-button id="save-code" variant="primary" text="{{ \'permissions.button.save\' | translate }}" class="awsui-util normal-button" click="save()" loading="isSaving" data-disabled="disableSave()">\n                    </awsui-button>\n                </td>\n            </tr>\n        </table>\n\n        <div ng-if="permissions.selectedItem.value===\'policy\'" class="permissions-editor">\n            <div id="policy-editor" ui-ace="{ useWrapMode : true, showGutter: true, mode: \'json\', firstLineNumber: 1, onLoad: policyEditorLoaded, onChange: policyEditorChanged }" class="code">\n            </div>\n            <table class="editor-docs-button">\n                <tr>\n                    <td>\n                        <awsui-button id="documentation" variant="link" text="{{ \'permissions.button.documentation\' | translate }}" class="awsui-util link-button" target="_blank" href="{{policyDocLink}}">\n                        </awsui-button>\n                    </td>\n                    <td>\n                        <awsui-button id="policy-generator" variant="link" text="{{ \'permissions.button.policygenerator\' | translate }}" class="awsui-util link-button" target="_blank" href="{{policyGenLink}}">\n                        </awsui-button>\n                    </td>\n                </tr>\n            </table>\n        </div>\n        <div ng-if="permissions.selectedItem.value===\'cors\'" class="permissions-editor">\n            <div id="cors-editor" ui-ace="{ useWrapMode : true, showGutter: true, mode: \'xml\', firstLineNumber: 1, onLoad: corsEditorLoaded, onChange: corsEditorChanged }" class="code"></div>\n            <div class="editor-docs-button">\n                <awsui-button id="cors-documentation" variant="link" text="{{ \'permissions.button.documentation\' | translate }}" class="awsui-util link-button" target="_blank" href="{{corsDocLink}}">\n                </awsui-button>\n            </div>\n        </div>\n        <div ng-switch-default="">\n            <acl permission-obj="permissionObj" put-acl="putAcl" error="error" bucket="bucket" is-bucket-permission="true"></acl>\n        </div>\n    </div>\n</div>');a.put("/s3/partials/bucketproperties.html",'<div class="card-enabled-icon"></div>\n<div class="awsui-grid">\n    <div class="awsui-container properties-cards">\n        <hr class="properties-headers-line-space">\n        <div class="wrapper awsui-row">\n            <bucket-versioning id="bucket-versioning-card" card-open="toggleVersioning" versioning="versioning"></bucket-versioning>\n            <bucket-logging id="bucket-logging-card" card-open="toggleLogging" logging="logging"></bucket-logging>\n            <bucket-website id="bucket-website-card" card-open="toggleWebsite" website="website"></bucket-website>\n        </div>\n        <hr class="properties-headers-line-space">\n        <div class="properties-headers">\n            <h1 translate="bucketproperties.title.advancedsettings"></h1>\n        </div>\n        <div class="wrapper awsui-row">\n            <bucket-tagging id="bucket-tagging-card" card-open="toggleTagging" bucket-tags="bucketTags.tagSet"></bucket-tagging>\n            <bucket-replication id="bucket-crr-card" fac-id="s3-crr" card-open="toggleCRR" versioning-status="versioning.selectedValue"></bucket-replication>\n            <bucket-accelerate id="bucket-accelerate-card" fac-id="s3-x-acceleration" card-open="toggleAccelerate"></bucket-accelerate>\n            <events id="bucket-events-card" card-open="toggleEvents"></events>\n        </div>\n    </div>\n</div>');a.put("/s3/partials/bucketreports.html",'<div class="inventory-reports">\n    <div ng-if="!finishedLoading && !showError" class="awsui-spinner awsui-spinner-large" style="margin: 10% 50%">\n    </div>\n    <div ng-if="showError && reportsTable.length === 0">\n        <awsui-alert type="error" visible="showError">{{ errorMessage }}</awsui-alert>\n    </div>\n    <div class="empty-object-inventory" ng-if="reportsTable.length === 0 && finishedLoading && !showError">\n        <span class="no-reports-enabled" translate="">report.emptymessage</span>\n        <div class="no-inventory-reports-icon"><img src="/s3/img/no-inventory-reports.png"></div>\n        <div class="inventory-header" translate="">report.inventory</div>\n        <div class="inventory-additional-information" translate="">report.additionalInformation</div>\n        <awsui-button variant="link" icon="plus" text="{{ \'report.button.add\' | translate }}" click="addRow($event)"></awsui-button>\n    </div>\n    <div ng-if="reportsTable.length > 0 && finishedLoading" transclude-name="content">\n        <awsui-button disabled="isAdding || isEditingRow" variant="primary" icon="plus" text="{{ \'report.button.add\' | translate }}" click="addRow($event)"></awsui-button>\n        <awsui-button disabled="reportsTable.length === 0 || isAdding || isEditingRow || selectedRowIndex < 0" variant="normal" text="{{ \'report.button.edit\' | translate }}" click="editRow($event)">\n        </awsui-button>\n        <awsui-button disabled="reportsTable.length === 0 || isAdding || isEditingRow || selectedRowIndex < 0" variant="normal" text="{{ \'events.button.delete\' | translate }}" click="deletePressed()" loading="isDeleting">\n        </awsui-button>\n        <div class="events-table">\n            <div class="events-table">\n                <awsui-radio-group ng-model="radioValue.value" ng-disabled="true">\n                    <table class="table table-condense reports-table table-borderless">\n                        <thead>\n                        <tr>\n                            <td class="report-radio"></td>\n                            <td translate="">report.label.name</td>\n                            <td translate="">report.label.filter</td>\n                            <td>\n                                {{\'report.label.bucket\' | translate}}\n                                <awsui-tooltip text="{{ \'report.bucketPolicy.tooltip\' | translate }}" position="right" size="small">\n                                    <i class="awsui-icon alert-info-circle"></i>\n                                </awsui-tooltip>\n                            </td>\n                            <td translate="">report.label.prefix</td>\n                            <td translate="">report.label.freq</td>\n                        </tr>\n                        </thead>\n\n                        <tr ng-if="flags.displayDelayWarning">\n                            <td colspan="6">\n                                <awsui-alert id="inventory-delay-alert" dismissible="true" ng-click="resetDelayWarning()" visible="flags.displayDelayWarning" header="{{\'report.warning.header\' | translate}}">\n                                    <span translate="">report.warning.text</span>\n                                </awsui-alert>\n                            </td>\n                        </tr>\n\n                        <tbody ng-repeat="row in reportsTable">\n                            <tr ng-if="row.isEditing">\n                                <td colspan="6">\n                                    <awsui-alert dismissible="false" id="inventory-policy-alert">\n                                        <span translate=""> report.bucketPolicy.tooltip</span>\n                                        <span>\n                                            <a href="{{getLearnMoreLink(\'configure-inventory\')}}" target="_blank" translate="">learn.more</a>\n                                        </span>\n                                    </awsui-alert>\n                                </td>\n                            </tr>\n                            <tr ng-if="row.isEditing">\n                                <td></td>\n                                <td class="report-input input-td">\n                                    <awsui-control-group class="label-text" validation-message="{{row.invalidNameMessage}}">\n\n                                        <awsui-textfield id="report-input" ng-class="{\'inventory-input-text\' : !row.nameError, \'verification-error\': row.nameError}" placeholder="{{\'report.placeholder.name\' | translate}}" ng-keyup="validateName(row)" ng-model="row.name"></awsui-textfield>\n                                    </awsui-control-group>\n                                </td>\n\n                                <td class="input-td">\n                                    <awsui-control-group class="label-text">\n                                        <span dom-region="validationMessage" ng-if="filterInfo">\n                                            <span translate="" translate-values="{ bucket1 : bucketName + \'/\' + filterInfo, bucket2: bucketName + filterInfo }">prefixsearch.validation.slash.start.warning</span>\n                                        </span>\n                                        <span dom-region="control">\n                                            <awsui-textfield class="inventory-input-text" placeholder="{{\'report.placeholder.filter\' | translate}}" ng-keyup="validatePrefix()" ng-model="row.filter"></awsui-textfield>\n                                        </span>\n                                    </awsui-control-group>\n                                </td>\n                                <td class="input-td">\n                                    <awsui-control-group class="label-text" validation-message="{{row.bucketUnknown}}">\n                                        <bucket-selector class="bucket-selector-object-inventory" selected-report="row" show-bucket-name-only="true" choose-accounts="true" editable="true" same-region="true" is-open="selectingBucket.selected">\n                                    </bucket-selector></awsui-control-group>\n                                </td>\n                                <td class="input-td">\n                                    <awsui-control-group class="label-text">\n                                        <span dom-region="validationMessage" ng-if="prefixInfo">\n                                            <span translate="" translate-values="{ bucket1 : bucketNamePre + \'/\' + prefixInfo, bucket2: bucketNamePre + prefixInfo }">prefixsearch.validation.slash.start.warning</span>\n                                        </span>\n                                        <span dom-region="control">\n                                            <awsui-textfield class="inventory-input-text" placeholder="{{\'report.placeholder.prefix\' | translate}}" ng-keyup="validatePrefix()" ng-model="row.prefix" data-disabled="!row.bucket"></awsui-textfield>\n                                         </span>\n                                    </awsui-control-group>\n                                </td>\n                                <td class="frequency-input input-td">\n                                    <awsui-control-group class="label-text">\n                                        <awsui-select items="freqTypes" class="select-type-dropdown" ng-model="row.freq" ng-click="$event.stopPropagation()"></awsui-select>\n                                    </awsui-control-group>\n                                </td>\n                            </tr>\n                            <tr ng-if="row.isEditing">\n                                <td></td>\n                                <td colspan="5" ng-if="!showAdvancedSettingsDropdown"><awsui-button icon="plus" text="{{ \'bucketproperties.title.advancedsettings\' | translate }}" variant="link" ng-click="toggleAdvancedSettingsDropdown()"></awsui-button></td>\n                                <td colspan="5" ng-if="showAdvancedSettingsDropdown"><awsui-button text="- {{ \'bucketproperties.title.advancedsettings\' | translate }}" variant="link" ng-click="toggleAdvancedSettingsDropdown()"></awsui-button>\n                                    <table>\n                                        <tbody>\n                                        <tr>\n                                            <th class="advanced-header">\n                                                <div class="advanced-header-label" translate="">report.label.versions</div>\n                                            </th>\n                                            <td>\n                                                <awsui-control-group class="label-text">\n                                                    <awsui-select items="versionTypes" class="select-type-dropdown" ng-model="row.versioning" ng-click="$event.stopPropagation()"></awsui-select>\n                                                </awsui-control-group>\n                                            </td>\n                                        </tr>\n                                        <tr>\n                                            <th class="advanced-header">\n                                                <div class="advanced-header-label" translate="">report.label.optional</div>\n                                            </th>\n                                            <td class="inventory-optional-fields">\n                                                <awsui-control-group class="label-text">\n                                                    <awsui-checkbox ng-model="row.optional.Size" checked="row.optional.Size">{{\'report.optional.size\' | translate}}</awsui-checkbox>\n                                                    <awsui-checkbox ng-model="row.optional.LastModifiedDate" checked="row.optional.LastModifiedDate">{{\'report.optional.modified\' | translate}}</awsui-checkbox>\n                                                    <awsui-checkbox ng-model="row.optional.StorageClass" checked="row.optional.StorageClass">{{\'report.optional.storageclass\' | translate}}</awsui-checkbox>\n                                                    <awsui-checkbox ng-model="row.optional.ETag" checked="row.optional.ETag">{{\'report.optional.ETag\' | translate}}</awsui-checkbox>\n                                                    <awsui-checkbox ng-model="row.optional.ReplicationStatus" checked="row.optional.ReplicationStatus">{{\'report.optional.replicationstatus\' | translate}}</awsui-checkbox>\n                                                </awsui-control-group>\n                                            </td>\n                                        </tr>\n                                        </tbody>\n                                    </table>\n                                </td>\n                                <td colspan="4"></td>\n                            </tr>\n                            <tr ng-if="row.isEditing" class="bucket-properties-buttons">\n                                <td></td>\n                                <td colspan="5" class="save-cancel-row">\n                                    <awsui-button text="{{ \'events.button.cancel\' | translate }}" variant="normal" ng-click="!isSaving && cancelPressed($event)" data-disabled="isSaving" class="cancel-button"></awsui-button>\n                                    <awsui-button text="{{ \'events.button.save\' | translate }}" variant="primary" data-disabled="row.nameError || !row.bucket || row.bucketError || selectingBucket.selected || row.bucketUnknown" ng-click="savePressed($event)" loading="isSaving"></awsui-button>\n                                </td>\n                            </tr>\n                            <tr ng-if="row.isEditing && showError">\n                                <td colspan="6">\n                                    <awsui-alert type="error" visible="showError">{{ errorMessage }}</awsui-alert>\n                                </td>\n                            </tr>\n                            <tr ng-if="!row.isEditing">\n\n                                <td class="report-radio">\n                                    <awsui-radio-button ng-click="selectRow($index)" value="{{$index}}" disabled="isEditingRow">\n                                        <td ng-if="!row.isEditing" class="report-row">{{ row.name }}</td>\n                                        <td ng-if="!row.isEditing" class="report-row">{{ getFilterValue(row.filter) }}</td>\n                                        <td class="awsui-icon bucket" ng-if="!row.isEditing" class="report-row">{{ row.bucket }}</td>\n                                        <td ng-if="!row.isEditing" class="report-row">{{ getPrefixValue(row.prefix) }}</td>\n                                        <td ng-if="!row.isEditing">{{ getTranslationValue(row.freq) }}</td>\n                                    </awsui-radio-button>\n                                </td>\n                            </tr>\n\n                        </tbody>\n                    </table>\n                </awsui-radio-group>\n            </div>\n        </div>\n    </div>\n    <div transclude-name="footer">\n\n    </div>\n</div>');a.put("/s3/partials/buckets.html",'<div class="bucket-list">\n    <awsui-alert class="notification dark" type="info" ng-if="notificationShow">\n        <targetmbox></targetmbox>\n        <div class="notificationdoc awsui-util-f-r"><a href="{{docLink}}" target="_blank" class="awsui-icon awsui-icon-link-light" translate="notification.doc"></a></div>\n    </awsui-alert>\n    <div class="buckets-header">\n        <div class="breadcrumbs">\n            <span class="s3-logo-icon logo"></span>\n            <span translate="">lamb.label.allbuckets</span>\n        </div>\n        <div>\n            <hint></hint>\n        </div>\n    </div>\n    <div ng-class="{ \'bucket-nav-wrapper\': bucketList.length > 0, \'bucket-nav-wrapper-empty\': bucketList.length === 0 }">\n        <div class="action-strip" sticky-nav="fix-to-top" sticky-nav-padding-top="140">\n            <table ng-if="bucketList.length > 0" id="search-box" class="search-box">\n                <tr>\n                    <td class="search-icon"><i class="awsui-icon search"></i></td>\n                    <td><input type="text" class="input-field" ng-model="tableFiltering.filter[filterColumn]" ng-keydown="filterKeyDown($event)" placeholder="{{ \'bucketselector.inputfield.placeholder\' | translate }}"></td>\n                </tr>\n            </table>\n            <awsui-button class="bucket-action-strip-button action-button-spacing" icon="plus" text="{{ \'bucketactionstrip.createbucket\' | translate }}" variant="primary" click="showCreateBucketModal()" data-disabled="!isFeatureEnabled(\'s3-cb\')"></awsui-button>\n            <awsui-button class="bucket-action-strip-button action-button-spacing" text="{{ \'bucketactionstrip.deletebucket\' | translate }}" variant="normal" click="deleteBucket()" data-disabled="selectedBucket === undefined || !isFeatureEnabled(\'s3-db\')"></awsui-button>\n            <awsui-button class="bucket-action-strip-button action-button-spacing" text="{{ \'bucketactionstrip.emptybucket\' | translate }}" variant="normal" click="emptyBucket()" data-disabled="selectedBucket === undefined || !isFeatureEnabled(\'s3-eb\')"></awsui-button>\n            <awsui-button class="refresh-button" icon="refresh" variant="standalone-icon" loading="isRefreshing" click="reloadBuckets()"></awsui-button>\n            <div class="num-regions">\n                <label class="counter-literal">{{ numRegions }}</label>\n                <label class="counter-literal counter-text" translate="">lamb.label.regions</label>\n            </div>\n            <div class="num-buckets">\n                <label class="counter-literal">{{ (bucketList | filter:tableFiltering.filter).length || \'-\'}}</label>\n                <label class="counter-literal counter-text" translate="">lamb.label.buckets</label>\n            </div>\n        </div>\n    </div>\n    <awsui-alert class="lamb-error" type="error" header="{{\'error.header\'|translate}}" visible="error">{{error}}</awsui-alert>\n    <div class="columbia-table bucket-table" sticky-nav-padding-top="80">\n        <empty-state ng-if="bucketList.length === 0" open-modal="showCreateBucketModal" type="\'bucket\'"></empty-state>\n        <table ng-if="bucketList.length > 0" class="table table-condensed fix-width-table">\n            <thead>\n            <tr>\n                <th ng-click="setSortOrder(\'Name\')">\n                    <a translate="lamb.column.name"></a>\n                    <span class="sorting-icon" ng-class="{\'sorting-ascending\': sortColumnName===\'Name\' && !reverseSortOrder, \'sorting-descending\': sortColumnName===\'Name\' && reverseSortOrder, \'sorting-disabled\': sortColumnName!==\'Name\'}"></span>\n                </th>\n                <th ng-click="setSortOrder(\'Location\')">\n                    <a translate="lamb.column.region"></a>\n                    <span class="sorting-icon" ng-class="{\'sorting-ascending\': sortColumnName===\'Location\' && !reverseSortOrder, \'sorting-descending\': sortColumnName===\'Location\' && reverseSortOrder, \'sorting-disabled\': sortColumnName!==\'Location\'}"></span>\n                </th>\n                <th ng-click="setSortOrder(\'CreationDate\')">\n                    <a translate="lamb.column.creationdate"></a>\n                    <span class="sorting-icon" ng-class="{\'sorting-ascending\': sortColumnName===\'CreationDate\' && !reverseSortOrder, \'sorting-descending\': sortColumnName===\'CreationDate\' && reverseSortOrder, \'sorting-disabled\': sortColumnName!==\'CreationDate\'}"></span>\n                </th>\n            </tr>\n            </thead>\n            <tbody>\n            <tr class="unselectable" unselectable="on" onselectstart="return false" ng-show="!isLoadingPage" ng-repeat="bucket in bucketList | filter:tableFiltering.filter| orderBy:sortColumnName:reverseSortOrder" ng-click="openConfigPanel(bucket)" class="bucket-row" ng-class="{\'row-selected\': bucket.Name===selectedBucket.Name, \'row-hover\' : hoverBucketRow && bucket.Name!==selectedBucket.Name}" ng-mouseenter="hoverBucketRow = true" ng-mouseleave="hoverBucketRow = false">\n                \n                <td class="awsui-icon bucket truncate" ng-class="{\'awsui-icon-light\': bucket.Name===selectedBucket.Name}"><a class="list-view-item-name" href="" ng-click="selectBucket(bucket.Name)">{{bucket.Name}}</a></td>\n                <td>{{bucket.Location}}</td>\n                <td>{{bucket.CreationDate | date:"medium" }}</td>\n            </tr>\n            <tr>\n                <storage-console-config-panel ng-mouseenter="hoverSidePanelAction(true)" ng-mouseleave="hoverSidePanelAction(false)" class="bucket-side-panel" ng-class="{\'side-config-panel bucket-side-panel\': panelOpen, \'hide-config-panel bucket-side-panel\': panelHide}" panel-open="panelOpen">\n                    <header>\n                        <div class="bucket-side-panel-header">\n                            <div class="truncate side-panel-header-name">{{ selectedBucket.Name }}</div>\n                            <span class="panel-close-icon" ng-click="closePanel()"></span>\n                        </div>\n                        <awsui-button size="small" text="{{ \'bucketproperties.sideconfigpanel.copyarn\' | translate }}" click="copyARNToClipboard($event)"></awsui-button>\n                    </header>\n                    <content>\n                        <ul class="bucket-panel-config-lists" ng-repeat="(configTitle, configContent) in configData" ng-click="moveToBucketTab(configTitle)">\n                            <li>\n                                <div class="subtitle" translate="bucketproperties.{{configTitle}}"></div>\n                                <ul class="bucket-config-panel-content">\n                                    <li ng-repeat="(configKey, configValue) in configContent">\n                                        <div class="truncate config-panel-content-left" translate="bucketproperties.sideconfigpanel.{{configKey}}"></div>\n                                        <div class="truncate config-panel-content-right">{{configValue}}</div>\n                                    </li>\n                                </ul>\n                            </li>\n                        </ul>\n                    </content>\n                </storage-console-config-panel>\n            </tr>\n            </tbody>\n        </table>\n        <div ng-if="isLoadingPage" class="loading-spinner">\n            <span class="awsui-spinner awsui-spinner-large"></span>\n        </div>\n    </div>\n    <div ng-if="!isLoadingPage" operation-manager=""></div>\n    <create-bucket-modal is-open="isCreateBucketModalOpen" bucket-list="bucketList" regions="regions" num-regions="numRegions" load-buckets="loadBuckets"></create-bucket-modal>\n    <bucket-confirmation-modal header-title="bucketConfirmationDetails.headerTitle" is-open="isConfirmationModalOpen" warning-message="bucketConfirmationDetails.warningMessage" operation="bucketConfirmationDetails.operation" is-delete="bucketConfirmationDetails.isDelete">\n    </bucket-confirmation-modal></div>');a.put("/s3/partials/bucketselector.html",'<div id="bucket-selector" class="bucket-selector" clickoutside="" on-click-outside="closeDropDown">\n    <table id="current-displayed-table" class="current-displayed bucket-not-selected" ng-class="{\'bucket-selected\' : copySettingsSourceBucket, \'bucket-not-selected-card\' : editable && !selectedReport.bucketError, \'bucket-not-selected-card-error\' : editable && selectedReport.bucketError}" ng-click="toggleDropDown()">\n        <tr class="current-displayed-row">\n            <td ng-if="copySettingsSourceBucket.Name && !showBucketNameOnly" class="awsui-icon bucket awsui-icon-light bucket-icon"></td>\n            <td class="current-displayed-item">\n                <div class="current-displayed-item truncate">{{ copySettingsSourceBucket.Name || (bucketList.length === 0 &&\n                    emptyText) || getBucketPlaceHolder() }}</div>\n                <table id="selected-bucket" ng-if="copySettingsSourceBucket && !showBucketNameOnly" class="current-displayed-summary">\n                    <tr>\n                        <td class="current-displayed-summary-item"><span translate="bucketselector.summary.label.region"></span><span> {{copySettingsSourceBucket.Location}}</span></td>\n                        <td class="current-displayed-summary-item" ng-if="copySettingsSourceBucket.granteeCount">{{copySettingsSourceBucket.granteeCount}} <span translate="bucketselector.summary.label.grantees"></span></td>\n                        <td class="current-displayed-summary-item" ng-if="copySettingsSourceBucket.propertyCount">{{copySettingsSourceBucket.propertyCount}} <span translate="bucketselector.summary.label.properties"></span></td>\n                    </tr>\n                </table>\n            </td>\n            <td ng-if="!copySettingsSourceBucket" class="bucket-count">\n                <div ng-if="!showBucketNameOnly">\n                    <span translate="bucketselector.label.buckets" translate-values="{ bucketCount: bucketList.length || 0 }"></span>\n                </div>\n            </td>\n            <td ng-if="!copySettingsSourceBucket" class="angle-down awsui-icon awsui-icon-link awsui-icon-big current-displayed-angle"></td>\n            <td ng-if="copySettingsSourceBucket" ng-click="deselectBucket()" class="deselect-icon" ng-class="{\'panel-close-icon\' : !editable, \'awsui-icon caret-down awsui-icon-light\' : editable}"></td>\n        </tr>\n    </table>\n\n    <div class="list-items" ng-if="isOpen" ng-class="{\'list-items-normal\' : !chooseAccounts, \'list-items-choose\': chooseAccounts}">\n        <div ng-if="chooseAccounts">\n            <awsui-radio-group ng-model="account.outside" value="false">\n                <table class="choose-accounts-table">\n                    <tbody>\n                        <tr>\n                            <td class="this-account-button">\n                                <awsui-radio-button value="false">\n                                    <span class="choose-accounts-text">\n                                        {{\'bucketselector.inputfield.currentAccount\' | translate}}\n                                    </span>\n                                </awsui-radio-button>\n                            </td>\n                            <td class="this-account-button">\n                                <awsui-radio-button value="true">\n                                    <span class="choose-accounts-text">\n                                        {{\'bucketselector.inputfield.anotherAccount\' | translate}}\n                                    </span>\n                                </awsui-radio-button>\n                            </td>\n                        </tr>\n                    </tbody>\n                </table>\n            </awsui-radio-group>\n        </div>\n        <table ng-if="!chooseAccounts || account.outside === \'false\'" id="search-box" class="search-box">\n            <tr>\n                <td>\n                    <input type="text" class="input-field" ng-model="tableFiltering.filter[filterColumn]" ng-keydown="filterKeyDown($event)" placeholder="{{ getSearchPlaceHolder() }}"></td>\n                <td><i class="awsui-icon search"></i></td>\n            </tr>\n        </table>\n        <div ng-if="chooseAccounts && account.outside === \'true\'">\n            <table class="choose-bucket-other-account-table">\n                <tbody>\n                    <tr>\n                        <td><span class="enter-another-bucket">{{\'bucketselector.inputfield.label.account\' | translate}}</span></td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <div class="input-text-field">\n                                <awsui-textfield class="test-css" ng-model="tmpValues.accountId" placeholder="{{\'bucketselector.inputfield.enterId.placeholder\' | translate}}"></awsui-textfield>\n\n                            </div>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td><span class="enter-another-bucket">{{\'bucketselector.inputfield.label.bucket\' | translate}}</span></td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <div class="input-text-field bucket-name-field">\n                                <awsui-control-group validation-message="{{tmpValues.regionError}}">\n                                    <awsui-textfield class="test-css" ng-model="tmpValues.bucket" placeholder="{{\'bucketselector.inputfield.bucketName.placeholder\' | translate}}">\n                                    </awsui-textfield>\n                                </awsui-control-group>\n                            </div>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <awsui-button class="another-account-save" text="{{ \'events.button.save\' | translate }}" variant="normal" ng-click="!tmpValues.bucket || savePressed($event)" disabled="!tmpValues.bucket" loading="savingBucket"></awsui-button>\n                        </td>\n                    </tr>\n                </tbody>\n            </table>\n        </div>\n        <div ng-if="!chooseAccounts || account.outside === \'false\'" class="item" ng-repeat="bucket in bucketList | filter:tableFiltering.filter" ng-click="selectBucket(bucket)">\n            <table>\n                <tr>\n                    <td class="arrow" ng-click="toggleBucket($event, bucket)"><div ng-class="bucket.isExpanded ? \'arrow-down\' : \'arrow-right\'"></div></td>\n                    <td><div class="bucket-item">{{bucket.Name}}</div></td>\n                </tr>\n                <tr>\n                    <td></td>\n                    <td>\n                        <table class="bucket-summary">\n                                <tr>\n                                    <td class="bucket-summary-item"><span translate="bucketselector.summary.label.region"></span><span> {{bucket.Location}}</span></td>\n                                    <td ng-if="bucket.granteeCount" class="bucket-summary-item">{{bucket.granteeCount}} <span translate="bucketselector.summary.label.grantees"></span></td>\n                                    <td ng-if="bucket.propertyCount" class="bucket-summary-item">{{bucket.propertyCount}} <span translate="bucketselector.summary.label.properties"></span></td>\n                                </tr>\n                        </table>\n                    </td>\n                </tr>\n            </table>\n            <div class="bucket-content" ng-if="bucket.isExpanded">\n                <p class="bucket-content-title" translate="createbucketmodal.label.permissions"></p>\n                <p class="bucket-content-column-header" translate="createbucketmodal.label.object"></p>\n                <table class="bucket-summary">\n                    <tr>\n                        <td class="bucket-content-value" translate="bucketselector.content.label.read"></td>\n                        <td class="bucket-content-value">{{bucket.permissionCount.READ}} <span translate="bucketselector.summary.label.grantees"></span></td>\n                    </tr>\n                    <tr>\n                        <td class="bucket-content-value" translate="bucketselector.content.label.write"></td>\n                        <td class="bucket-content-value">{{bucket.permissionCount.WRITE}} <span translate="bucketselector.summary.label.grantees"></span></td>\n                    </tr>\n                </table>\n                <p class="bucket-content-column-header" translate="bucketselector.content.label.permissionaccess"></p>\n                <table class="bucket-summary">\n                    <tr>\n                        <td class="bucket-content-value" translate="bucketselector.content.label.read"></td>\n                        <td class="bucket-content-value">{{bucket.permissionCount.READ_ACP}} <span translate="bucketselector.summary.label.grantees"></span></td>\n                    </tr>\n                    <tr>\n                        <td class="bucket-content-value" translate="bucketselector.content.label.write"></td>\n                        <td class="bucket-content-value">{{bucket.permissionCount.WRITE_ACP}} <span translate="bucketselector.summary.label.grantees"></span></td>\n                    </tr>\n                </table>\n                <div class="bucket-content-divider"></div>\n                <p class="bucket-content-title" translate="bucketselector.summary.label.properties"></p>\n                <table class="bucket-summary">\n                    <tr>\n                        <td class="bucket-content-column-header" translate="bucketselector.content.label.versioning"></td>\n                        <td class="bucket-content-column-header" translate="bucketselector.content.label.tags"></td>\n                        <td class="bucket-content-column-header" translate="bucketselector.content.label.logging"></td>\n                    </tr>\n                    <tr>\n                        <td class="bucket-content-value">{{bucket.versioningStatus}}</td>\n                        <td class="bucket-content-value">{{bucket.tagCount}} <span translate="bucketselector.content.label.tags"></span></td>\n                        <td class="bucket-content-value">{{bucket.loggingStatus}}</td>\n                    </tr>\n                </table>\n            </div>\n        </div>\n        <div class="no-matches-found" ng-if="((bucketList | filter:tableFiltering.filter).length == 0)">{{getResultsMessage()}}</div>\n    </div>\n</div>');a.put("/s3/partials/buckettagging.html",'<card card-summary-obj="cardSummaryObj" card-id="scrollCardId" is-open="cardOpen" ng-class="{ \'card-disable-tags-water-mark\': !cardOpen, \'card-enable-tags-water-mark\': cardOpen }">\n    <div transclude-name="header">\n        <span translate="bucketproperties.tagging.label.tags"></span>\n        <div class="card-close-icon" ng-show="cardOpen" ng-click="cancelBucketTagging($event)"></div>\n    </div>\n    <div transclude-name="content">\n        <p class="bucketproperties-summary" ng-show="!cardOpen" translate="bucketproperties.tagging.summary"></p>\n        <table class="tagging-table" ng-if="cardOpen">\n            <tr>\n                <th>\n                    <translate>bucketproperties.tagging.label.key</translate>\n                    <awsui-tooltip text="{{\'bucketproperties.tagging.key.tooltip\' | translate}}" position="right" size="small">\n                        <i class="awsui-icon alert-info-circle"></i>\n                    </awsui-tooltip>\n                </th>\n                <th>\n                    <translate>bucketproperties.tagging.label.value</translate>\n                    <awsui-tooltip text="{{\'bucketproperties.tagging.value.tooltip\' | translate}}" position="right" size="small">\n                        <i class="awsui-icon alert-info-circle"></i>\n                    </awsui-tooltip>\n                </th>\n                <th></th>\n            </tr>\n            <tr ng-repeat="tag in bucketTags.tags">\n                <td><input type="text" ng-model="tag.Key" class="tag-input"></td>\n                <td><input type="text" ng-model="tag.Value" class="tag-input"></td>\n                <td>\n                    <awsui-button class="remove-tag" icon="times-circle" variant="standalone-icon" ng-click="removeTag($index)"></awsui-button>\n                </td>\n            </tr>\n            <tr>\n                <td><awsui-button id="add-bucket-tag" ng-click="addTag()" class="bucket-properties-buttons" text="{{\'bucketproperties.tagging.label.addtag\' | translate}}" icon="plus"></awsui-button></td>\n                <td></td>\n                <td></td>\n            </tr>\n        </table>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n        <awsui-alert type="error" class="error-alert" readonly="readonly" ng-show="tagError && cardOpen">{{ tagErrorMessage }}</awsui-alert>\n    </div>\n    <div transclude-name="footer">\n        <div class="bucket-properties-buttons" ng-if="cardOpen">\n            <awsui-button id="cancel-bucket-tagging" class="bucket-properties-buttons" ng-click="cancelBucketTagging($event)" text="{{ \'button.cancel\' | translate }}"></awsui-button>\n            <awsui-button id="save-bucket-tagging" class="bucket-properties-buttons" ng-click="saveBucketTagging($event)" text="{{ \'button.save\' | translate }}" variant="primary"></awsui-button>\n        </div>\n    </div>\n</card>');a.put("/s3/partials/bucketversioning.html",'<card card-summary-obj="cardSummaryObj" card-id="scrollCardId" is-open="cardOpen" ng-class="{ \'card-disable-version-water-mark\': !cardOpen, \'card-enable-version-water-mark\': cardOpen }">\n    <div transclude-name="header">\n        <span translate="bucketproperties.versioning.label.versioning"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="cancelBucketVersioning($event)"></div>\n    </div>\n    <div transclude-name="content">\n        <p class="bucketproperties-summary" ng-if="!cardOpen" translate="bucketproperties.versioning.summary"></p>\n        <div class="awsui-container" ng-if="cardOpen">\n            <awsui-radio-group ng-model="versioning.selectedValue" change="updateWarningMsg()">\n            <div class="awsui-row card-content-row">\n                \n                <awsui-radio-button class="enableVersioning" value="enable" ng-model="versioning.selectedValue" label="{{ \'bucketproperties.versioning.label.enableversioning\' | translate }}"></awsui-radio-button>\n            </div>\n            <awsui-alert class="bucketversion-warning" visible="versioning.selectedValue === \'enable\' && versioningWarningMsg " type="warning">{{versioningWarningMsg}}</awsui-alert>\n            <div class="awsui-row card-content-row">\n                <awsui-radio-button class="disableVersioning" value="disable" ng-model="versioning.selectedValue" label="{{ \'bucketproperties.versioning.label.disableversioning\' | translate }}">\n                </awsui-radio-button>\n                <p class="disable-versioning-description" translate="bucketproperties.versioning.description.disableversioning"></p>\n                <awsui-alert class="bucketversion-warning" visible="versioning.selectedValue === \'disable\' && versioningWarningMsg " type="warning">{{versioningWarningMsg}}</awsui-alert>\n            </div>\n            </awsui-radio-group>\n        </div>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n        <awsui-alert type="error" class="error-alert" ng-if="versioningError && cardOpen"> {{ versioningErrorMessage }}</awsui-alert>\n    </div>\n    <div transclude-name="footer">\n        <div class="bucket-properties-buttons" ng-if="cardOpen">\n            <awsui-button id="cancel-bucket-versioning" ng-click="cancelBucketVersioning($event)" text="{{ \'button.cancel\' | translate }}"></awsui-button>\n            <awsui-button id="save-bucket-versioning" ng-click="saveBucketVersioning($event)" text="{{ \'button.save\' | translate }}" variant="primary"></awsui-button>\n        </div>\n    </div>\n</card>');a.put("/s3/partials/bucketwebsite.html",'<card card-summary-obj="cardSummaryObj" card-id="scrollCardId" is-open="cardOpen" ng-class="{ \'card-disable-webhost-water-mark\': !cardOpen, \'card-enable-webhost-water-mark\': cardOpen }">\n    <div transclude-name="header">\n        <span translate="bucketproperties.website.label.cardopen"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="cancelBucketWebsite($event)"></div>\n    </div>\n    <div id="bucket-website-card-content" transclude-name="content">\n        <p class="bucketproperties-summary" ng-if="!cardOpen" translate="bucketproperties.website.summary"></p>\n        <div class="awsui-container" ng-if="cardOpen">\n            <div class="awsui-row card-content-row">\n                <span class="endpoint-label" translate="bucketproperties.website.label.endpoint"></span>\n                <span class="region-endpoint"> <a ng-click="openBucketEndpoint()"> {{ bucketEndpoint }}</a></span>\n            </div>\n            <div class="awsui-row card-content-row">\n                <awsui-radio-group ng-model="website.selectedValue">\n                    <awsui-radio-button name="staticWebsite" style="display: inline" value="useBucket" class="website-radio-button" ng-model="website.selectedValue" label="{{ \'bucketproperties.website.label.usethisbuckettohost\' | translate }}"></awsui-radio-button>\n                    <awsui-tooltip text="{{\'bucketproperties.website.usethisbuckettohost.tooltip\' | translate}}" position="right" size="small">\n                        <i class="awsui-icon alert-info-circle"></i>\n                    </awsui-tooltip>\n                    <a class="learn-more-card-open-link" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n                </awsui-radio-group>\n            </div>\n            <div ng-if="website.selectedValue === \'useBucket\'">\n                <div class="awsui-row card-content-row">\n                    <label class="target-value" translate="bucketproperties.website.label.indexdocument"></label>\n                    <awsui-tooltip text="{{\'bucketproperties.website.indexdocument.tooltip\' | translate}}" position="right" size="small">\n                        <i class="awsui-icon alert-info-circle"></i>\n                    </awsui-tooltip>\n                </div>\n                <div class="awsui-row card-content-row">\n                    <input type="text" class="properties-placeholder" ng-model="website.indexDocument" placeholder="{{ websitePlaceholder }}">\n                </div>\n                <div class="awsui-row card-content-row">\n                    <label class="target-value" translate="bucketproperties.website.label.errordocument"></label>\n                    <awsui-tooltip text="{{\'bucketproperties.website.errordocument.tooltip\' | translate}}" position="right" size="small">\n                        <i class="awsui-icon alert-info-circle"></i>\n                    </awsui-tooltip>\n                </div>\n                <div class="awsui-row card-content-row">\n                    <input type="text" class="properties-placeholder" ng-model="website.errorDocument" placeholder="{{ \'bucketproperties.website.placeholder.errordocument\' | translate }}">\n                </div>\n                <div class="awsui-row card-content-row">\n                    <label class="target-value edit-redirection-rules" translate="bucketproperties.website.label.editredirectionrules"></label>\n                    <awsui-tooltip text="{{\'bucketproperties.website.editredirectionrules.tooltip\' | translate}}" position="right" size="small">\n                        <i class="awsui-icon alert-info-circle"></i>\n                    </awsui-tooltip>\n                </div>\n                <div class="awsui-row card-content-row" ng-if="cardOpen">\n                    <div class="bucket-website-content">\n                        <awsui-textarea class="routing-xml" ng-if="cardOpen" ng-model="website.routingXML"></awsui-textarea>\n                    </div>\n                </div>\n            </div>\n            <div class="awsui-row card-content-row">\n                <awsui-radio-group ng-model="website.selectedValue">\n                    <awsui-radio-button name="staticWebsite" style="display: inline" value="redirectRequest" ng-model="website.selectedValue" label="{{ \'bucketproperties.website.label.redirectrequests\' | translate }}">\n                    </awsui-radio-button>\n                    <awsui-tooltip text="{{\'bucketproperties.website.redirectrequests.tooltip\' | translate}}" position="right" size="small">\n                        <i class="awsui-icon alert-info-circle"></i>\n                    </awsui-tooltip>\n                    <a class="learn-more-card-open-link" target="_blank" href="https://docs.aws.amazon.com/console/s3/website-redirect" translate="">learn.more</a>\n                </awsui-radio-group>\n            </div>\n            <div ng-if="website.selectedValue === \'redirectRequest\'">\n                <div class="awsui-row card-content-row">\n                    <label class="target-value" translate="bucketproperties.website.label.targetdomain"></label>\n                </div>\n                <div class="awsui-row card-content-row">\n                    <input type="text" class="properties-placeholder" ng-model="website.targetDomain" placeholder="{{ \'bucketproperties.website.placeholder.targetdomain\' | translate }}">\n                </div>\n                <div class="awsui-row card-content-row">\n                    <label class="target-value" translate="bucketproperties.website.label.redirectrequestprotocol"></label>\n                </div>\n                <div class="awsui-row card-content-row">\n                    <input type="text" class="properties-placeholder" ng-model="website.redirectRequestProtocol" placeholder="{{ \'bucketproperties.website.placeholder.redirectrequestprotocol\' | translate }}">\n                </div>\n            </div>\n            <div class="awsui-row card-content-row">\n                <awsui-radio-group ng-model="website.selectedValue">\n                    <awsui-radio-button name="staticWebsite" value="disable" ng-model="website.selectedValue" ng-if="cardOpen" label="{{ \'bucketproperties.website.label.disablewebsitehosting\' | translate }}">\n                    </awsui-radio-button>\n                </awsui-radio-group>\n            </div>\n        </div>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="https://docs.aws.amazon.com/console/s3/hostingstaticwebsite" translate="">learn.more</a>\n        <awsui-alert type="error" class="error-alert" readonly="readonly" ng-if="websiteError && cardOpen">{{ websiteErrorMessage }}</awsui-alert>\n    </div>\n    <div transclude-name="footer">\n        <div ng-if="cardOpen" class="bucket-properties-buttons">\n            <awsui-button ng-click="cancelBucketWebsite($event)" text="{{ \'button.cancel\' | translate }}"></awsui-button>\n            <awsui-button id="save-bucket-website-hosting" ng-click="saveBucketWebsite($event)" text="{{ \'button.save\' | translate }}" variant="primary"></awsui-button>\n        </div>\n\n        \n            \n            \n            \n        \n    </div>\n</card>');a.put("/s3/partials/card.html",'<div class="card" ng-click="openCard()" ng-class="{ \'cardexpand\' : isOpen }">\n    <div class="card-header">\n        <div class="card-header-wrapper" transclude="header"></div>\n    </div>\n    <div class="card-content">\n        <div class="card-content-wrapper" transclude="content"></div>\n    </div>\n    <div class="card-footer awsui-util-t-r" transclude="footer"></div>\n    <div class="bucket-status-display single-line" ng-if="!isOpen && cardSummaryObj && !cardSummaryObj.isMultiValue">\n        <div class="divide-line"></div>\n        <div class="icon" ng-class="{\'card-disabled-icon\': !cardSummaryObj.isActive, \'card-enabled-icon\': cardSummaryObj.isActive }"></div>\n        <div ng-class="{\'card-status-text-gray\': !cardSummaryObj.isActive, \'card-status-text\': cardSummaryObj.isActive }" translate="{{ cardSummaryObj.isActive ? cardSummaryObj.activeSummary.text : cardSummaryObj.inactiveSummary.text }}"></div>\n    </div>\n    <div class="bucket-status-display" ng-if="!isOpen && cardSummaryObj && cardSummaryObj.isMultiValue">\n        <div class="divide-line"></div>\n        <table class="cardfooter-summary-table" ng-class="{\'multi-lines\' : cardSummaryObj.isActive}">\n            <tr>\n                <td class="icon-column" rowspan="2">\n                    <div class="icon" ng-class="{\'card-disabled-icon\': !cardSummaryObj.isActive, \'card-enabled-icon\': cardSummaryObj.isActive }"></div>\n                </td>\n                <td class="card-summary-valuetitle" ng-class="{\'card-status-text-gray\': !cardSummaryObj.isActive, \'card-status-text\': cardSummaryObj.isActive }" translate="{{ cardSummaryObj.isActive ? cardSummaryObj.activeSummary.text : cardSummaryObj.inactiveSummary.text }}">\n                </td>\n            </tr>\n            <tr>\n                <td><p class="truncate card-summary-value">{{ cardSummaryObj.activeSummary.value  }}</p></td>\n                <td></td>\n            </tr>\n        </table>\n    </div>\n</div>');a.put("/s3/partials/cloudwatch.html",'<table class="metrics-content-table">\n\n    <tr>\n        <td class="metrics-content-cell management-side-panel-color">\n            <div class="select-metrics-side-panel">\n                <span class="awsui-icon awsui-spinner awsui-spinner-large config-spinner" ng-if="models.configLoading"></span>\n                <table class="select-metrics-table" ng-if="!models.configLoading">\n                    <tr>\n                        <td>\n                            <span class="metrics-header">Metrics</span>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <table class="search-box prefix-search-box">\n                                <tbody>\n                                <tr>\n                                    <td class="search-icon"><i class="awsui-icon search"></i></td>\n                                    <td><input type="text" class="input-field ng-pristine ng-valid ng-empty ng-touched" ng-model="models.searchText" ng-keydown="filterKeyDown($event)" placeholder="{{ \'management.search.placeholder\' | translate }}"></td>\n                                </tr>\n                                </tbody>\n                            </table>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td>\n                            <awsui-alert class="save-filter-info-alert" header="{{\'management.metric.info\'|translate}}" dismissible="true" visible="models.addInfoMessage" ng-click="models.addInfoMessage=false">{{ \'management.metrics.statistics.delay\' | translate}}</awsui-alert>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td class="side-panel-row" ng-class="{\'row-highlight\': models.bucketChecked}">\n                            <table border="0px">\n                                <tr>\n                                    <td>\n                                        <div class="row-checkbox">\n                                            <awsui-checkbox checked="models.bucketChecked" data-disabled="false" ng-model="models.bucketChecked" change="getCloudwatchMetrics()"></awsui-checkbox>\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <i class="awsui-icon bucket buckets-bucket-icon" ng-class="{\'awsui-icon-light\': models.bucketChecked}"></i>\n                                    </td>\n                                    <td>\n                                        <div class="buckets-name" ng-class="{\'bucket-selected\': models.bucketChecked}">\n                                            {{ bucketName }}\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <span class="awsui-icon awsui-icon-link pencil buckets-cog" ng-class="{\'awsui-icon-light\': models.bucketChecked}" ng-click="configureMetrics()"></span>\n                                    </td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n                    <tr ng-if="models.toggleMetricsConfig">\n                        <td class="bucket-dropdown-config dark">\n                            <div class="new-filter-params">\n                                <div class="select-metrics-row">\n                                    <div class="select-metrics-text" translate="management.metrics.side.select.select.info">\n                                    </div>\n                                    <div class="select-metrics-learn-more dark">\n                                        <a href="{{ getLearnMoreLink(\'configure-metrics-filter\') }}" target="_blank" class="ng-binding" translate="">learn.more</a>\n                                    </div>\n                                </div>\n\n                                <div class="list-all-metrics">\n                                    <div ng-repeat="metricType in metricTypes">\n                                        <div class="expandable-metrics-dropdown" ng-model="collapsed" ng-init="collapsed=true" data-disabled="models.applyingConfig" ng-click="collapsed=!collapsed">\n                                            <awsui-checkbox class="checkbox" checked="metricType.checked" change="checkAllPaidMetrics(metricType)" data-disabled="metricType.disable" ng-model="metricType.checked"></awsui-checkbox>\n                                            <span ng-if="collapsed" class="awsui-icon caret-right awsui-icon-light section"></span>\n                                            <span ng-if="!collapsed" class="awsui-icon caret-down awsui-icon-light section"></span>\n                                            <div class="dropdown-text section">\n                                                {{metricType.title}} ({{metricType.metrics.length}})\n                                            </div>\n                                            <div class="metric-charge-info">{{ metricType.info }}</div>\n                                            <div class="specific-metrics" ng-show="!collapsed">\n                                                <div class="specific-metric" ng-repeat="specificMetric in metricType.metrics">\n                                                    <div class="specific-metric-text">\n                                                        <awsui-checkbox checked="true" data-disabled="true">\n                                                            {{specificMetric.name}}\n                                                        </awsui-checkbox>\n                                                    </div>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                </div>\n\n                                <div class="select-metrics-buttons">\n                                    <table>\n                                        <tr>\n                                            <td class="metric-button-spacing">\n                                                <awsui-button variant="primary" text="{{ \'button.save\'   | translate}}" class="normal-button" ng-click="applyMetricsConfig()" loading="models.applyingConfig"></awsui-button>\n                                            </td>\n                                            <td>\n                                                <awsui-button variant="normal" text="{{ \'button.cancel\' | translate}}" class="normal-button" ng-click="cancelMetricsConfig()" data-disabled="models.applyingConfig"></awsui-button>\n                                            </td>\n                                        </tr>\n                                    </table>\n                                </div>\n\n                            </div>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td class="filter-header">\n                            <table border="0px" class="filters-table-header">\n                                <tr>\n                                    <td>\n                                        <div class="row-checkbox">\n                                            <awsui-checkbox checked="false" change="viewAllFilters()" data-disabled="filterList.length === 0" ng-model="models.allFilters"></awsui-checkbox>\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <div class="filter-title" translate="management.metrics.side.filter.header" translate-values="{count: filterList.length}"></div>\n                                    </td>\n                                    <td>\n                                        <div class="filter-add" ng-click="addFilter()">\n                                            <div class="awsui-icon awsui-icon-link plus" translate="management.metrics.side.filter.add"></div>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n\n                    <tr ng-if="models.showAddFilter">\n                        <td class="bucket-dropdown-config dark">\n                            <table>\n                                <tr>\n                                    <td class="filter-title-cell">\n                                        <div class="filter-add-title" translate="management.metrics.side.filter.dropdown.add">\n                                        </div>\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <td>\n                                        <div class="new-filter-params">\n                                            <div class="new-filter-text" translate="management.metrics.side.filter.name.title">\n                                            </div>\n                                            <div class="new-filter-input">\n                                                <awsui-control-group>\n                                                    <span class="error-background-fix" dom-region="validationMessage" ng-if="models.filterNameError">\n                                                        {{models.filterNameError}}\n                                                    </span>\n\n                                                    <awsui-textfield placeholder="{{ \'management.metrics.side.filter.name.placeholder\' | translate}}" ng-keyup="validateFilter()" data-disabled="models.editFilter || models.savingFilter" ng-model="models.filterName"></awsui-textfield>\n                                                </awsui-control-group>\n                                            </div>\n\n                                            <div class="new-filter-text" translate="management.metrics.side.filter.prefix.title">\n                                            </div>\n                                            <div class="new-filter-input" ng-class="{\'new-filter-input-search\' : models.filterValue || (filters.tagFilters.length + filters.prefixFilters.length) > 0 }">\n                                                <search filters="filters" no-backend-calls="true" search-error="models.filterValueError"></search>\n                                            </div>\n\n\n                                            <div class="select-metrics-buttons">\n                                                <table>\n                                                    <tr>\n                                                        <td colspan="2">\n                                                            <div class="filter-delete">\n                                                                <awsui-button data-disabled="models.deleteFilter || models.savingFilter" loading="models.deleteFilter" icon="" variant="link" ng-click="deleteFilter()" ng-if="models.editFilter" text="{{ \'management.metrics.action.delete\' | translate }}">\n                                                                </awsui-button>\n                                                            </div>\n                                                        </td>\n                                                    </tr>\n                                                    <tr>\n                                                        <td class="metric-button-spacing">\n                                                            <awsui-button variant="primary" text="{{ \'button.save\'   | translate}}" data-disabled="models.savingFilter || models.deleteFilter\n                                                                          || !models.filterName || models.filterNameError" class="normal-button" loading="models.savingFilter" ng-click="saveFilter()"></awsui-button>\n                                                        </td>\n                                                        <td>\n                                                            <awsui-button variant="normal" text="{{ \'button.cancel\' | translate}}" class="normal-button" data-disabled="models.savingFilter || models.deleteFilter" click="cancelFilter()"></awsui-button>\n                                                        </td>\n                                                    </tr>\n                                                </table>\n                                                <div class="filter-error">\n                                                    <awsui-alert type="error" header="{{\'error.header\'|translate}}" ng-if="models.filterError">{{models.filterError}}\n                                                    </awsui-alert>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n\n                    <tr ng-if="!models.showAddFilter && filterList.length > 0" class="filter-header">\n                        <td>\n                            <table class="filters-table">\n                                <tr ng-repeat="row in filterList | filter:models.searchText " ng-class="{\'bucket-selected row-highlight\' : row.checked}">\n                                    <td>\n                                        <div class="row-checkbox">\n                                            <awsui-checkbox checked="row.checked" data-disabled="false" ng-model="row.checked" change="filterChanged(row)"></awsui-checkbox>\n                                        </div>\n                                    </td>\n                                    <td class="filter-name-row">\n                                        <div>\n                                            {{row.Id}}\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <span class="awsui-icon awsui-icon-link pencil buckets-cog" ng-class="{\'awsui-icon-light\': row.checked}" ng-click="addFilter(row)"></span>\n                                    </td>\n                                </tr>\n                            </table>\n                        </td>\n                    </tr>\n                    <tr ng-if="!models.showAddFilter && filterList.length === 0">\n                        <td>\n                            <div class="side-panel-metrics-help">\n                                <span translate="management.metrics.side.filter.help"></span> <br>\n\n                                <a href="{{ getLearnMoreLink(\'configure-metrics-filter\') }}" target="_blank" class="ng-binding" translate="">learn.more</a>\n                                <br>\n                                <br>\n                                <awsui-button data-disabled="false" loading="false" icon="plus" variant="primary" ng-click="addFilter()">\n                                    {{ \'management.metrics.side.filter.add\' | translate}}\n                                </awsui-button>\n                            </div>\n                        </td>\n                    </tr>\n                </table>\n            </div>\n        </td>\n        <td class="metrics-content-cell">\n\n            <div>\n                <div class="metrics-loading" ng-if="metricsLoading">\n                    <span class="awsui-icon awsui-spinner awsui-spinner-large">\n                </div>\n                <div ng-if="!metricsLoading">\n                    <div class="si-top-right-header">\n                        <div>\n                            <table class="metric-type">\n                                <tr>\n                                    <td ng-repeat="(key, metricType) in S3Constants.METRICS.TYPE" ng-class="{\'type-selected\' : selectedMetricType === metricType}" ng-click="setSelectedMetricType(metricType)">\n                                        {{ getGroupTitle(metricType) }}\n                                    </td>\n                                </tr>\n                            </table>\n                            <table class="time-range">\n                                <tr>\n                                    <td>\n                                        <div ng-class="{\'timeframe-selected\': selectedTimeFrame === \'H1\'}" ng-click="setTimeRange(\'H1\')" translate="">management.metrics.timeframe.1h\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <div ng-class="{\'timeframe-selected\': selectedTimeFrame === \'H3\'}" ng-click="setTimeRange(\'H3\')" translate="">management.metrics.timeframe.3h\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <div ng-class="{\'timeframe-selected\': selectedTimeFrame === \'H12\'}" ng-click="setTimeRange(\'H12\')" translate="">management.metrics.timeframe.12h\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <div ng-class="{\'timeframe-selected\': selectedTimeFrame === \'H24\'}" ng-click="setTimeRange(\'H24\')" translate="">management.metrics.timeframe.1d\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <div ng-class="{\'timeframe-selected\': selectedTimeFrame === \'W1\'}" ng-click="setTimeRange(\'W1\')" translate="">management.metrics.timeframe.1w\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <div ng-class="{\'timeframe-selected\': selectedTimeFrame === \'W2\'}" ng-click="setTimeRange(\'W2\')" translate="">management.metrics.timeframe.2w\n                                        </div>\n                                    </td>\n                                    <td>\n                                        <span class="awsui-icon refresh awsui-icon-light" ng-click="refresh()"></span>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n                    </div>\n                    <div class="si-metrics-list-header">\n                        <div>\n                            <table class="metrics-link-table">\n                                <tr>\n                                    <td ng-repeat="metric in metricsWithStats" ng-click="goToChart(metric.ref.chartId)">\n                                        <div class="metric-name" ng-class="{\'timeframe-selected\': selectedMetricGroup === metric.display}" ng-click="setMetricGroup(metric.display)">\n                                            {{ metric.display }}\n                                        </div>\n                                    </td>\n                                </tr>\n                            </table>\n                        </div>\n\n                        <div class="metrics-update-time">{{ models.updatedOn }}</div>\n                    </div>\n                    <div class="metrics-error-main">\n                        <awsui-alert type="error" header="{{\'error.header\'|translate}}" visible="error">{{error}}\n                        </awsui-alert>\n                        <awsui-alert header="{{\'management.metric.info\'|translate}}" visible="info">{{info}}\n                        </awsui-alert>\n                    </div>\n                    <div class="inner-tab-container" ng-if="metrics[selectedMetricType]">\n                        <metrics-monitoring metric-list="metrics[selectedMetricType]" zoom="selectedTimeFrame"></metrics-monitoring>\n                    </div>\n                </div>\n            </div>\n\n        </td>\n    </tr>\n</table>');a.put("/s3/partials/confirmationdialogmodal.html",'<div class="confirmation-modal" ng-show="isOpen.flag">\n    <dialog-modal is-open="isOpen.dialogOpen" close-callback="closeConfirmationModal()" header-title="modalInfo.headTitle" has-warning-msg="modalInfo.warningInfo" count-info="countInfo" source-dst-info="sourceDstInfo">\n        <div transclude-name="content">\n            <file-list-in-modal selected="selected" close-icon-show="closeIconShow"></file-list-in-modal>\n        </div>\n        <div transclude-name="footer">\n            <awsui-button id="cancel" text="{{ \'createbucketmodal.footer.cancel\' | translate }}" variant="normal" click="closeConfirmationModal()"></awsui-button>\n            <awsui-button id="create-primary" variant="primary" text="{{modalInfo.buttonName}}" class="awsui-util-f-r primary-button" loading="isCounting.flag" click="operationFunc()"></awsui-button>\n        </div>\n    </dialog-modal>\n</div>');a.put("/s3/partials/createbucketmodal.html",'<modal id="create-bucket-modal" class="create-bucket-modal" ng-class="{\'overflow-y-visible\': state===STEP.NAME_AND_REGION}" id="create-S3-bucket-modal" is-open="isOpen" steps="STEP" state="state" close-callback="closeCreateBucketModal" header-title="headerTitle" next-state="nextState" previous-state="previousState" set-state="setState">\n    \n    <div id="content" class="create-bucket-modal-content" transclude-name="content">\n        <div class="createbucketbodycontent" ng-if="state === STEP.NAME_AND_REGION">\n            <p class="subheader" translate="createbucketmodal.label.nameandregion"></p>\n            <p class="label" translate="createbucketmodal.label.name"></p>\n            <awsui-tooltip text="{{\'createbucketmodal.bucketname.tooltip\' | translate}}" position="bottom" size="small">\n                <i class="awsui-icon alert-info-circle"></i>\n            </awsui-tooltip>\n            <div class="bucketname-and-region">\n                <awsui-control-group>\n                    <span dom-region="validationMessage" ng-if="bucketNameValidationErrors.length > 0">\n                        <label ng-repeat="message in bucketNameValidationErrors">{{message}}</label><br>\n                    </span>\n                    <span dom-region="control">\n                        <awsui-textfield id="bucket-name" class="create-bucket-modal-input" autocomplete="true" ng-keyup="validateBucketName()" placeholder="{{\'createbucketmodal.placeholder.name\' | translate}}" ng-model="createBucketValues.name">\n                        </awsui-textfield>\n                    </span>\n                </awsui-control-group>\n            </div>\n            <p class="label" translate="createbucketmodal.label.region"></p>\n            <dropdown items="regions" id="bucket-region" selected-item="createBucketValues.region" placeholder="{{ \'createbucketmodal.placeholder.region\' | translate }}" filter="true"></dropdown>\n            <div class="modal-content-divider"></div>\n            <p class="subheader" translate="createbucketmodal.label.copysettings"></p>\n            <bucket-selector class="bucket-selector" get-source-bucket-properties="createBucketProperties.getResponse" get-source-bucket-permissions="sourceBucketPermissions" curr-bucket-permissions="currPermissions" copy-settings-source-bucket="createBucketValues.copySettingsSourceBucket" bucket-list="bucketList" operation="operation" default-acls="defaultAcls"></bucket-selector>\n        </div>\n        \n        <div class="createbucketproperites" ng-if="state === STEP.PROPERTIES">\n            <div class="wrapper create-bucket-card-style">\n                <bucket-versioning id="create-bucket-versioning-card" card-open="toggleVersioning" versioning="createBucketProperties.getResponse.versioning" for-create-bucket-modal="forCreateBucketModal" replication="createBucketProperties.getResponse.replication"></bucket-versioning>\n                <bucket-logging id="create-bucket-logging-card" card-open="toggleLogging" logging="createBucketProperties.getResponse.logging" create-bucket-values="createBucketValues" bucket-list="bucketList" for-create-bucket-modal="forCreateBucketModal"></bucket-logging>\n                <bucket-tagging id="create-bucket-tagging-card" card-open="toggleTagging" bucket-tags="createBucketProperties.getResponse.tagging" for-create-bucket-modal="forCreateBucketModal"></bucket-tagging>\n            </div>\n        </div>\n        \n        <div ng-if="state === STEP.PERMISSIONS" class="createbucketpermissionsstep">\n            <modal-permissions public-permissions="currPermissions.publicPermissions" user-permissions="currPermissions.userPermissions"></modal-permissions>\n        </div>\n        \n        <div ng-if="state === STEP.REVIEW" class="createbucketbodycontent">\n            <table id="review-table" class="review-table">\n                <tr>\n                    <td class="review-subheader" translate="createbucketmodal.label.nameandregion"></td>\n                    <td class="edit-button">\n                        <awsui-button class="button-in-darkbg" class="button-in-darkbg" text="{{ \'createbucketmodal.button.edit\' | translate }}" variant="link" ng-click="setState(STEP.NAME_AND_REGION)">\n                        </awsui-button>\n                    </td>\n                </tr>\n            </table>\n            <table class="details-table">\n                <tr>\n                    <td class="review-nameregion"><span class="review-detail-title" translate="createbucketmodal.label.name"></span><span class="review-detail-content"> {{createBucketValues.name}}</span></td>\n                    <td><span class="review-detail-title" translate="createbucketmodal.label.region"></span><span class="review-detail-content"> {{createBucketValues.region.text}}</span></td>\n                </tr>\n            </table>\n            <table class="review-table">\n                <tr>\n                    <td class="review-subheader" translate="createbucketmodal.label.properties"></td>\n                    <td class="edit-button">\n                        <awsui-button class="button-in-darkbg" text="{{ \'createbucketmodal.button.edit\' | translate }}" variant="link" click="setState(STEP.PROPERTIES)">\n                        </awsui-button>\n                    </td>\n                </tr>\n            </table>\n            <table class="details-table">\n                <tr ng-repeat="property in propertyStatuses">\n                    <td class="review-detail-title">{{property.name}}</td>\n                    <td class="review-detail-content">{{property.status}}</td>\n                </tr>\n            </table>\n\n            <table class="review-table">\n                <tr>\n                    <td class="review-subheader" translate="createbucketmodal.label.permissions"></td>\n                    <td class="edit-button">\n                        <awsui-button class="button-in-darkbg" text="{{ \'createbucketmodal.button.edit\' | translate }}" variant="link" click="setState(STEP.PERMISSIONS)">\n                        </awsui-button>\n                    </td>\n                </tr>\n            </table>\n            <table class="details-table">\n                <tr ng-repeat="acl in aclsSummaries">\n                    <td class="review-detail-title">{{acl.summaryTitle}}</td>\n                    <td class="review-detail-content">{{acl.value}}</td>\n                </tr>\n            </table>\n\n            <awsui-alert visible="createS3BucketWarning" class="block small-top-margin" type="warning" dismissible="false" header="{{ \'warning.header\' | translate }}"> {{ createS3BucketWarning }}\n            </awsui-alert>\n\n            <awsui-alert visible="createS3BucketError" class="block small-top-margin" type="error" dismissible="false" header="{{ \'createbucketmodal.error.header\' | translate }}"> {{ createS3BucketError }}\n            </awsui-alert>\n        </div>\n    </div>\n    <div class="create-bucket-modal-footer" transclude-name="footer">\n        <awsui-button id="next" ng-if="state !== STEP.REVIEW" variant="primary" text="{{ \'createbucketmodal.footer.next\' | translate }}" class="awsui-util-f-r primary-button" click="generateSummary()" data-disabled="!createBucketValues.name || bucketNameValidationErrors.length > 0 || !createBucketValues.region">\n        </awsui-button>\n        <awsui-button id="create-primary" ng-if="state === STEP.REVIEW" variant="primary" text="{{ \'createbucketmodal.footer.confirm\' | translate }}" class="awsui-util-f-r primary-button" click="createBucket(createBucketValues.name, createBucketValues.region)" loading="isCreatingBucket" data-disabled="!createBucketValues.name || !createBucketValues.region || createS3BucketWarning">\n        </awsui-button>\n        <awsui-button id="cancel" text="{{ \'createbucketmodal.footer.cancel\' | translate }}" variant="normal" ng-if="state === STEP.NAME_AND_REGION" class="awsui-util-f-r" click="closeCreateBucketModal()">\n        </awsui-button>\n        <awsui-button id="previous" text="{{ \'createbucketmodal.footer.previous\' | translate }}" variant="normal" ng-if="state !== STEP.NAME_AND_REGION" class="awsui-util-f-r" click="goToPreviousState()" data-disabled="createS3BucketWarning">\n        </awsui-button>\n        <awsui-button id="create-secondary" ng-if="state === STEP.NAME_AND_REGION" variant="normal" text="{{ \'createbucketmodal.footer.createnow\' | translate }}" class="awsui-util-f-l" click="createBucket(createBucketValues.name, createBucketValues.region)" loading="isCreatingBucket" data-disabled="!createBucketValues.name || !createBucketValues.region">\n        </awsui-button>\n    </div>\n</modal>');a.put("/s3/partials/detailprogress.html",'<modal class="detail-progress" is-open="isOpen" header-title="targetOperation.displayName" close-callback="closeCallback">\n    <div class="detail-progress-header" transclude-name="header">\n        <span class="operation-water-mark operation-water-mark-image"></span>\n        <div class="operation-modal-title" ng-show="targetOperation.name === \'Upload\'">{{ targetOperation.displayName }} ({{ targetOperation.currentUploadSpeed }}/s)</div>\n        <div class="operation-modal-title" ng-show="targetOperation.name !== \'Upload\'">{{ targetOperation.displayName }}</div>\n        <div class="operation-modal-percentage">{{ targetOperation.successPercentage }}% {{ "operation.progress.complete" | translate }}</div>\n        <div class="detail-progress-overall-progress">\n            <div class="detail-progress-bar"></div>\n            <div class="detail-progress-bar-fill"></div>\n        </div>\n    </div>\n    <div class="detail-progress-content" transclude-name="content">\n        <table class="detail-progress-overall-table">\n            <tr>\n                <td>\n                    <span class="object-progress-icon awsui-icon" ng-class="{\'alert-check-circle\': targetOperation.parameters.operationSuccessful, \'alert-exclamation-circle\': targetOperation.parameters.operationUnsuccessful, \'alert-exclamation-triangle\': targetOperation.parameters.operationPartiallySuccessful}"></span>\n                    <div ng-if="targetOperation.name === \'Upload\'" class="detail-progress-text total-count" translate="">operation.detail.totalfiles</div>\n                    <div ng-if="targetOperation.name !== \'Upload\'" class="detail-progress-text total-count" translate="">operation.detail.totalObjects</div>\n                </td>\n                <td><div class="detail-progress-text total-objects-count">{{ targetOperation.totalObjectCount }}</div></td>\n            </tr>\n            <tr>\n                <td class="success-count-line">\n                    <div class="detail-progress-text total-successful" translate="">operation.detail.successful</div>\n                </td>\n                <td class="total-success-count-percentage">\n                    <div ng-if="targetOperation.parameters.isDeleteBucketSuccessful" class="detail-progress-text total-successful-count">{{ targetOperation.succeedKeyCount }} ({{ targetOperation.successPercentage-50 }}%)</div>\n                    <div ng-if="!targetOperation.parameters.isDeleteBucketSuccessful" class="detail-progress-text total-successful-count">{{ targetOperation.succeedKeyCount }} ({{ targetOperation.successPercentage }}%)</div>\n                </td>\n            </tr>\n            <tr ng-repeat="errorType in targetOperation.errorTypes">\n                <td class="error-files-list-expander">\n                    <i class="awsui-icon alert-exclamation-circle hidden"></i>\n                    <awsui-expandable-section class="expander dark" header="{{errorType.errorMessage}}" expanded="false">\n                        <table class="files-list-table">\n                        <tr class="file-role" ng-repeat="errorKey in targetOperation.errorDetails[errorType.errorMessage]">\n                            <td class="file-icon">\n                                <span class="awsui-icon awsui-icon-light" ng-class="getFileIconClass(errorKey)"></span>\n                            </td>\n                            <td class="object-detail">\n                                <div class="object-name">{{ errorKey }}</div>\n                                <div class="object-info">/{{ targetOperation.initialBucket }}/{{ targetOperation.initialPath }}</div>\n                            </td>\n                            <td class="error-icon"><i class="awsui-icon alert-exclamation-circle"></i></td>\n                        </tr>\n                        </table>\n                    </awsui-expandable-section>\n                </td>\n                <td class="error-count-percentage">\n                    <div ng-if="targetOperation.name === deleteBucketOperationName" class="detail-progress-text total-successful-count">{{ errorType.errorCount }} ({{ targetOperation.errorPercentage-50 }}%)</div>\n                    <div ng-if="targetOperation.name !== deleteBucketOperationName" class="detail-progress-text total-successful-count">{{ errorType.errorCount }} ({{ targetOperation.errorPercentage }}%)</div>\n                </td>\n            </tr>\n            <tr ng-if="targetOperation.name === deleteBucketOperationName">\n                <td>\n                    <span class="object-progress-icon awsui-icon" ng-class="{\'alert-check-circle\': targetOperation.parameters.isDeleteBucketSuccessful, \'alert-exclamation-circle\': !targetOperation.parameters.isDeleteBucketSuccessful }"></span>\n                    <div class="detail-progress-text total-count" translate="">operation.detail.bucketDeletion</div>\n                </td>\n                <td ng-if="targetOperation.parameters.isDeleteBucketSuccessful"><div class="detail-progress-text deletion-status" translate="">operation.detail.successful</div></td>\n                <td ng-if="!targetOperation.parameters.isDeleteBucketSuccessful"><div class="detail-progress-text deletion-status" translate="">operation.detail.failed</div></td>\n            </tr>\n        </table>\n    </div>\n    <div class="detail-progress-footer" transclude-name="footer">\n        <div class="cancel-operation-button" ng-click="cancelOperationFunction(targetOperation)">\n            <div class="cancel-operation-button-text">{{ cancelButtonText }}</div>\n        </div>\n    </div>\n</modal>');a.put("/s3/partials/dialogmodal.html",'<div class="aws-modal" id="confirmation-modal">\n    <div ng-show="isOpen.flag" class="modal-frame fade in ng-hide">\n        <div class="modal-header" ng-class="getClass()" transclude="header">\n            <i class="panel-close-icon modal-close" ng-click="closeModal()"></i>\n            <div class="modal-header-title">{{headerTitle}}</div>\n            <div class="modal-header-divider"></div>\n        </div>\n        <div ng-if="countInfo.flag" class="confirmation-info-subheader">\n            <table class="dialog-info-table">\n                <tr class="dialog-info-text">\n                    <td colspan="2" class="confirmation-info-text" translate="confirmationmodal.countinfo.title.currentlevel"></td>\n                    <td colspan="2" class="confirmation-info-text">\n                        <span translate="">confirmationmodal.countinfo.title.totalimpact</span>\n                        <awsui-tooltip text="{{\'confirmationmodal.totalimpact.tooltip\' | translate}}" position="bottom" size="small">\n                            <i class="awsui-icon alert-info-circle"></i>\n                        </awsui-tooltip>\n                        <a class="confirmation-modal-learn-more" target="_blank" href="https://docs.aws.amazon.com/console/s3/ui-folder" translate="">learn.more</a>\n                    </td>\n                </tr>\n                <tr class="dialog-info-data">\n                    <td translate="confirmationmodal.countinfo.folders" translate-values="{ folderCount : {{countInfo.folders}} }"></td>\n                    <td translate="confirmationmodal.countinfo.objects" translate-values="{ objectCount : {{countInfo.currLevelObjs}} }"></td>\n                    <td translate="confirmationmodal.countinfo.totalobjects" translate-values="{ totalObjCount : {{countInfo.objects}} }"></td>\n                    <td>\n                        <awsui-tooltip ng-if="countInfo.sizeDataMissing" text="{{\'confirmationmodal.info.sizedatamissing\' | translate}}" position="bottom" size="small">\n                            <span>\n                                {{countInfo.size | humanReadableBytes}}\n                                <span>*</span>\n                            </span>\n                        </awsui-tooltip>\n                        <span ng-if="!countInfo.sizeDataMissing">\n                            {{countInfo.size | humanReadableBytes}}\n                        </span>\n\n                        <span translate="confirmationmodal.countinfo.totalsize"></span>\n                    </td>\n                </tr>\n            </table>\n        </div>\n        <div ng-if="sourceDstInfo.flag" class="paste-subheader-info">\n            <table>\n                <tr>\n                    <td>\n                        <translate class="confirmation-label">confirmationmodal.source</translate>\n                        <span>{{sourceDstInfo.source}}</span>\n                    </td>\n                    <td>\n                        <translate class="confirmation-label">confirmationmodal.dst</translate>\n                        <span>{{dstFolderPath}}</span>\n                    </td>\n                </tr>\n            </table>\n        </div>\n        <div class="modal-body" transclude="content" ng-class="{\n                           \'modal-body-height-with-warning\': hasWarningMsg.flag && !sourceDstInfo.flag,\n                           \'modal-body-height-without-warning\': !hasWarningMsg.flag,\n                           \'modal-body-height-with-warning-and-source-dst-info\': hasWarningMsg.flag && sourceDstInfo.flag\n                       }">\n        </div>\n        <div class="modal-footer" transclude="footer">\n            <div class="confirmation-banner">\n                <div class="footer-divider"></div>\n                <awsui-alert ng-if="hasWarningMsg.flag" type="warning" dismissible="false">\n                    <p translate="{{hasWarningMsg.text}}" translate-values="{val: \'{{hasWarningMsg.val}}\' }"></p>\n                </awsui-alert>\n            </div>\n        </div>\n    </div>\n    <div ng-show="isOpen.flag" class="modal-background ng-hide"></div>\n</div>');a.put("/s3/partials/dropdown.html",'<div id="dropdown" class="dropdown" clickoutside="" on-click-outside="closeDropDown">\n    <table id="current-displayed-table" class="current-displayed item-not-selected" ng-class="{\'item-selected\' : selectedItem}">\n        <tr ng-if="!selectedItem.displayTextField && !enableInput" ng-click="toggleDropDown(disabled)" class="current-displayed-row" ng-class="{\'dropdown-disabled\' : disabled}">\n            <td class="current-displayed-item">{{ selectedItem.text || selectedItem || placeholder }}</td>\n            <td class="angle-down awsui-icon awsui-icon-link awsui-icon-big float-right-icon"></td>\n        </tr>\n        <tr class="current-displayed-row" ng-class="{\'dropdown-disabled\' : disabled}" ng-if="enableInput">\n            <td>\n                <awsui-textfield class="dropdown-inputfield" name="inputValidation" ng-model="inputField.text" ng-change="updateInput(inputField)" placeholder="{{\'granteedropdown.placeholder\' | translate }}"></awsui-textfield>\n            </td>\n            <td class="angle-down awsui-icon awsui-icon-link awsui-icon-big float-right-icon" ng-click="toggleDropDown(disabled)"></td>\n        </tr>\n        <tr class="current-displayed-row" ng-class="{\'dropdown-disabled\' : disabled}" ng-if="selectedItem.displayTextField">\n            <td>\n                <awsui-textfield class="dropdown-inputfield" data-disabled="disabled" ng-model="selectedItem.inputValue" placeholder="{{ selectedItem.value }}"></awsui-textfield>\n            </td>\n            <td class="angle-down awsui-icon awsui-icon-link awsui-icon-big float-right-icon" ng-click="toggleDropDown(disabled)"></td>\n        </tr>\n    </table>\n    <div class="list-items" ng-if="isOpen">\n        <table ng-if="filter" id="search-box" class="search-box">\n            <tr>\n                <td class="dropdown-search-inputtext"><input type="text" class="input-field" ng-model="tableFiltering.filter[filterColumn]" ng-keydown="filterKeyDown($event)" placeholder="{{ \'dropdown.inputfield.placeholder\' | translate }}"></td>\n                <td><i class="awsui-icon search"></i></td>\n            </tr>\n        </table>\n        <div class="item" ng-repeat="item in items | filter:tableFiltering.filter | orderBy:\'text || toString()\'" ng-click="selectItem(item)">\n            <div class="list-item">{{item.text || item}}</div>\n        </div>\n        <span class="no-matches-found" ng-if="((items | filter:tableFiltering.filter).length == 0)" translate="dropdown.nomatchesfound"></span>\n    </div>\n</div>');a.put("/s3/partials/editor.html",'<div class="ide-container">\n    <div id="editor" class="ide" ng-class="{ \'editor-large\': large, \'readonly\': readonly }" ng-model="code" ui-ace="{theme: \'dawn\', mode: \'javascript\', fontSize: 14, onLoad: aceLoaded}">\n    </div>\n</div>');a.put("/s3/partials/emptystate.html",'<div id="initial-start-page">\n    <div id="initial-start-top-content" class="awsui-util-t-c">\n        <div class="initial-start-paragraph" translate="emptystate.{{type}}.title"></div>\n    </div>\n    <table id="initial-start-selling-points">\n        <tbody>\n        <tr class="awsui-util-t-c">\n            <td>\n                <div class="intro-image no-{{type}}-1"></div>\n                <div class="intro-feature" translate="emptystate.{{type}}.firstheader"></div>\n            </td>\n            <td>\n                <div class="intro-image no-{{type}}-2"></div>\n                <div class="intro-feature" translate="emptystate.{{type}}.secondheader"></div>\n            </td>\n            <td>\n                <div class="intro-image no-{{type}}-3"></div>\n                <div class="intro-feature" translate="emptystate.{{type}}.thirdheader"></div>\n            </td>\n        </tr>\n        <tr>\n            <td class="intro-feature-details" translate="emptystate.{{type}}.firstdetails"></td>\n            <td class="intro-feature-details" translate="emptystate.{{type}}.seconddetails"></td>\n            <td class="intro-feature-details" translate="emptystate.{{type}}.thirddetails"></td>\n        </tr>\n        <tr id="initial-start-feature-learn-more" class="awsui-util-t-c">\n            <td><a href="{{getLearnMoreLink(0)}}" target="_blank">{{\'learn.more\'|translate}}</a></td>\n            <td><a href="{{getLearnMoreLink(1)}}" target="_blank">{{\'learn.more\'|translate}}</a></td>\n            <td><a href="{{getLearnMoreLink(2)}}" target="_blank">{{\'learn.more\'|translate}}</a></td>\n        </tr>\n        </tbody>\n    </table>\n    <div id="initial-start-support">\n        <awsui-button class="awsui-util-mb-s" text="{{\'get.started\' | translate}}" variant="primary" click="openModal()"></awsui-button>\n    </div>\n</div>');a.put("/s3/partials/events.html",'<card card-summary-obj="cardSummaryObj" card-id="scrollCardId" is-open="cardOpen" ng-class="{ \'card-disable-events-water-mark\': !cardOpen, \'card-enable-events-water-mark\': cardOpen }"> <div transclude-name="header">\n        <span translate="events.header"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="closeCard($event)"></div>\n    </div>\n    <div transclude-name="content">\n        <awsui-button ng-if="cardOpen" data-disabled="cardState.isAdding" text="{{\'events.button.addnotification\' | translate}}" icon="plus" variant="link" click="addEvent()"></awsui-button>\n        <awsui-button ng-if="cardOpen" data-disabled="cardState.selectedEventTable === null || cardState.isAdding" text="{{ \'events.button.delete\' | translate }}" variant="link" click="deletePressed()" loading="isDeleting">\n        </awsui-button>\n        <awsui-button ng-if="cardOpen" data-disabled="cardState.selectedEventTable === null || cardState.isAdding" text="{{ \'events.button.edit\' | translate }}" variant="link" click="editPressed()">\n        </awsui-button>\n        <div class="events-table" ng-if="cardOpen">\n            <awsui-radio-group ng-model="cardState.radioValue">\n                <table class="table table-condense">\n                    <thead>\n                        <tr>\n                            <td></td>\n                            <td translate="">events.table.name</td>\n                            <td translate="">events.table.events</td>\n                            <td translate="">events.table.filter</td>\n                            <td translate="">events.table.type</td>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <tr ng-repeat-start="event in eventsTable" class="add-events-row" ng-if="event.isEditing">\n                            <td colspan="4">{{ cardState.headerTitle }}</td>\n                            <td colspan="1">\n                                <span class="panel-close-icon close-button" ng-click="closeAddEvents()"></span>\n                            </td>\n                        </tr>\n                        <tr ng-repeat-end="">\n                            <td colspan="5" ng-if="event.isEditing">\n                                <add-events-form id="add-events-form" event-types="eventTypes" selected-event="cardState.selectedEventObj" resource-types="resourceTypes" modal-info="modalInfo" for-create-bucket-modal="forCreateBucketModal" card-state="cardState"></add-events-form>\n                            </td>\n                            <td ng-if="!event.isEditing">\n                                <awsui-radio-button ng-click="selectEvent(event)" value="{{event}}">\n                                    <td ng-if="!event.isEditing" class="event-id">{{event.id}}</td>\n                                    <td ng-if="!event.isEditing">{{event.events}}</td>\n                                    <td ng-if="!event.isEditing">{{event.filter}}</td>\n                                    <td ng-if="!event.isEditing">{{event.type}}</td>\n                                </awsui-radio-button>\n                            </td>\n                        </tr>\n                    </tbody>\n                    <tr ng-if="currEvents.length === 0 && !isAddingEvent">\n                        <td colspan="5">\n                            <div class="empty-message">\n                                {{ \'events.table.emptymessage\' | translate }}\n                                <awsui-button text="{{\'events.button.addnotification\' | translate}}" ng-click="openAddEventModal()"></awsui-button>\n                            </div>\n                        </td>\n                    </tr>\n                </table>\n            </awsui-radio-group>\n        </div>\n        <p ng-if="!cardOpen" class="bucketproperties-summary" translate="bucketproperties.events.summary"></p>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n        <awsui-alert ng-if="cardOpen" type="error" visible="cardState.showError">{{ cardState.errorMessage }}</awsui-alert>\n    </div>\n    <div transclude-name="footer">\n        <div class="bucket-properties-buttons" ng-if="cardOpen">\n            <awsui-button text="{{ \'events.button.save\' | translate }}" variant="primary" data-disabled="cardState.selectedEventObj.name === \'\' || cardState.selectedEventObj.arn === \'\'" class="awsui-util-f-r buttons" ng-click="savePressed($event)" loading="cardState.isSaving">\n            </awsui-button>\n            <awsui-button text="{{ \'events.button.cancel\' | translate }}" variant="normal" class="awsui-util-f-r buttons" ng-click="cancelPressed($event)">\n            </awsui-button>\n        </div>\n    </div>\n</card>');a.put("/s3/partials/fileslistinmodal.html",'<div ng-show="haveSelectedItems()" class="truncate">\n    <table class="modal-selected-files">\n        <tr ng-show="forUploads">\n            <td colspan="4">\n                <span class="awsui-icon plus awsui-icon-link" for="uploadInput"></span>\n                <label class="modal-add-files-label" id="modal-selected-files-upload-add" for="uploadInput">{{\'uploadmodal.label.add.more.files\' | translate }}</label>\n            </td>\n        </tr>\n        <tr ng-repeat="folder in selectedItems.folders">\n            <td class="modal-file-icon"><span class="folder awsui-icon awsui-icon-light"></span></td>\n            <td>\n                <p class="modal-selected-files-file-name">{{ folder.Prefix }}</p>\n                <p class="modal-selected-files-file-size">\n                    <span ng-if="folder.objsCount === null || folder.objsCount === undefined" translate="confirmationmodal.filelist.calculating"></span>\n                    <span ng-if="folder.objsCount !== null && folder.objsCount !== undefined" translate="confirmationmodal.folders" translate-values="{totalFolders: {{folder.objsCount}} }"></span>\n                    <span ng-if="folder.objsCount !== null && folder.objsCount !== undefined">- {{folder.folderSize | humanReadableBytes }} </span>\n                </p>\n            </td>\n            <td>\n                <span class="awsui-icon times awsui-icon-big awsui-icon-light" ng-show="closeIconShow" ng-click="closeIconFunc(folder)"></span>\n            </td>\n        </tr>\n        <tr ng-repeat="file in selectedItems.objects">\n            <td><span class="awsui-icon awsui-icon-light" ng-class="getFileIconClass(file)"></span></td>\n            <td>\n                <p class="modal-selected-files-file-name">{{ file.Key }}</p>\n                <p class="modal-selected-files-file-size">\n                    <span ng-if="file.Size">- {{ file.Size | humanReadableBytes }}</span>\n                    <span ng-if="!file.Size"> -- </span>\n                </p>\n            </td>\n            <td>\n                <span class="awsui-icon times awsui-icon-big awsui-icon-light" ng-show="closeIconShow" ng-click="closeIconFunc(file)"></span>\n            </td>\n        </tr>\n    </table>\n</div>');a.put("/s3/partials/hint.html",'<div class="useful-links">\n    <div class="hint-button">\n        <awsui-tooltip text="{{\'tooltip.oldconsole\' | translate}}" position="bottom" size="small">\n            <span class="switch-oldconsole hint-icons"></span><awsui-button variant="link" click="goToOldConsole()" text="{{\'button.oldconsole\' | translate}}" class="switch-back-button"></awsui-button>\n        </awsui-tooltip>\n    </div>\n    <div ng-if="showVideo()" class="hint-button">\n        <span class="introvideo hint-icons"></span><awsui-button variant="link" click="goToVideo()" text="{{\'button.introvideo\' | translate}}" class="switch-back-button"></awsui-button>\n    </div>\n    <div class="tips-button">\n        <awsui-tooltip text="{{hintMessage}}" position="bottom" size="small">\n            <i class="blue-lightbulb hint-icons"></i><awsui-button variant="link" text="{{\'hint.label\' | translate}}" class="hint-tips-button"></awsui-button>\n        </awsui-tooltip>\n    </div>\n</div>');a.put("/s3/partials/lifecycleconfirmationmodal.html",'<dialog-modal class="lifecycle-confirmation-modal" is-open="isOpen" close-callback="closeConfirmationModal" header-title="headerTitle">\n    <div transclude-name="content">\n        <awsui-alert class="confirmation-warning" visible="!showContinue" type="warning"> {{ warningMessage }} </awsui-alert>\n        <awsui-alert class="confirmation-warning" visible="showContinue" type="warning"> {{ stateChangeWarning }}</awsui-alert>\n        <awsui-alert visible="lifecycleError" class="block small-top-margin" type="error" dismissible="false" header="{{ \'lifecyclemodal.step3.error.header\' | translate }}"> {{ lifecycleError }}\n        </awsui-alert>\n    </div>\n    <div transclude-name="footer">\n        <awsui-button id="cancel" text="{{ \'createbucketmodal.footer.cancel\' | translate }}" variant="normal" click="closeConfirmationModal()"></awsui-button>\n        <awsui-button id="continue" variant="primary" ng-if="!showContinue" text="{{ \'lifecycleconfirmationmodal.footer.confirm\' | translate }}" class="awsui-util-f-r primary-button" click="detectStateChange()">\n        </awsui-button>\n        <awsui-button id="save" ng-if="showContinue" click="saveLifecycle()" variant="primary" text="{{ \'lifecyclemodal.footer.continue\' | translate }}" class="awsui-util-f-r primary-button">\n        </awsui-button>\n    </div>\n</dialog-modal>');a.put("/s3/partials/lifecyclemodal.html",'<modal id="lifecycle-modal" class="lifecycle-modal" ng-class="{\'overflow-y-visible\': state===STEP.NAME_AND_SCOPE}" is-open="isOpen" steps="STEP" state="state" close-callback="closeLifecycleModal" header-title="headerTitle" next-state="nextState" previous-state="previousState" set-state="setState">\n    <div class="lifecycle-modal-content" transclude-name="content">\n        <div class="body-content" ng-if="state === STEP.NAME_AND_SCOPE">\n            <p class="label" translate="lifecyclemodal.label.policyname"></p>\n            <awsui-textfield id="rule-name" class="policy-name" change="updateNextButtonDisabled()" ng-model="selectedRule.ID" placeholder="{{\'lifecyclemodal.placeholder.policyname\' | translate}}">\n            </awsui-textfield>\n            <table>\n                <tr>\n                    <td>\n                        <p class="label" translate="lifecyclemodal.label.applypolicy"></p>\n                    </td>\n                    <td class="tool-tip-text-subheader">\n                        <awsui-tooltip text="{{ \'lifecyclemodal.prefixtag.tooltip\' | translate }}" position="right" size="small">\n                            <i class="awsui-icon alert-info-circle"></i>\n                        </awsui-tooltip>\n                    </td>\n                </tr>\n            </table>\n            <div ng-if="showOldUI" fac="s3-ot" fac-toggle="">\n                <awsui-radio-group class="step1-radio-buttons" ng-model="selectedRule.applied" change="updateNextButtonDisabled()">\n                    <awsui-radio-button class="step1-radio-buttons" value="whole" ng-model="selectedRule.applied" label="{{ \'lifecyclemodal.step1.wholebucket\' | translate }}"></awsui-radio-button>\n                    <awsui-radio-button class="step1-radio-buttons" value="prefix" ng-model="selectedRule.applied" label="{{ \'lifecyclemodal.step1.prefix\' | translate }}"></awsui-radio-button>\n                </awsui-radio-group>\n                <awsui-textfield ng-if="selectedRule.applied === \'prefix\'" change="updateNextButtonDisabled()" class="policy-name" autocomplete="true" ng-model="selectedRule.Prefix" placeholder="{{\'lifecyclemodal.placeholder.prefix\' | translate}}">\n                </awsui-textfield>\n            </div>\n            <div ng-if="!showOldUI" class="lifecycle-tag-search">\n                    <search fac-id="s3-ot" fetch-one-page-prefix="fetchOnePagePrefix(prefix)" fetch-one-page-tag="fetchOnePageTag()" filters="selectedRule.filters" markers="markers" tag-continuation-tokens="tagContinuationTokens" no-backend-calls="true" search-error="tag.error" tag-search-selected="tagSearchSelected" show-tag="showTag">\n                    </search>\n            </div>\n            <awsui-alert visible="showV2FormatWarning" type="warning">\n                {{ \'lifecyclemodal.warning.newformatwarning\' | translate }}\n            </awsui-alert>\n            <awsui-alert visible="clearLDMAMUWarning" type="warning">\n                {{ \'lifecyclemodal.warning.removeldmamu\' | translate }}\n            </awsui-alert>\n        </div>\n        <div class="body-content" ng-if="state === STEP.TRANSITION">\n            <table>\n                <tr>\n                    <td>\n                        <p class="configure-label" translate="lifecyclemodal.step2.configurerule"></p>\n                    </td>\n                    <td class="tool-tip-text-header">\n                        <awsui-tooltip text="{{ \'lifecyclemodal.standardia.tooltip\' | translate }}" position="bottom" size="small">\n                            <i class="awsui-icon alert-info-circle"></i>\n                        </awsui-tooltip>\n                    </td>\n                </tr>\n            </table>\n            <table class="upload-modal-radio-button-properties">\n                <tr>\n                    <td>\n                        <awsui-checkbox id="current-version-transition" class="step2-radio-label" ng-model="selectedRule.showCurrent" change="showStep2CurrentVersionChange()">\n                            <span class="show-version" translate="lifecyclemodal.step2.current"></span>\n                        </awsui-checkbox>\n                    </td>\n                    <td class="show-previous">\n                        <awsui-checkbox id="previous-version-transition" class="step2-radio-label" ng-model="selectedRule.showPrevious" change="showStep2PreviousVersionChange()">\n                            <span class="show-version" translate="lifecyclemodal.step2.noncurrent"></span>\n                        </awsui-checkbox>\n                    </td>\n                </tr>\n            </table>\n            <div class="review-section-header"></div>\n            <div ng-if="selectedRule.showCurrent">\n                <p class="current-version-label" translate="lifecyclemodal.step2.currentversion"></p>\n                <div class="modal-content-divider"></div>\n                <p ng-if="selectedRule.currentRuleActions.length === 0" class="empty-transitions" translate="lifecyclemodal.step2.emptycurrenttransitions"></p>\n                <table class="lifecycle-table">\n                    <tr ng-if="selectedRule.currentRuleActions.length !== 0">\n                        <td id="object-creation" class="options" translate="lifecyclemodal.objectcreated"></td>\n                        <td class="object-created-days" translate="lifecyclemodal.step2.daysafterobjectcreation"></td>\n                    </tr>\n                </table>\n                <div class="add-transition">\n                    <a id="add-current-transition" ng-class="{ \'add-disabled\' : selectedRule.isAddCurrentTransitionDisabled }" ng-click="addCurrentRuleAction()"> {{\'lifecyclemodal.step2.addtransition\' | translate}}</a>\n                </div>\n                <table class="lifecycle-table">\n                    <tr ng-repeat="action in selectedRule.currentRuleActions">\n                        <td class="transition-options">\n                            <awsui-select class="lifecycle-modal-select" change="selectCurrentRuleAction(selectedRule.currentRuleActions[$index].action,$index)" items="selectedRule.currentRuleOptions[$index]" ng-model="selectedRule.currentRuleActions[$index].action" placeholder="{{\'lifecyclemodal.selectrule\' | translate}}"></awsui-select>\n                        </td>\n                        <td class="object-transition-days">\n                            <awsui-textfield ng-class="{ \'highlight-error\' : highlightTextBoxErrorCurrent[$index] }" placeholder="{{\'lifecyclemodal.days\' | translate}}" class="lifecycle-modal-input" ng-model="selectedRule.currentRuleActions[$index].value" disabled="selectedRule.currentRuleActions[$index].action === \'\'" ng-keyup="validateDays($index, \'current\')">\n                            </awsui-textfield>\n                            <span class="close-transition" ng-click="removeCurrentRuleAction($index)"> X </span>\n                        </td>\n                    </tr>\n                </table>\n                <awsui-alert type="error" visible="notANumberErrorCurrent.SIA" header="{{ \'lifecyclemodal.step2.numbersiaerrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.step2.numbererrormessage\' | translate }} </awsui-alert>\n                <awsui-alert type="error" visible="notANumberErrorCurrent.Glacier" header="{{ \'lifecyclemodal.step2.numberglaciererrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.step2.numbererrormessage\' | translate }} </awsui-alert>\n                <awsui-alert type="error" visible="minimumDaysCurrent.SIA" header="{{ \'lifecyclemodal.step2.minimumdayssiaerrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.step2.minimumdayssiaerrormessage\' | translate }} </awsui-alert>\n                <awsui-alert type="error" visible="minimumDaysCurrent.Glacier" header="{{ \'lifecyclemodal.step2.minimumdaysglaciererrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.step2.minimumdaysglaciererrormessage\' | translate }} </awsui-alert>\n                <awsui-alert type="error" visible="higherNumberErrorCurrent.SIA" header="{{ \'lifecyclemodal.highernumbererrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.highernumbererrormessage\' | translate }} </awsui-alert>\n                <awsui-alert type="error" visible="higherNumberErrorCurrent.Glacier" header="{{ \'lifecyclemodal.highernumbererrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.highernumbererrormessage\' | translate }} </awsui-alert>\n                <awsui-alert type="error" visible="greaterThanCurrentError.GlacierGreaterThanSIA" header="{{ \'lifecyclemodal.step2.glaciergreaterthansiaerrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.step2.glaciergreaterthansiaerrormessage\' | translate }} {{ currentGlacierGreaterThanSIAValue }} </awsui-alert>\n                <awsui-alert type="error" visible="currentError" header="{{ \'lifecyclemodal.step2.noruleactionerrorheader\' | translate }}"> {{ \'lifecyclemodal.step2.selectruleactionerror\'| translate }} </awsui-alert>\n                <div ng-if="selectedRule.currentRuleActions.length === 0" class="modal-section"></div>\n            </div>\n            <div ng-if="selectedRule.showPrevious">\n                <table>\n                    <tr>\n                        <td>\n                            <p class="current-version-label" translate="lifecyclemodal.step2.previousversion"></p>\n                        </td>\n                        <td class="tool-tip-text">\n                            <awsui-tooltip text="{{ \'lifecyclemodal.previousversion.tooltip\' | translate }}" position="right" size="small">\n                                <i class="awsui-icon alert-info-circle"></i>\n                            </awsui-tooltip>\n                        </td>\n                    </tr>\n                </table>\n                <div class="modal-content-divider"></div>\n                <p ng-if="selectedRule.noncurrentRuleActions.length === 0" class="empty-transitions" translate="lifecyclemodal.step2.emptynoncurrenttransitions"></p>\n                <table class="lifecycle-table">\n                    <tr ng-if="selectedRule.noncurrentRuleActions.length !== 0">\n                        <td class="options" translate="lifecyclemodal.objectbecomespreviousversion"></td>\n                        <td class="object-created-days" translate="lifecyclemodal.step2.daysafterobjectcreation"></td>\n                    </tr>\n                </table>\n                <span class="add-transition">\n                    <a ng-class="{ \'add-disabled\' : selectedRule.isAddPrevTransitionDisabled }" ng-click="addNoncurrentRuleAction()"> {{\'lifecyclemodal.step2.addtransition\' | translate}} </a>\n                </span>\n                <table class="lifecycle-table">\n                    <tr ng-repeat="action in selectedRule.noncurrentRuleActions">\n                        <td class="transition-options"><awsui-select class="lifecycle-modal-select" change="selectNoncurrentRuleAction(selectedRule.noncurrentRuleActions[$index].action, $index)" items="selectedRule.noncurrentRuleOptions[$index]" ng-model="selectedRule.noncurrentRuleActions[$index].action" placeholder="{{\'lifecyclemodal.selectrule\' | translate}}"></awsui-select>\n                            <div ng-if="selectedRule.noncurrentRuleActions[$index].showRldm"><awsui-checkbox ng-model="selectedRule.noncurrentRuleActions[$index].removeExpire">{{ \'lifecyclemodal.removeexpire\' | translate }}</awsui-checkbox></div>\n                        </td>\n                        <td ng-class="{ \'object-transition-days\' : !selectedRule.noncurrentRuleActions[$index].showRldm , \'remove-expire\' : selectedRule.noncurrentRuleActions[$index].showRldm }">\n                            <awsui-textfield ng-class="{ \'highlight-error\' : highlightTextBoxErrorNonCurrent[$index] }" placeholder="{{\'lifecyclemodal.days\' | translate}}" class="text-input lifecycle-modal-input" ng-model="selectedRule.noncurrentRuleActions[$index].value" disabled="selectedRule.noncurrentRuleActions[$index].action === \'\'" ng-keyup="validateDays($index,\'nonCurrent\')">\n                            </awsui-textfield>\n                            <span class="close-transition" ng-click="removeNoncurrentRuleAction($index)"> X </span>\n                        </td>\n                    </tr>\n                </table>\n                <awsui-alert type="error" visible="notANumberErrorNoncurrent.SIA" header="{{ \'lifecyclemodal.step2.numbersiaerrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.step2.numbererrormessage\' | translate }} </awsui-alert>\n                <awsui-alert type="error" visible="notANumberErrorNoncurrent.Glacier" header="{{ \'lifecyclemodal.step2.numberglaciererrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.step2.numbererrormessage\' | translate }} </awsui-alert>\n                <awsui-alert type="error" visible="minimumDaysNoncurrent.SIA" header="{{ \'lifecyclemodal.step2.minimumdayssiaerrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.step2.minimumdayssiaerrormessage\' | translate }} </awsui-alert>\n                <awsui-alert type="error" visible="minimumDaysNoncurrent.Glacier" header="{{ \'lifecyclemodal.step2.minimumdaysglaciererrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.step2.minimumdaysglaciererrormessage\' | translate }} </awsui-alert>\n                <awsui-alert type="error" visible="higherNumberErrorNoncurrent.SIA" header="{{ \'lifecyclemodal.step2.numbersiaerrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.highernumbererrormessage\' | translate }} </awsui-alert>\n                <awsui-alert type="error" visible="higherNumberErrorNoncurrent.Glacier" header="{{ \'lifecyclemodal.highernumbererrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.highernumbererrormessage\' | translate }} </awsui-alert>\n                <awsui-alert type="error" visible="greaterThanNonCurrentError.GlacierGreaterThanSIA" header="{{ \'lifecyclemodal.step2.glaciergreaterthansiaerrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.step2.glaciergreaterthansiaerrormessage\' | translate }} {{ noncurrentGlacierGreaterThanSIAValue }}</awsui-alert>\n                <awsui-alert type="error" visible="hasPrevError" header="{{ \'lifecyclemodal.step2.noruleactionerrorheader\' | translate }}"> {{ \'lifecyclemodal.step2.selectruleactionerror\'| translate }}</awsui-alert>\n                <div ng-if="selectedRule.noncurrentRuleActions.length === 0" class="modal-section"></div>\n            </div>\n        </div>\n        <div class="body-content" ng-if="state === STEP.EXPIRATION">\n            <p class="configure-expiration-label" translate="lifecyclemodal.step3.configureexpiration"></p>\n            <table class="upload-modal-radio-button-properties">\n                <tr>\n                    <td>\n                        <awsui-checkbox id="current-version-transition" class="step2-radio-label" ng-model="selectedRule.showStep3CurrentVersion" change="showStep3CurrentVersionChange()">\n                            <span class="show-version" translate="lifecyclemodal.step2.current"></span>\n                        </awsui-checkbox>\n                    </td>\n                    <td class="show-previous">\n                        <awsui-checkbox id="previous-version-transition" class="step2-radio-label" ng-model="selectedRule.showStep3PreviousVersion" change="showStep3PreviousVersionChange()">\n                            <span class="show-version" translate="lifecyclemodal.step2.noncurrent"></span>\n                        </awsui-checkbox>\n                    </td>\n                </tr>\n            </table>\n            <div ng-show="selectedRule.showStep3CurrentVersion">\n                <awsui-checkbox change="selectCurrentExpiration()" class="step2-radio-label" ng-model="selectedRule.expiration.enabled">\n                    <span class="expiration-label" translate="lifecyclemodal.expirecurrentversion"></span>\n                    <span class="tool-tip-cursor">\n                        <awsui-tooltip text="{{ \'lifecyclemodal.expirecurrobjs.tooltip\' | translate }}" position="bottom" size="small">\n                            <i class="awsui-icon alert-info-circle"></i>\n                        </awsui-tooltip>\n                    </span>\n                </awsui-checkbox>\n                <div ng-show="selectedRule.expiration.enabled">\n                    <span class="expiration-after" translate="lifecyclemodal.step3.after"></span>\n                    <span>\n                        <awsui-textfield id="expiration-days" class="expiration-days lifecycle-modal-input" ng-class="{ \'highlight-error\' : highlightTextBoxErrorCurrent[2] }" ng-keyup="validateCurrentExpiration()" ng-model="selectedRule.expiration.days">\n                        </awsui-textfield>\n                    </span>\n                    <span class="from-object-creation" translate="lifecyclemodal.fromobjectcreation"></span>\n                </div>\n                <awsui-alert type="error" visible="notANumberErrorCurrent.Expire" header="{{ \'lifecyclemodal.step2.numberexpireerrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.step2.numbererrormessage\' | translate }} </awsui-alert>\n                <awsui-alert type="error" visible="minimumDaysCurrent.Expire" header="{{ \'lifecyclemodal.step2.minimumdaysexpireerrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.step2.minimumdaysexpireerrormessage\' | translate }} </awsui-alert>\n                <awsui-alert type="error" visible="higherNumberErrorCurrent.Expire" header="{{ \'lifecyclemodal.highernumbererrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.highernumbererrormessage\' | translate }} </awsui-alert>\n                <awsui-alert type="error" visible="greaterThanCurrentError.DeleteGreaterThanGlacier">\n                    {{ \'lifecyclemodal.step2.expiregreaterthanglaciererrormessage\' | translate }} {{ expireGreaterThanGlacierValue }} </awsui-alert>\n                <awsui-alert type="error" visible="greaterThanCurrentError.DeleteGreaterThanSIA">\n                    {{ \'lifecyclemodal.step2.expiregreaterthansiaerrormessage\' | translate }} {{ expireGreaterThanSIAValue }} </awsui-alert>\n            </div>\n            <div ng-show="selectedRule.showStep3PreviousVersion">\n                <awsui-checkbox class="step2-radio-label" change="selectNoncurrentExpiration()" class="step2-radio-label" ng-model="selectedRule.permanentlyDelete.enabled">\n                    <span class="expiration-label"> {{ \'lifecyclemodal.step3.permanentlydelete\' | translate }} </span>\n                    <span class="tool-tip-cursor">\n                        <awsui-tooltip text="{{ \'lifecyclemodal.delprevversions.tooltip\' | translate }}" position="bottom" size="small">\n                            <i class="awsui-icon alert-info-circle"></i>\n                        </awsui-tooltip>\n                    </span>\n                </awsui-checkbox>\n                <div ng-show="selectedRule.permanentlyDelete.enabled">\n                    <span class="expiration-after" translate="lifecyclemodal.step3.after"></span>\n                    <span>\n                        <awsui-textfield id="permanently-delete-days" class="expiration-days lifecycle-modal-input" ng-class="{ \'highlight-error\' : highlightTextBoxErrorNonCurrent[2] }" ng-keyup="validateNoncurrentExpiration()" ng-model="selectedRule.permanentlyDelete.days">\n                        </awsui-textfield>\n                    </span>\n                    <span class="from-object-creation" translate="lifecyclemodal.step3.afterbecomingpreviousversion"></span>\n                </div>\n                <awsui-alert type="error" visible="minimumDaysNoncurrent.PermanentlyDelete" header="{{ \'lifecyclemodal.step2.minimumdayspermanentlydeleteerrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.step2.minimumdayspermanentlydeleteerrormessage\' | translate }}</awsui-alert>\n                <awsui-alert type="error" visible="notANumberErrorNoncurrent.PermanentlyDelete" header="{{ \'lifecyclemodal.step2.numberpermanentlydeleteerrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.step2.numbererrormessage\' | translate }} </awsui-alert>\n                <awsui-alert type="error" visible="higherNumberErrorNoncurrent.PermanentlyDelete" header="{{ \'lifecyclemodal.highernumbererrorheader\' | translate }}">\n                    {{ \'lifecyclemodal.highernumbererrormessage\' | translate }} </awsui-alert>\n                <awsui-alert type="error" visible="greaterThanNonCurrentError.DeleteGreaterThanSIA">\n                    {{ \'lifecyclemodal.step2.permanentlydeletegreaterthansiaerrormessage\' | translate }} {{ permanentlyDeleteGreaterThanSIAValue }} </awsui-alert>\n                <awsui-alert type="error" visible="greaterThanNonCurrentError.DeleteGreaterThanGlacier">\n                    {{ \'lifecyclemodal.step2.permanentlydeletegreaterthanglaciererrormessage\' | translate }} {{ permanentlyDeleteGreaterThanGlacierValue }} </awsui-alert>\n            </div>\n            <p class="for-amu" translate="lifecyclemodal.step3.ldmamucleanup"></p>\n            <awsui-checkbox data-disabled="(!selectedRule.showRldm || (selectedRule.filters.tagFilters.length > 0))" class="expiration-after-section" ng-model="selectedRule.removeExpire">\n                <span ng-class="{ \'disable-text\' : (!selectedRule.showRldm || (selectedRule.filters.tagFilters.length > 0)) }" class="expiration-label" translate="lifecyclemodal.step3.ldmcleanup"></span>\n                <span class="tool-tip-cursor">\n                    <awsui-tooltip text="{{ \'lifecyclemodal.cleanupuploads.tooltip\' | translate }}" position="bottom" size="small">\n                        <i class="awsui-icon alert-info-circle"></i>\n                    </awsui-tooltip>\n                </span>\n            </awsui-checkbox>\n            <awsui-alert class="modal-warning" visible="(!selectedRule.showRldm && !(selectedRule.filters.tagFilters.length > 0))" type="warning">\n                {{ \'lifecyclemodal.warning.disableldmexpire\' | translate }}\n            </awsui-alert>\n            <awsui-checkbox data-disabled="(selectedRule.filters.tagFilters.length > 0)" class="expiration-after-section" change="selectAmuAction()" ng-model="selectedRule.amu.enabled">\n                <span ng-class="{ \'disable-text\' : (selectedRule.filters.tagFilters.length > 0) }" class="expiration-label" translate="lifecyclemodal.step3.imucleanup"></span>\n                <span class="tool-tip-cursor">\n                    <awsui-tooltip text="{{ \'lifecyclemodal.cleanupldm.tooltip\' | translate }}" position="bottom" size="small">\n                        <i class="awsui-icon alert-info-circle"></i>\n                    </awsui-tooltip>\n                </span>\n            </awsui-checkbox>\n            <div ng-if="selectedRule.amu.enabled">\n                <span class="expiration-after" translate="lifecyclemodal.step3.after"></span>\n                <span>\n                    <awsui-textfield ng-keyup="validateAmuDays()" class="expiration-days date-styling-override lifecycle-modal-input" ng-model="selectedRule.amu.days">\n                    </awsui-textfield>\n                </span>\n                <span class="from-object-creation" translate="lifecyclemodal.step3.fromstartofupload"></span>\n            </div>\n            <awsui-alert type="error" visible="notANumberAmuError" header="{{ \'lifecyclemodal.step2.numberamuerrorheader\' | translate }}">\n                {{ \'lifecyclemodal.step2.numbererrormessage\' | translate }} </awsui-alert>\n            <awsui-alert type="error" visible="minimumDaysAmuError" header="{{ \'lifecyclemodal.step2.minimumdaysamuerrorheader\' | translate }}">\n                {{ \'lifecyclemodal.step2.minimumdaysamuerrormessage\' | translate }} </awsui-alert>\n            <awsui-alert class="modal-warning" visible="(selectedRule.filters.tagFilters.length > 0)" type="warning">\n                {{ \'lifecyclemodal.warning.disableldmandamu\' | translate }}\n            </awsui-alert>\n            <awsui-alert type="error" visible="higherNumberErrorAmu" header="{{ \'lifecyclemodal.highernumbererrorheader\' | translate }}">\n                {{ \'lifecyclemodal.highernumbererrormessage\' | translate }} </awsui-alert>\n        </div>\n        <div class="body-content" ng-if="state === STEP.REVIEW">\n            <table id="review-table" class="review-table">\n                <tr>\n                    <td class="review-subheader" translate="lifecyclemodal.label.nameandscope"></td>\n                    <td class="edit-button">\n                        <awsui-button class="button-in-darkbg" text="{{ \'lifecyclemodal.button.edit\' | translate }}" variant="link" ng-click="setState(STEP.NAME_AND_SCOPE)">\n                        </awsui-button>\n                    </td>\n                </tr>\n            </table>\n            <table class="details-table">\n                <tr>\n                    <td><span class="detail-name" translate="lifecyclemodal.step3.label.name"></span><span class="details"> {{ selectedRule.summary.ruleName }} </span></td>\n                </tr>\n                <tr>\n                    <td class="scope-name"><span class="detail-name" translate="lifecyclemodal.step3.label.scope"></span><span class="details"> {{ selectedRule.summary.prefix }} </span></td>\n                </tr>\n            </table>\n            <table class="review-table">\n                <tr>\n                    <td class="review-rule" translate="lifecyclemodal.label.rule"></td>\n                    <td class="edit-button">\n                        <awsui-button class="button-in-darkbg" text="{{ \'lifecyclemodal.button.edit\' | translate }}" variant="link" click="setState(STEP.TRANSITION)">\n                        </awsui-button>\n                    </td>\n                </tr>\n            </table>\n            <div class="review-content"></div>\n            <p ng-if="selectedRule.summary.currentVersionHeader" class="review-subheader version-header" translate="lifecyclemodal.currentversion"></p>\n            <div class="review-content" ng-if="selectedRule.summary.currentTransitionsList[0] !== \'\'">\n                <div class="review-subheader review-content-description">\n                    <span class="review-content-header" translate="lifecyclemodal.review.transition"></span>\n                    <span class="transition-details">{{ selectedRule.summary.currentTransitionsList[0] }} </span>\n                </div>\n            </div>\n            <div class="review-content" ng-if="selectedRule.summary.currentTransitionsList[1] !== \'\'">\n                <div class="review-subheader review-content-description">\n                    <span class="review-content-header" translate="lifecyclemodal.review.transition"></span>\n                    <span class="transition-details">{{ selectedRule.summary.currentTransitionsList[1] }} </span>\n                </div>\n            </div>\n            <p ng-if="selectedRule.summary.noncurrentVersionHeader" class="review-subheader version-header review-section-header" translate="lifecyclemodal.noncurrentversion"></p>\n            <div class="review-content" ng-if="selectedRule.summary.noncurrentTransitionsList[0] !== \'\'">\n                <div class="review-subheader review-content-description">\n                    <span class="review-content-header" translate="lifecyclemodal.review.transition"></span>\n                    <span class="transition-details">{{ selectedRule.summary.noncurrentTransitionsList[0] }} </span>\n                </div>\n            </div>\n            <div class="review-content" ng-if="selectedRule.summary.noncurrentTransitionsList[1] !== \'\'">\n                <div class="review-subheader review-content-description">\n                    <span class="review-content-header" translate="lifecyclemodal.review.transition"></span>\n                    <span class="transition-details">{{ selectedRule.summary.noncurrentTransitionsList[1] }} </span>\n                </div>\n            </div>\n            <table class="review-table">\n                <tr>\n                    <td class="review-rule" translate="lifecyclemodal.expiration"></td>\n                    <td class="edit-button">\n                        <awsui-button class="button-in-darkbg" text="{{ \'lifecyclemodal.button.edit\' | translate }}" variant="link" click="setState(STEP.EXPIRATION)">\n                        </awsui-button>\n                    </td>\n                </tr>\n            </table>\n            <div class="review-content"></div>\n            <div class="review-content" ng-if="(selectedRule.expiration.enabled && selectedRule.expiration.days !==\'\')">\n                <div class="review-subheader review-content-description">\n                    <span class="review-content-header" translate="lifecyclemodal.expire"></span>\n                    <span class="transition-details"> {{ selectedRule.expiration.days }} </span>\n                    <span translate="lifecyclemodal.days"></span>\n                </div>\n            </div>\n            <div class="review-content" ng-if="(selectedRule.permanentlyDelete.enabled && selectedRule.permanentlyDelete.days !==\'\')">\n                <div class="review-subheader review-content-description">\n                    <span class="review-content-header" translate="lifecyclemodal.permanentlydelete"></span>\n                    <span class="transition-details"> {{ selectedRule.permanentlyDelete.days }} </span>\n                    <span translate="lifecyclemodal.days"></span>\n                </div>\n            </div>\n            <p ng-if="selectedRule.summary.rldm" class="review-subheader review-content-header" translate="lifecyclemodal.step3.ldmcleanup"></p>\n            <div ng-if="selectedRule.summary.amu !== \'\'">\n                <div class="review-subheader review-content-description">\n                    <span class="review-content-header" translate="lifecyclemodal.step3.imucleanup"></span>\n                    <span translate="lifecyclemodal.step3.afterdays"></span>\n                    <span class="transition-details"> {{ selectedRule.summary.amu }} </span>\n                    <span translate="lifecyclemodal.days"></span>\n                </div>\n            </div>\n            <awsui-alert visible="lifecycleError" class="block small-top-margin" type="error" dismissible="false" header="{{ \'lifecyclemodal.step3.error.header\' | translate }}"> {{ lifecycleError }}\n            </awsui-alert>\n            <awsui-alert visible="stateChangeWarning" type="warning"> {{ stateChangeWarning }}</awsui-alert>\n            <awsui-alert visible="showOverlappingPrefixWarning" type="warning">\n                <div translate="lifecyclemodal.warning.overlappingprefix" translate-values="{ overlappingRule : overlappingRule }">\n                </div>\n                <div ng-if="showOverlappingNewFormatWarning" translate="lifecyclemodal.warning.overlappingprefixnewformatwarning">\n                </div>\n            </awsui-alert>\n        </div>\n    </div>\n    <div class="lifecycle-modal-footer" transclude-name="footer">\n        <awsui-button id="next-step" ng-if="state !== STEP.REVIEW" data-disabled="((state === STEP.NAME_AND_SCOPE && (!selectedRule.ID || (selectedRule.applied === \'prefix\' && !selectedRule.Prefix)\n                      || tag.error !== \'\'))\n                      || (state !== STEP.NAME_AND_SCOPE && selectedRule.isNextButtonDisabled))" variant="primary" text="{{ \'lifecyclemodal.footer.next\' | translate }}" class="awsui-util-f-r primary-button" click="generateSummary()">\n        </awsui-button>\n        <awsui-button id="save-rule" ng-if="state === STEP.REVIEW && !showContinue" click="detectStateChange()" variant="primary" text="{{ \'lifecyclemodal.footer.save\' | translate }}" class="awsui-util-f-r primary-button">\n        </awsui-button>\n        <awsui-button id="continue-rule" ng-if="state === STEP.REVIEW && showContinue" click="saveLifecycle()" variant="primary" text="{{ \'lifecyclemodal.footer.continue\' | translate }}" class="awsui-util-f-r primary-button">\n        </awsui-button>\n        <awsui-button id="cancel-rule" text="{{ \'lifecyclemodal.footer.cancel\' | translate }}" variant="normal" ng-if="state === STEP.NAME_AND_SCOPE" class="awsui-util-f-r" click="closeLifecycleModal()">\n        </awsui-button>\n        <awsui-button id="previous-step" text="{{ \'lifecyclemodal.footer.previous\' | translate }}" variant="normal" ng-if="state !== STEP.NAME_AND_SCOPE" class="awsui-util-f-r" click="goToPreviousStep()">\n        </awsui-button>\n    </div>\n</modal>');a.put("/s3/partials/modal.html",'<div class="aws-modal">\n    <div ng-show="isOpen.flag" class="modal-frame fade in ng-hide">\n        <div class="modal-header modal-header-image" transclude="header">\n            <i class="panel-close-icon modal-close" ng-click="closeModal()"></i>\n            <div class="modal-header-title">{{headerTitle}}</div>\n            \n            <table id="header-steps" class="header-steps" ng-if="steps">\n                <tr>\n                    <td class="attained-step" ng-if="getState(0)">\n\n                        <div class="modal-header-value" ng-class="{ \'selected-step\': state === getState(0) }"><span class="modal-image" ng-class="state === getState(0) ? \'modal-stepone-selected-image\' : \'modal-checked-image\'"></span><span class="modal-stepname">{{getState(0).value}}</span></div>\n                    </td>\n                    <td ng-if="getState(1)" ng-class="state !== getState(0) ? \'attained-step\' : \'step\'">\n\n                        \n                        <div class="modal-header-value" ng-class="{ \'selected-step\': state === getState(1) }"><span class="modal-image" ng-class="{\'modal-steptwo-selected-image\': state==getState(1),\n                            \'modal-steptwo-unselected-image\': state === getState(0),\n                            \'modal-checked-image\': state === getState(2) || state===getState(3)}"></span><span class="modal-stepname">{{getState(1).value}}</span></div>\n                    </td>\n                    <td ng-if="getState(2)" ng-class="state === getState(2) || state===getState(3)? \'attained-step\' : \'step\'">\n                        \n                        <div class="modal-header-value" ng-class="{ \'selected-step\': state === getState(2) }"><span class="modal-image" ng-class="{\'modal-stepthree-selected-image\': state==getState(2),\n                            \'modal-stepthree-unselected-image\': state === getState(0) || state===getState(1),\n                            \'modal-checked-image\': state === getState(3)}"></span><span class="modal-stepname">{{getState(2).value}}</span></div>\n                    </td>\n                    <td ng-if="getState(3)" ng-class="state === getState(3) ? \'attained-step\' : \'step\'">\n                        \n\n                        <div class="modal-header-value" ng-class="{ \'selected-step\': state === getState(3) }"><span class="modal-image" ng-class="state === getState(3) ? \'modal-stepfour-selected-image\' : \'modal-stepfour-unselected-image\'"></span><span class="modal-stepname">{{getState(3).value}}</span></div>\n                    </td>\n                </tr>\n            </table>\n            <div class="modal-header-divider"></div>\n        </div>\n        <div class="modal-body" transclude="content"></div>\n        <div class="modal-footer" transclude="footer">\n            <div class="footer-divider"></div>\n        </div>\n    </div>\n    <div ng-show="isOpen.flag" class="modal-background ng-hide"></div>\n</div>');a.put("/s3/partials/modalpermissions.html",'<div class="modal-permissions">\n    <div>\n        <awsui-expandable-section class="modalpermissionexpand dark" header="{{ \'modal.acl.header.manageusers\' | translate }}">\n            \n            <permissions-sub-modal is-public="false" acl-modal-titles="manageUserTitles" permissions="userPermissions">\n            </permissions-sub-modal>\n        </awsui-expandable-section>\n    </div>\n    <div>\n        <awsui-expandable-section class="modalpermissionexpand dark" header="{{ \'modal.acl.header.managepublicpermissions\' | translate }}">\n            \n            <permissions-sub-modal is-public="true" acl-modal-titles="publicpermissionsecTitles" permissions="publicPermissions">\n            </permissions-sub-modal>\n        </awsui-expandable-section>\n    </div>\n</div>');a.put("/s3/partials/object-details/objectdetails.html",'<div class="object-details">\n    <div class="watermark-wrapper header-section">\n        <div class="watermark watermark-file"></div>\n        <breadcrumbs></breadcrumbs>\n        <div class="file-name-container">\n            <span class="file-name">{{obj.Key}}</span>\n            <div class="version-label-container" ng-click="listVersions($event)">\n                <span class="version-label">{{versionLabel}}</span>\n                <div class="versions-dropdown-caret"></div>\n            </div>\n            <versions-dropdown bucket="bucket" error="error" get-metadata="getMetadata(operation, versionId)" key="key" obj="obj" selected-tab="selectedTab" show-versions-dropdown="showVersionsDropdown" version-label="versionLabel">\n            </versions-dropdown>\n        </div>\n    </div>\n    <awsui-tabs class="object-tabs" tabs="tabs" ng-model="selectedTab" ng-switch="selectedTab">\n        <div ng-switch-default="" class="overview">\n            <awsui-alert type="success" visible="showSuccessMessage">{{ successMessageString }}</awsui-alert>\n            <awsui-button class="action-button-spacing" id="open" variant="normal" text="{{ \'objectdetails.button.open\' | translate }}" click="openSelectedObject()" data-disabled="actionButtonsDisabled()">\n            </awsui-button>\n            <awsui-button class="action-button-spacing" id="download" variant="normal" text="{{ \'objectdetails.button.download\' | translate }}" click="downloadSelectedObject()" data-disabled="actionButtonsDisabled()">\n            </awsui-button>\n            <awsui-button class="action-button-spacing" id="downloadAs" variant="normal" text="{{ \'objectdetails.button.downloadAs\' | translate }}" click="openDownloadAsPanel()" data-disabled="actionButtonsDisabled()">\n            </awsui-button>\n            <awsui-button class="action-button-spacing" id="makepublic" variant="normal" text="{{ \'objectdetails.button.makepublic\' | translate }}" click="makePublic()" loading="isMakingPublic" data-disabled="actionButtonsDisabled()">\n            </awsui-button>\n            <div class="awsui-util-p-l"></div>\n            <div class="header" translate="objectdetails.overview.owner"></div>\n            <div class="awsui-util-pb-m" id="objectOwner">{{obj.Owner.DisplayName || obj.Owner.ID}}</div>\n            <div class="header" translate="objectdetails.overview.lastactivity"></div>\n            <div class="awsui-util-pb-m" id="objectLastActivity">{{obj.LastModified | date:"medium"}}</div>\n            <div class="header" translate="objectdetails.overview.etag"></div>\n            <div class="awsui-util-pb-m" id="objectEtag">{{obj.ETag}}</div>\n            <div class="header" translate="objectdetails.overview.storageclass"></div>\n            <div class="awsui-util-pb-m" id="objectStorageClass">{{ getStorageClassTranslation() }}</div>\n            <div class="header" translate="objectdetails.overview.sse"></div>\n            <div ng-if="obj.Encryption !==  undefined" class="awsui-util-pb-m" id="objectServerSideEncryption">{{ getEncryptionTranslation() }}</div>\n            <div ng-if="obj.KmsID !== undefined" class="header" translate="objectdetails.overview.kmsid"></div>\n            <div ng-if="obj.KmsID !== undefined" class="awsui-util-pb-m">{{obj.KmsID}}</div>\n            <div ng-if="showReplication" class="header" translate="objectdetails.overview.replicationstatus"></div>\n            <div ng-if="showReplication" class="awsui-util-pb-m">{{obj.ReplicationStatus}}</div>\n            <div ng-if="showExpiry" class="header" translate="objectdetails.overview.expirydate"></div>\n            <div ng-if="showExpiry" class="awsui-util-pb-m">{{obj.ExpirationDate}}</div>\n            <div ng-if="showExpiry" class="header" translate="objectdetails.overview.expiryrule"></div>\n            <div ng-if="showExpiry" class="awsui-util-pb-m">{{obj.ExpirationRule}}</div>\n            <div ng-if="showRestoration" class="header" translate="objects.details.Restoration"></div>\n            <div ng-if="showRestoration" class="awsui-util-pb-m" translate="objectdetails.value.restoration"></div>\n            <div ng-if="restorationExpiry" class="header" translate="objects.details.RestorationExpiry"></div>\n            <div ng-if="restorationExpiry" class="awsui-util-pb-m">{{restorationExpiry}}</div>\n            <div class="header" translate="objectdetails.overview.size"></div>\n            <div class="awsui-util-pb-m" id="objectSize">{{obj.Size | humanReadableBytes }}</div>\n            <div ng-if="showVersionId" class="header" translate="objectdetails.overview.versionid"></div>\n            <div ng-if="showVersionId" class="awsui-util-pb-m">{{obj.versionId}}</div>\n            <div class="header" translate="objectdetails.overview.link"></div>\n            <a class="link awsui-util-pb-m" id="object-link" href="{{obj.Link}}">{{obj.Link}}</a>\n            <storage-console-config-panel class="download-side-panel" ng-class="{\'side-config-panel objects-side-panel\': downloadAsPanel, \'hide-config-panel objects-side-panel\': !downloadAsPanel}" panel-open="downloadAsPanel">\n                <header>\n                    <span class="side-panel-header download-as-panel-header" translate="object.download.destination"></span>\n                    <span class="panel-close-icon" ng-click="closeDownloadAsPanel()"></span>\n                </header>\n                <content>\n                    <div class="download-as-directions">\n                        <div class="download-as-directions-text" translate="object.download.directions"></div>\n                        <a ng-show="!downloadAsPanelGenerating && !downloadPanelError" ng-href="{{downloadPanel.url}}" id="downloadAsLink">{{ obj.Key }}</a>\n                        <div class="download-as-directions-text" ng-show="!downloadAsPanelGenerating && downloadPanelError" translate="object.download.error"></div>\n                        <span ng-show="downloadAsPanelGenerating" class="awsui-spinner awsui-spinner-light"></span>\n                    </div>\n                </content>\n            </storage-console-config-panel>\n        </div>\n        <div ng-switch-when="properties">\n            <object-properties obj="obj" options="options" get-metadata="getMetadata(operation, versionId)" bucket="bucket"></object-properties>\n        </div>\n        <div ng-switch-when="permissions" class="permissions-container">\n            <acl permission-obj="permissionObj" put-acl="putAcl" error="aclError" is-bucket-permission="false" bucket="bucket" is-glacier="obj && obj.StorageClass === \'GLACIER\' && !restorationExpiry"></acl>\n        </div>\n        <awsui-alert visible="objectDetailError && selectedTab === \'overview\'" class="block small-top-margin permissions-error" type="error" dismissible="false" header="{{ \'error.header\' | translate }}"> {{ objectDetailError }}\n        </awsui-alert>\n        <awsui-alert visible="objectPropertiesError && selectedTab === \'properties\'" class="block small-top-margin permissions-error" type="error" dismissible="false" header="{{ \'error.header\' | translate }}"> {{ objectPropertiesError}}\n        </awsui-alert>\n        <awsui-alert visible="aclError && selectedTab === \'permissions\'" class="block small-top-margin permissions-error" type="error" dismissible="false" header="{{ \'error.header\' | translate }}"> {{ aclError }}\n        </awsui-alert>\n        <awsui-alert visible="warning" class="block small-top-margin permissions-error" type="warning" dismissible="false" header="{{ \'warning.header\' | translate }}"> {{ warning }}\n        </awsui-alert>\n    </awsui-tabs>\n</div>');a.put("/s3/partials/object-details/objectmetadata.html",'<card card-id="scrollCardId" card-summary-obj="cardSummaryObj" is-open="cardOpen" ng-class="{ \'card-disable-metadata-water-mark\': !cardOpen, \'card-enable-metadata-water-mark\': cardOpen }">\n    <div transclude-name="header">\n        <span translate="objectproperties.label.metadata"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="cancel($event)"></div>\n    </div>\n    <div transclude-name="content">\n        <p class="bucketproperties-summary" ng-if="!cardOpen" translate="objectdetail.metadata.blurb"></p>\n        <div ng-if="cardOpen">\n            <awsui-button id="objectmetadata-addnew" data-disabled="obj && obj.StorageClass===\'GLACIER\'" text="{{\'objectdetail.metadata.addnew\' | translate}}" icon="plus" variant="link" click="addMetadata(selectedRow)"></awsui-button>\n            <awsui-button id="objectmetadata-delete" data-disabled="isDeleteAndEditDisabled(selectedRow)" text="{{\'events.button.delete\' | translate}}" variant="link" click="deleteMetadata(selectedRow)" loading="isDeleting">\n            </awsui-button>\n            <awsui-button id="objectmetadata-edit" data-disabled="isDeleteAndEditDisabled(selectedRow)" text="{{ \'events.button.edit\' | translate }}" variant="link" click="editMetadata(selectedRow)">\n            </awsui-button>\n            <awsui-tooltip text="{{\'objectproperties.metadata.tooltip\' | translate}}" position="right" size="small">\n                <i class="awsui-icon alert-info-circle"></i>\n            </awsui-tooltip>\n            <awsui-radio-group ng-model="selectedRow.scopeIndex" ng-change="switchSelectedRow(selectedRow)">\n                <table class="table-condense metadata-table">\n                    <thead>\n                    <tr>\n                        <td></td>\n                        <td translate="">objectdetail.metadata.key</td>\n                        <td translate="">objectdetail.metadata.value</td>\n                    </tr>\n                    </thead>\n                    <tbody>\n                    <tr class="newmetadatarow" ng-repeat-start="newMetadata in newMetadataList">\n                        <td>\n                            <awsui-radio-button value="newMetadataList:{{$index}}">\n                        <td translate="">objectdetail.metadata.newmetadata</td>\n                        <td>\n                            <span class="newmetadata-delete close-icon" ng-click="removeNewMetadata($index, $event, selectedRow)"></span>\n                        </td>\n                        </awsui-radio-button>\n                        </td>\n                    </tr>\n                    <tr ng-repeat-end="">\n                        <td></td>\n                        <td class="newMetadata-dropdown">\n                            <awsui-control-group validation-message="{{ newMetadata.metadataKey.error }}">\n                                <dropdown disabled="!newMetadata.isEditing" items="predefinedMetadata" selected-item="newMetadata.metadataKey" filter="true" placeholder="{{ \'objectdetail.metadata.key-placeholder\' | translate }}"></dropdown>\n                            </awsui-control-group>\n                        </td>\n                        <td class="metadata-value-input">\n                            <dropdown disabled="!newMetadata.isEditing" ng-if="newMetadata.metadataKey.dropDownValue" items="newMetadata.metadataKey.dropDownValue" selected-item="newMetadata.metadataValue" filter="true" placeholder="{{\'objectdetail.metadata.value-placeholder\' | translate}}">\n                            </dropdown>\n                            <awsui-control-group validation-message="{{  newMetadata.metadataValue.inputError }}">\n                                <awsui-textfield data-disabled="!newMetadata.isEditing" ng-model="newMetadata.metadataValue.text" ng-if="newMetadata.metadataKey && !newMetadata.metadataKey.dropDownValue"></awsui-textfield>\n                            </awsui-control-group>\n                        </td>\n                    </tr>\n                    <tr class="metadatarow" ng-repeat="metadata in userDefinedMetadata | orderBy: \'metadataKey.text\' ">\n                        <td>\n                            <awsui-radio-button value="userDefinedMetadata:{{getIndex(metadata)}}">\n                        <td>\n                            <div class="metatext" ng-if="!metadata.isEditing">{{ metadata.metadataKey.inputValue || metadata.metadataKey.text }}</div>\n                            <awsui-control-group validation-message="{{ metadata.metadataKey.error }}">\n                                <dropdown ng-if="metadata.isEditing" items="predefinedMetadata" selected-item="metadata.metadataKey" filter="true" placeholder="{{ \'objectdetail.metadata.key-placeholder\' | translate }}"></dropdown>\n                            </awsui-control-group>\n                        </td>\n                        <td class="metadata-value-input">\n                            <div class="metatext" ng-if="!metadata.isEditing">{{ metadata.metadataValue.text }}</div>\n                            <dropdown ng-if="metadata.isEditing && metadata.metadataKey.dropDownValue" items="metadata.metadataKey.dropDownValue" selected-item="metadata.metadataValue" filter="true" enable-input="true" input-field="metadata.metadataValue" placeholder="{{ \'objectdetail.metadata.value-placeholder\' | translate }}"></dropdown>\n                            <awsui-control-group validation-message="{{ metadata.metadataValue.inputError }}">\n                                <awsui-textfield ng-model="metadata.metadataValue.text" ng-if="metadata.isEditing && metadata.metadataKey && !metadata.metadataKey.dropDownValue"></awsui-textfield>\n                            </awsui-control-group>\n                        </td>\n                    </awsui-radio-button></td></tr>\n                    </tbody>\n                </table>\n            </awsui-radio-group>\n        </div>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n        <awsui-alert class="input-error" type="error" header="{{ \'error.header\' | translate }}" ng-if="validationError && cardOpen">\n            <p translate="objectdetail.metadata.multisamekeywarning" translate-values="{ errorMsg : \'{{validationError}}\' }"></p>\n        </awsui-alert>\n        <awsui-alert class="input-error" type="error" header="{{ \'error.header\' | translate }}" ng-if="metadataError && cardOpen">{{ metadataError }}</awsui-alert>\n    </div>\n    <div transclude-name="footer">\n        <div ng-if="cardOpen">\n            <awsui-button id="objectmetadata-save" ng-click="save($event)" data-disabled="obj && obj.StorageClass===\'GLACIER\'" text="{{ \'button.save\' | translate }}" class="awsui-util-f-r object-property-button" loading="isSaving" variant="primary"></awsui-button>\n            <awsui-button id="objectmetadata-cancel" ng-click="cancel($event)" text="{{ \'button.cancel\' | translate }}" class="awsui-util-f-r object-property-button"></awsui-button>\n        </div>\n    </div>\n</card>');a.put("/s3/partials/object-details/objectproperties.html",'<div class="awsui-grid">\n    <div class="awsui-container properties-cards">\n        <div class="wrapper awsui-row object-properties">\n            <object-storage-class id="object-storage-card" obj="obj"></object-storage-class>\n            <object-encryption id="object-sse-card" obj="obj" options="options" update-data="updateData()"></object-encryption>\n            <object-metadata id="object-metadata-card" obj="obj"></object-metadata>\n            <object-tag id="object-tags-card" obj="obj" fac-id="s3-ot"></object-tag>\n        </div>\n    </div>\n</div>');a.put("/s3/partials/object-details/objectsse.html",'<card card-id="scrollCardId" card-summary-obj="cardSummaryObj" is-open="cardOpen" disable-expand="obj && obj.StorageClass === \'GLACIER\'" ng-class="{ \'card-disable-sse-water-mark\': !cardOpen, \'card-enable-sse-water-mark\': cardOpen }">\n    <div transclude-name="header">\n        <span translate="objectproperties.label.sse"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="cancel($event)"></div>\n    </div>\n    <div transclude-name="content">\n        <p class="bucketproperties-summary" ng-if="!cardOpen" translate="objectproperties.sse.blurb"></p>\n        <div class="awsui-container" ng-if="cardOpen">\n            <div class="awsui-row card-content-row">\n                <awsui-radio-group ng-model="obj.Encryption" ng-change="updateKMSKey(obj.Encryption)">\n                    <awsui-radio-button id="objectsse-none" value="NONE" ng-model="obj.Encryption" label="{{ \'sse.none\' | translate }}"></awsui-radio-button>\n                </awsui-radio-group>\n            </div>\n            <div class="awsui-row card-content-row">\n                <awsui-radio-group ng-model="obj.Encryption" ng-change="updateKMSKey(obj.Encryption)">\n                    <awsui-radio-button id="objectsse-aes256" value="AES256" ng-model="obj.Encryption" label="{{ \'sse.aes256\' | translate }}"></awsui-radio-button>\n                </awsui-radio-group>\n                <p class="object-radio-description" translate="objectproperties.sse.aes256description"></p>\n            </div>\n            <div class="awsui-row card-content-row" fac-id="s3-kms">\n                <awsui-radio-group ng-model="obj.Encryption" ng-change="updateKMSKey(obj.Encryption)">\n                    <awsui-radio-button id="objectsse-kms" value="aws:kms" ng-model="obj.Encryption" label="{{ \'sse.aws.kms\' | translate }}"></awsui-radio-button>\n                </awsui-radio-group>\n            </div>\n            <awsui-control-group validation-message="{{ KMSServiceError }}">\n                <dropdown ng-if="obj.Encryption===\'aws:kms\'" items="kmsKeys" placeholder="{{ \'objectproperties.placeholder.kmskeys\' | translate }}" disabled="KMSServiceError" selected-item="options.kmsId" filter="true">\n                </dropdown>\n            </awsui-control-group>\n            <awsui-textfield class="custom-kms-arn" ng-if="options.kmsId.value===\'CUSTOM_ARN\'" ng-model="options.kmsARN"></awsui-textfield>\n        </div>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n        <awsui-alert class="custom-kms-arn-error" type="error" ng-if="sseError && cardOpen"> {{ sseError }} </awsui-alert>\n    </div>\n    <div transclude-name="footer">\n        <div ng-if="cardOpen">\n            <awsui-button id="objectsse-save" ng-click="save($event)" disabled="obj.Encryption == cachedValue.Encryption" text="{{ \'button.save\' | translate }}" class="awsui-util-f-r object-property-button" loading="isSaving" variant="primary"></awsui-button>\n            <awsui-button id="objectsse-cancel" ng-click="cancel($event)" text="{{ \'button.cancel\' | translate }}" class="awsui-util-f-r object-property-button"></awsui-button>\n        </div>\n    </div>\n</card>');a.put("/s3/partials/object-details/objectstorageclass.html",'<card card-id="scrollCardId" card-summary-obj="cardSummaryObj" is-open="cardOpen" disable-expand="obj && obj.StorageClass === \'GLACIER\'" ng-class="{ \'card-disable-storage-class-water-mark\': !cardOpen, \'card-enable-storage-class-water-mark\': cardOpen }">\n    <div transclude-name="header">\n        <span translate="objectproperties.label.storageclass"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="cancel($event)"></div>\n    </div>\n    <div transclude-name="content">\n        <p class="bucketproperties-summary" ng-if="!cardOpen" translate="objectproperties.storageclass.blurb"></p>\n        <div class="awsui-container" ng-if="cardOpen">\n            <div class="awsui-row card-content-row">\n                <awsui-radio-group ng-model="obj.StorageClass">\n                    <awsui-radio-button id="objectstorage-standard" value="STANDARD" ng-model="obj.StorageClass" label="{{ \'storageclasses.standard\' | translate }}"></awsui-radio-button>\n                </awsui-radio-group>\n                <p class="object-radio-description" translate="objectproperties.storageclass.standarddescription"></p>\n            </div>\n            <div class="awsui-row card-content-row">\n                <awsui-radio-group ng-model="obj.StorageClass">\n                    <awsui-radio-button id="objectstorage-standardia" value="STANDARD_IA" ng-model="obj.StorageClass" label="{{ \'storageclasses.standardia\' | translate }}"></awsui-radio-button>\n                </awsui-radio-group>\n                <p class="object-radio-description" translate="objectproperties.storageclass.siadescription"></p>\n            </div>\n            <div class="awsui-row card-content-row">\n                <awsui-radio-group ng-model="obj.StorageClass">\n                    <awsui-radio-button id="objectstorage-reduced" value="REDUCED_REDUNDANCY" ng-model="obj.StorageClass" label="{{ \'storageclasses.rrs\' | translate }}"></awsui-radio-button>\n                </awsui-radio-group>\n                <p class="object-radio-description" translate="objectproperties.storageclass.rrsdescription"></p>\n            </div>\n        </div>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n        <div class="error-alert" ng-if="storageClassError && cardOpen">{{ storageClassError }}</div>\n    </div>\n    <div transclude-name="footer">\n        <div class="object-properties-buttons" ng-if="cardOpen">\n            <awsui-button id="objectstorage-save" ng-click="save($event)" data-disabled="obj.StorageClass == cachedValue.StorageClass" text="{{ \'button.save\' | translate }}" class="awsui-util-f-r object-property-button" loading="isSaving" variant="primary"></awsui-button>\n            <awsui-button id="objectstorage-cancel" ng-click="cancel($event)" text="{{ \'button.cancel\' | translate }}" class="awsui-util-f-r object-property-button"></awsui-button>\n        </div>\n    </div>\n</card>');a.put("/s3/partials/object-details/objecttag.html",'<card card-id="scrollCardId" card-summary-obj="cardSummaryObj" is-open="cardOpen" ng-class="{ \'card-disable-tags-water-mark\': !cardOpen, \'card-enable-tags-water-mark\': cardOpen }">\n    <div transclude-name="header">\n        <span translate="objectproperties.tags.label"></span>\n        <div class="card-close-icon" ng-show="cardOpen" ng-click="cancelObjectTagging($event)"></div>\n    </div>\n    <div transclude-name="content">\n        <p class="bucketproperties-summary" ng-if="!cardOpen" translate="objectproperties.tags.summary"></p>\n        <table class="tagging-table" ng-if="cardOpen">\n            <thead>\n            <tr>\n                <td></td>\n                <td translate="objectproperties.tags.key"></td>\n                <td translate="objectproperties.tags.value"></td>\n            </tr>\n            </thead>\n            <tbody>\n            <tr ng-repeat="tag in obj.Tagging">\n                <td>\n                    <awsui-control-group validation-message="{{tag.errorMessage}}">\n                        <awsui-textfield class="tag-input" ng-model="tag.Key"></awsui-textfield>\n                    </awsui-control-group>\n                </td>\n                <td>\n                    <awsui-control-group>\n                        <awsui-textfield class="tag-input" ng-model="tag.Value"></awsui-textfield>\n                    </awsui-control-group>\n                </td>\n                <td><a href="" class="remove-tag" ng-click="removeTag($index)">X</a></td>\n            </tr>\n            </tbody>\n        </table>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n        <awsui-button id="add-object-tag" ng-click="addTag()" ng-show="cardOpen" data-disabled="obj.Tagging.length >= maxAllowedTags || isAnyKeyEmpty()" icon="plus" class="object-properties-button" text="{{\'objectproperties.tags.addnew\' | translate}}"></awsui-button>\n        <awsui-alert class="tag-error" type="error" ng-show="tagError && tagErrorMessage !== \'\' && cardOpen">{{tagErrorMessage}}</awsui-alert>\n        <awsui-alert class="objecttag-replication-warning" ng-if="cardOpen" dismissible="false" type="warning"><p translate="replicationcard.warningmsg"></p></awsui-alert>\n    </div>\n    <div transclude-name="footer">\n        <div class="object-properties-buttons" ng-if="cardOpen">\n            <awsui-button id="objecttag-save" class="object-property-button awsui-util-f-r" ng-click="saveObjectTagging($event)" text="{{ \'button.save\' | translate }}" variant="primary"></awsui-button>\n            <awsui-button id="objecttag-cancel" class="object-property-button awsui-util-f-r" ng-click="cancelObjectTagging($event)" text="{{ \'button.cancel\' | translate }}"></awsui-button>\n        </div>\n    </div>\n</card>');a.put("/s3/partials/objectfrequencyanalytics.html",'<div class="object-freq">\n    <table ng-if="storage && dataRetrieved && frequencyTypes" class="info-table">\n        <tbody>\n            <tr>\n                <td>\n                    <span class="enabled-lightbulb-blue-image lightbulb-icon"></span>\n                </td>\n                <td>\n                    <table>\n                        <tbody>\n                            <tr>\n                                <td>\n                                    <span class="header-text header" translate="storageanalysis.label.accession"></span>\n                                </td>\n                            </tr>\n                            <tr>\n                                <td>\n                                    <span class="secondary-text header" translate="storageanalysis.label.analyzed" translate-values="{ days : daysAnalyzed}"></span>\n                                </td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </td>\n                <td>\n                    <awsui-select items="objectTypes" class="select-object-types" ng-model="storageClass.value" change="processData()" placeholder="{{\'storageanalysis.label.standard\' | translate}}"></awsui-select>\n                </td>\n                <td>\n                    <div class="info-legend-group">\n                        <div class="info-legend">\n                            <div class="info-color-box storage-back"></div>\n                            <span class="storage-color" translate="storageanalysis.label.storage"></span>\n                        </div>\n                        <div class="info-legend">\n                            <div class="info-color-box data-back"></div>\n                            <span class="data-color" translate="storageanalysis.label.dataRetrieved"></span>\n                        </div>\n                    </div>\n                </td>\n            </tr>\n        </tbody>\n    </table>\n    <table ng-if="storage && dataRetrieved && frequencyTypes" class="object-freq-table">\n        <tbody>\n            <tr>\n                <td class="cards" data-ng-repeat="i in [0, 1, 2]">\n                    <bar-chart-card chart-title="titles[i]" data="[storage[i], dataRetrieved[i]]" labels="labels" colors="{row: frequencyTypes[i].color, bars: barColors}" max-value="maxValue" width="width" height="height" footer="frequencyTypes[i]">\n                    </bar-chart-card>\n                </td>\n            </tr>\n            <tr>\n                <td class="cards" data-ng-repeat="i in [3, 4, 5]">\n                    <bar-chart-card chart-title="titles[i]" data="[storage[i], dataRetrieved[i]]" labels="labels" colors="{row: frequencyTypes[i].color, bars: barColors}" max-value="maxValue" width="width" height="height" footer="frequencyTypes[i]">\n                    </bar-chart-card>\n                </td>\n            </tr>\n        </tbody>\n    </table>\n</div>');a.put("/s3/partials/objects.html",'<awsui-alert type="error" header="{{\'error.header\'|translate}}" visible="currLocation.objects.error">{{currLocation.objects.error}}</awsui-alert>\n<div ng-hide="objectListError" class="object-list" filedrop="">\n    <div ng-class="{ \'object-nav-wrapper\': !showEmptyScreen, \'object-nav-wrapper-empty\': showEmptyScreen }">\n        <div class="action-strip" sticky-nav="fix-to-top" sticky-nav-padding-top="160">\n            <search ng-if="!showEmptyScreen" fetch-one-page-prefix="fetchOnePagePrefix(prefix)" fetch-one-page-tag="fetchOnePageTag()" filters="filters" markers="markers" tag-continuation-tokens="tagContinuationTokens"></search>\n            <awsui-button class="bucket-action-strip-button action-button-spacing" text="{{ \'objectactionstrip.upload\' | translate }}" ng-click="openUploadModal()" variant="primary" icon="upload" data-disabled="!isFeatureEnabled(\'s3-up\')"></awsui-button>\n            <awsui-button class="bucket-action-strip-button action-button-spacing" text="{{ \'objectactionstrip.createfolder\' | translate }}" ng-click="showCreateFolder()" variant="primary" icon="plus" data-disabled="!isFeatureEnabled(\'s3-cf\')"></awsui-button>\n            <action-dropdown class="moredropdown" get-selected-objects="getSelectedObjects" get-selected-folders="getSelectedFolders" is-single-object-only-selected="isSingleObjectOnlySelected" tag-filter-length="filters.tagFilters.length" text="{{ \'objectactionstrip.more\' | translate }}" items="more_dropdown" bucketname="bucketName" show-deleted="showDeleted"></action-dropdown>\n            <awsui-button-group class="bucket-action-show-deleted-objs" fac-id="s3-sdo">\n                <awsui-button ng-class="{selected: !showDeleted}" ng-click="showAllObjects()" text="{{ \'objectactionstrip.showall\' | translate }}"></awsui-button>\n                <awsui-button ng-class="{selected: showDeleted}" ng-click="showDeletedObjects()" text="{{ \'objectactionstrip.showdeleted\' | translate }}"></awsui-button>\n            </awsui-button-group>\n            <div class="refresh-button">\n                <span class="object-bucket-region" ng-bind="bucketRegion.text"></span>\n                <awsui-button id="refreshButton" icon="refresh" variant="standalone-icon" loading="isRefreshing" click="fetchObjects(false, false)"></awsui-button>\n            </div>\n        </div>\n    </div>\n    <empty-state ng-if="showEmptyScreen" open-modal="openUploadModal" type="\'object\'"></empty-state>\n    <div ng-if="noResultsMessage">{{noResultsMessage}}</div>\n    <div class="columbia-table object-table" ng-if="!showEmptyScreen && !noResultsMessage">\n        <div class="pages-row pages-row-top">\n            <div class="pages">\n                <awsui-button icon="angle-left" variant="standalone-icon" click="fetchPreviousPageOfObjects()" data-disabled="isFetchPreviousPageDisabled()"></awsui-button>\n                <span id="paginationNumbering">{{\'objects.pagination.viewing\' | translate}} {{ startKeyNum }} {{\'objects.pagination.to\' | translate}} {{ endKeyNum }} </span>\n                <awsui-button icon="angle-right" variant="standalone-icon" click="fetchNextPageOfObjects()" data-disabled="isFetchNextPageDisabled()"></awsui-button>\n            </div>\n        </div>\n        <table class="table table-condensed fix-width-table">\n            <thead>\n            <tr class="black-header">\n                <th><awsui-checkbox ng-model="allKeys.selected" change="selectAllKeys()"></awsui-checkbox></th>\n\n                    <th ng-click="setSortOrder(\'Key\')">\n                        <awsui-tooltip text="{{\'tooltip.pagesortonly\' | translate}}" position="bottom">\n                            <a translate="objects.column.key"></a>\n                            <span class="sorting-icon" ng-class="{\'sorting-ascending\': sortColumnName===\'Key\' && !reverseSortOrder, \'sorting-descending\': sortColumnName===\'Key\' && reverseSortOrder, \'sorting-disabled\': sortColumnName!==\'Key\'}"></span>\n                        </awsui-tooltip>\n                    </th>\n                    <th ng-click="setSortOrder(\'LastModified\')">\n                        <awsui-tooltip text="{{\'tooltip.pagesortonly\' | translate}}" position="bottom">\n                        <a translate="objects.column.lastmodified"></a>\n                        <span class="sorting-icon" ng-class="{\'sorting-ascending\': sortColumnName===\'LastModified\' && !reverseSortOrder, \'sorting-descending\': sortColumnName===\'LastModified\' && reverseSortOrder, \'sorting-disabled\': sortColumnName!==\'LastModified\'}"></span>\n                        </awsui-tooltip>\n                    </th>\n                    <th ng-click="setSortOrder(\'Size\')">\n                        <awsui-tooltip text="{{\'tooltip.pagesortonly\' | translate}}" position="bottom">\n                        <a translate="objects.column.size"></a>\n                        <span class="sorting-icon" ng-class="{\'sorting-ascending\': sortColumnName===\'Size\' && !reverseSortOrder, \'sorting-descending\': sortColumnName===\'Size\' && reverseSortOrder, \'sorting-disabled\': sortColumnName!==\'Size\'}"></span>\n                        </awsui-tooltip>\n                    </th>\n                    <th ng-click="setSortOrder(\'StorageClass\')">\n                        <awsui-tooltip text="{{\'tooltip.pagesortonly\' | translate}}" position="bottom">\n                        <a translate="objects.column.storageclass"></a>\n                        <span class="sorting-icon" ng-class="{\'sorting-ascending\': sortColumnName===\'StorageClass\' && !reverseSortOrder, \'sorting-descending\': sortColumnName===\'StorageClass\' && reverseSortOrder, \'sorting-disabled\': sortColumnName!==\'StorageClass\'}"></span>\n                        </awsui-tooltip>\n                    </th>\n            </tr>\n            </thead>\n            <tbody ng-hide="currLocation.loading">\n                <tr ng-if="createFolder.displayed">\n                    <td>\n                        <awsui-checkbox ng-click="$event.stopPropagation()"></awsui-checkbox>\n                    </td>\n                    <td class="awsui-icon folder-open">\n                        <update-object show-operation="createFolder.displayed" fetch-objects="fetchObjects" current-marker="currentMarker" default-placeholder="{{\'createfolder.input.defaultvalue\' | translate}}" operation="operation" reset-selection="resetSelection">\n                    </td>\n                    <td></td>\n                    <td></td>\n                    <td></td>\n                </tr>\n                <tr class="unselectable" unselectable="on" onselectstart="return false" ng-repeat="folder in currLocation.folders.relativePaths | orderBy:sortColumnName:reverseSortOrder" ng-class="{\'row-selected\': folder.selected, \'row-hover\' : hoverFolder && !folder.selected }" ng-mouseenter="hoverFolder = true" ng-mouseleave="hoverFolder = false" ng-show="currLocation.folders.relativePaths.length" ng-click="clickObjectRow($event, folder)" ng-dblclick="navigateIntoFolder(folder.Prefix)">\n                    <td><awsui-checkbox checked="folder.selected" change="selectOneMoreKey(folder, \'folderKey\')" ng-click="$event.stopPropagation()"></awsui-checkbox></td>\n                    <td class="awsui-icon folder-open truncate" ng-class="{\'awsui-icon-light\': folder.selected && !panelHide}">\n                        <a class="list-view-item-name object-name" ng-click="navigateIntoFolder(folder.Prefix); $event.stopPropagation()" ng-show="!folder.beingRenamed"> {{ folder.Prefix }} </a>\n                        <span ng-if="folder.beingRenamed">\n                            <update-object show-operation="folder.beingRenamed" fetch-objects="fetchObjects" current-marker="currentMarker" default-value="{{folder.Prefix}}" operation="operation" reset-selection="resetSelection">\n                        </span>\n                    </td>\n                    <td> -- </td>\n                    <td> -- </td>\n                    <td> -- </td>\n                </tr>\n                <tr class="unselectable" unselectable="on" onselectstart="return false" ng-repeat="obj in currLocation.objects.relativePaths | orderBy:sortColumnName:reverseSortOrder" ng-class="{\'row-selected\': obj.selected , \'row-hover\' : hoverObj && !obj.selected}" ng-mouseenter="hoverObj = true" ng-mouseleave="hoverObj = false" ng-click="clickObjectRow($event, obj)" ng-dblclick="openObjectInBrowser(obj)">\n                    <td><awsui-checkbox checked="obj.selected" change="selectOneMoreKey(obj, \'objectKey\')" ng-click="$event.stopPropagation();"></awsui-checkbox></td>\n                    <td class="truncate">\n                        <span class="awsui-icon" ng-class="getIconClass(obj)" ng-click="openObjectInBrowser(obj)"></span>\n                        <a class="list-view-item-name object-name" ng-click="goToObjectDetails(obj)" ng-show="!obj.beingRenamed"> {{ obj.Key }} </a>\n                        <span ng-if="obj.beingRenamed">\n                            <update-object show-operation="obj.beingRenamed" fetch-objects="fetchObjects" current-marker="currentMarker" default-value="{{obj.Key}}" operation="operation" reset-selection="resetSelection">\n                        </span>\n                    </td>\n                    <td ng-if="obj.LastModified !== \'\'">{{ obj.LastModified | date:"medium" }}</td>\n                    <td ng-if="obj.LastModified === \'\'"> -- </td>\n                    <td ng-if="obj.Size !== \'\'">{{ obj.Size | humanReadableBytes }}</td>\n                    <td ng-if="obj.Size === \'\'"> -- </td>\n                    <td ng-if="obj.StorageClass !== \'\'">{{ getStorageClassTranslation(obj.StorageClass)}}</td>\n                    <td ng-if="obj.StorageClass === \'\'"> -- </td>\n                </tr>\n            </tbody>\n        </table>\n        <div class="pages-row">\n            <div class="pages">\n                <awsui-button icon="angle-left" variant="standalone-icon" click="fetchPreviousPageOfObjects()" data-disabled="isFetchPreviousPageDisabled()"></awsui-button>\n                <span>{{\'objects.pagination.viewing\' | translate}} {{ startKeyNum }} {{\'objects.pagination.to\' | translate}} {{ endKeyNum }} </span>\n                <awsui-button icon="angle-right" variant="standalone-icon" click="fetchNextPageOfObjects()" data-disabled="isFetchNextPageDisabled()"></awsui-button>\n\n            </div>\n        </div>\n    </div>\n    <storage-console-config-panel ng-mouseenter="hoverDownloadPanel(true)" ng-mouseleave="hoverDownloadPanel(false)" class="download-side-panel" ng-class="{\'side-config-panel objects-side-panel\': downloadAsPanel, \'hide-config-panel objects-side-panel\': !downloadAsPanel}" panel-open="downloadAsPanel">\n        <header>\n            <span class="side-panel-header download-as-panel-header" translate="object.download.destination"></span>\n            <span class="panel-close-icon" ng-click="closeDownloadAsPanel()"></span>\n        </header>\n        <content>\n            <div class="download-as-directions">\n                <div class="download-as-directions-text" translate="object.download.directions"></div>\n                <a ng-show="!downloadAsPanelGenerating && !downloadPanelError" ng-href="{{downloadPanel.url}}" id="downloadAsLink">{{ getSelectedObjects()[0].Key }}</a>\n                <div class="download-as-directions-text" ng-show="!downloadAsPanelGenerating && downloadPanelError" translate="object.download.error"></div>\n                <span ng-show="downloadAsPanelGenerating" class="awsui-spinner awsui-spinner-light"></span>\n            </div>\n        </content>\n    </storage-console-config-panel>\n    <storage-console-config-panel ng-mouseenter="hoverObjectPropertiesPanel(true)" ng-mouseleave="hoverObjectPropertiesPanel(false)" ng-class="{\'side-config-panel objects-side-panel\': objectPropertiesPanel.show, \'hide-config-panel objects-side-panel\': !objectPropertiesPanel.show}" panel-open="objectPropertiesPanel.show">\n        <header>\n            <div class="truncate side-panel-header"> {{ objectPropertiesConfig.object.Key }}\n            </div>\n            <span class="panel-close-icon" ng-click="closeObjectPropertiesPanel()"></span>\n            <div class="version-label-container" ng-click="listVersions($event)">\n                        <span class="version-label"> {{ versionLabel.name }}</span>\n                        <div class="versions-dropdown-caret"></div>\n            </div>\n            <versions-dropdown bucket="bucketForVersionsDropdown.name" error="objectSelectedForSidePanel.error" get-metadata="getMetadata(operation, versionId)" set-up-metadata="setUpObjectMetadataForPropertiesPanel(obj)" update-obj-metadata="updateObjMetadata(obj)" update-obj-acl="updateObjAcl(obj)" key="versionDropdownKey.name" obj="objectSelectedForSidePanel.obj" versions="objectSelectedForSidePanel.versions" show-versions-dropdown="showVersionsDropdown" version-label="versionLabel.name" objects-page="objectsPage.show" refresh="refreshAndClearObjectsCacheForCurrentBucket()" object-properties-panel="objectPropertiesPanel">\n            </versions-dropdown>\n        </header>\n        <content>\n            <div class="objects-panel-config-lists" ng-repeat="(configTitle, configContent) in objectPropertiesConfig">\n                <div>\n                    <table ng-if="configTitle !== \'permissions\'">\n                        <tr class="objects-config-panel-content" ng-repeat="(configKey, configValue) in configContent">\n                            <td class="subtitle">{{ getPropertyTitleConditionally($first, \'objects.details.\', configTitle) }}</td>\n                            <td class="config-panel-content-left" translate="objects.details.{{configKey}}"></td>\n                            <td ng-if="configKey !== \'Link\'" class="config-panel-content-right">{{configValue}}</td>\n                            <td ng-if="configKey === \'Link\'" class="config-panel-content-right link"><a href="{{configValue}}">{{configValue}}</a></td>\n                        </tr>\n                    </table>\n                    <table ng-if="configTitle === \'permissions\'">\n                        <tr class="objects-config-panel-content">\n                            <td class="subtitle"><span translate="objects.details.permissions"></span></td>\n                            <td class="config-panel-content-left" translate="objects.details.owner"></td>\n                            <td class="config-panel-content-right">{{ configContent.owner }}</td>\n                        </tr>\n                    </table>\n                    <table class="object-side-panel-permissions-table" ng-repeat="(permissionHeader, properties) in configContent.grantees">\n                        <tr class="objects-config-panel-content">\n                            <td></td>\n                            <td class="config-panel-content-left config-panel-content-subheading"><span translate="objects.details.{{permissionHeader}}"></span></td>\n                            <td class="config-panel-content-right"></td>\n                        </tr>\n                        <tr class="objects-config-panel-content" ng-repeat="(permissionKey, permissionValue) in properties">\n                            <td class="subtitle"></td>\n                            <td class="config-panel-content-left"><span translate="objects.details.{{permissionKey}}"></span></td>\n                            <td class="config-panel-content-right">{{ permissionValue }} {{ \'objects.details.grantees\' | translate }}</td>\n                        </tr>\n                    </table>\n                </div>\n                <div ng-if="!$last" class="bucket-config-panel-divider"></div>\n            </div>\n            <awsui-alert class="version-dropdown-error" ng-if="objectSelectedForSidePanel.error !== \'\'" type="error"> {{ objectSelectedForSidePanel.error }} </awsui-alert>\n        </content>\n        <footer>\n            <awsui-button ng-click="downloadSelectedObject()" data-disabled="objectSelectedForSidePanel.obj.disableDownload" text="{{ \'objects.button.download\' | translate }}" variant="primary"></awsui-button>\n        </footer>\n    </storage-console-config-panel>\n</div>\n<upload-modal modal-open="isUploadModalDisplayed" current-path="currentPath" fetch-objects="fetchObjects" operation="operations.dragAndDropOperation" selected="selected" flags="flags" filedrop=""></upload-modal>\n<confirmation-dialog-modal ng-if="operation && isConfirmationModalOpen.dialogOpen.flag" is-open="isConfirmationModalOpen" count-info="countInfo" operation="operation">\n</confirmation-dialog-modal>\n<storage-console-config-panel class="multiselect-config-panel" ng-class="{\'side-config-panel objects-side-panel\': isConfirmationModalOpen.sidePanelOpen,\n                                  \'hide-config-panel objects-side-panel\': !isConfirmationModalOpen.sidePanelOpen}" panel-open="isConfirmationModalOpen.sidePanelOpen" is-side-panel="true" ng-mouseenter="hoverConfirmationPanel(true)" ng-mouseleave="hoverConfirmationPanel(false)">\n    <header>\n        <span class="side-panel-header multi-selected-configpanel-header">{{modalInfo.headTitle}}</span>\n        <span class="panel-close-icon" ng-click="cancelConfirmationPanel($event)"></span>\n        <p translate="mutiselectpanel.files" translate-values="{totalObjs: {{countInfo.objects}} }"></p>\n    </header>\n    <content>\n        <div class="initialrestore-panel" ng-if="opName === more_dropdown[3].items[1].opName">\n            <table>\n                <tr>\n                    <td class="initialrestore-toptext" translate="confirmationsidepanel.initiaterestore.toptext"></td>\n                </tr>\n                <tr>\n                    <td>\n                        <form class="initial-restore-panel-value" name="initialRestorePanel" autocomplete="off">\n                            <awsui-control-group validation-message="{{  (initialRestorePanel.initialRestoreValue.$error.required ? \'initialrestorevalue.emptywarning \' : panelSettingValues.inputErrorMsg) | translate }}">\n                                <awsui-textfield name="initialRestoreValue" ng-model="panelSettingValues.setting" ng-change="validateInitialRestoreValue(panelSettingValues)" required=""></awsui-textfield>\n                            </awsui-control-group>\n                        </form>\n                    </td>\n                </tr>\n                <tr>\n                    <td class="initialrestore-bottomtext" translate="confirmationsidepanel.initiaterestore.bottomtext"></td>\n                </tr>\n            </table>\n        </div>\n        <div class="add-object-tags" ng-if="opName === more_dropdown[3].items[4].opName">\n            <table class="tagging-table">\n                <thead>\n                    <tr>\n                        <td translate="objectproperties.tags.key" class="key-header"></td>\n                        <td translate="objectproperties.tags.value" class="value-header"></td>\n                    </tr>\n                </thead>\n                <tbody>\n                    <tr ng-repeat="tag in panelSettingValues.values">\n                        <td>\n                            <awsui-textfield class="tag-input" ng-model="tag.Key"></awsui-textfield>\n                        </td>\n                        <td>\n                            <awsui-textfield class="tag-input" ng-model="tag.Value"></awsui-textfield>\n                        </td>\n                        <td><a href="" class="remove-tag" ng-click="removeTag($index)">X</a></td>\n                    </tr>\n                </tbody>\n            </table>\n            <awsui-button ng-click="addTag()" data-disabled="panelSettingValues.values.length >= panelSettingValues.setting.maxKeys || isAnyKeyEmpty()" icon="plus" class="object-properties-button" text="{{\'objectproperties.tags.addnew\' | translate}}"></awsui-button>\n            <awsui-alert class="error-alert" type="error" ng-show="tagError">{{tagErrorMessage}}</awsui-alert>\n            <awsui-alert class="objecttag-replication-warning" dismissible="false" type="warning">\n                <p translate="replicationcard.warningmsg"></p>\n            </awsui-alert>\n        </div>\n        <div ng-repeat="value in panelSettingValues.values" ng-if="opName !== more_dropdown[1].items[2].opName && opName !== more_dropdown[3].items[4].opName">\n            <div class="awsui-row">\n                <awsui-radio-group class="sidepanel-radio-settings" ng-model="panelSettingValues.setting">\n                    <awsui-radio-button value="{{value[0]}}" ng-model="panelSettingValues.setting" label="{{ value[1] }}"></awsui-radio-button>\n                </awsui-radio-group>\n                <div class="sidepanel-radio-description" translate="{{value[2]}}"></div>\n            </div>\n        </div>\n    </content>\n\n    <footer>\n        <awsui-button ng-click="saveConfirmationPanel($event)" text="{{ \'button.save\' | translate }}" class="awsui-util-f-r object-property-button" loading="isCounting.flag" variant="primary"></awsui-button>\n        \n        <awsui-button ng-click="cancelConfirmationPanel($event)" text="{{ \'button.cancel\' | translate }}" class="awsui-util-f-r object-property-button"></awsui-button>\n    </footer>\n</storage-console-config-panel>');a.put("/s3/partials/permissionsSubModal.html",'<table class="expandsectable">\n    <tr class="subsectitle-row">\n        <td ng-repeat="aclTitle in aclModalTitles">\n            {{aclTitle.txt}}\n            <awsui-tooltip text="{{aclTitle.info}}" position="{{aclTitle.pos}}" size="small">\n                <i class="awsui-icon alert-info-circle"></i>\n            </awsui-tooltip>\n        </td>\n        <td></td>\n    </tr>\n    <tr class="subseccontent-row" ng-repeat="permission in permissions" ng-if="!permissions[$index].revokeAll">\n        <td ng-if="isPublic">{{permission.detail.text}}</td>\n        <td ng-if="!isPublic">{{permission.detail.DisplayName}}<span ng-if="$index===0" translate="userpermission.owner"></span></td>\n        <td>\n            <awsui-checkbox class="createbucketcheckbox" ng-model="permission.permissions.READ">{{ \'permissions.value.read\' | translate }}</awsui-checkbox>\n            <awsui-checkbox class="createbucketcheckbox" ng-model="permission.permissions.WRITE">{{ \'permissions.value.write\' | translate }}</awsui-checkbox>\n        </td>\n        <td>\n            <awsui-checkbox class="createbucketcheckbox" ng-model="permission.permissions.READ_ACP">{{ \'permissions.value.read\' | translate }}</awsui-checkbox>\n            <awsui-checkbox class="createbucketcheckbox" ng-model="permission.permissions.WRITE_ACP">{{ \'permissions.value.write\' | translate }}</awsui-checkbox>\n            <span class="permissions-sub-modal-close close-icon" ng-if="!isPublic" ng-click="deleteUserAcl($index)"></span>\n        </td>\n    </tr>\n</table>');a.put("/s3/partials/progressbar.html",'<div scroll="" selected-tab="{{selectedTab}}" total-operation="{{totalOperationCount}}" ng-show=" totalOperationCount > 0 " class="progress-bar-footer" ng-class="{ open: isExpanded }">\n    <div ng-show="isExpanded" class="progress-bar-session">\n        <table>\n            <tr class="progress-bar-operation" ng-repeat="operation in showingOperations">\n                <th class="progress-bar-icon-and-name">\n                    <span class="operation-icon awsui-icon awsui-icon-link" ng-click="openModal(operation)" ng-class="getIconForOperation(operation.name)"></span>\n                    <div class="operation-name" ng-click="openModal(operation)"> {{operation.displayName}} <div class="upload-speed-report" ng-show="{{operation.name === \'Upload\' && operation.state === \'active\'}}"> ({{operation.currentUploadSpeed}}/s)</div></div>\n                </th>\n                <th class="progress-bar-real-progress-bar">\n                    <div class="operation-progress-bar {{ operation.state }}-fill">\n                        <div ng-if="operation.successPercentage !== 0" class="current-progress-fill" ng-style="{width: operation.successPercentage + \'%\'}">\n                            <span ng-if="operation.successPercentage >= thresholdPercentage" class="operation-percentage-text">{{operation.successPercentage}}% </span>\n                            <span ng-if="operation.successPercentage >= thresholdPercentage" class="operation-percentage-text" translate="">operation.detail.successful</span>\n                        </div>\n                        <div ng-if="operation.errorPercentage !== 0" class="current-error-fill" ng-style="{width: operation.errorPercentage + \'%\'}">\n                            <span ng-if="operation.errorPercentage >= thresholdPercentage" class="operation-percentage-text">{{operation.errorPercentage}}%</span>\n                            <span ng-if="operation.errorPercentage >= thresholdPercentage" class="operation-percentage-text" translate="">operation.detail.failed</span>\n                        </div>\n                    </div>\n                </th>\n\n                <th class="progress-bar-cancel-icon">\n                    <span class="operation-cancel-button blue-cancel-icon" ng-click="cancelOperation(operation)"></span>\n                </th>\n                <div class="awsui-util-clearfix"></div>\n            </tr>\n        </table>\n    </div>\n\n    <div class="operation-summary">\n        <div class="total-operations">\n            {{ \'operation.tab.totalOperations\' | translate }}\n        </div>\n        <div class="in-progress-expander" ng-class="{ \'cursorpointer\' : hoverOnInprogress &&  totalOngoingOperations.length > 0 || operationState.ongoingOperations,\n        \'cursornomal\' : hoverOnInprogress &&  totalOngoingOperations.length === 0,\n        \'deselectprogresstab\': !operationState.ongoingOperations && totalOngoingOperations.length > 0}" ng-mouseenter="hoverOnInprogress = true" ng-mouseleave="hoverOnInprogress = false" ng-click="expandOrCollapseOperations(allOperations.ongoingOperations, totalOngoingOperations.length !== 0, \'ongoingOperations\')">\n            {{ totalOngoingOperations.length }} {{ \'operation.tab.inProgress\' | translate }}\n        </div>\n        <div class="completed-expander" ng-class="{ \'cursorpointer\' : hoverOnComplete &&  completedOperations.length > 0 || operationState.completedOperations,\n        \'cursornomal\' : hoverOnComplete &&  completedOperations.length === 0,\n        \'deselectprogresstab\': !operationState.completedOperations && completedOperations.length > 0 }" ng-mouseenter="hoverOnComplete = true" ng-mouseleave="hoverOnComplete = false" ng-click="expandOrCollapseOperations(allOperations.completedOperations, completedOperations.length !== 0, \'completedOperations\')">\n            {{ completedOperations.length}} {{ \'operation.tab.success\' | translate }}\n        </div>\n        <div class="error-expander" ng-class="{ \'cursorpointer\' : hoverOnError &&  incompleteOperations.length > 0 || operationState.incompleteOperations,\n        \'cursornomal\' : hoverOnError &&  incompleteOperations.length === 0,\n        \'deselectprogresstab\': !operationState.incompleteOperations && incompleteOperations.length > 0}" ng-mouseenter="hoverOnError = true" ng-mouseleave="hoverOnError = false" ng-click="expandOrCollapseOperations(allOperations.incompleteOperations, incompleteOperations.length !== 0, \'incompleteOperations\')">\n            {{ incompleteOperations.length }} {{ \'operation.tab.error\' | translate }}\n        </div>\n    </div>\n</div>\n<detail-progress is-open="modalOpen" cancel-button-text="detailCancelButtonText" target-operation="detailOperation" cancel-operation-function="cancelFromDetailView" close-callback="closeDetailView"></detail-progress>');a.put("/s3/partials/replication.html",'<card card-summary-obj="cardSummaryObj" card-id="scrollCardId" is-open="cardOpen" ng-class="{ \'card-disable-CRR-water-mark\': !cardOpen, \'card-enable-CRR-water-mark\': cardOpen }">\n    <div transclude-name="header">\n        <span translate="bucketproperties.crossregionreplication.label.crossregionreplication"></span>\n        <div class="card-close-icon" ng-if="cardOpen" ng-click="cancelPressed($event)"></div>\n    </div>\n    <div transclude-name="content">\n        <p ng-if="!cardOpen" class="bucketproperties-summary" translate="bucketproperties.crossregionreplication.summary"></p>\n        <div class="awsui-row card-content-row">\n            <awsui-radio-group ng-if="cardOpen" ng-model="replicationObj.isEnabled">\n                <awsui-radio-button style="display: inline" value="Enabled" label="{{ \'replication.label.enable\' | translate }}" disabled="versioningStatus === S3Constants.BUCKET_PROPERTIES.DISABLE"></awsui-radio-button>\n                <awsui-tooltip text="{{\'replication.enable.tooltip\' | translate}}" position="right" size="small">\n                    <i class="awsui-icon alert-info-circle"></i>\n                </awsui-tooltip>\n                <awsui-alert ng-if="replicationObj.isEnabled == S3Constants.REPLICATION.DISABLED" class="warning-box" type="warning" dismissable="false">{{ \'replication.enablewarning\' | translate }}</awsui-alert>\n                <div class="enabled-replication-content" ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED" ng-click="$event.stopPropagation(); completeEdit()">\n                    <div class="source-section">\n                        <div class="section-header">\n                            <span translate="">replication.sectionheader.source</span>\n                            <div></div>\n                        </div>\n                        <div class="region-text">\n                            <span id="region-title" translate="">replication.label.region</span>\n                            <span>{{sourceRegion}}</span>\n                        </div>\n                        <awsui-control-group ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED">\n                            <awsui-select ng-change="resetError()" placeholder="{{ \'replication.placeholder.source\' | translate }}" ng-model="replicationObj.replicationType" items="sources">\n                            </awsui-select>\n                        </awsui-control-group>\n                    </div>\n                    <div class="destination-section">\n                        <div class="section-header">\n                            <span>{{ \'replication.sectionheader.destination\' | translate }}</span>\n                            <div></div>\n                        </div>\n                        <awsui-control-group ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED">\n                            <dropdown items="regionMapping" selected-item="replicationObj.destinationRegion" placeholder="{{ \'replication.placeholder.region\' | translate }}" filter="true"></dropdown>\n                        </awsui-control-group>\n                        <awsui-control-group ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED">\n                            <dropdown disabled="bucketList.length === 0" items="bucketList" selected-item="replicationObj.destinationBucket" placeholder="{{ \'replication.placeholder.destinationbucket\' | translate }}" filter="true"></dropdown>\n                        </awsui-control-group>\n                    </div>\n                    <div class="bottom-section">\n                        <awsui-control-group ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED && replicationObj.replicationType === \'bucket\'" label="{{ \'replication.label.storageclass\' | translate }}">\n                            <awsui-select ng-change="resetError()" placeholder="{{ \'replication.placeholder.storageclass\' | translate }}" ng-model="replicationObj.storageClass" items="storageClasses"></awsui-select>\n                        </awsui-control-group>\n                        <awsui-expandable-section class="collapsable-section" header="{{ \'replication.label.currentprefixes\' | translate }}" ng-if="cardOpen && replicationObj.replicationType === \'prefix\' && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED">\n                            <div class="replication-table">\n                                <table class="table table-condensed">\n                                    <thead>\n                                        <tr>\n                                            <td></td>\n                                            <td translate="">replication.table.prefix</td>\n                                            <td translate="">replication.table.storageclass</td>\n                                            <td></td>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                        <tr class="add-rule">\n                                            <td colspan="2" ng-click="addRule($event)">{{ \'replication.table.add\' | translate }}</td>\n                                            <td></td>\n                                            <td></td>\n                                        </tr>\n                                            <tr ng-repeat="rule in replicationObj.rulesArray" ng-click="editRule(rule, $event)">\n                                                <td>\n                                                    <div ng-if="rule.status === S3Constants.REPLICATION.ENABLED && !rule.markedForDelete" class="card-enabled-icon rule-status" ng-click="toggleRuleStatus(rule, $event)"></div>\n                                                    <div ng-if="rule.status === S3Constants.REPLICATION.DISABLED && !rule.markedForDelete" class="card-disabled-icon rule-status" ng-click="toggleRuleStatus(rule, $event)"></div>\n                                                    <span ng-if="rule.markedForDelete" class="awsui-icon awsui-icon-bigger times-circle" ng-click="toggleRuleStatus(rule, $event)"></span>\n                                                </td>\n                                                <td ng-if="rule.isEditing && !rule.prefixError">\n                                                    <awsui-textfield placeholder="{{ \'replication.placeholder.prefix\' | translate }}" ng-model="rule.prefix" ng-change="resetError()" ng-click="$event.stopPropagation()"></awsui-textfield>\n                                                </td>\n                                                <td ng-if="rule.isEditing && rule.prefixError">\n                                                    <awsui-textfield class="verification-error" placeholder="{{ \'replication.placeholder.prefix\' | translate }}" ng-change="resetError()" ng-model="rule.prefix" ng-click="$event.stopPropagation()"></awsui-textfield>\n                                                </td>\n                                                <td ng-if="rule.isEditing && !rule.storageError">\n                                                    <awsui-select ng-change="resetError()" placeholder="{{ \'replication.placeholder.storageclass\' | translate }}" ng-click="$event.stopPropagation()" ng-model="rule.storageClass" items="storageClasses"></awsui-select>\n                                                </td>\n                                                <td ng-if="rule.isEditing && rule.storageError">\n                                                    <awsui-select ng-change="resetError()" class="verification-error" placeholder="{{ \'replication.placeholder.storageclass\' | translate }}" ng-click="$event.stopPropagation()" ng-model="rule.storageClass" items="storageClasses"></awsui-select>\n                                                </td>\n                                                <td ng-if="!rule.isEditing">\n                                                    {{ rule.prefix }}\n                                                </td>\n                                                <td ng-if="!rule.isEditing">\n                                                    {{ storageClassesMap[rule.storageClass] }}\n                                                </td>\n                                                <td>\n                                                    <awsui-button icon="times-circle" variant="standalone-icon" ng-click="removeRule(rule, $event, true)"></awsui-button>\n                                                </td>\n                                            </tr>\n                                    </tbody>\n                                </table>\n                            </div>\n                        </awsui-expandable-section>\n                        <div class="section-header">\n                            <div></div>\n                        </div>\n                        <awsui-control-group ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED" label="{{ \'replication.label.selectrole\' | translate }}" class="crr-listrole">\n                            <awsui-select placeholder="{{ \'replication.placeholder.selectrole\' | translate }}" ng-model="replicationObj.role" items="iamRoles"></awsui-select>\n                        </awsui-control-group>\n                        <awsui-alert class="crr-listrole-error" header="Error" dismissible="false" type="error" ng-if="displayListRoleError()">{{listRoleError}}</awsui-alert>\n                    </div>\n                </div>\n            </awsui-radio-group>\n        </div>\n        <div class="awsui-row card-content-row">\n            <awsui-radio-group ng-if="cardOpen" ng-model="replicationObj.isEnabled">\n                <awsui-radio-button value="Disabled" label="{{ \'replication.label.disable\' | translate }}"></awsui-radio-button>\n                <div class="disabled-replication-content">\n                    <div>\n                        <awsui-button ng-if="cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.DISABLED && !forCreateBucketModal" text="{{ \'replication.label.delete\' | translate }}" click="deletePressed()" variant="danger" disabled="!replicationObj.configExists" loading="deleting">\n                        </awsui-button>\n                    </div>\n                </div>\n            </awsui-radio-group>\n        </div>\n        <a class="learn-more-card-closed-link" ng-if="!cardOpen" target="_blank" href="{{docLink}}" translate="">learn.more</a>\n        <awsui-alert class="warning-box" ng-if="errorMessage &&  cardOpen && replicationObj.isEnabled === S3Constants.REPLICATION.ENABLED" type="error">{{ errorMessage }}</awsui-alert>\n    </div>\n    <div transclude-name="footer">\n        <div class="bucket-properties-buttons" ng-if="cardOpen">\n            <awsui-button ng-if="cardOpen" text="{{ \'replication.label.cancel\' | translate }}" ng-click="cancelPressed($event)">\n            </awsui-button>\n            <awsui-button ng-if="cardOpen" text="{{ \'replication.label.save\' | translate }}" ng-click="savePressed($event)" variant="primary" loading="cardState.isSaving" data-disabled="isDisable()">\n            </awsui-button>\n        </div>\n    </div>\n</card>');a.put("/s3/partials/search.html",'<div class="object-search">\n    <div>\n        <div ng-repeat="prefixFilter in filters.prefixFilters track by $index" class="search-filter">\n            <span class="filter-identifier" translate="prefixsearch.identifier"></span>\n            <span class="filter-value">{{prefixFilter}}</span>\n            <span class="search-filter-cancel-button blue-cancel-icon" ng-click="removePrefixFilter(prefixFilter)"></span>\n        </div>\n        <div ng-repeat="tagFilter in filters.tagFilters track by $index" class="search-filter" ng-if="objectTaggingEnabled">\n            <span class="filter-identifier" translate="tagsearch.identifier"></span>\n            <span class="filter-value">{{tagFilter.tagKey}} | {{tagFilter.tagVal}}</span>\n            <span class="search-filter-cancel-button blue-cancel-icon" ng-click="removeTagFilter(tagFilter)"></span>\n        </div>\n    </div>\n        <div clickoutside="" on-click-outside="closeDropdown">\n        <div id="search-box" class="search-box">\n            <span class="search-icon" ng-if="!noBackendCalls"><i class="awsui-icon search"></i></span>\n            <span>\n                <span ng-show="shouldShowTag()" class="show-tag" translate="tagsearch.tag"></span>\n                <input type="text" class="input-field" ng-trim="false" ng-model="filters.input" ng-keydown="filterKeyDown($event)" ng-focus="openDropdown()" placeholder="{{getInputPlaceholder()}}" focus-when="prefixSearchInput">\n                \n            </span>\n        </div>\n        <div ng-show="dropdownOpen" id="search-dropdown">\n            <div ng-show="isSearchEmpty()" class="search-instruction" ng-class="{\'filter-instruction\':noBackendCalls}">\n                {{inputDropdownText}}\n            </div>\n            <div ng-show="!isSearchEmpty() && shouldShowTag()" ng-click="tagSearch(true)" class="search-instruction" translate="tagsearch.entervalue" ng-if="objectTaggingEnabled">\n            </div>\n            <div ng-show="!isSearchEmpty() && !shouldShowTag()">\n                <div class="search-option" ng-class="{\'search-option-selected\' : !tagSearchSelected}" ng-click="prefixSearch()" ng-mouseenter="highlightRow(false)" translate="{{tagSearchSelected ? \'prefixsearch.not.enter\' : \'prefixsearch.enter\'}}" translate-values="{ filterInput : filters.input }">\n                </div>\n                <div class="search-option" ng-class="{\'search-option-selected\' : tagSearchSelected}" ng-click="selectTag()" ng-mouseenter="highlightRow(true)" translate="{{tagSearchSelected ? \'tagsearch.enter\' : \'tagsearch.not.enter\'}}" translate-values="{ filterInput : filters.input }" ng-if="objectTaggingEnabled">\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="search-prefix-info" ng-if="prefixInfo" translate="" translate-values="{ bucket1 : bucketName + \'/\' + prefixInfo, bucket2: bucketName + prefixInfo }">prefixsearch.validation.slash.start.warning\n    </div>\n    <awsui-control-group validation-message="{{searchError}}" id="search-validation"></awsui-control-group>\n</div>');a.put("/s3/partials/storageConsoleLineChartAnalytics.html",'<div class="line-chart-container">\n  <div class="analytics-line-chart-heading">{{ heading }}</div>\n  <div id="{{ chartid }}" class="chartgraph"></div>\n</div>');a.put("/s3/partials/storageConsoleLineChartS3.html",'<div class="line-chart-container">\n  <div class="metrics-line-chart-heading">{{ heading }}</div>\n  <div id="{{ chartid }}" class="chartgraph"></div>\n</div>');a.put("/s3/partials/storagemanagement.html",'<div>\n    <awsui-button-group class="si-category-buttons">\n        <awsui-tooltip text="{{\'management.view.tooltip.lifecycle\'|translate}}" position="top">\n            <awsui-button class="si-action-button" text="{{ \'management.view.lifecycle\' | translate }}" ng-click="showView(S3Constants.MANAGEMENT.VIEWS.LIFECYCLE)" variant="{{ viewId === S3Constants.MANAGEMENT.VIEWS.LIFECYCLE ? \'primary\' : \'\' }}">\n            </awsui-button>\n        </awsui-tooltip>\n        <awsui-tooltip text="{{\'management.view.tooltip.analytics\'|translate}}" position="top">\n            <awsui-button class="si-action-button" text="{{ \'management.view.analytics\' | translate }}" ng-click="showView(S3Constants.MANAGEMENT.VIEWS.ANALYTICS)" variant="{{ viewId === S3Constants.MANAGEMENT.VIEWS.ANALYTICS ? \'primary\' : \'\' }}" fac-id="s3-an"></awsui-button>\n        </awsui-tooltip>\n        <awsui-tooltip text="{{\'management.view.tooltip.metrics\'|translate}}" position="top">\n            <awsui-button class="si-action-button" text="{{ \'management.view.metrics\' | translate }}" variant="{{ viewId === S3Constants.MANAGEMENT.VIEWS.CLOUDWATCH ? \'primary\' : \'\' }}" ng-click="showView(S3Constants.MANAGEMENT.VIEWS.CLOUDWATCH)" fac-id="s3-me"></awsui-button>\n        </awsui-tooltip>\n        <awsui-tooltip text="{{\'management.view.tooltip.inventory\'|translate}}" position="top">\n            <awsui-button class="si-action-button" text="{{ \'management.view.inventory\' | translate }}" variant="{{ viewId === S3Constants.MANAGEMENT.VIEWS.INVENTORY ? \'primary\' : \'\' }}" ng-click="showView(S3Constants.MANAGEMENT.VIEWS.INVENTORY)" fac-id="s3-oi"></awsui-button>\n        </awsui-tooltip>\n    </awsui-button-group>\n\n    <bucket-lifecycle ng-if="viewEnabled(S3Constants.MANAGEMENT.VIEWS.LIFECYCLE)"></bucket-lifecycle>\n    <analytics ng-if="viewEnabled(S3Constants.MANAGEMENT.VIEWS.ANALYTICS)"></analytics>\n    <cloudwatch-metrics ng-if="viewEnabled(S3Constants.MANAGEMENT.VIEWS.CLOUDWATCH)"></cloudwatch-metrics>\n    <bucket-reports ng-if="viewEnabled(S3Constants.MANAGEMENT.VIEWS.INVENTORY)"></bucket-reports>\n\n</div>');a.put("/s3/partials/storagemetrics.html",'<div>\n    <div class="clearfix"></div>\n    <div class="metrics-table">\n        <table>\n            <tr ng-repeat="metric in metricList">\n                <td>\n                    <div class="storage-management-error-box">\n                        <awsui-alert type="error" header="{{\'error.header\'|translate}}" visible="metric.error">\n                            {{metric.error}}\n                        </awsui-alert>\n                    </div>\n                    <div ng-if="metric.statistics.Datapoints">\n                        <div class="cloudwatch-link">\n                            <awsui-button target="_blank" href="{{deepLinks[$index]}}" variant="link" icon="external-link">\n                                <span translate="">management.metrics.cloudwatch</span>\n                            </awsui-button>\n                        </div>\n                        <div class="svg-chart-container">\n                            <storage-console-line-chart chartid="metric.chartId" data="metric.statistics.Datapoints" heading="metric.heading" isxdate="true" xid="timestamp" xscaleby="1000" yid="metric.statistic" xmin="metric.startTime" xmax="metric.endTime" totalwidth="940" totalheight="400" template-url="partials/storageConsoleLineChartS3.html">\n                            </storage-console-line-chart>\n                        </div>\n                        <div class="dimensions">\n                            <div class="square"></div>\n                            <span class="dimension-labels" ng-repeat="label in getChartLabels(metric)">{{ label }}</span>\n                            <div class="dimension-labels-stat">\n                                <span>\n                                    (<span translate="management.metric.statistic.{{metric.statistic.toLowerCase()}}"></span>)\n                                </span>\n                            </div>\n                        </div>\n                        <hr class="hr-props">\n                    </div>\n                </td>\n            </tr>\n        </table>\n    </div>\n</div>');a.put("/s3/partials/targetmbox.html",'\n<div ng-if="mBoxContent.length === 0">\n  <div class="js-mbox" data-mbox="en_s3_ed_1">\n    <div>{{ \'notification.text\' | translate }}</div>\n  </div>\n</div>\n\n<div ng-if="mBoxContent.length > 0">\n  <div class="js-mbox" data-mbox="en_s3_ed_1" ng-bind-html="mBoxContent | trusted" ng-style="{\'visibility\': \'visible\'}"></div>\n</div>\n \n<div ng-if="showDefault" class="mbox-default">\n  <div>{{ \'notification.text\' | translate }}</div>\n</div>');a.put("/s3/partials/updateobject.html",'<awsui-textfield class="input-text new-folder-input" ng-model="updateObject.name" ng-keypress="triggerKeyboardEvt($event)" value="{{defaultValue}}" placeholder="{{defaultPlaceholder}}" ng-click="$event.stopPropagation();" ng-dblclick="$event.stopPropagation();" auto-focus="true">\n</awsui-textfield>\n<awsui-alert class="input-error" type="error" header="{{ \'error.header\' | translate}}" ng-show="updateObject.errorMessage">{{updateObject.errorMessage}}</awsui-alert>\n<div class="create-folder-btn">\n    <awsui-button text="{{ \'updateobject.button.save\' | translate}}" ng-click="triggerAction($event)" ng-dblclick="$event.stopPropagation();" data-disabled="updateObject.name.length === 0"></awsui-button>\n    <awsui-button text="{{ \'updateobject.button.cancel\' | translate}}" ng-dblclick="$event.stopPropagation();" ng-click="resetOperationState($event, true)"></awsui-button>\n</div>');a.put("/s3/partials/upload.html",'<modal is-open="modalOpen" close-callback="closeModal" id="uploadModal" current-path="currentPath" steps="STEP" state="state" header-title="headerTitle" next-state="nextState" previous-state="previousState" set-state="setState" class="upload-modal">\n    <div transclude-name="content">\n        <div class="upload-modal-selected-files-properties" ng-show="haveSelectedItems() && state !== STEP.REVIEW">\n            <div class="upload-modal-selected-files-properties-inner-div truncate">\n                <span class="upload-modal-selected-files-properties-span">\n                    {{ getSelectedFilesData().files }} <span translate="uploadmodal.label.files"></span>\n                </span>\n                <span class="upload-modal-selected-files-properties-span">\n                    <span class="upload-modal-selected-files-properties-span-header" translate="uploadmodal.label.size"></span> {{ getSelectedFilesData().size | humanReadableBytes }}\n                </span>\n                <span class="upload-modal-selected-files-properties-span">\n                    <span class="upload-modal-selected-files-properties-span-header" translate="uploadmodal.label.path"></span> {{ currentPath }}\n                </span>\n            </div>\n        </div>\n        <div class="upload-modal-content">\n            <div ng-if="state === STEP.SELECT_FILES">\n                <div id="upload-modal-initial-select" ng-show="!haveSelectedItems()">\n                    <input type="file" id="uploadInput" name="uploadInput" fileread="" multiple="multiple">\n                    <label id="uploadInputNoFilesSelected" for="uploadInput">{{ \'uploadmodal.label.add.files\' | translate }}</label>\n                </div>\n\n                <awsui-alert type="error" header="Error" ng-show="errorMessage">\n                    {{ errorMessage }}\n                </awsui-alert>\n\n                <file-list-in-modal remove-item-from-upload="removeItemFromUpload(item)" close-icon-show="true" for-uploads="true" selected="selected"></file-list-in-modal>\n            </div>\n\n            \n            <div ng-if="state === STEP.PERMISSIONS" class="upload-modal-permissions-content">\n                <modal-permissions public-permissions="options.permissions.publicPermissions" user-permissions="options.permissions.userPermissions"></modal-permissions>\n            </div>\n            \n            <div ng-if="state === STEP.PROPERTIES" class="upload-modal-property-content">\n                <div class="upload-modal-properties-group">\n                    <div>\n                        <h2 class="upload-modal-properties-group-header" translate="uploadmodal.label.storage-class"></h2>\n                    </div>\n                    <h2 class="upload-modal-properties-group-desc" translate="uploadmodal.properties.storage.description"></h2>\n                    <awsui-radio-group ng-model="options.storageClass" ng-init="setStorageClassOption()">\n                        <table class="upload-modal-radio-button-properties">\n                            <tr>\n                                <td>\n                                    <awsui-radio-button class="radio-button" value="STANDARD">{{ \'uploadmodal.label.standard\' | translate }}</awsui-radio-button>\n                                </td>\n                                <td>\n                                    <awsui-radio-button class="radio-button" value="STANDARD_IA">{{ \'uploadmodal.label.standard_ia\' | translate }}</awsui-radio-button>\n                                </td>\n                                <td>\n                                    <awsui-radio-button class="radio-button" value="REDUCED_REDUNDANCY">{{ \'uploadmodal.label.reduced_redundancy\' | translate }}</awsui-radio-button>\n                                </td>\n                            </tr>\n                        </table>\n                    </awsui-radio-group>\n\n                </div>\n\n                <div class="upload-modal-properties-group">\n                    <div>\n                        <h2 class="upload-modal-properties-group-header" translate="uploadmodal.label.encryption"></h2>\n                    </div>\n                    <h2 class="upload-modal-properties-group-desc" translate="uploadmodal.properties.encryption.description"></h2>\n                        <awsui-radio-group ng-model="options.serverSideEncryption" ng-init="setEncryptionOption()" ng-change="updateKMSKey(options.serverSideEncryption)">\n                        <table class="upload-modal-radio-button-properties">\n                            <tr>\n                                <td>\n                                    <awsui-radio-button class="radio-button" value="NONE">{{ \'uploadmodal.label.none\' | translate }}</awsui-radio-button>\n                                </td>\n                                <td>\n                                    <awsui-radio-button class="radio-button" value="AES256">{{ \'uploadmodal.label.AES256\' | translate }}</awsui-radio-button>\n                                </td>\n                                <td fac-id="s3-kms">\n                                    <awsui-radio-button class="radio-button" value="KMS">{{ \'uploadmodal.label.kms\' | translate }}</awsui-radio-button>\n                                </td>\n                            </tr>\n                        </table>\n                    </awsui-radio-group>\n                    <awsui-control-group validation-message="{{ KMSServiceError }}">\n                        <awsui-select ng-if="options.serverSideEncryption===\'KMS\'" items="kmsKeys" placeholder="{{ \'uploadmodal.placeholder.kmskeys\' | translate }}" data-disabled="KMSServiceError" ng-model="options.kmsId" class="upload-modal-properties-kms-dropdown">\n                        </awsui-select>\n                    </awsui-control-group>\n                    <awsui-textfield class="upload-modal-kms-textfield" ng-if="options.kmsId===\'CUSTOM_ARN\'" ng-model="options.kmsARN"></awsui-textfield>\n                </div>\n\n                <div class="upload-modal-properties-group">\n                    <div>\n                        <h2 class="upload-modal-properties-group-header" translate="uploadmodal.label.metadata"></h2>\n                    </div>\n                    <h2 class="upload-modal-properties-group-desc" translate="uploadmodal.properties.metadata.description"></h2>\n                    <table class="upload-modal-metadata-properties">\n                        <thead>\n                        <th translate="uploadmodal.metadata.label.header"></th>\n                        <th translate="uploadmodal.metadata.label.value"></th>\n                        <th></th>\n                        </thead>\n\n                        <tbody>\n\n                        <tr ng-repeat="(key, value) in options.metadata">\n                            <td> {{ key }}</td>\n                            <td> {{ value }}</td>\n                            <td>\n                                <awsui-button variant="standalone-icon" icon="times" ng-click="deleteMetadataHeader(key)"></awsui-button>\n                            </td>\n                        </tr>\n                        <tr class="upload-modal-metadata-properties-textfield">\n                            <td>\n                                <awsui-select items="metadataHeaders.headers" placeholder="{{ \'uploadmodal.metadata.placehoder.selectheader\' | translate }}" ng-model="metadataHeaders.selectedHeader" ng-change="metaErrorReset()"></awsui-select>\n                            </td>\n                            <td>\n                                <awsui-textfield ng-model="metadataHeaders.selectedValue" ng-change="metaErrorReset()" placeholder="{{ \'uploadmodal.metadata.placehoder.headervalue\' | translate }}"></awsui-textfield>\n                            </td>\n                            <td>\n                                <awsui-button text="{{ \'uploadmodal.metadata.savebutton\' | translate }}" variant="normal" ng-click="addMetadataOptionsHeader(metadataHeaders.selectedHeader, metadataHeaders.selectedValue)" data-disabled="!metadataHeaders.selectedHeader || !metadataHeaders.selectedValue">\n                                </awsui-button>\n                            </td>\n                        </tr>\n\n                        <tr class="upload-modal-metadata-properties-textfield">\n                            <td>\n                                <awsui-textfield ng-model="metadataHeaders.customHeader" ng-init="metadataHeaders.customHeader =\'x-amz-meta-\'" ng-change="metaErrorReset()" placeholder="{{ \'uploadmodal.metadata.customheader\' | translate }}"></awsui-textfield>\n                            </td>\n                            <td>\n                                <awsui-textfield ng-model="metadataHeaders.customValue" ng-change="metaErrorReset()" placeholder="{{ \'uploadmodal.metadata.placehoder.headervalue\' | translate }}"></awsui-textfield>\n                            </td>\n                            <td>\n                                <awsui-button text="{{ \'uploadmodal.metadata.savebutton\' | translate }}" variant="normal" ng-click="addMetadataOptionsHeader(metadataHeaders.customHeader, metadataHeaders.customValue, true)" data-disabled="!metadataHeaders.customHeader || !metadataHeaders.customValue">\n                                </awsui-button>\n                            </td>\n                        </tr>\n                        <tr>\n                            <awsui-alert class="input-error" type="error" header="{{ \'error.header\' | translate }}" ng-if="metadataErrorMsg"> {{metadataErrorMsg}}\n                            </awsui-alert>\n                        </tr>\n\n\n                        </tbody>\n                    </table>\n                </div>\n                <div class="upload-modal-properties-group" fac-id="s3-ot-up">\n                    <h2 class="upload-modal-properties-group-header" translate="uploadmodal.label.tags"></h2>\n                    <h2 class="upload-modal-properties-group-desc" translate="uploadmodal.tags.description"></h2>\n                    <table class="upload-modal-metadata-properties">\n                        <thead>\n                        <th translate="uploadmodal.tags.label.header"></th>\n                        <th translate="uploadmodal.tags.label.value"></th>\n                        <th></th>\n                        </thead>\n\n                        <tbody>\n                        <tr ng-repeat="(key, value) in options.tags">\n                            <td> {{ key }}</td>\n                            <td> {{ value }}</td>\n                            <td>\n                                <awsui-button variant="standalone-icon" icon="times" ng-click="deleteTag(key)"></awsui-button>\n                            </td>\n                        </tr>\n                        <tr class="upload-modal-metadata-properties-textfield">\n                            <td>\n                                <awsui-control-group class="uploadmodal-tagerror" validation-message="{{ taggingError }}">\n                                    <awsui-textfield ng-model="currentTagging.key" placeholder="{{ \'uploadmodal.tags.placehoder.key\' | translate }}" ng-change="updateTaggingError(currentTagging.key)">\n                                    </awsui-textfield>\n                                </awsui-control-group>\n                            </td>\n                            <td class="tagvalue">\n                                <awsui-textfield ng-model="currentTagging.value" placeholder="{{ \'uploadmodal.tags.placehoder.value\' | translate }}">\n                                </awsui-textfield>\n                            </td>\n                            <td class="tagvalue">\n                                <awsui-button text="{{ \'uploadmodal.metadata.savebutton\' | translate }}" variant="normal" ng-click="addTag(currentTagging.key, currentTagging.value)" data-disabled="!currentTagging.key">\n                                </awsui-button>\n                            </td>\n\n                        </tr>\n                        </tbody>\n                    </table>\n\n                </div>\n            </div>\n            \n            <div ng-if="state === STEP.REVIEW">\n                <div class="review-section">\n                    <table id="review-table" class="review-table">\n                        <tr>\n                            <td class="review-subheader" translate="uploadmodal.label.files"></td>\n                            <td class="edit-button">\n                                <awsui-button class="button-in-darkbg" text="{{ \'uploadmodal.label.edit\' | translate }}" variant="link" ng-click="setState(STEP.SELECT_FILES)">\n                                </awsui-button>\n                            </td>\n                        </tr>\n                    </table>\n                    <table class="review-table-details">\n                        <tr class="details">\n                            <td>{{ getSelectedFilesData().files }} <span translate="uploadmodal.label.files"></span>\n                            </td>\n                            <td><span translate="uploadmodal.label.size"></span> {{ getSelectedFilesData().size |\n                                humanReadableBytes }}\n                            </td>\n                        </tr>\n                    </table>\n                </div>\n                <div class="review-section">\n                    <table class="review-table">\n                        <tr>\n                            <td class="review-subheader" translate="uploadmodal.label.permissions"></td>\n                            <td class="edit-button">\n                                <awsui-button class="button-in-darkbg" text="{{ \'uploadmodal.label.edit\' | translate }}" variant="link" ng-click="setState(STEP.PERMISSIONS)">\n                                </awsui-button>\n                            </td>\n                        </tr>\n                    </table>\n                    <table class="review-table-details">\n                        <tr class="details">\n                            <td>{{ getGranteeCount() }} <span translate="uploadmodal.label.grantees"></span></td>\n                        </tr>\n                    </table>\n                </div>\n                <div class="review-section">\n                    <table class="review-table">\n                        <tr>\n                            <td class="review-subheader" translate="uploadmodal.label.properties"></td>\n                            <td class="edit-button">\n                                <awsui-button class="button-in-darkbg" text="{{ \'uploadmodal.label.edit\' | translate }}" variant="link" ng-click="setState(STEP.PROPERTIES)">\n                                </awsui-button>\n                            </td>\n                        </tr>\n                    </table>\n                    <table class="review-table-details">\n                        <tr class="detail-name">\n                            <th translate="uploadmodal.label.encryption"></th>\n                            <th translate="uploadmodal.label.storage-class"></th>\n                        </tr>\n                        <tr class="details">\n                            <td>{{ getEncryptionTranslation() }}</td>\n                            <td>{{ getStorageClassTranslation() }}</td>\n                        </tr>\n                        <tr class="detail-name">\n                            <th class="awsui-util-pt-m" translate="uploadmodal.label.metadata"></th>\n                            <th></th>\n                        </tr>\n                        <tr class="details" ng-repeat="(key, value) in options.metadata">\n                            <td>{{ key }}</td>\n                            <td>{{ value }}</td>\n                        </tr>\n                        <tr class="detail-name" fac-id="s3-ot-up">\n                            <th class="awsui-util-pt-m" translate="uploadmodal.label.tags"></th>\n                            <th></th>\n                        </tr>\n                        <tr class="details" ng-repeat="(key, value) in options.tags" fac-id="s3-ot-up">\n                            <td>{{ key }}</td>\n                            <td>{{ value }}</td>\n                        </tr>\n                    </table>\n                </div>\n                <div ng-show="completedFiles.length > 0">\n                    <h3>Uploaded File(s):</h3>\n                    <table class="table table-striped">\n                        <thead>\n                        <tr>\n                            <th>Name</th>\n                            <th>Etag</th>\n                        </tr>\n                        </thead>\n                        <tbody>\n                        <tr ng-repeat="uploadResult in completedFiles">\n                            <td>{{ uploadResult.name }}</td>\n                            <td>{{ uploadResult.etag }}</td>\n                        </tr>\n                        </tbody>\n                    </table>\n                </div>\n                <div ng-show="errorFiles.length > 0">\n                    <h3>File(s) That Had Errors:</h3>\n                    <table class="table table-striped">\n                        <thead>\n                        <tr>\n                            <th>Name</th>\n                            <th>Error</th>\n                        </tr>\n                        </thead>\n                        <tbody>\n                        <tr ng-repeat="uploadResult in errorFiles">\n                            <td>{{ uploadResult.name }}</td>\n                            <td>{{ uploadResult.errorMessage }}</td>\n                        </tr>\n                        </tbody>\n                    </table>\n                </div>\n                <awsui-alert type="error" header="Error" ng-show="errorMessage">\n                    {{ errorMessage }}\n                </awsui-alert>\n            </div>\n        </div>\n    </div>\n    <div class="upload-modal-footer" transclude-name="footer">\n        <awsui-button text="{{ \'uploadmodal.footer.upload\' | translate }}" variant="primary" ng-class="{\'awsui-util-f-l\': state !== STEP.REVIEW, \'awsui-util-f-r primary-button\': state === STEP.REVIEW}" click="uploadNow()" data-disabled="uploadDisabled">\n        </awsui-button>\n        <awsui-button id="next" ng-if="state !== STEP.REVIEW" variant="primary" text="{{ \'uploadmodal.footer.next\' | translate }}" class="awsui-util-f-r primary-button" click="goToNextState()" data-disabled="!haveSelectedItems()">\n        </awsui-button>\n        <awsui-button id="previous" text="{{ \'uploadmodal.footer.previous\' | translate }}" ng-if="state !== STEP.SELECT_FILES" class="awsui-util-f-r" click="previousState()">\n        </awsui-button>\n    </div>\n</modal>');a.put("/s3/partials/versionsdropdown.html",'<div class="versions-dropdown" ng-class="{\'objects-side-panel-versions\': objectsPage}" ng-if="showVersionsDropdown.show == true" clickoutside="" on-click-outside="closeDropdown">\n    <table>\n        <tr class="version-row" ng-repeat="version in versions track by version.VersionId" ng-click="switchVersion($event, version)">\n            <td class="version-file-icon"><span class="awsui-icon awsui-icon-big" ng-class="version.fileIconClass"></span></td>\n            <td class="version-date">\n                {{version.LastModified | date:\'medium\'}}\n                <span class="date-subtext" ng-if="version.IsLatest === \'true\' && version.ETag">\n                    (<span translate="versionsdropdown.label.latestVersion"></span>)\n                </span>\n                <span class="date-subtext" ng-if="!version.ETag">\n                    (<span translate="versionsdropdown.label.deleteMarker"></span>)\n                </span>\n            </td>\n            <td class="version-storage-class">{{version.StorageClass}}</td>\n            <td class="version-download-icon">\n                <span class="awsui-icon awsui-icon-big download" ng-class="{\'awsui-icon-link\':!version.downloadDisabled, \'awsui-icon-disabled\':version.downloadDisabled}" ng-click="downloadVersion($event, version)"></span>\n            </td>\n            <td class="version-delete-icon"><span class="awsui-icon awsui-icon-big trash-o" ng-class="{\'awsui-icon-link\':!version.deleteDisabled, \'awsui-icon-disabled\':version.deleteDisabled}" ng-click="deleteVersion($event, version)"></span></td>\n        </tr>\n    </table>\n</div>')}]);